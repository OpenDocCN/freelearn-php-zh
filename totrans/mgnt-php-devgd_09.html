<html><head></head><body><div class="appendix" title="Appendix&#xA0;B.&#xA0;Understanding and Setting Up Our Development Environment"><div class="titlepage"><div><div><h1 class="title"><a id="appB"/>Appendix B. Understanding and Setting Up Our Development Environment</h1></div></div></div><p>In this appendix, we will go over the stack of technologies involved in running Magento and learn how to set up a proper environment for development. The following topics will be covered in this appendix:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">LAMP virtual machine</li><li class="listitem" style="list-style-type: disc">Setting up and using VirtualBox</li><li class="listitem" style="list-style-type: disc">Setting up and using Vagrant</li><li class="listitem" style="list-style-type: disc">IDEs and version control systems</li></ul></div><p>We will also learn how to set up a LAMP virtual machine from scratch and how to automate this process entirely using Vagrant and Chef.</p><div class="section" title="LAMP from scratch"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec52"/>LAMP from scratch</h1></div></div></div><p>
<span class="strong"><strong>LAMP</strong></span> (<span class="strong"><strong>Linux, Apache, MySQL, and PHP</strong></span>) is <a id="id472" class="indexterm"/>a solution stack of open source technologies that are used to build a web server and are the current standard for the running of Magento.</p><p>For a more detailed list of <a id="id473" class="indexterm"/>requirements, refer to <a class="ulink" href="http://www.magentocommerce.com/system-requirements">www.magentocommerce.com/system-requirements</a>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note36"/>Note</h3><p>Although nginx has seen a wider range of adoption among Magento developers, at the time of writing this book, Apache2 is still the community-accepted standard. We will focus on working with it.</p></div></div><p>As developers, there are multiple challenges and nuances of setting up and maintaining our development environment, such as the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Matching your development and production environments</li><li class="listitem" style="list-style-type: disc">Maintaining a consistent environment between different platforms and team members</li><li class="listitem" style="list-style-type: disc">Setting up a new environment can take several hours</li><li class="listitem" style="list-style-type: disc">Not all developers have the knowledge or experience required to set up a LAMP server on their own</li></ul></div><p>We can resolve the first two points with the help of Oracle's <a id="id474" class="indexterm"/>VirtualBox (<a class="ulink" href="http://www.virtualbox.org">www.virtualbox.org</a>). VirtualBox is powerful and widely popular virtualization engine that will allow us to create virtual machines. VMs can also be shared between developers and across all major operating systems.</p><div class="section" title="Getting VirtualBox"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec68"/>Getting VirtualBox</h2></div></div></div><p>VirtualBox is <a id="id475" class="indexterm"/>open source, and it is supported across all platforms. It can be downloaded directly from <a class="ulink" href="http://www.virtualbox.org/wiki/Downloads">www.virtualbox.org/wiki/Downloads</a>.</p><p>Now, we<a id="id476" class="indexterm"/> will proceed to set up a Linux virtual machine. We have selected Ubuntu server 12.04.2 LTS for its ease of use and widely available support. First, download the ISO file from <a class="ulink" href="http://www.ubuntu.com/download/server">www.ubuntu.com/download/server</a>; either 64-bit or 32-bit versions will work.</p><p>To create a new Linux virtual machine, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Start the VirtualBox manager and click on the <span class="strong"><strong>New</strong></span> button in the top-left corner:<div class="mediaobject"><img src="graphics/4195OS_09_01.jpg" alt="Getting VirtualBox"/></div></li><li class="listitem">A wizard dialog will pop up and guide us through the steps to create a bare virtual machine. The wizard will ask us for the basic information to set up the virtual machine:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>VM Name</strong></span>: This defines how we will name our virtual machine; let's name it <code class="literal">Magento_dev 01</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Memory</strong></span>: This is the value of system memory that will be assigned to the guest operating system when our VM starts, in order to run a full LAMP server; 1 GB or more is recommended</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Operating System Type</strong></span>: This is the type of OS that we will install later; in our case, we want to select <span class="strong"><strong>Linux/Ubuntu</strong></span>, and depending on our selection, VirtualBox will enable or disable certain VM options</li></ul></div></li><li class="listitem">Next, we need to<a id="id477" class="indexterm"/> specify a virtual hard disk. Select <span class="strong"><strong>Create a virtual hard drive now</strong></span>.<div class="mediaobject"><img src="graphics/4195OS_09_03.jpg" alt="Getting VirtualBox"/></div></li><li class="listitem">There are many hard disk options available, but for most purposes, selecting <span class="strong"><strong>VDI</strong></span> (which is <a id="id478" class="indexterm"/><span class="strong"><strong>VirtualBox Disk Image</strong></span>) will suffice. This will create a single file on our host operating system.</li><li class="listitem">We now <a id="id479" class="indexterm"/>need to select the type of storage on the physical drive. We are provided with two options:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Dynamically allocated</strong></span>: The disk image will grow automatically as the files and usage on our guest operating system grow</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Fixed Size</strong></span>: This option will limit the size of the virtual disk from the start</li></ul></div></li><li class="listitem">Next, we will need to specify the size of our virtual hard disk. We want to adjust the size depending on how many Magento installations we plan to use.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note37"/>Note</h3><p>In general, we want to keep at least 2 GB per Magento installation and another 3 GB if we are running the database server on the same installation. This is not to say that all this space will be used at once or whether it will even be used at all, but Magento installations can use a lot of disk space once product images and cache files are factored in.</p></div></div></li><li class="listitem">Finally, we just need to click on the <span class="strong"><strong>Create</strong></span> button.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note38"/>Note</h3><p>The main difference between the fixed size hard disk and the dynamically allocated hard disk is that the fixed size hard disk will reserve the space on the physical hard drive right from the start, whereas the dynamically allocated hard disk will grow incrementally until it gets to the specified limits.</p></div></div></li></ol></div><p>The newly created box will appear on the left-hand side navigation menu, but before we start our recently created VM, we need to make some changes:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Select our newly created VM and click on the <span class="strong"><strong>Settings</strong></span> button on the top.</li><li class="listitem">Open the <span class="strong"><strong>Network</strong></span> menu and select <span class="strong"><strong>Adapter 2</strong></span>. We want to set this box up as a bridged adapter to our main network interface. This will allow us to connect remotely using <a id="id480" class="indexterm"/><span class="strong"><strong>SSH</strong></span>.<div class="mediaobject"><img src="graphics/4195OS_09_04.jpg" alt="Getting VirtualBox"/></div></li><li class="listitem">Go to the <a id="id481" class="indexterm"/><span class="strong"><strong>System</strong></span> menu and change the <span class="strong"><strong>Boot Order</strong></span> value, so that the CD/DVD-ROM boots first.</li><li class="listitem">In the <span class="strong"><strong>Storage</strong></span> menu, select one of the empty IDE controllers and mount our previously downloaded Ubuntu ISO image.<div class="mediaobject"><img src="graphics/4195OS_09_02.jpg" alt="Getting VirtualBox"/></div></li></ol></div></div><div class="section" title="Booting our virtual machine"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec69"/>Booting our virtual machine</h2></div></div></div><p>At this <a id="id482" class="indexterm"/>point, we have successfully installed and configured our VirtualBox instance and are now ready to boot our new virtual machine for the first time. To do this, just select the VM in the left sidebar and click on the <span class="strong"><strong>Start</strong></span> button at the top.</p><p>A new window will pop up with an interface to the VM. Ubuntu will take a few minutes to boot up.</p><p>Once Ubuntu has finished booting up, we will see two menus. The first menu will allow us to select the language, and the second one is the main menu that provides several options. In our case, we just want to proceed with <span class="strong"><strong>Install Ubuntu Server</strong></span>:</p><div class="mediaobject"><img src="graphics/4195OS_09_05.jpg" alt="Booting our virtual machine"/></div><p>We should now <a id="id483" class="indexterm"/>see the Ubuntu installation wizard, which will ask for our language and keyboard settings. After selecting the appropriate settings for our country and language, the installer will proceed to load all the necessary packages in the memory. This can take a few minutes.</p><p>Ubuntu will proceed to configure our main network adapter, and once the automatic configuration is done, we will be asked to set up the hostname for the virtual machine. We can leave the hostname to the default settings.</p><div class="mediaobject"><img src="graphics/4195OS_09_06.jpg" alt="Booting our virtual machine"/></div><p>The next screen <a id="id484" class="indexterm"/>will request that we enter the full name of our user; for this example, let's use <code class="literal">Magento Developer</code>.</p><div class="mediaobject"><img src="graphics/4195OS_09_10.jpg" alt="Booting our virtual machine"/></div><p>Next, we will be<a id="id485" class="indexterm"/> asked to create a username and password. Let's use <code class="literal">magedev</code> as our username.</p><div class="mediaobject"><img src="graphics/4195OS_09_07.jpg" alt="Booting our virtual machine"/></div><p>Let's set <code class="literal">magento2013</code> as our password.</p><div class="mediaobject"><img src="graphics/4195OS_09_08.jpg" alt="Booting our virtual machine"/></div><p>On the next <a id="id486" class="indexterm"/>screens, we will be asked to confirm our password and set up the correct time zone. After entering the right values, the installation wizard will show the following screen, asking about our partition settings:</p><div class="mediaobject"><img src="graphics/4195OS_09_13.jpg" alt="Booting our virtual machine"/></div><p>In our case, we <a id="id487" class="indexterm"/>want to select <span class="strong"><strong>Guided – use entire disk and set up LVM</strong></span>; let's confirm that we are partitioning our virtual disk.</p><div class="mediaobject"><img src="graphics/4195OS_09_14.jpg" alt="Booting our virtual machine"/></div><p>We will be asked to confirm our changes a final time; select <span class="strong"><strong>Finish partitioning and Write changes to the disk</strong></span>.</p><div class="mediaobject"><img src="graphics/4195OS_09_15.jpg" alt="Booting our virtual machine"/></div><p>The installation<a id="id488" class="indexterm"/> wizard will ask us to select predefined packages to install; one of the available options is <span class="strong"><strong>LAMP server</strong></span>.</p><p>Although this is highly convenient, we don't want to install the LAMP server that comes prepackaged with our Ubuntu CD; we will be installing all the LAMP components manually, to guarantee that they are set up to specific needs and are up to date with the latest patches.</p><p>However, for this, we will need an SSH server; select <span class="strong"><strong>OpenSSH server</strong></span> from the list and click on <span class="strong"><strong>Continue</strong></span>.</p><div class="mediaobject"><img src="graphics/4195OS_09_15B.jpg" alt="Booting our virtual machine"/></div><p>The installation of <a id="id489" class="indexterm"/>Ubuntu is complete, and it will reboot into our newly installed virtual box.</p><p>We are almost ready to proceed with the installation of the rest of our environment, but first, we need to update our package manager repository definitions, log in to the console, and run the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apt-get update</strong></span>
</pre></div><p>
<span class="strong"><strong>APT</strong></span> stands for <a id="id490" class="indexterm"/>
<span class="strong"><strong>Advance Packaging Tool</strong></span> and is one of the core libraries included with most Debian GNU/Linux distributions; <code class="literal">apt</code> greatly simplifies the process of installing and maintaining software on our systems.</p><p>Once <code class="literal">apt-get</code> has finished updating all the repository sources, we can proceed with the installation of the other components of our LAMP server.</p></div><div class="section" title="Installing Apache2"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec70"/>Installing Apache2</h2></div></div></div><p>Apache<a id="id491" class="indexterm"/> is an<a id="id492" class="indexterm"/> HTTP server. Currently, it is used to host over 60 percent of the websites on the Web and is the accepted standard for the running of Magento stores. There are many guides and tutorials available online in order to fine-tune and tweak Apache2 to increase Magento's performance.</p><p>Installing <a id="id493" class="indexterm"/>apache is as simple as running the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apt-get install apache2 -y</strong></span>
</pre></div><p>This will take care of installing Apache2 and all the required dependencies for us. If everything has been installed correctly, we can now test it by opening our browser and entering <code class="literal">http://192.168.36.1/</code>.</p><p>By default, Apache runs as a service and can be controlled with the following commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apache2ctl stop </strong></span>
<span class="strong"><strong>$ sudo apache2ctl start </strong></span>
<span class="strong"><strong>$ sudo apache2ctl restart </strong></span>
</pre></div><p>You should now see Apache's default web page with the <span class="strong"><strong>It Works!</strong></span> message.</p></div><div class="section" title="Installing PHP"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec71"/>Installing PHP</h2></div></div></div><p>
<span class="strong"><strong>PHP</strong></span> is<a id="id494" class="indexterm"/> a server-side scripting language and stands for <a id="id495" class="indexterm"/>
<span class="strong"><strong>PHP Hypertext Processor</strong></span>. Magento is <a id="id496" class="indexterm"/>implemented on PHP5 and Zend Framework, and we would need to install PHP and some additional libraries in order to run it.</p><p>Let's use <code class="literal">apt-get</code> again and run the following commands in order to get PHP5 and all the necessary libraries installed:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apt-get install php5 php5-curl php5-gd php5-imagick php5-imap php5-mcrypt php5-mysql -y</strong></span>
<span class="strong"><strong>$ sudo apt-get install php-pear php5-memcache -y</strong></span>
<span class="strong"><strong>$ sudo apt-get install libapache2-mod-php5 -y</strong></span>
</pre></div><p>The first command installed not only PHP5, but it also installed additional packages required by Magento in order to connect with our database and manipulate images.</p><p>The second command will install PEAR, a PHP package manager, and a PHP memcached adapter.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note39"/>Note</h3><p>Memcached is high-performance, distributed memory caching system; this is an optional caching system for Magento.</p></div></div><p>The third command installs and sets up the PHP5 module for Apache.</p><p>We can finally test that our PHP installation is working by running the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ php -v</strong></span>
</pre></div></div><div class="section" title="Installing MySQL"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec72"/>Installing MySQL</h2></div></div></div><p>MySQL <a id="id497" class="indexterm"/>is a popular choice of database for many web applications, and Magento is no exception. We will need to install and set up MySQL as part of the development stack:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apt-get install mysql-server mysql-client -y</strong></span>
</pre></div><p>During the installation, we will be asked to enter a root password; use <code class="literal">magento2015</code>. Once the installation has finished, we should have a MySQL service instance running in the background. We can test it by trying to connect to the MySQL server:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo mysql -uroot -pmagento2015</strong></span>
</pre></div><p>If everything is installed correctly, we should see the following <code class="literal">mysql</code> server prompt:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mysql&gt;</strong></span>
</pre></div><p>At this point, we have a fully functional LAMP environment that can be used not only to develop and work on Magento websites, but also for any other kind of PHP development.</p></div><div class="section" title="Putting everything together"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec73"/>Putting everything together</h2></div></div></div><p>At this point, we <a id="id498" class="indexterm"/>have a basic LAMP setup up and running. However, to work with Magento, we would need to perform some configuration changes and additional setup.</p><p>The first thing that we will need to do is create a location to store our development sites files, so we will run the following commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo mkdir -p /srv/www/magento_dev/public_html/</strong></span>
<span class="strong"><strong>$ sudo mkdir /srv/www/magento_dev/logs/</strong></span>
<span class="strong"><strong>$ sudo mkdir /srv/www/magento_dev/ssl/</strong></span>
</pre></div><p>This will create the necessary folder structure for our first Magento site. Now, we need to check out the latest version of Magento. We can quickly get the files using <span class="strong"><strong>SVN</strong></span>.</p><p>We would need to install SVN first on our server with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apt-get install subversion -y</strong></span>
</pre></div><p>Once the installer has finished, open the <code class="literal">magento_dev</code> directory and run the <code class="literal">svn</code> command to get the latest version files:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ cd /srv/www/magento_dev </strong></span>
<span class="strong"><strong>$ sudo svn export --force http://svn.magentocommerce.com/source/branches/1.9 public_html/</strong></span>
</pre></div><p>We will also need to fix some of the permissions on our new Magento copy:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo chown -R www-data:www-data public_html/</strong></span>
<span class="strong"><strong>$ sudo chmod -R 755 public_html/var/ </strong></span>
<span class="strong"><strong>$ sudo chmod -R 755 public_html/media/ </strong></span>
<span class="strong"><strong>$ sudo chmod -R 755 public_html/app/etc/</strong></span>
</pre></div><p>Next, we need <a id="id499" class="indexterm"/>to create a new database for our Magento installation. Let's open our <code class="literal">mysql</code> shell:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo mysql -uroot -pmagento2015</strong></span>
</pre></div><p>Once in the mysql shell, we can use the create command, which should be followed by the type of entity (database or table) we want to create and the database name in order to create a new database:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mysql&gt; create database magento_dev;</strong></span>
</pre></div><p>Although we could use the root credentials to access our development database, this is not a recommended practice to follow because it could compromise not only a single site, but also full database server. MySQL accounts are restricted based on privileges we want, in order to create a new set of credentials that has privileges limited to only our working database:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mysql&gt; GRANT ALL PRIVILEGES ON magento_dev.* TO 'mage'@'localhost' IDENTIFIED BY 'dev2015$#';</strong></span>
</pre></div><p>Now, we need to properly set up Apache2 and enable some additional modules; fortunately, this version of Apache comes with a set of useful commands:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">a2ensite</code>: This <a id="id500" class="indexterm"/>creates symlinks between the <code class="literal">vhosts</code> files in the <code class="literal">site-available</code> folder and the <code class="literal">sites-enabled</code> folder in order to allow the Apache server to read these files.</li><li class="listitem" style="list-style-type: disc"><code class="literal">a2dissite</code>: This <a id="id501" class="indexterm"/>removes the symlinks created the by the <code class="literal">a2ensite</code> command. It effectively disables the site.</li><li class="listitem" style="list-style-type: disc"><code class="literal">a2enmod</code>: This is<a id="id502" class="indexterm"/> used to create symlinks between the <code class="literal">mods-enabled</code> directory and the module configuration files.</li><li class="listitem" style="list-style-type: disc"><code class="literal">a2dismod</code>: This <a id="id503" class="indexterm"/>will remove the symlinks from <code class="literal">mods-enabled</code>. This command will prevent the module from being loaded by Apache.</li></ul></div><p>Magento uses the <code class="literal">mod_rewrite</code> module to generate URLs. The <code class="literal">mod_rewrite</code> module uses a rule-based rewriting engine to rewrite request URLs on the fly.</p><p>We can enable <code class="literal">mod_rewrite</code> with the <code class="literal">a2enmod</code> command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo a2enmod rewrite</strong></span>
</pre></div><p>The next step will require that we create a new virtual host file under the <code class="literal">site-available</code> directory:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo nano /etc/apache2/sites-available/magento.localhost.com</strong></span>
</pre></div><p>The <code class="literal">nano</code> command <a id="id504" class="indexterm"/>will open a shell text editor, where we can set up the configuration for our virtual domain:</p><div class="informalexample"><pre class="programlisting">&lt;VirtualHost *:80&gt;
   ServerAdmin magento@locahost.com
   ServerName magento.localhost.com
   DocumentRoot /srv/www/magento_dev/public_html

   &lt;Directory /srv/www/magento_dev/public_html/&gt;
      Options Indexes FollowSymlinks MultiViews
      AllowOverride All
      Order allow,deny
      allow from all
   &lt;/Directory&gt;
   ErrorLog /srv/www/magento_dev/logs/error.log
   LogLevel warn
&lt;/VirtualHost&gt;</pre></div><p>To save the new virtual host file, press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>O</em></span> and then press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span>. The virtual host file will tell Apache where it can find the site files and what permissions are to be given to it. In order for the new configuration changes to take effect, we need to enable the new site and restart Apache. We can use the following commands to do this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo a2ensite magento.localhost.com</strong></span>
<span class="strong"><strong>$ sudo apache2ctl restart</strong></span>
</pre></div><p>We are nearly ready to install Magento. We just need to set up a local mapping into our host system host file, using the following for Windows and Unix respectively:</p><p>Using Windows, we can do the following:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">C:\system32\drivers\etc\hosts</code> in Notepad.</li><li class="listitem">Add the following line at the end of this file: <code class="literal">192.168.36.1 magento.localhost.com</code>.</li></ol></div><p>Using Unix/Linux/OS X, we can do the following:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">/etc/hosts</code> using nano:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo nano /etc/hosts</strong></span>
</pre></div></li><li class="listitem">Add the following line at the end of this file: <code class="literal">192.168.36.1 magento.localhost.com</code>.</li></ol></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note40"/>Note</h3><p>If you are facing problems making the necessary changes on your <code class="literal">hosts</code> files, refer to <a class="ulink" href="http://www.magedevguide.com/hostfile-help">http://www.magedevguide.com/hostfile-help</a>.</p></div></div><p>We now can <a id="id505" class="indexterm"/>install Magento by opening <code class="literal">http://magento.localhost.com</code> in our browser. Toward the end, we should see the installer wizard. Follow the steps as indicated by the wizard, and you are set to go!</p><div class="mediaobject"><img src="graphics/4195OS_09_09.jpg" alt="Putting everything together"/></div></div></div></div>
<div class="section" title="Up and running with Vagrant"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec53"/>Up and running with Vagrant</h1></div></div></div><p>Previously, we <a id="id506" class="indexterm"/>created a Magento installation wizard using a VM. Although using a VM gives us a reliable environment, setting our LAMP for each of our Magento staging installations can still be very complicated. This is especially true for developers who don't have experience working in a Unix/Linux environment.</p><p>What if we could get all the benefits of running a VM but with a completely automated setup process? What if we were able to have new VM instances created and configured on the fly for each of our staging websites?</p><p>This is possible using Vagrant in combination with Chef. We can create an automated VM without the need for extensive knowledge of Linux or the different LAMP components.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note41"/>Note</h3><p>Currently, Vagrant supports VirtualBox 4.0.x, 4.1.x, and 4.2.x.</p></div></div><div class="section" title="Installing Vagrant"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec74"/>Installing Vagrant</h2></div></div></div><p>Vagrant <a id="id507" class="indexterm"/>can be downloaded directly from <a class="ulink" href="http://downloads.vagrantup.com">downloads.vagrantup.com</a>. Furthermore, its packages and installers are available for multiple platforms. Once you have downloaded Vagrant, run the installation file.</p><p>Once we have installed both Vagrant and VirtualBox, starting a base VM is as simple as typing the following lines in the terminal or Command Prompt depending on the OS you use:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ vagrant box add lucid32 http://files.vagrantup.com/lucid32.box</strong></span>
<span class="strong"><strong>$ vagrant init lucid32</strong></span>
<span class="strong"><strong>$ vagrant up</strong></span>
</pre></div><p>These commands will start a new Vagrant box with Ubuntu Linux installed. From this point onward, we could start installing our LAMP server as per normal. But why should we spend an hour to configure and set up a LAMP server for each project when we can use Chef to automatically do it? Chef is a configuration management tool written in Ruby that integrates into Vagrant.</p><p>To make it easier for developers to start working with Magento, I have created a Vagrant repository in GitHub called <code class="literal">magento-vagrant</code> that includes all the necessary cookbooks and recipes for Chef. The <code class="literal">magento-vagrant</code> repository also includes a new cookbook that will take care of the specific Magento setup and configuration.</p><p>In order to start working with <code class="literal">magento-vagrant</code>, you will need a working copy of Git.</p><p>In Ubuntu, run this command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo apt-get install git-core -y</strong></span>
</pre></div><p>In Windows, we<a id="id508" class="indexterm"/> can use the native tool found at <a class="ulink" href="http://windows.github.com/">http://windows.github.com/</a> to download and manage our repositories.</p><p>Regardless of the operating system that you are using, we will need to check out a copy of this repository into our local filesystem. We will use <code class="literal">C:/Users/magedev/Documents/mage-vagrant/</code> to download our repository. Inside the <code class="literal">mage-vagrant</code> folder, we will find the following files and directories:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">cookbooks</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">data_bags</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Public</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">.vagrant</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">Vagrantfile</code></li></ul></div><p>The <code class="literal">magento-vagrant</code> repository includes cookbooks for each of the components of our development environment, which will be installed automatically as soon as we start our new VagrantBox.</p><p>The only thing left to do now is to set up our development sites. The process to add new Magento sites to our vagrant installation has been simplified through the use of Vagrant and Chef.</p><p>Inside the <code class="literal">data_bags</code> directory, we have one file for each Magento installation inside our VagrantBox; the default repository comes with an example installation of Magento CE 1.7.</p><p>For each site, we will need to create a new JSON file containing all the settings that Chef will need. Let's take a look at the <code class="literal">magento-vagrant</code> default file.</p><p>The file location is <code class="literal">C:/Users/magedev/Documents/mage-vagrant/data_bags/sites/default.json</code>. Here are the contents of the file:</p><div class="informalexample"><pre class="programlisting">{
    "id": "default",
    "host": "magento.localhost.com",
    "repo": [
        "url": "svn.magentocommerce.com/source/branches/1.7",
        "revision": "HEAD"   
     ],
   "database": [
       "name": "magento_staging",
       "username": "magento",
       "passwod": "magento2015$"
   ]
}</pre></div><p>This will <a id="id509" class="indexterm"/>automatically set up a Magento installation using the latest files from the Magento repository.</p><p>Adding new sites to our VagrantBox is just matter of adding a new JSON file to the corresponding site and restarting the VagrantBox.</p><p>Now that we have a running Magento installation, let's look into<a id="id510" class="indexterm"/> choosing a proper <span class="strong"><strong>Integrated Development Environment</strong></span> (<span class="strong"><strong>IDE</strong></span>).</p></div></div>
<div class="section" title="Choosing an IDE"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec54"/>Choosing an IDE</h1></div></div></div><p>Choosing the<a id="id511" class="indexterm"/> right IDE is mostly the matter of a developer's personal taste. However, choosing the right IDE can be critical for a Magento developer.</p><p>The challenge for the IDEs comes mostly from Magento's extensive usage of factory names. This makes the implementation of certain features difficult, such as code completion, also known as IntelliSense. Currently, there are two IDEs that excel in their native support for Magento: <span class="strong"><strong>NetBeans</strong></span> and <a id="id512" class="indexterm"/>
<span class="strong"><strong>PhpStorm</strong></span>.</p><p>Although <a id="id513" class="indexterm"/>NetBeans is open source and has been around for a long time, PhpStorm has been taking the upper hand and gaining more support from the Magento Community.</p><p>Furthermore, the recent release of <a id="id514" class="indexterm"/>
<span class="strong"><strong>Magicento</strong></span>, a plugin specifically created to extend and integrate Magento into PhpStorm, has made it the best option currently available.</p></div>
<div class="section" title="Working with a version control system"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec55"/>Working with a version control system</h1></div></div></div><p>The Magento code base <a id="id515" class="indexterm"/>is very extensive and is comprised of over 7,000 files and close to a million and a half lines of code. For this reason, working with a version control system is not only good practice, but also a necessity.</p><p>Version control systems <a id="id516" class="indexterm"/>are used to keep track of changes across multiple files and by multiple developers. Using a version control system, we gain access to very powerful tools.</p><p>Of the several version control systems available <span class="strong"><strong>(git</strong></span>, <span class="strong"><strong>svn</strong></span>, <span class="strong"><strong>mercurial</strong></span>), Git deserves special attention due to its simplicity and flexibility. By releasing the upcoming version 2 of Magento on GitHub, a Git hosting service, the Magento core development team has recognized the importance that Git has among the Magento community.</p><p>For more information on <a id="id517" class="indexterm"/>Magento2, refer to <a class="ulink" href="https://github.com/magento/magento2">https://github.com/magento/magento2</a>.</p><p>GitHub now specifically includes a .<code class="literal">gitignore</code> file for Magento, which will ignore all the files in the Magento core and only keep track of our own code.</p><p>That said, there are a several version control concepts that we need to keep in mind when working with our Magento projects:</p><p>
<span class="strong"><strong>Branching</strong></span>: This<a id="id518" class="indexterm"/> allows us to work on new features without affecting our trunk (stable release).</p><p>
<span class="strong"><strong>Merging</strong></span>: This <a id="id519" class="indexterm"/>is used to move code from one place to another. Usually, this is done from a development brand in our trunk once the code is ready to be moved into production.</p><p>
<span class="strong"><strong>Tagging</strong></span>: This is <a id="id520" class="indexterm"/>used to create snapshots of a release.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec56"/>Summary</h1></div></div></div><p>In this appendix, we learned about:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Setting up and working with LAMP environments</li><li class="listitem" style="list-style-type: disc">Setting development environments across multiple platforms</li><li class="listitem" style="list-style-type: disc">Creating and provisioning Vagrant virtual machines</li><li class="listitem" style="list-style-type: disc">Working with Chef recipes</li><li class="listitem" style="list-style-type: disc">Using version control systems for Magento development</li></ul></div><p>Having a proper environment is the first step toward starting development for Magento and is an integral part of our Magento toolbox.</p><p>Now that we have a development environment set up and ready to use, it's time to dive deep into Magento's fundamental concepts. These concepts will give us the necessary tools and knowledge required to develop with Magento.</p></div></body></html>
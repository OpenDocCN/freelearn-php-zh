["```php\n    'library_path' => '/opt/ImageMagick/bin'\n    ```", "```php\n    <?php if (! defined('BASEPATH')) exit('No direct script access allowed');\n\n    class Upload extends CI_Controller {\n      function __construct() {\n        parent::__construct();\n        $this->load->helper('form');\n        $this->load->helper('url');\n      }\n\n      function index() {\n        $this->load->view('upload/upload', array('error' => ' ' ));\n      }\n\n      function do_upload() {\n        $config['upload_path'] = '/path/to/upload/dir/';\n        $config['allowed_types'] = 'gif|jpg|png';\n        $config['max_size'] = '10000';\n        $config['max_width'] = '1024';\n        $config['max_height'] = '768';\n\n        $this->load->library('upload', $config);\n\n        if (! $this->upload->do_upload()) {\n          $error = array('error' => $this->upload->display_errors());\n          $this->load->view('upload/upload', $error);\n        } else {\n    $data = array('upload_data' => $this->upload->data());\n          echo '<pre>';\n          var_dump($data);\n          echo '</pre>';\n             }\n      }  \n    }\n    ```", "```php\n    <?php if ($error) : ?>\n    <?php echo $error ; ?>\n    <?php endif ; ?>\n\n    <?php echo form_open_multipart('upload/do_upload');?>\n\n    <input type = \"file\" name = \"userfile\" size = \"20\" />\n\n    <br /><br />\n\n    <input type = \"submit\" value = \"upload\" />\n\n    <?php echo form_close() ; ?>\n    ```", "```php\n$config['upload_path'] = '/path/to/upload/dir';\n$config['allowed_types'] = 'gif|jpg|png';\n$config['max_size'] = '10000';\n$config['max_width'] = '1024';\n$config['max_height'] = '768';\n```", "```php\n    <?php if (! defined('BASEPATH')) exit('No direct script access allowed');\n    class Image_manip {\n    }\n    ```", "```php\n    function __construct() {\n    \tparent::__construct();\n    \t$this->load->helper('form');\n    \t$this->load->helper('url');\n    \t$this->load->library('image_manip');\n    }\n    ```", "```php\n    if ( ! $this->upload->do_upload()) {\n    \t$error = array('error' => $this->upload->display_errors());\n    \t$this->load->view('upload/upload', $error);\n    } else {\n    \t$data = array('upload_data' => $this->upload->data());\n\n    \t$result = $this->upload->data();\n    \t$origional_image = $result['full_path'];\n\n    \t$data = array(\n    \t\t'image_library' => 'gd2',\n    \t\t'source_image' => $origional_image,\n    \t\t'create_thumb' => TRUE,\n    \t\t'maintain_ratio' => TRUE,\n    \t\t'width' => '75',\n    \t\t'height' => '50'\n    \t\t);\n\n    \tif ($this->image_manip->resize_image($data)) {\n    \t\techo 'Image successfully resized<br /><pre>';\n    \t\tvar_dump($result);\n    \t\techo '</pre>';\n    \t} else {\n    \t\techo 'There was an error with the image processing.';\n    \t}\n    }\n    ```", "```php\n      function resize_image($data) {\n        $CI =& get_instance();\n        $CI->load->library('image_lib', $data);\n        if ($CI->image_lib->resize()) {\n          return true;\n        } else {\n          echo $CI->image_lib->display_errors();\n        }\n      }\n    ```", "```php\n  $this->image_manip->resize_image($data);\n```", "```php\n  $CI = & get_instance();\n  $CI->load->library('image_lib', $data);\n```", "```php\n  if ($CI->image_lib->resize()) {\n    return true;\n  } else {\n    echo $CI->image_lib->display_errors();\n  }\n```", "```php\n    <?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n    class Image_manip {\n    }\n    ```", "```php\n      function rotate($data) {\n        $CI = & get_instance();\n        $CI->load->library('image_lib', $data);\n\n        $CI->image_lib->initialize($data); \n\n        if ($CI->image_lib->rotate()) {\n          return true;\n        } else {\n          echo $CI->image_lib->display_errors();\n        }\n      }\n    ```", "```php\n    function __construct() {\n      parent::__construct();\n      $this->load->helper('form');\n      $this->load->helper('url');\n      $this->load->library('image_manip');\n    }\n    ```", "```php\n    if ( ! $this->upload->do_upload()) {\n    \t$error = array('error' => $this->upload->display_errors());\n    \t$this->load->view('upload/upload', $error);\n    } else {\n    \t$data = array('upload_data' => $this->upload->data());\n\n    \t$result = $this->upload->data();\n    \t$original_image = $result['full_path'];\n\n    \t$data = array(\n    \t\t'image_library' => 'imagemagick',\n    \t\t'library_path' => '/opt/ImageMagick/bin',\n    \t\t'source_image' => $original_image,\t\t\t\n    \t\t'rotation_angle' => 'vrt'\n    \t\t);\n    \t\tif ($this->image_manip->rotate($data)) {\n    \t\techo 'Image successfully rotated<br /><pre>';\n    \t\tvar_dump($result);\n    \t\techo '</pre>';\n    \t} else {\n    \t\techo 'There was an error with the image processing.';\n    \t}\n    }\n    ```", "```php\n\t$original_image = $result['full_path'];\n```", "```php\n\t$this->image_manip->rotate($data);\n```", "```php\n    <?php if (! defined('BASEPATH')) exit('No direct script access allowed');\n    class Image_manip {\n    }\n    ```", "```php\n    function __construct() {\n    \tparent::__construct();\n    \t$this->load->helper('form');\n    \t$this->load->helper('url');\n    \t$this->load->library('image_manip');\n    }\n    ```", "```php\n    if ( ! $this->upload->do_upload()) {\n    \t$error = array('error' => $this->upload->display_errors());\n    \t$this->load->view('upload/upload', $error);\n    } else {\n    \t$data = array('upload_data' => $this->upload->data());\n\n    \t$result = $this->upload->data();\n    \t$original_image = $result['full_path'];\n\n    \t$data = array(\n    \t\t'source_image' => $original_image,\n    \t\t'image_library' => 'imagemagick',\n    \t\t'library_path' => '/opt/ImageMagick/bin',\n    \t\t'x_axis' => '100',\n    \t\t'y_axis' => '60'\t\n    \t);\n\n    \tif ($this->image_manip->crop_image($data)) {\n    \t\techo 'Image successfully cropped<br /><pre>';\n    \t\tvar_dump($result);\n    \t\techo '</pre>';\n    \t} else {\n    \t\techo 'There was an error with the image processing.';\n    \t}\n    }\n    ```", "```php\n      function crop_image($data) {\n        $CI =& get_instance();\n        $CI->load->library('image_lib', $data);\n\n        $CI->image_lib->initialize($data); \n\n        if ($CI->image_lib->crop()) {\n          return true; \n        } else {\n          echo $CI->image_lib->display_errors();\n        }\n      } \n    ```", "```php\n  $original_image = $result['full_path'];\n```", "```php\n $this->image_manip->crop_image($data);\n\n```", "```php\n    <?php if (! defined('BASEPATH')) exit('No direct script access allowed');\n    class Image_manip {\n    }\n    ```", "```php\n      function do_watermark($data) {\n        $CI =& get_instance();\n        $CI->load->library('image_lib', $data);\n\n        $CI->image_lib->initialize($data); \n        if ($CI->image_lib->watermark()) {\n          return true;\n        } else {\n          echo $CI->image_lib->display_errors();\n        }\n      }\n    ```", "```php\n    function __construct() {\n      parent::__construct();\n      $this->load->helper('form');\n      $this->load->helper('url');\n     $this->load->library('image_manip');\n    }\n    ```", "```php\n    if ( ! $this->upload->do_upload()) {\n      $error = array('error' => $this->upload->display_errors());\n      $this->load->view('upload/upload', $error);\n    } else {\n      $data = array('upload_data' => $this->upload->data());\n\n      $result = $this->upload->data();\n      $original_image = $result['full_path'];\n\n      $data = array(\n      'image_library' => 'GD2','source_image' => $original_image,'wm_text' => 'Copyright (c) ' . date(\"Y\",time()) . ' - YOUR NAME','wm_type' => 'text','wm_font_path' => './system/fonts/texb.ttf',\n        'wm_font_size' => '16','wm_font_color' => 'ffffff','wm_vrt_alignment' => 'middle','wm_hor_alignment' => 'left','wm_padding' => '20'\n      );\n\n      if ($this->image_manip->do_watermark($data)) {\n        echo 'Image successfully watermarked<br /><pre>';\n        var_dump($result);\n        echo '</pre>';\n      } else {\n        echo 'There was an error with the image processing.';\n      }\n    }\n    ```", "```php\n  $original_image = $result['full_path'];\n```", "```php\n    <?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n    class Image_manip {\n    }\n    ```", "```php\n      function do_watermark($data) {\n        $CI =& get_instance();\n        $CI->load->library('image_lib', $data);\n\n        $CI->image_lib->initialize($data); \n        if ($CI->image_lib->watermark()) {\n          return true;\n        } else {\n          echo $CI->image_lib->display_errors();\n        }\n      }\n    ```", "```php\n    function __construct() {\n      parent::__construct();\n      $this->load->helper('form');\n      $this->load->helper('url');\n     $this->load->library('image_manip');\n    }\n    ```", "```php\n    if (! $this->upload->do_upload()) {\n      $error = array('error' => $this->upload->display_errors());\n        $this->load->view('upload/upload', $error);\n      } else {\n        $data = array('upload_data' => $this->upload->data());\n\n        $result = $this->upload->data();\n        $original_image = $result['full_path'];\n\n        // Create Watermark\n        $data = array(\n        'image_library' => 'gd2','source_image' => $original_image, 'wm_type' => 'overlay','wm_overlay_path' => $config['upload_path'] . '/overlay_image_name',\n        'wm_font_path' => './system/fonts/texb.ttf','wm_font_size' => '16','wm_font_color' => 'ffffff','wm_vrt_alignment' => 'middle','wm_hor_alignment' => 'left','wm_padding' => '20'\n        );\n\n        $this->image_manip->do_watermark($data);\n      }\n    ```", "```php\nCREATE TABLE `captcha` (`captcha_id` bigint(13) unsigned NOT NULL AUTO_INCREMENT,`captcha_time` int(10) unsigned NOT NULL,`ip_address` varchar(16) NOT NULL DEFAULT '0',`word` varchar(20) NOT NULL,PRIMARY KEY (`captcha_id`),KEY `word` (`word`)) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n```", "```php\n    <?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n\n    class Comments extends CI_Controller {\n      function __construct() {\n        parent::__construct();\n          $this->load->helper('form');\n          $this->load->helper('url');\n          $this->load->helper('make_captcha');\n          $this->load->model('Captcha_model');\n      }\n\n      public function index() {\n          $this->load->library('form_validation');\n          $this->form_validation->set_error_delimiters('', '<br />');\n\n          $this->form_validation->set_rules('name', 'Name', 'required|max_length[225]');\n          $this->form_validation->set_rules('email', 'Email', 'required|max_length[225]');\n          $this->form_validation->set_rules('message', 'Message', 'required|max_length[225]');\n          $this->form_validation->set_rules('captcha', 'Captcha', 'required|max_length[225]');\n\n          // Begin validation\n          if ($this->form_validation->run() == FALSE) {\n            $data['img'] = make_captcha();\n            $this->load->view('comments/post_form', $data);\n          } else {\n            $expiration = time() - 7200;\n\n            $this->Captcha_model->delete_expired($expiration);\n\n            $data = array(\n              'captcha' => $this->input->post('captcha'),\n              'ip_address' => $this->input->ip_address(),\n              'expiration' => $expiration);\n\n            $num_rows = \n              $this->Captcha_model->does_exist($data);\n\n            if ($num_rows == 0) {\n              $data['error'] = \"Type the word in the image.\";\n              $data['img'] = make_captcha();\n              $this->load->view('comments/post_form', $data);\n            } else {\n              echo 'CAPTCHA OKAY - HERE IS YOUR POST:' . '<br />';\n              echo $this->input->post('name') . '<br />';\n              echo $this->input->post('email') . '<br />';\n              echo $this->input->post('message') . '<br />';\n          }\n        }\n      }\n    }\n    ```", "```php\n    <?php if (! defined('BASEPATH')) exit('No direct script access allowed');\n\n    function make_captcha() {\n      $CI =& get_instance();\n      $CI->load->helper('captcha');\n\n      $vals = array(\n          'img_path' => '/file/path/to/image/captcha/',\n          'img_url' => 'http://url/to/image/captcha/',\n          'font_path' => './system/fonts/texb.ttf',\n          'img_width' => '150',\n          'img_height' => 30,\n          'expiration' => 7200\n          );\n\n      $cap = create_captcha($vals);\n      $data = array(\n          'captcha_time' => $cap['time'],\n          'ip_address' => $CI->input->ip_address(),\n          'word' => $cap['word']\n          );\n\n      $query = $CI->db->insert_string('captcha', $data);\n      $CI->db->query($query);\n\n      return $cap['image'];\n    }\n    ```", "```php\n    <?php if (! defined('BASEPATH')) exit('No direct script access allowed');\n\n    class Captcha_model extends CI_Model {\n        function __construct() {\n            parent::__construct();\n        }\n\n        public function delete_expired($expiration) {\n            $this->db->where('captcha_time < ',$expiration);\n            $this->db->delete('captcha');\n        }\n\n        public function does_exist($data) {\n            $this->db->where('word', $data['captcha']);\n            $this->db->where('ip_address', $data['ip_address']);\n            $this->db->where('captcha_time > ', $data['expiration']);\n            $query = $this->db->get('captcha');\n            return $query->num_rows();\n        }\n    }\n    ```", "```php\n    <?php echo form_open() ; ?>\n      <?php echo validation_errors() ; ?>\n      <?php if (isset($errors)) { echo $errors ; }  ?>\n      <br />\n      Name <input type = \"text\" name = \"name\" size = \"5\" value = \"<?php echo set_value('name') ; ?>\"/><br />\n      Email <input type = \"text\" name = \"email\" size = \"5\" value = \"<?php echo set_value('email') ; ?>\"/><br />\n      Message <br />\n      <textarea name = \"message\" rows = \"4\" cols = \"20\" /><?php echo set_value('message') ; ?></textarea><br />\n\n      Please enter the string you see below\n      <input type = \"text\" name = \"captcha\" value = \"\" />\n      <br />\n      <?php echo $img ; ?>\n      <br />\n      <input type = \"submit\" value = \"Submit\" />\n    <?php echo form_close() ; ?>\n    ```", "```php\n        if ($this->form_validation->run() == FALSE) {\n          $data['img'] = make_captcha();\n          $this->load->view('comments/post_form', $data);\n        } else {\n  ... etc\n```", "```php\n  $CI = & get_instance();\n  $CI->load->helper('captcha');\n```", "```php\n  $vals = array(\n    'img_path' => '/file/path/to/image/',\n    'img_url' => 'http://url/to/image/',\n    'font_path' => './system/fonts/texb.ttf',\n    'img_width' => '150',\n    'img_height' => 30,\n    'expiration' => 7200\n    );\n```", "```php\n  $cap = create_captcha($vals);\n  $data = array(\n    'captcha_time' => $cap['time'],\n    'ip_address' => $CI->input->ip_address(),\n    'word' => $cap['word']\n    );\n\n  $query = $CI->db->insert_string('captcha', $data);\n```", "```php\n  $expiration = time() - 7200;\n\n  $this->Captcha_model->delete_expired($expiration);\n```", "```php\n    public function delete_expired($expiration) {\n        $this->db->where('captcha_time < ',$expiration);\n        $this->db->delete('captcha');\n    }\n```", "```php\n    public function does_exist($data) {\n        $this->db->where('word', $data['captcha']);\n        $this->db->where('ip_address', $data['ip_address']);\n        $this->db->where('captcha_time > ', $data['expiration']);\n        $query = $this->db->get('captcha');\n        return $query->num_rows();\n    }\n```"]
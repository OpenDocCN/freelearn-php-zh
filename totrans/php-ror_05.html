<html><head></head><body>
<div id="_idContainer023">
<h1 class="chapter-number" id="_idParaDest-79"><a id="_idTextAnchor080"/><span class="koboSpan" id="kobo.1.1">5</span></h1>
<h1 id="_idParaDest-80"><a id="_idTextAnchor081"/><span class="koboSpan" id="kobo.2.1">Libraries and Class Syntax</span></h1>
<p><span class="koboSpan" id="kobo.3.1">So far, we’ve only worked with Ruby and its core components without the advantage of other libraries that are available in Ruby. </span><span class="koboSpan" id="kobo.3.2">Additionally, we’ve only taken a partial peek at Ruby objects and classes. </span><span class="koboSpan" id="kobo.3.3">In this chapter, we will take a test drive with you to learn about Ruby libraries (gems) and how we can take advantage of the Gemfile to do so. </span><span class="koboSpan" id="kobo.3.4">Lastly, we’ll also learn the basics of class syntax to help us move toward more advanced tools, such as Ruby </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">on Rails.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">With that in mind, in this chapter, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.7.1">Let’s get ready </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">to bundle!!!</span></span></li>
<li><span class="koboSpan" id="kobo.9.1">Gemfile </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">versus </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.11.1">composer.json</span></strong></span></li>
<li><span class="koboSpan" id="kobo.12.1">Integrating libraries into your code </span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">in Ruby</span></span></li>
<li><span class="koboSpan" id="kobo.14.1">Declaring classes </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">in Ruby</span></span></li>
<li><span class="koboSpan" id="kobo.16.1">Objects </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">in Ruby</span></span></li>
<li><span class="koboSpan" id="kobo.18.1">Inheritance </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">in Ruby</span></span></li>
</ul>
<h1 id="_idParaDest-81"><a id="_idTextAnchor082"/><span class="koboSpan" id="kobo.20.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.21.1">To follow along this chapter, we will need </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.23.1">Any IDE to view/edit code (e.g., SublimeText, Visual Studio Code, Notepad++, Vim, </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">Emacs, etc.)</span></span></li>
<li><span class="koboSpan" id="kobo.25.1">For macOS users, you will also need to have Xcode Command Line </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">Tools installed</span></span></li>
<li><span class="koboSpan" id="kobo.27.1">Ruby version 2.6 or later installed and ready </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">to use</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.29.1">The code presented in this chapter is available </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">at </span></span><a href="https://github.com/PacktPublishing/From-PHP-to-Ruby-on-Rails/"><span class="No-Break"><span class="koboSpan" id="kobo.31.1">https://github.com/PacktPublishing/From-PHP-to-Ruby-on-Rails/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.32.1">.</span></span></p>
<h1 id="_idParaDest-82"><a id="_idTextAnchor083"/><span class="koboSpan" id="kobo.33.1">Let’s get ready to bundle!!!</span></h1>
<p><span class="koboSpan" id="kobo.34.1">Programming languages by themselves, while useful, can’t take into account every single use case that a programmer might encounter. </span><span class="koboSpan" id="kobo.34.2">The core of the language includes many useful libraries, so out of the box, the language is quite useful. </span><span class="koboSpan" id="kobo.34.3">This is true for most programming languages. </span><span class="koboSpan" id="kobo.34.4">However, there comes a time when we need to go beyond the core library and use other libraries to solve our issues at hand. </span><span class="koboSpan" id="kobo.34.5">In Ruby, the community has created</span><a id="_idIndexMarker227"/><span class="koboSpan" id="kobo.35.1"> a number of libraries, fondly named </span><em class="italic"><span class="koboSpan" id="kobo.36.1">gems</span></em><span class="koboSpan" id="kobo.37.1">. </span><span class="koboSpan" id="kobo.37.2">To keep track of these gems, the Ruby</span><a id="_idIndexMarker228"/><span class="koboSpan" id="kobo.38.1"> community has come up with a tool called </span><em class="italic"><span class="koboSpan" id="kobo.39.1">bundler</span></em><span class="koboSpan" id="kobo.40.1">. </span><span class="koboSpan" id="kobo.40.2">To season PHP developers, the PHP counterpart for the bundler is Composer (</span><a href="https://getcomposer.org/"><span class="koboSpan" id="kobo.41.1">https://getcomposer.org/</span></a><span class="koboSpan" id="kobo.42.1">). </span><span class="koboSpan" id="kobo.42.2">The two work for the same purpose (managing libraries), but bundler works slightly differently in that it installs the libraries in the computer, while Composer merely makes them available for your project. </span><span class="koboSpan" id="kobo.42.3">But wait – we haven’t even installed a library yet. </span><span class="koboSpan" id="kobo.42.4">Let’s take a step back and install a </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">Ruby gem.</span></span></p>
<h2 id="_idParaDest-83"><a id="_idTextAnchor084"/><span class="koboSpan" id="kobo.44.1">Installing a gem</span></h2>
<p><span class="koboSpan" id="kobo.45.1">Before letting bundler take over, we should understand</span><a id="_idIndexMarker229"/><span class="koboSpan" id="kobo.46.1"> what and how to install gems on our system. </span><span class="koboSpan" id="kobo.46.2">Ruby has the ability to parse JSON objects, but there is a gem called </span><strong class="source-inline"><span class="koboSpan" id="kobo.47.1">oj</span></strong><span class="koboSpan" id="kobo.48.1"> that is more efficient in handling JSON strings and converting them to Ruby hashes. </span><span class="koboSpan" id="kobo.48.2">Let’s first install the </span><strong class="source-inline"><span class="koboSpan" id="kobo.49.1">oj</span></strong><span class="koboSpan" id="kobo.50.1"> gem. </span><span class="koboSpan" id="kobo.50.2">In a shell, let’s type the </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">following commands:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.52.1">
gem install oj</span></pre> <p><span class="koboSpan" id="kobo.53.1">We should get the following output after running the preceding command and pressing the </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.54.1">Enter</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.55.1"> key:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.56.1">
Fetching oj-3.14.2.gem
Building native extensions. </span><span class="koboSpan" id="kobo.56.2">This could take a while...
</span><span class="koboSpan" id="kobo.56.3">Successfully installed oj-3.14.2
Parsing documentation for oj-3.14.2
Installing ri documentation for oj-3.14.2
Done installing documentation for oj after 2 seconds
1 gem installed</span></pre> <p><span class="koboSpan" id="kobo.57.1">Congratulations! </span><span class="koboSpan" id="kobo.57.2">We have installed</span><a id="_idIndexMarker230"/><span class="koboSpan" id="kobo.58.1"> our first gem and are now ready to use it within our code. </span><span class="koboSpan" id="kobo.58.2">Let’s put this gem to the test by creating a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.59.1">reading_json.rb</span></strong><span class="koboSpan" id="kobo.60.1"> and adding the </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.62.1">
json_text = '{"name":"Sarah Kerrigan", "age":23, "human":
  true}'
ruby_hash = Oj.load(json_text)
puts ruby_hash
puts ruby_hash["name"]</span></pre> <p><span class="koboSpan" id="kobo.63.1">Now, let’s go back to our shell and try to execute the </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">following script:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.65.1">
ruby reading_json.rb</span></pre> <p><span class="koboSpan" id="kobo.66.1">We will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">following error:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.68.1">
reading_json.rb:5:in `&lt;main&gt;': uninitialized constant Oj (NameError)</span></pre> <p><span class="koboSpan" id="kobo.69.1">Why is our script failing? </span><span class="koboSpan" id="kobo.69.2">Well, we installed our gem and did not get any errors while doing so. </span><span class="koboSpan" id="kobo.69.3">As it turns out, we not only need to install our gem but also need to import it within our code. </span><span class="koboSpan" id="kobo.69.4">Let’s do that at the beginning of our file, so our code will now look </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.71.1">
require 'oj'
json_text = '{"name":"Sarah Kerrigan", "age":23, "human":
  true}'
ruby_hash = Oj.load(json_text)
puts ruby_hash
puts ruby_hash["name"]</span></pre> <p><span class="koboSpan" id="kobo.72.1">Then, let’s execute our script again with </span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.74.1">
ruby reading_json.rb</span></pre> <p><span class="koboSpan" id="kobo.75.1">Now, we will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">correct output:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.77.1">
{"name"=&gt;"Sarah Kerrigan", "age"=&gt;23, "human"=&gt;true}
Sarah Kerrigan</span></pre> <p><span class="koboSpan" id="kobo.78.1">As you can see, we’ve converted a JSON string into a Ruby hash, and it is now ready to be used within our script. </span><span class="koboSpan" id="kobo.78.2">This is useful when loading configuration from a JSON file or when processing an API call that returns a JSON response. </span><span class="koboSpan" id="kobo.78.3">However, there is one issue that we have not dealt with yet. </span><span class="koboSpan" id="kobo.78.4">How can we make sure that other people</span><a id="_idIndexMarker231"/><span class="koboSpan" id="kobo.79.1"> who use our script will have the same results? </span><span class="koboSpan" id="kobo.79.2">Well, this is the cue for both bundler and the Gemfile to enter </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">our scene.</span></span></p>
<h1 id="_idParaDest-84"><a id="_idTextAnchor085"/><span class="koboSpan" id="kobo.81.1">Gemfile versus composer.json</span></h1>
<p><span class="koboSpan" id="kobo.82.1">As I mentioned before, bundler</span><a id="_idIndexMarker232"/><span class="koboSpan" id="kobo.83.1"> helps us handle all our program’s dependencies – that is, everything </span><a id="_idIndexMarker233"/><span class="koboSpan" id="kobo.84.1">we need to install in order for our program to run correctly. </span><span class="koboSpan" id="kobo.84.2">To accomplish this, bundler uses a text file, which we will call a </span><strong class="source-inline"><span class="koboSpan" id="kobo.85.1">Gemfile</span></strong><span class="koboSpan" id="kobo.86.1">. </span><span class="koboSpan" id="kobo.86.2">Composer works in a very similar way by having us create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.87.1">composer.json</span></strong><span class="koboSpan" id="kobo.88.1">, but while Composer downloads the required libraries into a folder, bundler installs them on our system. </span><span class="koboSpan" id="kobo.88.2">If bundler determines that a dependency is missing, it will automatically try to install it. </span><span class="koboSpan" id="kobo.88.3">Ruby’s way is a bit more magical (or automatic). </span><span class="koboSpan" id="kobo.88.4">Let’s take bundler for a test drive to understand the process a little further. </span><span class="koboSpan" id="kobo.88.5">We will start by uninstalling our previously installed </span><strong class="source-inline"><span class="koboSpan" id="kobo.89.1">oj</span></strong><span class="koboSpan" id="kobo.90.1"> gem with the following command in </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">the shell:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.92.1">
gem uninstall oj</span></pre> <p><span class="koboSpan" id="kobo.93.1">The preceding command will confirm when the gem is removed from </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">our system:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.95.1">
Successfully uninstalled oj-3.14.2</span></pre> <p><span class="koboSpan" id="kobo.96.1">Now, if we try to run our </span><strong class="source-inline"><span class="koboSpan" id="kobo.97.1">reading_json.rb</span></strong><span class="koboSpan" id="kobo.98.1"> again, we will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.99.1">following error:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.100.1">
…kernel_require.rb:54:in `require': cannot load such file -- oj (LoadError)
  from...kernel_require.rb:54:in `require'
  from reading_json.rb:1:in `&lt;main&gt;'</span></pre> <p><span class="koboSpan" id="kobo.101.1">We are back to where we started, but now we will solve our library (or gem) installation with a Gemfile. </span><span class="koboSpan" id="kobo.101.2">Let’s create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.102.1">Gemfile</span></strong><span class="koboSpan" id="kobo.103.1"> with the </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">following content:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.105.1">
source 'https://rubygems.org'
gem 'oj'</span></pre> <p><span class="koboSpan" id="kobo.106.1">With this, we tell bundler where to download the dependencies and what our dependencies are. </span><span class="koboSpan" id="kobo.106.2">We could tell bundler other things, such as the gem version or even what Ruby version (or equivalent) to use, but for now, we’ll keep it simple. </span><span class="koboSpan" id="kobo.106.3">Now, let’s try it. </span><span class="koboSpan" id="kobo.106.4">On a shell, let’s type the </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.108.1">
bundle install</span></pre> <p><span class="koboSpan" id="kobo.109.1">Depending on the operating system</span><a id="_idIndexMarker234"/><span class="koboSpan" id="kobo.110.1"> that you’re using, you may need to type your root</span><a id="_idIndexMarker235"/><span class="koboSpan" id="kobo.111.1"> or administrator password, but once you do, the output of the command should be </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">as follows:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.113.1">
Fetching gem metadata from https://rubygems.org/..
</span><span class="koboSpan" id="kobo.113.2">Resolving dependencies...
</span><span class="koboSpan" id="kobo.113.3">Using bundler 1.17.2
Installing oj 3.14.2 with native extensions
Bundle complete! </span><span class="koboSpan" id="kobo.113.4">1 Gemfile dependency, 2 gems now installed.
</span><span class="koboSpan" id="kobo.113.5">Use `bundle info [gemname]` to see where a bundled gem is installed.</span></pre> <p><span class="koboSpan" id="kobo.114.1">Now that our gem is installed, we can safely run our script again with the </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.116.1">
ruby reading_json.rb</span></pre> <p><span class="koboSpan" id="kobo.117.1">We should get the exact same output </span><span class="No-Break"><span class="koboSpan" id="kobo.118.1">as before:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.119.1">
{"name"=&gt;"Sarah Kerrigan", "age"=&gt;23, "human"=&gt;true}
Sarah Kerrigan</span></pre> <p><span class="koboSpan" id="kobo.120.1">However, now we will notice something slightly different. </span><span class="koboSpan" id="kobo.120.2">If we look at the contents of the folder where we have our script and the Gemfile, we also have a new file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.121.1">Gemfile.lock</span></strong><span class="koboSpan" id="kobo.122.1">. </span><span class="koboSpan" id="kobo.122.2">Also, if we look at the contents, there should be something similar </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">to this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.124.1">
GEM
  remote: https://rubygems.org/
  specs:
    oj (3.14.2)
PLATFORMS
  ruby
DEPENDENCIES
  oj
BUNDLED WITH
   1.17.2</span></pre> <p><span class="koboSpan" id="kobo.125.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.126.1">Gemfile.lock</span></strong><span class="koboSpan" id="kobo.127.1"> file serves as a map of dependencies. </span><span class="koboSpan" id="kobo.127.2">If there is no map, bundler has to build it from scratch, and this process sometimes takes a while. </span><span class="koboSpan" id="kobo.127.3">However, if there is a lock file, even if the dependencies have not been installed, the process of installing them is much </span><span class="No-Break"><span class="koboSpan" id="kobo.128.1">more efficient.</span></span></p>
<p><span class="koboSpan" id="kobo.129.1">We’ve come a long way</span><a id="_idIndexMarker236"/><span class="koboSpan" id="kobo.130.1"> from just installing a gem to now creating the ideal scenario</span><a id="_idIndexMarker237"/><span class="koboSpan" id="kobo.131.1"> for our script to run. </span><span class="koboSpan" id="kobo.131.2">In the next section, we’ll look at additional options (such as using a specific version of a gem) that we can set with our Gemfile to add further specificity to our </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">Ruby environment.</span></span></p>
<h1 id="_idParaDest-85"><a id="_idTextAnchor086"/><span class="koboSpan" id="kobo.133.1">Integrating libraries into your code in Ruby</span></h1>
<p><span class="koboSpan" id="kobo.134.1">One of the most useful skills</span><a id="_idIndexMarker238"/><span class="koboSpan" id="kobo.135.1"> you should acquire in your path to becoming a seasoned Ruby</span><a id="_idIndexMarker239"/><span class="koboSpan" id="kobo.136.1"> developer is integrating other gems into your code. </span><span class="koboSpan" id="kobo.136.2">As we’ve seen before, this is accomplished by using the Gemfile, but we’ll look at some additional options we can add to it and integrate them into our own scripts. </span><span class="koboSpan" id="kobo.136.3">Let’s write a script that takes the GitHub public API and lists all of the public repos for the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.137.1">@PacktPublishing</span></strong><span class="koboSpan" id="kobo.138.1">. </span><span class="koboSpan" id="kobo.138.2">There are several ways</span><a id="_idIndexMarker240"/><span class="koboSpan" id="kobo.139.1"> we could do this, but for this example, I’ve chosen a gem called </span><strong class="bold"><span class="koboSpan" id="kobo.140.1">Faraday</span></strong><span class="koboSpan" id="kobo.141.1">. </span><span class="koboSpan" id="kobo.141.2">You can take a look at the source code </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">here: </span></span><a href="https://github.com/lostisland/faraday"><span class="No-Break"><span class="koboSpan" id="kobo.143.1">https://github.com/lostisland/faraday</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.144.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.145.1">Faraday is a client library that can help us make </span><strong class="bold"><span class="koboSpan" id="kobo.146.1">Representational State Transfer</span></strong><span class="koboSpan" id="kobo.147.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.148.1">REST</span></strong><span class="koboSpan" id="kobo.149.1">) calls that are much easier to read</span><a id="_idIndexMarker241"/><span class="koboSpan" id="kobo.150.1"> than using the native </span><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">Net::HTTP</span></strong><span class="koboSpan" id="kobo.152.1"> library that comes with Ruby. </span><span class="koboSpan" id="kobo.152.2">Let’s create a folder called </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">integrating_gems</span></strong><span class="koboSpan" id="kobo.154.1"> and navigate to </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">that folder:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.156.1">
mkdir integrating_gems
cd integrating_gems</span></pre> <p><span class="koboSpan" id="kobo.157.1">Now, let’s create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.158.1">Gemfile</span></strong><span class="koboSpan" id="kobo.159.1"> with the </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">following content:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.161.1">
source 'https://rubygems.org'
gem 'oj'
gem 'faraday'</span></pre> <p><span class="koboSpan" id="kobo.162.1">Before installing these gems, I’d like to use more options</span><a id="_idIndexMarker242"/><span class="koboSpan" id="kobo.163.1"> available in the Gemfile syntax. </span><span class="koboSpan" id="kobo.163.2">We’re going</span><a id="_idIndexMarker243"/><span class="koboSpan" id="kobo.164.1"> to lock the Faraday version at 2.5, which simply means that we install a specific version. </span><span class="koboSpan" id="kobo.164.2">So, let’s change the Faraday line to </span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.166.1">
gem 'faraday', '2.5'</span></pre> <p><span class="koboSpan" id="kobo.167.1">Locking to a version has, of course, its advantages and its disadvantages. </span><span class="koboSpan" id="kobo.167.2">Among the advantages is that you can be sure that the script will work the same way, with usually the same syntax, in several environments. </span><span class="koboSpan" id="kobo.167.3">The downside is that you probably would be locked to a Ruby version, and you could end up in a scenario where you won’t be able to upgrade Ruby until you upgrade the gem. </span><span class="koboSpan" id="kobo.167.4">For the </span><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">oj</span></strong><span class="koboSpan" id="kobo.169.1"> gem, we will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">~</span></strong><span class="koboSpan" id="kobo.171.1"> operator and set it to </span><span class="No-Break"><span class="koboSpan" id="kobo.172.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.173.1">
gem 'oj', '~&gt; 3.13.0'</span></pre> <p><span class="koboSpan" id="kobo.174.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.175.1">~</span></strong><span class="koboSpan" id="kobo.176.1"> operator is used to delimit ranges of versions. </span><span class="koboSpan" id="kobo.176.2">In this specific case, we tell bundler to get the highest released version between 3.13.0 and 3.14, excluding 3.14 – in other words, we require a version larger or equal to 3.13 but less than 3.14. </span><span class="koboSpan" id="kobo.176.3">So, why use this operator? </span><span class="koboSpan" id="kobo.176.4">Well, in short, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">~</span></strong><span class="koboSpan" id="kobo.178.1"> operator is used to increase stability within our dependencies. </span><span class="koboSpan" id="kobo.178.2">I won’t go into depth as to why we would use this syntax. </span><span class="koboSpan" id="kobo.178.3">Just know that you will encounter it sooner </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">or later.</span></span></p>
<p><span class="koboSpan" id="kobo.180.1">Should you want to dig deeper</span><a id="_idIndexMarker244"/><span class="koboSpan" id="kobo.181.1"> into this topic, please refer to the </span><span class="No-Break"><span class="koboSpan" id="kobo.182.1">following links:</span></span></p>
<ul>
<li><a href="https://thoughtbot.com/blog/rubys-pessimistic-operator"><span class="No-Break"><span class="koboSpan" id="kobo.183.1">https://thoughtbot.com/blog/rubys-pessimistic-operator</span></span></a></li>
<li><a href="https://guides.rubygems.org/patterns/#declaring_dependencies"><span class="No-Break"><span class="koboSpan" id="kobo.184.1">https://guides.rubygems.org/patterns/#declaring_dependencies</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.185.1">Our Gemfile will now</span><a id="_idIndexMarker245"/><span class="koboSpan" id="kobo.186.1"> look </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.188.1">
source 'https://rubygems.org'
gem 'oj', '~&gt; 3.13.0'
gem 'faraday', '2.5'</span></pre> <p><span class="koboSpan" id="kobo.189.1">Now, let’s install our dependencies</span><a id="_idIndexMarker246"/><span class="koboSpan" id="kobo.190.1"> again with bundler. </span><span class="koboSpan" id="kobo.190.2">On a shell, type in the </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">following</span></span><span class="No-Break"><a id="_idIndexMarker247"/></span><span class="No-Break"><span class="koboSpan" id="kobo.192.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.193.1">
bundle install</span></pre> <p><span class="koboSpan" id="kobo.194.1">We’ll get output similar </span><span class="No-Break"><span class="koboSpan" id="kobo.195.1">to this:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.196.1">
Fetching gem metadata from https://rubygems.org/........
</span><span class="koboSpan" id="kobo.196.2">Resolving dependencies…
Using bundler 1.17.2
Using faraday-net_http 2.1.0
Following files may not be writable, so sudo is needed:
  /usr/local/bin
Using ruby2_keywords 0.0.5
Using faraday 2.5.0
Using oj 3.13.23
Bundle complete! </span><span class="koboSpan" id="kobo.196.3">2 Gemfile dependencies, 5 gems now installed.
</span><span class="koboSpan" id="kobo.196.4">Use `bundle info [gemname]` to see where a bundled gem is installed.</span></pre> <p><span class="koboSpan" id="kobo.197.1">Now, with our gems ready, we can use them in our script. </span><span class="koboSpan" id="kobo.197.2">Let’s create a script called </span><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">faraday_example.rb</span></strong><span class="koboSpan" id="kobo.199.1"> with the </span><span class="No-Break"><span class="koboSpan" id="kobo.200.1">following content:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.201.1">
require 'faraday'
require 'oj'
conn = Faraday.new(
  url: 'https://api.github.com',
  headers: {'Content-Type' '&gt; 'application/json'}
)</span></pre> <p><span class="koboSpan" id="kobo.202.1">Let’s take a step back</span><a id="_idIndexMarker248"/><span class="koboSpan" id="kobo.203.1"> and see what we are doing. </span><span class="koboSpan" id="kobo.203.2">We’re importing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">faraday</span></strong><span class="koboSpan" id="kobo.205.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">oj</span></strong><span class="koboSpan" id="kobo.207.1"> gems. </span><span class="koboSpan" id="kobo.207.2">Then, we’re creating a client that will connect</span><a id="_idIndexMarker249"/><span class="koboSpan" id="kobo.208.1"> to the GitHub API. </span><span class="koboSpan" id="kobo.208.2">The client object requires a URL and some headers, which we provided. </span><span class="koboSpan" id="kobo.208.3">So far, we have not called the API yet. </span><span class="koboSpan" id="kobo.208.4">Let’s do that. </span><span class="koboSpan" id="kobo.208.5">At the end of the file, add the call to the API and output the response with </span><span class="No-Break"><span class="koboSpan" id="kobo.209.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.210.1">
response = conn.get('/users/PacktPublishing/repos')
puts response.body</span></pre> <p><span class="koboSpan" id="kobo.211.1">Now, let’s try to execute this script with </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.213.1">
ruby faraday_example.rb</span></pre> <p><span class="koboSpan" id="kobo.214.1">This will output a lot of text, so I’m going to include only </span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">an excerpt:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.216.1">
[{"id":184740404,"node_id":"MDEwOlJlcG9zaXRvcnkxODQ3NDA0MDQ=","name":"-.NET-Core-Microservices","full_name":"PacktPublishing/-.NET-Core-Microservices","private":false,"owner":{"login":"PacktPublishing","id":10974906,"node_id":"MDEyOk9yZ2FuaXphdGlvbjEwOTc0OTA2"
…</span></pre> <p><span class="koboSpan" id="kobo.217.1">With that output, we can confirm that we have successfully connected to the GitHub API. </span><span class="koboSpan" id="kobo.217.2">For the last part of the exercise, let’s use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">oj</span></strong><span class="koboSpan" id="kobo.219.1"> gem to convert the JSON text to a Ruby hash and output the names of all of the responses that the API returned. </span><span class="koboSpan" id="kobo.219.2">So, let’s remove the </span><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">puts</span></strong><span class="koboSpan" id="kobo.221.1"> command and replace it with an </span><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">oj</span></strong><span class="koboSpan" id="kobo.223.1"> object. </span><span class="koboSpan" id="kobo.223.2">Our code will look like </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">this now:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.225.1">
require 'faraday'
require 'oj'
conn = Faraday.new(
  url: 'https://api.github.com',
  headers: {'Content-Type' =&gt; 'application/json'}
)
response = conn.get('/users/PacktPublishing/repos')
repo_hash = Oj.load(response.body)</span></pre> <p><span class="koboSpan" id="kobo.226.1">So, we’ve taken the response</span><a id="_idIndexMarker250"/><span class="koboSpan" id="kobo.227.1"> from the GitHub API service and converted</span><a id="_idIndexMarker251"/><span class="koboSpan" id="kobo.228.1"> it to a Ruby hash. </span><span class="koboSpan" id="kobo.228.2">Lastly, let’s output the names of the repos by adding the following to the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.229.1">the script:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.230.1">
repo_hash.each { |repo| puts repo['name'] }</span></pre> <p><span class="koboSpan" id="kobo.231.1">If we run the script one last time, an excerpt from the output will look </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">like this:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.233.1">
-.NET-Core-Microservices
-Accelerate-Deep-Learning-on-Raspberry-Pi
-Accelerate-Deep-Learning-on-Raspberry-Pi-
…</span></pre> <p><span class="koboSpan" id="kobo.234.1">With that, we’ve successfully connected to an API with the Faraday gem and processed the output with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">oj</span></strong><span class="koboSpan" id="kobo.236.1"> gem. </span><span class="koboSpan" id="kobo.236.2">For reference, this is what the code should ultimately </span><span class="No-Break"><span class="koboSpan" id="kobo.237.1">look like:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.238.1">
require 'faraday'
require 'oj'
conn = Faraday.new(
  url: 'https://api.github.com',
  headers: {'Content-Type' =&gt; 'application/json'}
)
response = conn.get('/users/PacktPublishing/repos')
repo_hash = Oj.load(response.body)
repo_hash.each { |repo| puts repo['name'] }</span></pre> <p><span class="koboSpan" id="kobo.239.1">This is the starting point for how to share code to be run in other environments. </span><span class="koboSpan" id="kobo.239.2">Should we want others to be able to run our script, we should include both the script and the Gemfile with our shared code so that others know what needs to be installed before running </span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">the scripts.</span></span></p>
<p><span class="koboSpan" id="kobo.241.1">Also, just so you know, this was merely an exercise to learn how to include and use gems within our code. </span><span class="koboSpan" id="kobo.241.2">The syntax on the Gemfile was only procured for learning purposes. </span><span class="koboSpan" id="kobo.241.3">You should always aspire to have the latest version of a gem. </span><span class="koboSpan" id="kobo.241.4">However, locking to a version is useful when you want</span><a id="_idIndexMarker252"/><span class="koboSpan" id="kobo.242.1"> to have control of when and where</span><a id="_idIndexMarker253"/><span class="koboSpan" id="kobo.243.1"> you </span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">do upgrades.</span></span></p>
<p><span class="koboSpan" id="kobo.245.1">Now that we’ve established how gems work and their usage, we can now move on to object-oriented programming </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">in Ruby.</span></span></p>
<h1 id="_idParaDest-86"><a id="_idTextAnchor087"/><span class="koboSpan" id="kobo.247.1">Declaring classes in Ruby</span></h1>
<p><span class="koboSpan" id="kobo.248.1">Both PHP and Ruby are languages that use the </span><strong class="bold"><span class="koboSpan" id="kobo.249.1">Object-Oriented Programming</span></strong><span class="koboSpan" id="kobo.250.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.251.1">OOP</span></strong><span class="koboSpan" id="kobo.252.1">) paradigm, Ruby by design and PHP by its</span><a id="_idIndexMarker254"/><span class="koboSpan" id="kobo.253.1"> own evolution. </span><span class="koboSpan" id="kobo.253.2">By now, serious developers</span><a id="_idIndexMarker255"/><span class="koboSpan" id="kobo.254.1"> should be very familiar</span><a id="_idIndexMarker256"/><span class="koboSpan" id="kobo.255.1"> with the paradigm. </span><span class="koboSpan" id="kobo.255.2">In PHP, all frameworks use OOP. </span><span class="koboSpan" id="kobo.255.3">While we are not going to go in depth into how this paradigm is implemented in Ruby, we will go through the basics of </span><span class="No-Break"><span class="koboSpan" id="kobo.256.1">class syntax.</span></span></p>
<p><span class="koboSpan" id="kobo.257.1">A class is basically an abstraction of a real-world entity. </span><span class="koboSpan" id="kobo.257.2">It is the blueprint of this abstraction. </span><span class="koboSpan" id="kobo.257.3">Let’s start by creating a simple class representing a person, some attributes for this person, and an action (or method) for them. </span><span class="koboSpan" id="kobo.257.4">Let’s create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">class_syntax.rb</span></strong><span class="koboSpan" id="kobo.259.1"> with the </span><span class="No-Break"><span class="koboSpan" id="kobo.260.1">following content:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.261.1">
class Person
end</span></pre> <p><span class="koboSpan" id="kobo.262.1">This is as simple as it gets, but this by itself is not very useful. </span><span class="koboSpan" id="kobo.262.2">For this to be useful, we need to add attributes that represent the characteristics of a person. </span><span class="koboSpan" id="kobo.262.3">So, let’s add some attributes such as their first name and their last name. </span><span class="koboSpan" id="kobo.262.4">Our code will now look </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.264.1">
class Person
  @first_name = nil
  @last_name = nil
end</span></pre> <p><span class="koboSpan" id="kobo.265.1">Note that we have defined our attributes by prepending them with </span><strong class="source-inline"><span class="koboSpan" id="kobo.266.1">@</span></strong><span class="koboSpan" id="kobo.267.1">. </span><span class="koboSpan" id="kobo.267.2">These are called instance variables and can only be accessed by a method. </span><span class="koboSpan" id="kobo.267.3">Now, let’s define a method to print out the </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">full name:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.269.1">
class Person
  @first_name = nil
  @last_name = nil
  def full_name
    puts "#{@first_name} #{@last_name}"
  end
end</span></pre> <p><span class="koboSpan" id="kobo.270.1">With the exception of the instance</span><a id="_idIndexMarker257"/><span class="koboSpan" id="kobo.271.1"> variable, note that we are not doing anything we have</span><a id="_idIndexMarker258"/><span class="koboSpan" id="kobo.272.1"> not learned before. </span><span class="koboSpan" id="kobo.272.2">We defined a method (or function), and we included the first and last name variables on the string to be printed by the method. </span><span class="koboSpan" id="kobo.272.3">One last thing we will do to this blueprint is add a constructor. </span><span class="koboSpan" id="kobo.272.4">In OOP, a constructor is a method that can be customized to add behaviors and attributes when we create an object with a class definition. </span><span class="koboSpan" id="kobo.272.5">In other words, when we take the blueprint, we define and use it to create a specific object, and we can control certain values at the time of creation of the object. </span><span class="koboSpan" id="kobo.272.6">In PHP, this method is implemented by simply naming the method </span><strong class="source-inline"><span class="koboSpan" id="kobo.273.1">__constructor()</span></strong><span class="koboSpan" id="kobo.274.1">. </span><span class="koboSpan" id="kobo.274.2">Its equivalent in Ruby is naming the method </span><strong class="source-inline"><span class="koboSpan" id="kobo.275.1">initialize()</span></strong><span class="koboSpan" id="kobo.276.1">. </span><span class="koboSpan" id="kobo.276.2">Let’s now include it in our class definition. </span><span class="koboSpan" id="kobo.276.3">Our class definition should look </span><span class="No-Break"><span class="koboSpan" id="kobo.277.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.278.1">
class Person
  def initialize
   @first_name = 'James'
   @last_name = 'Raynor'
  end
  def full_name
    puts "#{@first_name} #{@last_name}"
  end
end</span></pre> <p><span class="koboSpan" id="kobo.279.1">Note that we no longer need the instance</span><a id="_idIndexMarker259"/><span class="koboSpan" id="kobo.280.1"> variable definition, as this is done</span><a id="_idIndexMarker260"/><span class="koboSpan" id="kobo.281.1"> on the constructor (initializer). </span><span class="koboSpan" id="kobo.281.2">Congratulations! </span><span class="koboSpan" id="kobo.281.3">Our first class is ready to be used. </span><span class="koboSpan" id="kobo.281.4">Let’s now move on to the next section to create our first object using this </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">class definition.</span></span></p>
<h1 id="_idParaDest-87"><a id="_idTextAnchor088"/><span class="koboSpan" id="kobo.283.1">Objects in Ruby</span></h1>
<p><span class="koboSpan" id="kobo.284.1">In the previous section, we defined</span><a id="_idIndexMarker261"/><span class="koboSpan" id="kobo.285.1"> what our abstraction of a person should look like. </span><span class="koboSpan" id="kobo.285.2">It is a person</span><a id="_idIndexMarker262"/><span class="koboSpan" id="kobo.286.1"> that will have a first name and a last name, and we will be able to print out their full name. </span><span class="koboSpan" id="kobo.286.2">In parallel to the construction business, since we now have a blueprint, we are now ready to erect our building with these specifications. </span><span class="koboSpan" id="kobo.286.3">This creation is what we call an instance or an object of a class. </span><span class="koboSpan" id="kobo.286.4">The class definition is generic and the instance is specific. </span><span class="koboSpan" id="kobo.286.5">Without going too deep into this relationship between a class definition and an object, we’ll take a look at what this relationship looks like in code and how this will help us make better and more readable code. </span><span class="koboSpan" id="kobo.286.6">Let’s take our previous code and create our </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">first object:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.288.1">
# class_syntax.rb
class Person
  def initialize
   @first_name = 'James'
   @last_name = 'Raynor'
  end
  def full_name
    puts "#{@first_name} #{@last_name}"
  end
end
person = Person.new</span></pre> <p><span class="koboSpan" id="kobo.289.1">We’ve now created a specific person based on our class, and we are now ready to call some of the methods for that person. </span><span class="koboSpan" id="kobo.289.2">We can now call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">full_name()</span></strong><span class="koboSpan" id="kobo.291.1"> method. </span><span class="koboSpan" id="kobo.291.2">Let’s do that by adding the following line to the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.292.1">our file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.293.1">
person.full_name</span></pre> <p><span class="koboSpan" id="kobo.294.1">Let’s run our script again from the shell with </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.296.1">
ruby class_syntax.rb</span></pre> <p><span class="koboSpan" id="kobo.297.1">Then, we should get the </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">following output:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.299.1">
James Raynor</span></pre> <p><span class="koboSpan" id="kobo.300.1">And voilà! </span><span class="koboSpan" id="kobo.300.2">We’ve finally given our class</span><a id="_idIndexMarker263"/><span class="koboSpan" id="kobo.301.1"> a more practical use. </span><span class="koboSpan" id="kobo.301.2">We are now able to create</span><a id="_idIndexMarker264"/><span class="koboSpan" id="kobo.302.1"> as many objects (persons) as we want with the class definition. </span><span class="koboSpan" id="kobo.302.2">However, we still have an issue. </span><span class="koboSpan" id="kobo.302.3">Our class only lets us create persons that are named James Raynor. </span><span class="koboSpan" id="kobo.302.4">We wanted specificity, but this turned out to be too specific. </span><span class="koboSpan" id="kobo.302.5">We need to modify our class so that we can create more generic objects. </span><span class="koboSpan" id="kobo.302.6">So, let’s do that by adding parameters to our constructor. </span><span class="koboSpan" id="kobo.302.7">Our code will now look like </span><span class="No-Break"><span class="koboSpan" id="kobo.303.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.304.1">
# class_syntax.rb
class Person
  def initialize( first_name, last_name )
   @first_name = first_name
   @last_name = last_name
  end
  def full_name
    puts "#{@first_name} #{@last_name}"
  end
end
person = Person.new
person.full_name</span></pre> <p><span class="koboSpan" id="kobo.305.1">We’ve added two parameters to our constructor method. </span><span class="koboSpan" id="kobo.305.2">The first name we pass to our class will be assigned to our instance variable, </span><strong class="source-inline"><span class="koboSpan" id="kobo.306.1">@first_name</span></strong><span class="koboSpan" id="kobo.307.1">, so that it will be available to other methods. </span><span class="koboSpan" id="kobo.307.2">The same goes for the last name. </span><span class="koboSpan" id="kobo.307.3">An additional adjustment that we must make now is to pass</span><a id="_idIndexMarker265"/><span class="koboSpan" id="kobo.308.1"> the first and last names </span><a id="_idIndexMarker266"/><span class="koboSpan" id="kobo.309.1">to our constructor. </span><span class="koboSpan" id="kobo.309.2">So, let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">do that:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.311.1">
# class_syntax.rb
class Person
  def initialize( first_name, last_name )
   @first_name = first_name
   @last_name = last_name
  end
  def full_name
    puts "#{@first_name} #{@last_name}"
  end
end
jim = Person.new( 'James', 'Raynor' )
jim.full_name</span></pre> <p><span class="koboSpan" id="kobo.312.1">Now, we can create as many instances (or objects) as we want. </span><span class="koboSpan" id="kobo.312.2">Let’s add two </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">more people:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.314.1">
# class_syntax.rb
class Person
  def initialize( first_name, last_name )
   @first_name = first_name
   @last_name = last_name
  end
  def full_name
    puts "#{@first_name} #{@last_name}"
  end
end
jim = Person.new( 'James', 'Raynor' )
sarah = Person.new( 'Sarah', 'Kerrigan' )
arcturus = Person.new( 'Arcturus', 'Mengsk' )
jim.full_name
sarah.full_name
arcturus.full_name</span></pre> <p><span class="koboSpan" id="kobo.315.1">Now, let’s run our script on </span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">our shell:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.317.1">
ruby class_syntax.rb</span></pre> <p><span class="koboSpan" id="kobo.318.1">The output will be </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.320.1">
James Raynor
Sarah Kerrigan
Arcturus Mengsk</span></pre> <p><span class="koboSpan" id="kobo.321.1">We’ve made our blueprint</span><a id="_idIndexMarker267"/><span class="koboSpan" id="kobo.322.1"> more generic, and we</span><a id="_idIndexMarker268"/><span class="koboSpan" id="kobo.323.1"> can now create different characters from </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">that blueprint.</span></span></p>
<p><span class="koboSpan" id="kobo.325.1">Before moving on to our next topic inheritance, I want us to take a look at a class tool that you will encounter in the future and that you’ll find extremely useful – </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">attribute accessors.</span></span></p>
<h2 id="_idParaDest-88"><a id="_idTextAnchor089"/><span class="koboSpan" id="kobo.327.1">Attribute accessors</span></h2>
<p><span class="koboSpan" id="kobo.328.1">In our class</span><a id="_idIndexMarker269"/><span class="koboSpan" id="kobo.329.1"> definition, we have the </span><strong class="source-inline"><span class="koboSpan" id="kobo.330.1">first_name</span></strong><span class="koboSpan" id="kobo.331.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.332.1">last_name</span></strong><span class="koboSpan" id="kobo.333.1"> attributes, and we</span><a id="_idIndexMarker270"/><span class="koboSpan" id="kobo.334.1"> also have a </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">full_name()</span></strong><span class="koboSpan" id="kobo.336.1"> method. </span><span class="koboSpan" id="kobo.336.2">However, what if we wanted to output the person’s first name? </span><span class="koboSpan" id="kobo.336.3">We might be tempted to try </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.338.1">
jim.first_name</span></pre> <p><span class="koboSpan" id="kobo.339.1">However, this would fail miserably with the </span><span class="No-Break"><span class="koboSpan" id="kobo.340.1">following error:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.341.1">
class_syntax.rb:23:in `&lt;main&gt;': undefined method `first_name' for #&lt;Person:0x000000014d935460&gt; (NoMethodError)</span></pre> <p><span class="koboSpan" id="kobo.342.1">This is where Ruby deviates</span><a id="_idIndexMarker271"/><span class="koboSpan" id="kobo.343.1"> from how PHP would look or behave. </span><span class="koboSpan" id="kobo.343.2">Ruby can apparently</span><a id="_idIndexMarker272"/><span class="koboSpan" id="kobo.344.1"> have a method and an attribute with the same name. </span><span class="koboSpan" id="kobo.344.2">While this is not technically true, let’s for argument’s sake say that it is so that we can momentarily move forward with the exercise. </span><span class="koboSpan" id="kobo.344.3">Let’s create a method </span><span class="No-Break"><span class="koboSpan" id="kobo.345.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.346.1">first_name</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.348.1">
…
  def first_name
    @first_name
  end
…</span></pre> <p><span class="koboSpan" id="kobo.349.1">The method looks strange, but let’s remember that Ruby doesn’t need us to explicitly return a value as it does it automatically. </span><span class="koboSpan" id="kobo.349.2">So, the method is simply returning the value contained in </span><strong class="source-inline"><span class="koboSpan" id="kobo.350.1">@first_name</span></strong><span class="koboSpan" id="kobo.351.1">. </span><span class="koboSpan" id="kobo.351.2">While useful, we would have to do this for every attribute we defined. </span><span class="koboSpan" id="kobo.351.3">Additionally, we only created the method to obtain the value. </span><span class="koboSpan" id="kobo.351.4">We would also need to create a method to set the value. </span><span class="koboSpan" id="kobo.351.5">However, I have some good news for you. </span><span class="koboSpan" id="kobo.351.6">Ruby has already solved this issue with attribute accessors. </span><span class="koboSpan" id="kobo.351.7">An attribute accessor automatically creates the methods to get and set the value. </span><span class="koboSpan" id="kobo.351.8">We only need to indicate which attribute we want this “magic” to have. </span><span class="koboSpan" id="kobo.351.9">Let’s define the attribute accessors and then exploit them. </span><span class="koboSpan" id="kobo.351.10">Our final code should look </span><span class="No-Break"><span class="koboSpan" id="kobo.352.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.353.1">
# class_syntax.rb
class Person
  attr_accessor :first_name, :last_name
  def initialize( first_name, last_name )
   @first_name = first_name
   @last_name = last_name
  end
  def full_name
    puts "#{first_name} #{last_name}"
  end
end
jim = Person.new( 'James', 'Raynor' )
sarah = Person.new( 'Sarah', 'Kerrigan' )
arcturus = Person.new( 'Arcturus', 'Mengsk' )
jim.full_name
sarah.full_name
arcturus.full_name
puts jim.first_name
puts sarah.first_name
puts arcturus.last_name</span></pre> <p><span class="koboSpan" id="kobo.354.1">Let’s run it again with the </span><span class="No-Break"><span class="koboSpan" id="kobo.355.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.356.1">
ruby class_syntax.rb</span></pre> <p><span class="koboSpan" id="kobo.357.1">We should get the </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">following output:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.359.1">
James Raynor
Sarah Kerrigan
Arcturus Mengsk
James
Sarah
Mengsk</span></pre> <p><span class="koboSpan" id="kobo.360.1">Note how we did not have</span><a id="_idIndexMarker273"/><span class="koboSpan" id="kobo.361.1"> to define the </span><strong class="source-inline"><span class="koboSpan" id="kobo.362.1">last_name</span></strong><span class="koboSpan" id="kobo.363.1"> method, and yet it’s available. </span><span class="koboSpan" id="kobo.363.2">At some point in your path towards</span><a id="_idIndexMarker274"/><span class="koboSpan" id="kobo.364.1"> learning Ruby, I guarantee you will encounter the </span><strong class="source-inline"><span class="koboSpan" id="kobo.365.1">attr_accessor</span></strong><span class="koboSpan" id="kobo.366.1"> tool. </span><span class="koboSpan" id="kobo.366.2">Ruby also has </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">attr_reader</span></strong><span class="koboSpan" id="kobo.368.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.369.1">attr_writer</span></strong><span class="koboSpan" id="kobo.370.1">, which separate into two methods what </span><strong class="source-inline"><span class="koboSpan" id="kobo.371.1">attr_accessor</span></strong><span class="koboSpan" id="kobo.372.1"> does by itself. </span><span class="koboSpan" id="kobo.372.2">Should you want to go more in depth into attribute accessors, what they</span><a id="_idIndexMarker275"/><span class="koboSpan" id="kobo.373.1"> do exactly, and see other</span><a id="_idIndexMarker276"/><span class="koboSpan" id="kobo.374.1"> examples, you</span><a id="_idIndexMarker277"/><span class="koboSpan" id="kobo.375.1"> may want to </span><span class="No-Break"><span class="koboSpan" id="kobo.376.1">visit </span></span><a href="https://www.rubyguides.com/2018/11/attr_accessor/"><span class="No-Break"><span class="koboSpan" id="kobo.377.1">https://www.rubyguides.com/2018/11/attr_accessor/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.378.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.379.1">Are you ready to make more powerful classes? </span><span class="koboSpan" id="kobo.379.2">Then, let’s hop to the </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">next section.</span></span></p>
<h1 id="_idParaDest-89"><a id="_idTextAnchor090"/><span class="koboSpan" id="kobo.381.1">Inheritance in Ruby</span></h1>
<p><span class="koboSpan" id="kobo.382.1">So far, we’ve looked at a few features</span><a id="_idIndexMarker278"/><span class="koboSpan" id="kobo.383.1"> that come with Ruby’s implementation of the OOP paradigm, but we have</span><a id="_idIndexMarker279"/><span class="koboSpan" id="kobo.384.1"> neglected to look at one of the core features that help us recycle code. </span><span class="koboSpan" id="kobo.384.2">Inheritance can be simplified as the practice of passing the features of a class to create a brand-new child class. </span><span class="koboSpan" id="kobo.384.3">With this new class, we can use any of the features from the parent class, create new features, or customize the features that come from the parent class. </span><span class="koboSpan" id="kobo.384.4">The syntax for inheritance can be quite different than in PHP, but the behavior is quite similar. </span><span class="koboSpan" id="kobo.384.5">With that in mind, let’s take a look at a few use cases and see it </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">in action.</span></span></p>
<p><span class="koboSpan" id="kobo.386.1">Let’s say we wanted a class that would let us connect to a database. </span><span class="koboSpan" id="kobo.386.2">Instead of having to write all the functionality to connect to a database, we could get an already created database class, create a new one that inherited all the database functionality, and then focus on creating just the features that we need. </span><span class="koboSpan" id="kobo.386.3">This is one way to reuse code with inheritance, but let’s use a simpler example so that we can see inheritance in practice. </span><span class="koboSpan" id="kobo.386.4">Let’s say we wanted to make an abstraction of a user. </span><span class="koboSpan" id="kobo.386.5">The user must have first name, last name, age, and email details. </span><span class="koboSpan" id="kobo.386.6">We can take the </span><strong class="source-inline"><span class="koboSpan" id="kobo.387.1">Person</span></strong><span class="koboSpan" id="kobo.388.1"> class, defined in the previous section, inherit the features in our new </span><strong class="source-inline"><span class="koboSpan" id="kobo.389.1">User</span></strong><span class="koboSpan" id="kobo.390.1"> class, and just focus on the </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">missing pieces.</span></span></p>
<p><span class="koboSpan" id="kobo.392.1">So, let’s take our </span><strong class="source-inline"><span class="koboSpan" id="kobo.393.1">Person</span></strong><span class="koboSpan" id="kobo.394.1"> class and create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">inheritance_example.rb</span></strong><span class="koboSpan" id="kobo.396.1"> with the </span><span class="No-Break"><span class="koboSpan" id="kobo.397.1">following content:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.398.1">
# inheritance_example.rb
class Person
  attr_accessor :first_name, :last_name
  def initialize( first_name, last_name )
   @first_name = first_name
   @last_name = last_name
  end
  def full_name
    puts "#{first_name} #{last_name}"
  end
end</span></pre> <p><span class="koboSpan" id="kobo.399.1">Now, let’s create a new class below</span><a id="_idIndexMarker280"/><span class="koboSpan" id="kobo.400.1"> our original class called </span><strong class="source-inline"><span class="koboSpan" id="kobo.401.1">User</span></strong><span class="koboSpan" id="kobo.402.1"> and inherit from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.403.1">Person</span></strong><span class="koboSpan" id="kobo.404.1"> class. </span><span class="koboSpan" id="kobo.404.2">We’ll do</span><a id="_idIndexMarker281"/><span class="koboSpan" id="kobo.405.1"> this with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.406.1">&lt;</span></strong><span class="koboSpan" id="kobo.407.1"> operator. </span><span class="koboSpan" id="kobo.407.2">Let’s add this to the end of our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.408.1">Person</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.409.1"> class:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.410.1">
# inheritance_example.rb
…
class User &lt; Person
end</span></pre> <p><span class="koboSpan" id="kobo.411.1">With just two lines of code, we’ve made a brand-new class that behaves (for now) in the exact same way as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.412.1">Person</span></strong><span class="koboSpan" id="kobo.413.1"> class. </span><span class="koboSpan" id="kobo.413.2">Let’s confirm that by creating a new </span><strong class="source-inline"><span class="koboSpan" id="kobo.414.1">User</span></strong><span class="koboSpan" id="kobo.415.1"> object. </span><span class="koboSpan" id="kobo.415.2">Let’s now add the following to the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.416.1">our file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.417.1">
# inheritance_example.rb
…
user = User.new</span></pre> <p><span class="koboSpan" id="kobo.418.1">Now, let’s try to run this script from </span><span class="No-Break"><span class="koboSpan" id="kobo.419.1">our shell:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.420.1">
ruby inheritance_example.rb</span></pre> <p><span class="koboSpan" id="kobo.421.1">This should output </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.423.1">
inheritance_example.rb:4:in `initialize': wrong number of arguments (given 0, expected 2) (ArgumentError)
  from inheritance_example.rb:18:in `new'
  from inheritance_example.rb:18:in `&lt;main&gt;'</span></pre> <p><span class="koboSpan" id="kobo.424.1">Our script failed, but why? </span><span class="koboSpan" id="kobo.424.2">As we read through the message, it states that the constructor expected two parameters, but none were given. </span><span class="koboSpan" id="kobo.424.3">From our previous execution example, we can infer that we have to give our constructor the parameters for the first name and last name. </span><span class="koboSpan" id="kobo.424.4">So, let’s add those parameters, and let’s also call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.425.1">full_name()</span></strong><span class="koboSpan" id="kobo.426.1"> method. </span><span class="koboSpan" id="kobo.426.2">Our code will now look </span><span class="No-Break"><span class="koboSpan" id="kobo.427.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.428.1">
class Person
  attr_accessor :first_name, :last_name
  def initialize( first_name, last_name )
   @first_name = first_name
   @last_name = last_name
  end
  def full_name
    puts "#{first_name} #{last_name}"
  end
end
class User &lt; Person
end
user = User.new
user = User.new("Amit", "Seth")
user.full_name</span></pre> <p><span class="koboSpan" id="kobo.429.1">Let’s run </span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">this script:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.431.1">
ruby inheritance_example.rb</span></pre> <p><span class="koboSpan" id="kobo.432.1">The script</span><a id="_idIndexMarker282"/><span class="koboSpan" id="kobo.433.1"> will output</span><a id="_idIndexMarker283"/> <span class="No-Break"><span class="koboSpan" id="kobo.434.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.435.1">
Amit Seth</span></pre> <p><span class="koboSpan" id="kobo.436.1">So, we have confirmed that, out of the box, this newly created class has inherited all of its functionality from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.437.1">Person</span></strong><span class="koboSpan" id="kobo.438.1"> class. </span><span class="koboSpan" id="kobo.438.2">Nowhere did we have to define the </span><strong class="source-inline"><span class="koboSpan" id="kobo.439.1">full_name()</span></strong><span class="koboSpan" id="kobo.440.1"> method, as it’s already available. </span><span class="koboSpan" id="kobo.440.2">Additionally, the constructor automatically assigned the first and last name to our </span><strong class="source-inline"><span class="koboSpan" id="kobo.441.1">@first_name</span></strong><span class="koboSpan" id="kobo.442.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.443.1">@last_name</span></strong><span class="koboSpan" id="kobo.444.1"> instance variables, respectively. </span><span class="koboSpan" id="kobo.444.2">Again, we only had to have this class inherit from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.445.1">Person</span></strong><span class="koboSpan" id="kobo.446.1"> class. </span><span class="koboSpan" id="kobo.446.2">However, using the example that we provided at the beginning of this section, we want to add an additional attribute called </span><strong class="source-inline"><span class="koboSpan" id="kobo.447.1">email</span></strong><span class="koboSpan" id="kobo.448.1">. </span><span class="koboSpan" id="kobo.448.2">So first, we will add an attribute accessor for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.449.1">email</span></strong><span class="koboSpan" id="kobo.450.1"> attribute. </span><span class="koboSpan" id="kobo.450.2">Our </span><strong class="source-inline"><span class="koboSpan" id="kobo.451.1">User</span></strong><span class="koboSpan" id="kobo.452.1"> class now looks </span><span class="No-Break"><span class="koboSpan" id="kobo.453.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.454.1">
class User &lt; Person
  attr_accessor :email
end</span></pre> <p><span class="koboSpan" id="kobo.455.1">We can now assign the </span><strong class="source-inline"><span class="koboSpan" id="kobo.456.1">em.ail</span></strong><span class="koboSpan" id="kobo.457.1"> attribute from our object with </span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.459.1">
user.email = "my@fakemail.com"</span></pre> <p><span class="koboSpan" id="kobo.460.1">However, what we want</span><a id="_idIndexMarker284"/><span class="koboSpan" id="kobo.461.1"> to do is include this assignment in the new </span><strong class="source-inline"><span class="koboSpan" id="kobo.462.1">User</span></strong><span class="koboSpan" id="kobo.463.1"> constructor. </span><span class="koboSpan" id="kobo.463.2">This is not as easy</span><a id="_idIndexMarker285"/><span class="koboSpan" id="kobo.464.1"> as it seems, but it’s not that difficult either. </span><span class="koboSpan" id="kobo.464.2">So, we first have to define a constructor for our new </span><strong class="source-inline"><span class="koboSpan" id="kobo.465.1">User</span></strong><span class="koboSpan" id="kobo.466.1"> class. </span><span class="koboSpan" id="kobo.466.2">Let’s do just that. </span><span class="koboSpan" id="kobo.466.3">Our </span><strong class="source-inline"><span class="koboSpan" id="kobo.467.1">User</span></strong><span class="koboSpan" id="kobo.468.1"> class will look like </span><span class="No-Break"><span class="koboSpan" id="kobo.469.1">this now:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.470.1">
class User &lt; Person
  attr_accessor :email
  def initialize( email )
    @email = email
  end
end</span></pre> <p><span class="koboSpan" id="kobo.471.1">However, by doing this, we’ve overwritten the original constructor method (initializer). </span><span class="koboSpan" id="kobo.471.2">But do not despair, as the original constructor is still available via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.472.1">super()</span></strong><span class="koboSpan" id="kobo.473.1"> method. </span><span class="koboSpan" id="kobo.473.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.474.1">super()</span></strong><span class="koboSpan" id="kobo.475.1"> method calls the original constructor, but you must provide the original number of arguments. </span><span class="koboSpan" id="kobo.475.2">So, to finish this example, let’s again add the first name, last name, and email to our constructor and, finally, call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.476.1">super()</span></strong><span class="koboSpan" id="kobo.477.1"> method. </span><span class="koboSpan" id="kobo.477.2">Our final code will look </span><span class="No-Break"><span class="koboSpan" id="kobo.478.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.479.1">
class Person
  attr_accessor :first_name, :last_name
  def initialize( first_name, last_name )
   @first_name = first_name
   @last_name = last_name
  end
  def full_name
    puts "#{first_name} #{last_name}"
  end
end
class User &lt; Person
  attr_accessor :email
  def initialize( first_name, last_name, email )
    @email = email
    super( first_name, last_name )
  end
end
user = User.new
user = User.new("Amit", "Seth")
user.full_name
puts user.email</span></pre> <p><span class="koboSpan" id="kobo.480.1">We’ve successfully used inheritance</span><a id="_idIndexMarker286"/><span class="koboSpan" id="kobo.481.1"> to reuse our </span><strong class="source-inline"><span class="koboSpan" id="kobo.482.1">Person</span></strong><span class="koboSpan" id="kobo.483.1"> class functionality and built a new class called </span><strong class="source-inline"><span class="koboSpan" id="kobo.484.1">User</span></strong><span class="koboSpan" id="kobo.485.1">. </span><span class="koboSpan" id="kobo.485.2">When talking about classes using inheritance, you’ll hear</span><a id="_idIndexMarker287"/><span class="koboSpan" id="kobo.486.1"> the term hierarchy. </span><span class="koboSpan" id="kobo.486.2">When talking about hierarchy, we’re referring to the position on an imaginary structure of our classes where on the top, we will have the most generic class and on the bottom the most specific class. </span><span class="koboSpan" id="kobo.486.3">For this example, the hierarchical relationship between the </span><strong class="source-inline"><span class="koboSpan" id="kobo.487.1">Person</span></strong><span class="koboSpan" id="kobo.488.1"> class and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">User</span></strong><span class="koboSpan" id="kobo.490.1"> class may start to make sense, with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">Person</span></strong><span class="koboSpan" id="kobo.492.1"> class being the most generic class and thus the one on top. </span><span class="koboSpan" id="kobo.492.2">In other words, a user is a person; thus, the person must have the attributes of a user and a person. </span><span class="koboSpan" id="kobo.492.3">The opposite is not true. </span><span class="koboSpan" id="kobo.492.4">A person may no necessarily be a user. </span><span class="koboSpan" id="kobo.492.5">A person could be a client and have a different use case where we don’t need the email attribute. </span><span class="koboSpan" id="kobo.492.6">While designing your Ruby classes, if you take into account this hierarchy, it will be easier for you to determine what functionality should go where to write less code and not have issues with repeating unnecessary code. </span><span class="koboSpan" id="kobo.492.7">While this example is extremely simplified, it showed</span><a id="_idIndexMarker288"/><span class="koboSpan" id="kobo.493.1"> us how easy it is to build</span><a id="_idIndexMarker289"/> <span class="No-Break"><span class="koboSpan" id="kobo.494.1">reusable classes.</span></span></p>
<h1 id="_idParaDest-90"><a id="_idTextAnchor091"/><span class="koboSpan" id="kobo.495.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.496.1">In this chapter, we learned how Ruby libraries are installed, used, and named (gems). </span><span class="koboSpan" id="kobo.496.2">We also learned to use the bundler tool to install gems, creating environments for our scripts and programs to function correctly. </span><span class="koboSpan" id="kobo.496.3">Lastly, we learned the most basic OOP syntax to both create, instantiate, and inherit classes. </span><span class="koboSpan" id="kobo.496.4">Now, we are ready to </span><span class="No-Break"><span class="koboSpan" id="kobo.497.1">start debugging.</span></span></p>
</div>
</body></html>
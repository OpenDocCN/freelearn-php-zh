<html><head></head><body>
<div id="_idContainer080">
<h1 class="chapter-number" id="_idParaDest-138"><a id="_idTextAnchor140"/><span class="koboSpan" id="kobo.1.1">10</span></h1>
<h1 id="_idParaDest-139"><a id="_idTextAnchor141"/><span class="koboSpan" id="kobo.2.1">Considerations for Hosting Rails Applications versus PHP Applications</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Congratulations for making it to this point. </span><span class="koboSpan" id="kobo.3.2">You’ve created a simple Rails application that uses controllers, views, and models. </span><span class="koboSpan" id="kobo.3.3">You used generators to prep for your development. </span><span class="koboSpan" id="kobo.3.4">You also set up the database with migrations. </span><span class="koboSpan" id="kobo.3.5">Lastly, you included a gem to help you out with authentication. </span><span class="koboSpan" id="kobo.3.6">And now, you’re happy to say, this application works on your machine. </span><span class="koboSpan" id="kobo.3.7">Now it’s time to share your application with the world (or maybe just a client), and herein lies an important difference between a PHP application and a Rails application: </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">the hosting.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">In this chapter, we are going to go through certain aspects of hosting that we must consider when releasing our Rails application. </span><span class="koboSpan" id="kobo.5.2">We’ll compare different hosting options, as well as examine additional concepts we need for Rails applications. </span><span class="koboSpan" id="kobo.5.3">Then, we will look at how the Rails framework behaves depending on the environment setup. </span><span class="koboSpan" id="kobo.5.4">More specifically, we’ll look at error reporting on </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">production environments.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">With Rails hosting in mind, in this chapter, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.9.1">PHP versus Rails in terms </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">of price</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">Do it yourself, or have it done </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">for you?</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.13.1">Why nginx?</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.14.1">Error gossip</span></span></li>
</ul>
<h1 id="_idParaDest-140"><a id="_idTextAnchor142"/><span class="koboSpan" id="kobo.15.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.16.1">To follow along this chapter, you will need </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.18.1">Any IDE to view/edit code (e.g., SublimeText, Visual Studio Code, Notepad++, Vim, </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">Emacs, etc.)</span></span></li>
<li><span class="koboSpan" id="kobo.20.1">For macOS users, you will also need to have the Xcode command line </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">tools installed</span></span></li>
<li><span class="koboSpan" id="kobo.22.1">Ruby version 3.1.1 or later installed and ready </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">to use</span></span></li>
<li><span class="koboSpan" id="kobo.24.1">Git client installed on our </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">local machine</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.26.1">The code presented in this chapter is available </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">at </span></span><a href="https://github.com/PacktPublishing/From-PHP-to-Ruby-on-Rails/"><span class="No-Break"><span class="koboSpan" id="kobo.28.1">https://github.com/PacktPublishing/From-PHP-to-Ruby-on-Rails/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.29.1">.</span></span></p>
<h1 id="_idParaDest-141"><a id="_idTextAnchor143"/><span class="koboSpan" id="kobo.30.1">PHP versus Rails in terms of price</span></h1>
<p><span class="koboSpan" id="kobo.31.1">Before you give me grief about this unfair comparison, I’m not comparing PHP and Rails directly. </span><span class="koboSpan" id="kobo.31.2">They can’t really be compared, as one is a programming language and the other a framework. </span><span class="koboSpan" id="kobo.31.3">A more fair </span><a id="_idIndexMarker497"/><span class="koboSpan" id="kobo.32.1">comparison would be comparing the Laravel framework with the Rails framework. </span><span class="koboSpan" id="kobo.32.2">What I’m trying to convey is a PHP universe in which many tools live. </span><span class="koboSpan" id="kobo.32.3">But to do that, we must go back in time for a bit to when PHP finally became</span><a id="_idIndexMarker498"/><span class="koboSpan" id="kobo.33.1"> object oriented. </span><span class="koboSpan" id="kobo.33.2">This object-oriented PHP opened up a whole new world of possibilities. </span><span class="koboSpan" id="kobo.33.3">In 2004, PHP was already popular, and with this new feature (object-oriented programming), it became even more popular. </span><span class="koboSpan" id="kobo.33.4">WordPress became the standard for managing blogs and eventually websites. </span><span class="koboSpan" id="kobo.33.5">More web frameworks developed with PHP came into the picture: CodeIgniter, Symfony, Laravel, just to name a few. </span><span class="koboSpan" id="kobo.33.6">Joomla and Drupal gave developers yet another option that was a mix of a </span><a id="_idIndexMarker499"/><span class="koboSpan" id="kobo.34.1">framework and a </span><strong class="bold"><span class="koboSpan" id="kobo.35.1">Content Management System</span></strong><span class="koboSpan" id="kobo.36.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.37.1">CMS</span></strong><span class="koboSpan" id="kobo.38.1">). </span><span class="koboSpan" id="kobo.38.2">Thanks to this popularity, everyone was offering hosting options that supported PHP, and very cheaply if I may add. </span><span class="koboSpan" id="kobo.38.3">As other technologies became available, hosting for these technologies was also available but at a much higher cost. </span><span class="koboSpan" id="kobo.38.4">With the risk of sounding outrageous, I will say that I had a running application for a client in a server that cost them just 20 USD each year. </span><span class="koboSpan" id="kobo.38.5">Suffice it to say, in 2023, things have become a little more balanced than in 2004, but you can still find very cheap options for PHP applications, while (for the most part) Rails hosting will be slightly more costly. </span><span class="koboSpan" id="kobo.38.6">A quick search will land us with several options for Rails hosting, including the following </span><a id="_idIndexMarker500"/><span class="koboSpan" id="kobo.39.1">more </span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">popular ones:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.41.1">DigitalOcean (</span></span><a href="https://www.digitalocean.com/"><span class="No-Break"><span class="koboSpan" id="kobo.42.1">https://www.digitalocean.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.43.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.44.1">Amazon </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">Lightsail (</span></span><a href="https://aws.amazon.com/lightsail/"><span class="No-Break"><span class="koboSpan" id="kobo.46.1">https://aws.amazon.com/lightsail/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.47.1">)</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.48.1">Heroku (</span></span><a href="https://www.heroku.com/platform"><span class="No-Break"><span class="koboSpan" id="kobo.49.1">https://www.heroku.com/platform</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.50.1">)</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.51.1">AWS (</span></span><a href="https://aws.amazon.com/"><span class="No-Break"><span class="koboSpan" id="kobo.52.1">https://aws.amazon.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.53.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.54.1">Google </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">Cloud (</span></span><a href="https://cloud.google.com/"><span class="No-Break"><span class="koboSpan" id="kobo.56.1">https://cloud.google.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.57.1">)</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.58.1">Azure (</span></span><a href="https://azure.microsoft.com/"><span class="No-Break"><span class="koboSpan" id="kobo.59.1">https://azure.microsoft.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.60.1">)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.61.1">In terms of cost, Amazon</span><a id="_idIndexMarker501"/><span class="koboSpan" id="kobo.62.1"> Lightsail is probably the most cost-effective option you will </span><a id="_idIndexMarker502"/><span class="koboSpan" id="kobo.63.1">find (at the time of this </span><a id="_idIndexMarker503"/><span class="koboSpan" id="kobo.64.1">writing) with plans for as little as 3.50 USD a month. </span><span class="koboSpan" id="kobo.64.2">This option offers a simple-to-use environment with </span><strong class="bold"><span class="koboSpan" id="kobo.65.1">Amazon Web Services</span></strong><span class="koboSpan" id="kobo.66.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.67.1">AWS</span></strong><span class="koboSpan" id="kobo.68.1">) behind the scenes, but without the complexity. </span><span class="koboSpan" id="kobo.68.2">DigitalOcean offers a great option in terms of price and flexibility starting at 6 USD a month with a virtual machine that they fondly call a Droplet. </span><span class="koboSpan" id="kobo.68.3">This plan includes a PostgreSQL database. </span><span class="koboSpan" id="kobo.68.4">Heroku is</span><a id="_idIndexMarker504"/><span class="koboSpan" id="kobo.69.1"> a little more pricey, starting from 5 USD, and </span><a id="_idIndexMarker505"/><span class="koboSpan" id="kobo.70.1">does not include a database in that price. </span><span class="koboSpan" id="kobo.70.2">A small database will add an additional 7 USD </span><a id="_idIndexMarker506"/><span class="koboSpan" id="kobo.71.1">each month for a total of 12 USD. </span><span class="koboSpan" id="kobo.71.2">The last two options I’d say are only for more advanced needs and perhaps more advanced clients. </span><span class="koboSpan" id="kobo.71.3">They can be cheap (initially), but the more you need, the more expensive they become. </span><span class="koboSpan" id="kobo.71.4">Also, setting everything up in any cloud service (be it AWS, Google</span><a id="_idIndexMarker507"/><span class="koboSpan" id="kobo.72.1"> Cloud, or Azure) can be a real challenge as you need to fully understand elements of the cloud ecosystem, as opposed to other options that deliver a ready-to-use interface for </span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">your application.</span></span></p>
<p><span class="koboSpan" id="kobo.74.1">Additionally, depending on what your application does, the cost will vary and you won’t really know how much you’ll be charged until the end of the month. </span><span class="koboSpan" id="kobo.74.2">They do have built-in cost calculators and give more-or-less precise monthly estimates, but since they charge for everything (execution time of your virtual machine, networking, data transfer, disk usage, fixed IPs, and many other things), the costs will vary from month to month. </span><span class="koboSpan" id="kobo.74.3">You have absolute control of how your application is deployed and executed, but it comes at a cost. </span><span class="koboSpan" id="kobo.74.4">And then there are the worst-case scenarios, where if your security is compromised, an attacker might take control of not only your server but also your infrastructure, potentially costing you thousands of dollars for a simple mistake. </span><span class="koboSpan" id="kobo.74.5">That’s not to say that you shouldn’t consider the cloud options as viable. </span><span class="koboSpan" id="kobo.74.6">They’re just not an option for beginners or even intermediate developers. </span><span class="koboSpan" id="kobo.74.7">They’re enterprise solutions for those companies that can handle the risk and benefit from their usage. </span><span class="koboSpan" id="kobo.74.8">Let’s take a closer look at these differences between the bundled solutions (DigitalOcean, Amazon Lightsail, and Heroku) and the build-your-own options (AWS, Google Cloud, </span><span class="No-Break"><span class="koboSpan" id="kobo.75.1">and Azure).</span></span></p>
<h1 id="_idParaDest-142"><a id="_idTextAnchor144"/><span class="koboSpan" id="kobo.76.1">DIY or have it done for you</span></h1>
<p><span class="koboSpan" id="kobo.77.1">We’ve seen, in terms of costs, the different options that are available to us for hosting our application. </span><span class="koboSpan" id="kobo.77.2">However, this isn’t the only distinguishing factor to consider while determining and implementing a solution. </span><span class="koboSpan" id="kobo.77.3">They also differ in terms of philosophy and usage. </span><span class="koboSpan" id="kobo.77.4">For now, we’ll stick to one option that is bundled, packaged, and ready to be used. </span><span class="koboSpan" id="kobo.77.5">By </span><em class="italic"><span class="koboSpan" id="kobo.78.1">bundled solution</span></em><span class="koboSpan" id="kobo.79.1">, I’m referring to a solution that gives you a server that is installed, configured, and ready to use. </span><span class="koboSpan" id="kobo.79.2">For simplicity, I picked DigitalOcean and deployed our small application, but rest assured that the other bundled options will be very similar in implementation. </span><span class="koboSpan" id="kobo.79.3">As this incurs a cost, I won’t add the steps to follow along, so you just can sit back and enjoy the ride. </span><span class="koboSpan" id="kobo.79.4">You can typically select an optimized server image from a marketplace. </span><span class="koboSpan" id="kobo.79.5">Most bundled solutions have their own marketplaces where you can search and select an image (or template) that suits your needs. </span><span class="koboSpan" id="kobo.79.6">In our case, we can go to </span><a href="https://marketplace.digitalocean.com/"><span class="koboSpan" id="kobo.80.1">https://marketplace.digitalocean.com/ </span></a><span class="koboSpan" id="kobo.81.1">and review the available options. </span><span class="koboSpan" id="kobo.81.2">Of course, they will have </span><a id="_idIndexMarker508"/><span class="koboSpan" id="kobo.82.1">the classic </span><strong class="bold"><span class="koboSpan" id="kobo.83.1">Linux-Apache-MySQL-PHP</span></strong><span class="koboSpan" id="kobo.84.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.85.1">LAMP</span></strong><span class="koboSpan" id="kobo.86.1">) images ready to go, but we’re interested in the Ruby-on-Rails counterpart, which we can easily </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">find here:</span></span></p>
<p><a href="https://marketplace.digitalocean.com/apps/ruby-on-rails"><span class="No-Break"><span class="koboSpan" id="kobo.88.1">https://marketplace.digitalocean.com/apps/ruby-on-rails</span></span></a></p>
<p><span class="koboSpan" id="kobo.89.1">Once we select the technology we will use, we can view what this virtual machine (or </span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">Droplet) includes:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer073">
<span class="koboSpan" id="kobo.91.1"><img alt="Figure 10.1 – Rails virtual machine" src="image/B19230_10_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.92.1">Figure 10.1 – Rails virtual machine</span></p>
<p><span class="koboSpan" id="kobo.93.1">The greatest advantage </span><a id="_idIndexMarker509"/><span class="koboSpan" id="kobo.94.1">of acquiring a bundled solution is that you don’t have to worry about installing Ruby, the Rails gem, and any other dependencies that we might need for our application. </span><span class="koboSpan" id="kobo.94.2">As we can see in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.95.1">Figure 10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.96.1">.1</span></em><span class="koboSpan" id="kobo.97.1">, this virtual machine will have Rails 7.0.4.2 and all the dependencies needed for our application to work. </span><span class="koboSpan" id="kobo.97.2">Now, we’re presented with access to a shell where we can either log in or transfer our application files onto this server. </span><span class="koboSpan" id="kobo.97.3">It even comes with an example application already configured so that we know for a fact that Rails is installed and ready to be used. </span><span class="koboSpan" id="kobo.97.4">When I browsed to the IP that DigitalOcean provided for me, I encountered this </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">familiar page:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer074">
<span class="koboSpan" id="kobo.99.1"><img alt="Figure 10.2 – Rails example application on DigitalOcean" src="image/B19230_10_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.100.1">Figure 10.2 – Rails example application on DigitalOcean</span></p>
<p><span class="koboSpan" id="kobo.101.1">Deploying our</span><a id="_idIndexMarker510"/><span class="koboSpan" id="kobo.102.1"> application was simple enough, only requiring the same steps we </span><span class="No-Break"><span class="koboSpan" id="kobo.103.1">did locally:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.104.1">Copy the source code to </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">the server.</span></span></li>
<li><span class="koboSpan" id="kobo.106.1">Run </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">Rails migrations.</span></span></li>
<li><span class="koboSpan" id="kobo.108.1">Run </span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">Rails seeds.</span></span></li>
<li><span class="koboSpan" id="kobo.110.1">Add </span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">a use</span></span><p class="list-inset"><span class="No-Break"><span class="koboSpan" id="kobo.112.1">And voilà:</span></span></p></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer075">
<span class="koboSpan" id="kobo.113.1"><img alt="Figure 10.3 – Deployed Rails application on DigitalOcean" src="image/B19230_10_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.114.1">Figure 10.3 – Deployed Rails application on DigitalOcean</span></p>
<p><span class="koboSpan" id="kobo.115.1">The same application we had locally has now been deployed to a hosting solution. </span><span class="koboSpan" id="kobo.115.2">With a few differences here and there, I can guarantee you that the other bundled options (such as Heroku or Amazon Lightsail) will provide a similar environment to get our app running. </span><span class="koboSpan" id="kobo.115.3">The automation of this process (the deployment) is outside of the scope of this book, but if you’re interested</span><a id="_idIndexMarker511"/><span class="koboSpan" id="kobo.116.1"> in more </span><a id="_idIndexMarker512"/><span class="koboSpan" id="kobo.117.1">complex options for deployment, I suggest you take a look at Jenkins, Docker, and </span><strong class="bold"><span class="koboSpan" id="kobo.118.1">Continuous Integration/Continuous </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.119.1">Delivery </span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">(</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.121.1">CI/CD</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">):</span></span></p>
<ul>
<li><a href="https://www.jenkins.io/"><span class="No-Break"><span class="koboSpan" id="kobo.123.1">https://www.jenkins.io/</span></span></a></li>
<li><a href="https://www.docker.com/"><span class="No-Break"><span class="koboSpan" id="kobo.124.1">https://www.docker.com/</span></span></a></li>
<li><a href="https://docs.docker.com/samples/rails/"><span class="No-Break"><span class="koboSpan" id="kobo.125.1">https://docs.docker.com/samples/rails/</span></span></a></li>
<li><a href="https://www.synopsys.com/glossary/what-is-cicd.html"><span class="No-Break"><span class="koboSpan" id="kobo.126.1">https://www.synopsys.com/glossary/what-is-cicd.html</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.127.1">For simplicity with our </span><a id="_idIndexMarker513"/><span class="koboSpan" id="kobo.128.1">application, we chose the use of a SQLite database. </span><span class="koboSpan" id="kobo.128.2">It’s easy to install and implement locally, but for a real-world scenario, we would go for a more robust option such as MySQL or PostgreSQL. </span><span class="koboSpan" id="kobo.128.3">This Droplet additionally comes with a ready-to-use PostgreSQL database. </span><span class="koboSpan" id="kobo.128.4">This is what any bundled option would provide </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">for us.</span></span></p>
<p><span class="koboSpan" id="kobo.130.1">To recap, these </span><a id="_idIndexMarker514"/><span class="koboSpan" id="kobo.131.1">are the advantages of the </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">bundled option:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.133.1">Can be set up in </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">no time</span></span></li>
<li><span class="koboSpan" id="kobo.135.1">Environment ready </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">to use</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.137.1">Dependencies resolved</span></span></li>
<li><span class="koboSpan" id="kobo.138.1">Robust </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">database ready</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.140.1">However, this solution may not be a perfect fit for everyone. </span><span class="koboSpan" id="kobo.140.2">Most bundled solutions are flexible in terms of Ruby, but not in terms of the operating system. </span><span class="koboSpan" id="kobo.140.3">These solution providers can and will delete deprecated packages. </span><span class="koboSpan" id="kobo.140.4">Some solution providers even update packages (for security purposes) without your permission and may impact the behavior of your application. </span><span class="koboSpan" id="kobo.140.5">Additionally, when you need to customize your server, that may be your cue to consider the non-bundled </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">solution options.</span></span></p>
<h3><span class="koboSpan" id="kobo.142.1">DIY</span></h3>
<p><span class="koboSpan" id="kobo.143.1">In contrast to the bundled </span><a id="_idIndexMarker515"/><span class="koboSpan" id="kobo.144.1">options for hosting, the do-it-yourself options give you much more flexibility. </span><span class="koboSpan" id="kobo.144.2">Why would we need that flexibility? </span><span class="koboSpan" id="kobo.144.3">There are many cases where this is necessary, but one specific use case I can think of for this scenario is to scale up an application’s resources. </span><span class="koboSpan" id="kobo.144.4">Let’s say, for example, that your application is initially set up to serve 500 users, but you notice that you now have a database with 10,000 users. </span><span class="koboSpan" id="kobo.144.5">Your application is now very slow, but increasing the size (memory and CPU) of your server for 10,000 users would be way too expensive. </span><span class="koboSpan" id="kobo.144.6">You also notice that the number of concurrent users (i.e., users using the application at the same time) reaches 4,000 and not 10,000. </span><span class="koboSpan" id="kobo.144.7">In comes auto-scaling to </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">the rescue!</span></span></p>
<p><span class="koboSpan" id="kobo.146.1">Auto-scaling determines the resource requirements at a given moment and automatically scales up as concurrent users peak, and then scales back down when user concurrency drops. </span><span class="koboSpan" id="kobo.146.2">By </span><em class="italic"><span class="koboSpan" id="kobo.147.1">scaling up </span></em><span class="koboSpan" id="kobo.148.1">I’m referring to the platform creating more servers on the fly to be able to handle more users. </span><span class="koboSpan" id="kobo.148.2">As the hosting service only charges you when those additional servers are actually running, the whole process can save the company money as you don’t have a whole army of servers turned on the whole time, but only when the number of users peaks. </span><span class="koboSpan" id="kobo.148.3">Additionally, your application’s availability increases with this approach. </span><span class="koboSpan" id="kobo.148.4">I’m oversimplifying this whole process, but I do hope you get where I’m going with this. </span><span class="koboSpan" id="kobo.148.5">This is only one of many scenarios where a non-bundled solution would be the best fit. </span><span class="koboSpan" id="kobo.148.6">If you are interested in learning more about the topic of auto-scaling, I recommend </span><a id="_idIndexMarker516"/><span class="koboSpan" id="kobo.149.1">you look at the official AWS page </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">for auto-scaling:</span></span></p>
<p><a href="https://aws.amazon.com/autoscaling/"><span class="No-Break"><span class="koboSpan" id="kobo.151.1">https://aws.amazon.com/autoscaling/</span></span></a></p>
<p><span class="koboSpan" id="kobo.152.1">I’m going to choose AWS for our hypothetical solution, but it would be implemented similarly on any other cloud. </span><span class="koboSpan" id="kobo.152.2">To deploy our simple application on AWS, we would create an EC2 instance and add the </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">security groups.</span></span></p>
<p><span class="koboSpan" id="kobo.154.1">Once we launch our instance, we would wait for it to come up, which might take a couple of minutes. </span><span class="koboSpan" id="kobo.154.2">Once our instance was ready, we would access it through SSH and then begin our Ruby configuration. </span><span class="koboSpan" id="kobo.154.3">This would include installing Ruby, the bundler, GCC compilers – the works. </span><span class="koboSpan" id="kobo.154.4">Once Ruby was ready, we would install our Rails gem. </span><span class="koboSpan" id="kobo.154.5">Then we would upload our application code to our virtual machine and run the initial setup (installing dependencies, Rails migrations, Rails seed, and user setup). </span><span class="koboSpan" id="kobo.154.6">Then we’d start the server. </span><span class="koboSpan" id="kobo.154.7">This is where</span><a id="_idIndexMarker517"/><span class="koboSpan" id="kobo.155.1"> things would start to get more and more complicated. </span><span class="koboSpan" id="kobo.155.2">We would have a number of options for making this application available to the world. </span><span class="koboSpan" id="kobo.155.3">One option would be to open port </span><strong class="source-inline"><span class="koboSpan" id="kobo.156.1">3000</span></strong><span class="koboSpan" id="kobo.157.1"> to the world, and away we go. </span><span class="koboSpan" id="kobo.157.2">However, the Rails server should never be exposed directly to the outside world. </span><span class="koboSpan" id="kobo.157.3">We’ll see why that is in the next section, but for now, let’s just stick to that principle. </span><span class="koboSpan" id="kobo.157.4">We’ll need to set up Nginx as our web server and have it redirect calls to our Rails app. </span><span class="koboSpan" id="kobo.157.5">Once this was ready, we would be good </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">to go.</span></span></p>
<p><span class="koboSpan" id="kobo.159.1">As you can see, this seems more complicated than the bundled option. </span><span class="koboSpan" id="kobo.159.2">With this simple example, there isn’t any easily discernable advantage to building it on our own, and that’s because it doesn’t really give us any advantage. </span><span class="koboSpan" id="kobo.159.3">At least, not for our specific case – firstly, because AWS will always be an expensive choice, and secondly, because it is an enterprise solution, and as such, as in most enterprise solutions, the configuration and deployment will be more complex, albeit resulting in many more choices for your application. </span><span class="koboSpan" id="kobo.159.4">While I wouldn’t recommend deploying our application in any DIY public cloud (AWS, Google Cloud, or Azure) to share it with the world, I would recommend you do this as an exercise as it will get you familiar with the operations of cloud solutions. </span><span class="koboSpan" id="kobo.159.5">Nowadays, familiarity with this type of technology is a must </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">for developers.</span></span></p>
<p><span class="koboSpan" id="kobo.161.1">While we don’t really need to go into the details of these solutions (at least not for now), I believe we do need to get a grasp of certain concepts regarding our application deployment. </span><span class="koboSpan" id="kobo.161.2">Deploying our application behind a web server (Nginx) is one of these concepts, which we will look at in more depth in the </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">next section.</span></span></p>
<h1 id="_idParaDest-143"><a id="_idTextAnchor145"/><span class="koboSpan" id="kobo.163.1">Why nginx?</span></h1>
<p><span class="koboSpan" id="kobo.164.1">Coming from a PHP background, one of the concepts that was difficult for me to grasp was Rails’ lack of the out-of-the-box server functionality seen in PHP. </span><span class="koboSpan" id="kobo.164.2">With PHP, if it is installed, you can open a </span><a id="_idIndexMarker518"/><span class="koboSpan" id="kobo.165.1">shell and type </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.167.1">
php -S localhost:9000</span></pre> <p><span class="koboSpan" id="kobo.168.1">This will bring up an internal PHP server. </span><span class="koboSpan" id="kobo.168.2">You can now open a browser, point it to </span><strong class="source-inline"><span class="koboSpan" id="kobo.169.1">http://localhost:9000/</span></strong><span class="koboSpan" id="kobo.170.1">, and that’s all you need to do. </span><span class="koboSpan" id="kobo.170.2">Any PHP scripts we add to the same folder where we started the PHP server will be available to said server. </span><span class="koboSpan" id="kobo.170.3">We don’t need any PHP framework to start programming in PHP. </span><span class="koboSpan" id="kobo.170.4">We can use this internal server for development and once we deploy our PHP application to a production server, our application just requires a web server that has PHP enabled. </span><span class="koboSpan" id="kobo.170.5">This is an oversimplification of how it’s actually done, but in essence, that’s all that’s needed for </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">PHP servers.</span></span></p>
<p><span class="koboSpan" id="kobo.172.1">In the good ol’ days, Apache was the way to go. </span><span class="koboSpan" id="kobo.172.2">These days, you can still use Apache, but Nginx has gained a lot of ground here, to the point that Nginx is nowadays almost (if not) the standard. </span><span class="koboSpan" id="kobo.172.3">What is Nginx? </span><span class="koboSpan" id="kobo.172.4">Nginx (according to its website) is an</span><a id="_idIndexMarker519"/><span class="koboSpan" id="kobo.173.1"> advanced load balancer, web server, and reverse proxy designed to handle high-traffic websites and applications. </span><span class="koboSpan" id="kobo.173.2">It is widely used as a web server and has reportedly been adopted by Netflix and Airbnb, among others. </span><span class="koboSpan" id="kobo.173.3">With these names involved, we can safely assume its efficiency whilst handling web-related components is extremely high. </span><span class="koboSpan" id="kobo.173.4">Why should we use Nginx as a web server for Rails? </span><span class="koboSpan" id="kobo.173.5">The</span><a id="_idIndexMarker520"/><span class="koboSpan" id="kobo.174.1"> answer is delegation. </span><span class="koboSpan" id="kobo.174.2">A web server should handle things such as static assets (images, stylesheets, etc.), file uploads, SSL certificate display, and some DDoS protection, to name just a few. </span><span class="koboSpan" id="kobo.174.3">Rails (and many other web frameworks) are very capable of handling most of these tasks too, but why reinvent the wheel when we can have our Rails application only needing to worry about Rails tasks, and Nginx worrying about the web-related tasks? </span><span class="koboSpan" id="kobo.174.4">Additionally, Nginx is much faster and more efficient at handling these tasks than any web framework. </span><span class="koboSpan" id="kobo.174.5">As a matter of fact, our demo bundled hosting solution (DigitalOcean) comes with Nginx installed and configured to point to the example Rails application. </span><span class="koboSpan" id="kobo.174.6">I disabled the Rails upstream and set the Nginx page to the default, and this is what </span><span class="No-Break"><span class="koboSpan" id="kobo.175.1">I got:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer076">
<span class="koboSpan" id="kobo.176.1"><img alt="Figure 10.3 – Nginx default page on DigitalOcean" src="image/B19230_10_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.177.1">Figure 10.3 – Nginx default page on DigitalOcean</span></p>
<p><span class="koboSpan" id="kobo.178.1">The task of setting up the Nginx configuration is another reason why we should opt for the bundled solution – the DIY solution leaves the task of installing and configuring Nginx to us. </span><span class="koboSpan" id="kobo.178.2">While this is</span><a id="_idIndexMarker521"/><span class="koboSpan" id="kobo.179.1"> definitely not a complicated task, it does add yet another layer of work to the DIY solution. </span><span class="koboSpan" id="kobo.179.2">I realize this is a lot of information to take in when considering hosting options, but if you want to learn more about Nginx and </span><a id="_idIndexMarker522"/><span class="koboSpan" id="kobo.180.1">related topics, please take a look at the </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">following sites:</span></span></p>
<ul>
<li><a href="https://www.nginx.com/"><span class="No-Break"><span class="koboSpan" id="kobo.182.1">https://www.nginx.com/</span></span></a></li>
<li><a href="https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-open-source/"><span class="No-Break"><span class="koboSpan" id="kobo.183.1">https://docs.nginx.com/nginx/admin-guide/installing-nginx/installing-nginx-open-source/</span></span></a></li>
<li><a href="https://unit.nginx.org/howto/rails/"><span class="No-Break"><span class="koboSpan" id="kobo.184.1">https://unit.nginx.org/howto/rails/</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.185.1">Lastly, we need to bear in mind that Rails will behave differently when run locally than in a production environment, and that includes how we view errors on </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">a server.</span></span></p>
<h1 id="_idParaDest-144"><a id="_idTextAnchor146"/><span class="koboSpan" id="kobo.187.1">Error gossip and last words</span></h1>
<p><span class="koboSpan" id="kobo.188.1">So far, we’ve only used the Rails framework with most of the default options. </span><span class="koboSpan" id="kobo.188.2">These default options include some configurations that would otherwise hinder and slow down the overall experience for the end user. </span><span class="koboSpan" id="kobo.188.3">These options make sense in development, as they make debugging and testing really easy. </span><span class="koboSpan" id="kobo.188.4">As developers, we need to be able to set up our local environment as soon as possible and start programming away. </span><span class="koboSpan" id="kobo.188.5">However, these default options do not make sense in a production environment. </span><span class="koboSpan" id="kobo.188.6">One of these defaults </span><a id="_idIndexMarker523"/><span class="koboSpan" id="kobo.189.1">concerns error reporting. </span><span class="koboSpan" id="kobo.189.2">We saw locally how errors are displayed, but in a real-life scenario, we would never want these errors to be shown in the same way. </span><span class="koboSpan" id="kobo.189.3">We would not want detailed error output stating paths, variables, or even what database we’re using, as this could be a security breach, or at least the beginning of one. </span><span class="koboSpan" id="kobo.189.4">We would want the error to be like gossip: quiet and behind our backs. </span><span class="koboSpan" id="kobo.189.5">And that’s exactly what we’re going to do. </span><span class="koboSpan" id="kobo.189.6">For this last exercise, we will need to load a Rails application as we’ve done in previous chapters. </span><span class="koboSpan" id="kobo.189.7">If you haven’t downloaded the source code for the course, open a terminal and type the following </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.190.1">git</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.191.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.192.1">
git clone https://github.com/PacktPublishing/From-PHP-to-Ruby-on-Rails.git</span></pre> <p><span class="koboSpan" id="kobo.193.1">If you’ve already done so, then just navigate into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.194.1">chapter10</span></strong><span class="koboSpan" id="kobo.195.1"> folder within your project by running the </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.197.1">
cd From-PHP-to-Ruby-on-Rails/chapter10/hosting_original/</span></pre> <p><span class="koboSpan" id="kobo.198.1">Again, let’s install our dependencies with the </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.200.1">
bundle install</span></pre> <p><span class="koboSpan" id="kobo.201.1">And to confirm our setup was done correctly, let’s run the </span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.203.1">
bundle exec rails –version</span></pre> <p><span class="koboSpan" id="kobo.204.1">The output should read something like </span><span class="No-Break"><span class="koboSpan" id="kobo.205.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.206.1">
Rails 7.0.6</span></pre> <p><span class="koboSpan" id="kobo.207.1">And now we are ready to run our Rails application in production. </span><span class="koboSpan" id="kobo.207.2">We do this by adding the </span><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">RAILS_ENV=production</span></strong><span class="koboSpan" id="kobo.209.1"> environment variable before the Rails startup command. </span><span class="koboSpan" id="kobo.209.2">Let’s give it a try. </span><span class="koboSpan" id="kobo.209.3">In our shell, let’s type </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.211.1">
RAILS_ENV=production bundle exec rails server</span></pre> <p><span class="koboSpan" id="kobo.212.1">Once we run the preceding command, our application will run as usual, and our shell will look </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">like this:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.214.1">
=&gt; Booting Puma
=&gt; Rails 7.0.6 application starting in production
=&gt; Run `bin/rails server --help` for more startup options
Puma starting in single mode...
</span><span class="koboSpan" id="kobo.214.2">* Puma version: 5.6.6 (ruby 3.1.1-p18) ("Birdie's Version")
*  Min threads: 5
*  Max threads: 5
*  Environment: production
*          PID: 6073
* Listening on http://0.0.0.0:3000
Use Ctrl-C to stop</span></pre> <p><span class="koboSpan" id="kobo.215.1">But now, if we go to our</span><a id="_idIndexMarker524"/><span class="koboSpan" id="kobo.216.1"> browser and navigate to </span><strong class="source-inline"><span class="koboSpan" id="kobo.217.1">http://0.0.0.0:3000</span></strong><span class="koboSpan" id="kobo.218.1">, we are now greeted with </span><span class="No-Break"><span class="koboSpan" id="kobo.219.1">this page:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer077">
<span class="koboSpan" id="kobo.220.1"><img alt="Figure 10.4 – Rails running in production mode" src="image/B19230_10_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.221.1">Figure 10.4 – Rails running in production mode</span></p>
<p><span class="koboSpan" id="kobo.222.1">Granted, for development, this is a hassle, but trust me, you will be thankful when this page shows on your application deployed in production. </span><span class="koboSpan" id="kobo.222.2">As we are running our application in production mode, all errors are hidden. </span><span class="koboSpan" id="kobo.222.3">Now we need to look for the error in our logs. </span><span class="koboSpan" id="kobo.222.4">So far, we’ve neglected our log files, as the errors were always shown on the browser, but the logs have always been there. </span><span class="koboSpan" id="kobo.222.5">If we look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.223.1">chapter10/hosting_original/log/</span></strong><span class="koboSpan" id="kobo.224.1"> folder, we now have </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">two files:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer078">
<span class="koboSpan" id="kobo.226.1"><img alt="Figure 10.5 – Rails log files" src="image/B19230_10_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.227.1">Figure 10.5 – Rails log files</span></p>
<p><span class="koboSpan" id="kobo.228.1">Since we are running our application in production, let’s open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">production.log</span></strong><span class="koboSpan" id="kobo.230.1"> file. </span><span class="koboSpan" id="kobo.230.2">If there is too much information in the log, we can delete the contents of the file, save the file, and then refresh</span><a id="_idIndexMarker525"/><span class="koboSpan" id="kobo.231.1"> the browser. </span><span class="koboSpan" id="kobo.231.2">Now we can look at the file again with less data. </span><span class="koboSpan" id="kobo.231.3">We should now see something </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">like this:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.233.1">
INFO -- : Started GET "/users/sign_in" for 127.0.0.1 at 2023-08-31 22:28:41 -0700
INFO -- : Processing by Devise::SessionsController#new as HTML
INFO -- : Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.5ms | Allocations: 981)
FATAL -- :
ActiveRecord::StatementInvalid (Could not find table 'users'):
…</span></pre> <p><span class="koboSpan" id="kobo.234.1">We notice the </span><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">FATAL</span></strong><span class="koboSpan" id="kobo.236.1"> keyword, which is what caused our error. </span><span class="koboSpan" id="kobo.236.2">The error states that we cannot find the </span><strong class="source-inline"><span class="koboSpan" id="kobo.237.1">'users'</span></strong><span class="koboSpan" id="kobo.238.1"> table. </span><span class="koboSpan" id="kobo.238.2">This is because we have not run the Rails migrations. </span><span class="koboSpan" id="kobo.238.3">So, let’s do that. </span><span class="koboSpan" id="kobo.238.4">Let’s stop our application by pressing </span><em class="italic"><span class="koboSpan" id="kobo.239.1">Ctrl + C</span></em><span class="koboSpan" id="kobo.240.1">, and run the following command on </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">our shell:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.242.1">
RAILS_ENV=production bundle exec rails db:migrate</span></pre> <p><span class="koboSpan" id="kobo.243.1">Don’t forget to prefix our command with the environment. </span><span class="koboSpan" id="kobo.243.2">The command should produce output detailing that the tables have </span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">been created:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.245.1">
I== 20230817050336 CreateFriends: migrating ======================
-- create_table(:friends)
   -&gt; 0.0005s
== 20230817050336 CreateFriends: migrated (0.0005s)===============
== 20230817200425 DeviseCreateUsers: migrating ===================
-- create_table(:users)
   -&gt; 0.0006s
-- add_index(:users, :email, {:unique=&gt;true})
   -&gt; 0.0001s
-- add_index(:users, :reset_password_token, {:unique=&gt;true})
   -&gt; 0.0001s
== 20230817200425 DeviseCreateUsers: migrated (0.0008s) ==========</span></pre> <p><span class="koboSpan" id="kobo.246.1">Now let’s restart our Rails application by typing the following on the </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">shell again:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.248.1">
RAILS_ENV=production bundle exec rails server</span></pre> <p><span class="koboSpan" id="kobo.249.1">Now, refresh the</span><a id="_idIndexMarker526"/><span class="koboSpan" id="kobo.250.1"> browser. </span><span class="koboSpan" id="kobo.250.2">It looks the same, with just an error page. </span><span class="koboSpan" id="kobo.250.3">Let’s delete the contents of our </span><strong class="source-inline"><span class="koboSpan" id="kobo.251.1">production.log</span></strong><span class="koboSpan" id="kobo.252.1"> file again and refresh our browser once more. </span><span class="koboSpan" id="kobo.252.2">Now when we look at the log file again, we see a different </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.253.1">FATAL</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.254.1"> error:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.255.1">
…
FATAL -- :
ActionView::Template::Error (The asset "application.css" is not present in the asset pipeline.
</span><span class="koboSpan" id="kobo.255.2">):
…</span></pre> <p><span class="koboSpan" id="kobo.256.1">I’ve removed the rest of the log for clarity, but the </span><strong class="source-inline"><span class="koboSpan" id="kobo.257.1">FATAL</span></strong><span class="koboSpan" id="kobo.258.1"> error is what gives us a clue as to the problem. </span><span class="koboSpan" id="kobo.258.2">In Rails, when executing our application in production, some assets need to be compiled or transpiled. </span><span class="koboSpan" id="kobo.258.3">In this case, it’s the CSS and JavaScript assets that need to be generated and </span><a id="_idIndexMarker527"/><span class="koboSpan" id="kobo.259.1">minified. </span><span class="koboSpan" id="kobo.259.2">Fortunately, Rails has a command to do this task. </span><span class="koboSpan" id="kobo.259.3">To do that, we need to stop our application with </span><em class="italic"><span class="koboSpan" id="kobo.260.1">Ctrl + C</span></em><span class="koboSpan" id="kobo.261.1"> on the shell and then run the </span><span class="No-Break"><span class="koboSpan" id="kobo.262.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.263.1">
RAILS_ENV=production rails assets:precompile</span></pre> <p><span class="koboSpan" id="kobo.264.1">This should output a series of messages stating that the assets have </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">been generated:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.266.1">
INFO -- : Writing hosting_original/public/assets/manifest-b84bfa46a33d7f0dc4d2e7b8889486c9a957a5e40713d58f54be71b66954a1ff.js
INFO -- : Writing hosting_original/public/assets/manifest-b84bfa46a33d7f0dc4d2e7b8889486c9a957a5e40713d58f54be71b66954a1ff.js.gz
INFO -- : Writing hosting_original/public/assets/application-e0cf9d8fcb18bf7f909d8d91a5e78499f82ac29523d475bf3a9ab265d5e2b451.css
…</span></pre> <p><span class="koboSpan" id="kobo.267.1">There are a lot of files that were generated, but we’re not going to get into details as to how the mechanism works. </span><span class="koboSpan" id="kobo.267.2">Let’s just say that the frontend assets were generated. </span><span class="koboSpan" id="kobo.267.3">Now let’s run our application once more with the </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.269.1">
RAILS_ENV=production bundle exec rails server</span></pre> <p><span class="koboSpan" id="kobo.270.1">And when we refresh the browser once more, we should see a </span><span class="No-Break"><span class="koboSpan" id="kobo.271.1">familiar page:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer079">
<span class="koboSpan" id="kobo.272.1"><img alt="Figure 10.6 – Rails login page" src="image/B19230_10_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.273.1">Figure 10.6 – Rails login page</span></p>
<p><span class="koboSpan" id="kobo.274.1">Congratulations, my dear readers! </span><span class="koboSpan" id="kobo.274.2">We are now running a Rails application in production mode. </span><span class="koboSpan" id="kobo.274.3">As you can see, it’s a lot more hassle to debug our application as the error messages are now hidden in logs. </span><span class="koboSpan" id="kobo.274.4">In a real production environment, we would have to look for where these logs were kept. </span><span class="koboSpan" id="kobo.274.5">Running Rails tasks (db, generators, assets, etc.) might also not prove </span><a id="_idIndexMarker528"/><span class="koboSpan" id="kobo.275.1">to be so straightforward. </span><span class="koboSpan" id="kobo.275.2">You might have to tweak the commands, and in some cases, will not be allowed to run them at all. </span><span class="koboSpan" id="kobo.275.3">Either way, for now, this is the end of the road and I applaud you readers for sticking with me in this </span><span class="No-Break"><span class="koboSpan" id="kobo.276.1">Ruby-on-Rails voyage.</span></span></p>
<h1 id="_idParaDest-145"><a id="_idTextAnchor147"/><span class="koboSpan" id="kobo.277.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.278.1">We covered a lot of information in this chapter. </span><span class="koboSpan" id="kobo.278.2">We learned about the costs of hosting, the different options on the market, and whether it makes sense to opt for a bundled solution with everything configured for us, or a DIY option, which offers more flexibility but is also more complex and expensive. </span><span class="koboSpan" id="kobo.278.3">We also learned why we should deploy our applications behind Nginx. </span><span class="koboSpan" id="kobo.278.4">Finally, we learned how to debug an application in </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">production mode.</span></span></p>
<p><span class="koboSpan" id="kobo.280.1">We are now ready to use what we’ve learned in this book and add Ruby to </span><span class="No-Break"><span class="koboSpan" id="kobo.281.1">our arsenal.</span></span></p>
</div>
</body></html>
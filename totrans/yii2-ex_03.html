<html><head></head><body><div class="chapter" title="Chapter&#xA0;3.&#xA0;Making Pretty URLs"><div class="titlepage"><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Making Pretty URLs</h1></div></div></div><p>This chapter explains how to configure URL rules and make URLs pretty, in particular for search engines. We will cover the following topics in this chapter:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Using Pretty URLs</li><li class="listitem" style="list-style-type: disc">Custom URL rules<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Example – news items list by year or category</li></ul></div></li><li class="listitem" style="list-style-type: disc">The default parameters in rules<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Example – the index page to display list links</li></ul></div></li><li class="listitem" style="list-style-type: disc">Complete URL rule parameters</li><li class="listitem" style="list-style-type: disc">The URL pattern to support a multilanguage view</li><li class="listitem" style="list-style-type: disc">Creating the rule class</li></ul></div><div class="section" title="Using pretty URLs"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec23"/>Using pretty URLs</h1></div></div></div><p>The <a id="id121" class="indexterm"/>URL format is very important for SEO. People do not pay attention to URLs (some browsers does not display them at all), but search engines make correspondences between text in the page and the URL.</p><p>Until now, we have used this type of URL <code class="literal">index.php?r=site/index</code> or <code class="literal">index.php?r=site/about</code>, where <code class="literal">r</code> indicates the parameter route to follow. Now, we will see how to change these formats in <code class="literal">site/index</code> and <code class="literal">site/about</code>, that are more easily readable and useful for search engines.</p><p>In order to use pretty URLs, we need to configure Yii2 to handle them, and this can be done in a couple of minutes.</p><p>First of all, we must ensure that all requests are rewritten to <code class="literal">web/index.php</code>. In Linux, we can change web server configuration using Apache and insert the <code class="literal">.htaccess</code> file in Yii2's app root folder, if this file does not exist. The <code class="literal">.htaccess</code> file allows us to override some default configuration of the web server.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note14"/>Note</h3><p>In the Linux environment, the filename starting with dot indicates that this file is hidden.</p></div></div><p>The <a id="id122" class="indexterm"/>content of <code class="literal">.htaccess</code> is the same as Yii1:</p><div class="informalexample"><pre class="programlisting">RewriteEngine on

# If a directory or a file exists, use it directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# Otherwise forward it to index.php
RewriteRule . web/index.php</pre></div><p>If the app root is <code class="literal">/var/www/vhosts/yiiapp/basic</code>, we will insert <code class="literal">.htaccess</code> in <code class="literal">/var/www/vhosts/yiiapp/basic</code>.</p><p>The first row activates <code class="literal">RewriteEngine</code> of the web server; then, in the second and third rows, the script checks whether the request is not in an existing file or folder; and finally the request is rewritten to <code class="literal">web/index.php</code>. With these changes, all the requests that are not existing files or path folders will be rewritten to <code class="literal">web/index.php</code>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note15"/>Note</h3><p>We can also configure rewrite rules in Apache configuration instead of the <code class="literal">.htaccess</code> file, if we have access to this level of Apache configuration.</p><p>If the <code class="literal">.htaccess</code> configuration has been ignored, check whether <code class="literal">AllowOverride</code> is set to <code class="literal">All</code> as follows:</p><div class="informalexample"><pre class="programlisting">&lt;Directory /var/www/path/to/folder&gt;
   AllowOverride All
&lt;/Directory&gt;</pre></div><p>And that is not set to <code class="literal">None</code>.</p></div></div><p>The last thing to do now is to configure Yii2 in order to handle a pretty URL.</p><p>Let's open <code class="literal">config/web.php</code> and add these contents in the <code class="literal">components</code> attribute:</p><div class="informalexample"><pre class="programlisting">'urlManager' =&gt; [
  'enablePrettyUrl' =&gt; true,
],</pre></div><p>Adding the <code class="literal">enablePrettyUrl</code> property, we have just configured <code class="literal">urlManager</code> to enable the pretty URL, toggling the pretty URL format.</p><p>The previous URL <code class="literal">index.php?r=site/index</code> becomes <code class="literal">/index.php/site/index</code> and <code class="literal">index.php?r=site/about</code> becomes <code class="literal">/index.php/site/about</code>.</p><p>Using the <code class="literal">enablePrettyUrl</code> property, we will have the prefix <code class="literal">index.php</code> again. We can choose whether to keep it or not; however, to limit the URL length, it is advisable to remove it.</p><p>In order to control the presence of the <code class="literal">index.php</code> prefix, we use another property called <code class="literal">showScriptName</code>.</p><p>If we set this property to <code class="literal">false</code>, we will remove the first part of the URL. This is our updated configuration:</p><div class="informalexample"><pre class="programlisting">'urlManager' =&gt; [
    'enablePrettyUrl' =&gt; true,
    'showScriptName' =&gt; false,
],</pre></div><p>Now, <a id="id123" class="indexterm"/>point the browser to <code class="literal">http://hostname/basic/web/site/index</code> to view the first page of the Yii2 application and check whether the other links are in the pretty format.</p><p>Finally, there is another property for the <code class="literal">urlManager</code> component, used to enable URL parsing based only on given URL rules, named <code class="literal">enableStrictParsing</code>. If this property is true, only the rules defined in <code class="literal">urlManager</code> will be executed; if there is no URL that matches the request, an error will be displayed.</p></div></div>
<div class="section" title="Custom URL rules"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec24"/>Custom URL rules</h1></div></div></div><p>Yii2 give us the opportunity <a id="id124" class="indexterm"/>to customize URL rules as we want. This can be done using the <code class="literal">rules</code> property in <code class="literal">urlManager</code>, an array where keys are patterns and values are corresponding routes. Patterns are common regular expression patterns, so it is necessary to have some familiarity with regular expression.</p><p>Patterns can contain parameters that will be passed to the route. In the next example, we will display a list of news that can be filtered through year or category parameter, based on parameters passed to the URL.</p><div class="section" title="Example – list news items by year or category"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec19"/>Example – list news items by year or category</h2></div></div></div><p>In this example, we <a id="id125" class="indexterm"/>will create a new Controller named <code class="literal">News</code> in <code class="literal">controllers/NewsController.php</code>. In this new controller, we will insert a <code class="literal">data()</code> function containing an array with test data, and a function named <code class="literal">actionItemsList</code>.</p><p>The first thing to do is to configure the <code class="literal">rules</code> property under the <code class="literal">urlManager</code> component under <code class="literal">config/web.php</code>:</p><div class="informalexample"><pre class="programlisting">'rules' =&gt; [
    news/&lt;year:\d{4}&gt;/items-list' =&gt; ' news/items-list',
    'news/&lt;category:\w+&gt;/items-list' =&gt; 'test-rules/items-list',
],</pre></div><p>Here, we have two patterns:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">news/&lt;year:\d{4}&gt;/items-list</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">news/&lt;category:\w+&gt;/items-list</code></li></ul></div><p>The first pattern catches requests with a numeric parameter with four digits, passed to the <code class="literal">news /items-list</code> route as the <code class="literal">year</code> GET parameter. We can request 'news/2014/items-list' or 'news/2015/items-list'.</p><p>The second pattern catches requests with the word parameter, passed to the <code class="literal">news/items-list</code> route as the <code class="literal">category</code> GET parameter. We can request <code class="literal">news/business/items-list</code> or <code class="literal">news/shopping/items-list</code>.</p><p>Then, we <a id="id126" class="indexterm"/>create <code class="literal">NewsController</code> where to define the <code class="literal">data()</code> function, to return static data to be used as data source, and the <code class="literal">actionItemsList()</code> function to handle requests to <code class="literal">news/year/or/category/itemsList</code>:</p><div class="informalexample"><pre class="programlisting">&lt;?php

namespace app\controllers;

use Yii;
use yii\web\Controller;

class NewsController extends Controller
{
  public function data()
  {
    return [
    [ "id" =&gt; 1, "date" =&gt; "2015-04-19", "category" =&gt; "business", "title" =&gt; "Test news of 2015-04-19" ],
    [ "id" =&gt; 2, "date" =&gt; "2015-05-20", "category" =&gt; "shopping", "title" =&gt; "Test news of 2015-05-20" ],
    [ "id" =&gt; 3, "date" =&gt; "2015-06-21", "category" =&gt; "business", "title" =&gt; "Test news of 2015-06-21" ],
    [ "id" =&gt; 4, "date" =&gt; "2016-04-19", "category" =&gt; "shopping", "title" =&gt; "Test news of 2016-04-19" ],
    [ "id" =&gt; 5, "date" =&gt; "2017-05-19", "category" =&gt; "business", "title" =&gt; "Test news of 2017-05-19" ],
    [ "id" =&gt; 6, "date" =&gt; "2018-06-19", "category" =&gt; "shopping", "title" =&gt; "Test news of 2018-06-19" ]
    ];
  }

  public function actionItemsList()
  {
    // if missing, value will be null
    $year = Yii::$app-&gt;request-&gt;get('year');
    // if missing, value will be null
    $category = Yii::$app-&gt;request-&gt;get('category');

    $data = $this-&gt;data();
    $filteredData = [];

    foreach($data as $d)
    {
      if(($year != null)&amp;&amp;(date('Y', strtotime($d['date'])) == $year)) $filteredData[] = $d;
      if(($category != null)&amp;&amp;($d['category'] == $category)) $filteredData[] = $d;
    }

    return $this-&gt;render('itemsList', ['year' =&gt; $year, 'category' =&gt; $category, 'filteredData' =&gt; $filteredData] );
    }</pre></div><p>Finally, we <a id="id127" class="indexterm"/>create a view in <code class="literal">views/news/itemsList.php</code>, displaying the parameter used, year or category, and a list of results:</p><div class="informalexample"><pre class="programlisting">&lt;?php if($year != null) { ?&gt;
&lt;b&gt;List for year &lt;?php echo $year ?&gt;&lt;/b&gt;
&lt;?php } ?&gt;
&lt;?php if($category != null) { ?&gt;
&lt;b&gt;List for category &lt;?php echo $category ?&gt;&lt;/b&gt;
&lt;?php } ?&gt;

&lt;br /&gt;&lt;br /&gt;


&lt;table border="1"&gt;
    &lt;tr&gt;
        &lt;th&gt;Date&lt;/th&gt;
        &lt;th&gt;Category&lt;/th&gt;
        &lt;th&gt;Title&lt;/th&gt;
    &lt;/tr&gt;

&lt;?php foreach($filteredData as $fd) { ?&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;?php echo $fd['date'] ?&gt;&lt;/td&gt;
        &lt;td&gt;&lt;?php echo $fd['category'] ?&gt;&lt;/td&gt;
        &lt;td&gt;&lt;?php echo $fd['title'] ?&gt;&lt;/td&gt;
    &lt;/tr&gt;
&lt;?php } ?&gt;
&lt;/table&gt;</pre></div><p>Now, let's point to <code class="literal">http://hostname/basic/web/news/2015/items-list</code> to display the items list filtered out by year:</p><div class="mediaobject"><img src="graphics/B04656_03_01.jpg" alt="Example – list news items by year or category"/><div class="caption"><p>List items filtered by year</p></div></div><p>Try to change<a id="id128" class="indexterm"/> the year between news and items list to see how the data result changes in the list. The rules that are created allow us to display the items list filtered by category. Point to <code class="literal">http://hostname/basic/web/news/business/items-list</code> to see the list filtered by business category:</p><div class="mediaobject"><img src="graphics/B04656_03_02.jpg" alt="Example – list news items by year or category"/><div class="caption"><p>List items filtered by category</p></div></div><p>We can also point to <code class="literal">http://hostname/basic/web/news/shopping/items-list</code> to see the list filtered by shopping category.</p></div></div>
<div class="section" title="Default parameters in rules"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec25"/>Default parameters in rules</h1></div></div></div><p>In rules, all the parameters that are declared are required; if the URL misses some parameter, the rule will not be applied. This problem can be solved using the default property of rule.</p><p>The URL rule structure has a parameter, named defaults, containing default parameters to be passed as default. Parameter defaults is an array, where keys are names of parameters and values are their corresponding values.</p><p>For example, change the second rule to a complete array and add <code class="literal">['category' =&gt; 'shopping']</code> as the default property rule:</p><div class="informalexample"><pre class="programlisting">'rules' =&gt; [
    'news/&lt;year:\d{4}&gt;/items-list' =&gt; 'news/items-list',
    [
        'pattern' =&gt; 'news/&lt;category:\w+&gt;/items-list',
        'route' =&gt; 'news/items-list',
        'defaults' =&gt; ['category' =&gt; 'shopping']
    ]
],</pre></div><p>Now, if we point to <code class="literal">http://hostname/basic/web/news/items-list</code> without specifying the year or category parameter, the first rule will be skipped and the second one will be executed using shopping as the default value, because the category is missing.</p><div class="section" title="Example – the index page to display the links list"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec20"/>Example – the index page to display the links list</h2></div></div></div><p>Now, create an<a id="id129" class="indexterm"/> index page to see how to create these custom URLs. In this page, we will display URL links to have the data filtered by year (for the last 5 years) and links to view the data filtered by category (shopping and business).</p><p>URLs are made using <code class="literal">yii\helpers\Url</code>, along with the <code class="literal">to()</code> method, where the first parameter can be:</p><p>The first parameter can be:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An array that will be passed to the <code class="literal">toRoute()</code> method to generate the URL. The first item of this array is the route to be rendered and the other items are the parameters to be passed to the route; for example, <code class="literal">Url::to(['news/items-list', 'year' =&gt; 2015])</code>.</li><li class="listitem" style="list-style-type: disc">A string with a leading <code class="literal">@</code>; this is treated as an alias, and the corresponding aliased string will be returned</li><li class="listitem" style="list-style-type: disc">An empty string that returns the currently requested URL.</li><li class="listitem" style="list-style-type: disc">A normal string that will be returned as it is.</li></ul></div><p>Create a simple <code class="literal">actionIndex</code> in <code class="literal">NewsController</code>:</p><div class="informalexample"><pre class="programlisting">public function actionIndex()
{
    return $this-&gt;render('index');
}</pre></div><p>Then, create <a id="id130" class="indexterm"/>a view for the index action under <code class="literal">views/news/index.php</code>:</p><div class="informalexample"><pre class="programlisting">&lt;?php

use yii\helpers\Url;
use yii\helpers\Html;

?&gt;

&lt;b&gt;Filter data by year:&lt;/b&gt;
&lt;br /&gt;
&lt;ul&gt;
  &lt;?php $currentYear = date('Y'); ?&gt;
  &lt;?php for($year=$currentYear;$year&gt;($currentYear-5);$year--) { ?&gt;
  &lt;li&gt;&lt;?php echo Html::a( 'List items by year '.$year, Url::to(['news/items-list', 'year' =&gt; $year]) ) ?&gt;&lt;/li&gt;
  &lt;?php } ?&gt;
&lt;/ul&gt;

&lt;br /&gt;

&lt;b&gt;Filter data by category:&lt;/b&gt;
&lt;br /&gt;
&lt;ul&gt;
  &lt;?php $categories = ['business', 'shopping']; ?&gt;
  &lt;?php foreach($categories as $category) { ?&gt;
  &lt;li&gt;&lt;?php echo Html::a( 'List items by category '.$category, Url::to(['news/items-list', 'category' =&gt; $category]) ) ?&gt;&lt;/li&gt;
  &lt;?php } ?&gt;
&lt;/ul&gt;

&lt;br /&gt;&lt;br /&gt;</pre></div><p>Point to <code class="literal">http://hostname/news/index</code> and it will display:</p><div class="mediaobject"><img src="graphics/B04656_03_03.jpg" alt="Example – the index page to display the links list"/><div class="caption"><p>Index of the available filtered data</p></div></div></div></div>
<div class="section" title="The complete URL rule parameters"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec26"/>The complete URL rule parameters</h1></div></div></div><p>The URL rule<a id="id131" class="indexterm"/> contains the following parameters:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">defaults</code>: As we have<a id="id132" class="indexterm"/> seen, we can declare default GET parameters that this rule provides</li><li class="listitem" style="list-style-type: disc"><code class="literal">encodeParams</code>: This value<a id="id133" class="indexterm"/> indicates whether the parameters should be encoded or not</li><li class="listitem" style="list-style-type: disc"><code class="literal">host</code>: This is the<a id="id134" class="indexterm"/> host info part of a URL</li><li class="listitem" style="list-style-type: disc"><code class="literal">mode</code>: This<a id="id135" class="indexterm"/> indicates whether this rule should be used for parsing the requested URL or creating a URL</li><li class="listitem" style="list-style-type: disc"><code class="literal">name</code>: This is<a id="id136" class="indexterm"/> the name of the rule</li><li class="listitem" style="list-style-type: disc"><code class="literal">pattern</code>: This is the <a id="id137" class="indexterm"/>pattern to be used to parse and create the path info part of a URL</li><li class="listitem" style="list-style-type: disc"><code class="literal">route</code>: This is the <a id="id138" class="indexterm"/>route of the controller action</li><li class="listitem" style="list-style-type: disc"><code class="literal">suffix</code>: This is the<a id="id139" class="indexterm"/> URL suffix used for this rule (<code class="literal">.json</code>, <code class="literal">.html</code>, and so on)</li><li class="listitem" style="list-style-type: disc"><code class="literal">verb</code>: This is the <a id="id140" class="indexterm"/>HTTP verb that this rule should match with (GET, POST, DELETE, and so on)</li></ul></div></div>
<div class="section" title="The URL pattern to support the multilanguage view"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec27"/>The URL pattern to support the multilanguage view</h1></div></div></div><p>There are different ways to <a id="id141" class="indexterm"/>display the same view in different languages. A basic approach to support multilanguage views could be to insert a language code at the start of the route. For example, the previous route <code class="literal">news/index</code> will become <code class="literal">en/news/index</code> in English language, <code class="literal">it/news/index</code> in Italian language, <code class="literal">fr/news/index</code> in French language, and so on.</p><p>Append this rule in the <code class="literal">rules</code> property of <code class="literal">UrlManager</code>:</p><div class="informalexample"><pre class="programlisting">[
    'pattern' =&gt; '&lt;lang:\w+&gt;/&lt;controller&gt;/&lt;action&gt;',
    'route' =&gt; '&lt;controller&gt;/&lt;action&gt;',
],</pre></div><p>All the requests that have a language ID as the prefix in the path info, will be matched and passed to the <code class="literal">&lt;controller&gt;/&lt;action&gt;</code> route with the $<code class="literal">lang</code> parameters passed in GET.</p><p>Now, create a<a id="id142" class="indexterm"/> new action named <code class="literal">actionInternationalIndex</code> in <code class="literal">NewsController</code> to test the multilanguage support:</p><div class="informalexample"><pre class="programlisting">public function actionInternationalIndex()
{
    // if missing, value will be 'en'
    $lang = Yii::$app-&gt;request-&gt;get('lang', 'en');
    
    Yii::$app-&gt;language = $lang;

    return $this-&gt;render('internationalIndex');
}</pre></div><p>In this action, <code class="literal">$lang</code> is taken from GET parameters. If the request does not contain the <code class="literal">$lang</code> parameter, the <code class="literal">en</code> value will be used as default.</p><p>Create new view in <code class="literal">views/news/internationalIndex.php</code> to check the language code passed to the URL.</p><div class="informalexample"><pre class="programlisting">Requested language for this page is:
&lt;br /&gt;
&lt;b&gt;&lt;?php echo Yii::$app-&gt;language ?&gt;&lt;/b&gt;</pre></div><p>Verify whether this action is working correctly by visiting <code class="literal">http://hostname/news/international-index</code>:</p><div class="mediaobject"><img src="graphics/B04656_03_04.jpg" alt="The URL pattern to support the multilanguage view"/><div class="caption"><p>Setting the English language</p></div></div><p>We are visualizing this page in English because no language code was passed to the URL. Consequently, the default language code, <code class="literal">en</code>, has been used. However, if we write the language code in the URL, the result will change.</p><p>For example, pointing to <code class="literal">http://hostname/basic/web/it/news/international-index</code> will display the following:</p><div class="mediaobject"><img src="graphics/B04656_03_05.jpg" alt="The URL pattern to support the multilanguage view"/><div class="caption"><p>Setting the Italian language</p></div></div><p>This response<a id="id143" class="indexterm"/> gives us the confirmation that we have used <code class="literal">it</code> as the language code.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note17"/>Note</h3><p>In this simple approach to support multi language, we get the <code class="literal">$lang</code> value from the request, as we have done in <code class="literal">actionInternationalIndex</code>; however, this is redundant and has to be generalized in all the requests. We could create a <code class="literal">BaseController</code> class as the base class for every Controller and then override the <code class="literal">beforeAction()</code> method, where we can set the <code class="literal">Yii::$app-&gt;language</code> parameter.</p></div></div></div>
<div class="section" title="Creating the rule class"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec28"/>Creating the rule class</h1></div></div></div><p>URL rules<a id="id144" class="indexterm"/> declared in terms of pattern-route pairs can cover the majority of projects. However, it is not flexible enough with dynamic data, where the URL could be any format and value stored in the database.</p><p>Now, we need to display item details using a URL that contains only the item title, such as <code class="literal">http://hostname/basic/web/news/Test</code> news of 2015-04-19</p><p>There is no way to solve this with URL rules, as we have done until now.</p><p>A more general solution to parse and create URL requests is using <code class="literal">Rule</code> classes.</p><p>The <code class="literal">Rule</code> class extends <code class="literal">Object</code> and implements <code class="literal">UrlRuleInterface</code>.</p><p>The next example will explain how to display item details, finding it from the title (defined in <code class="literal">data()</code> array of objects), and parsing and creating routes with a <code class="literal">Rule</code> class.</p><p>The route displayed in the browser will have the news/title format.</p><p>For this <a id="id145" class="indexterm"/>purpose, create a new folder <code class="literal">components</code> under the basic folder if it does not exist, and create <code class="literal">components/NewsUrlRule.php</code> with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;?php

namespace app\components;

use yii\web\UrlRuleInterface;
use yii\base\Object;

class NewsUrlRule extends Object implements UrlRuleInterface
{

  public function createUrl($manager, $route, $params)
  {
    if ($route === 'news/item-detail') {
      if (isset($params['title'])) {
        return 'news/'.$params['title'];
      }
    }
    return false;  // this rule does not apply
  }

  public function parseRequest($manager, $request)
  {
    $pathInfo = $request-&gt;getPathInfo();

    if (preg_match('%^([^\/]*)\/([^\/]*)$%', $pathInfo, $matches)) {
      if($matches[1] == 'news')
      {
        $params = [ 'title' =&gt; $matches[2]];
        return ['news/item-detail', $params];
      }
      else
      {
        return false;
      }
    }
    return false;  // this rule does not apply
  }
}</pre></div><p>The first method, <code class="literal">createUrl()</code> receives <code class="literal">$manager</code>, <code class="literal">$route</code>, and <code class="literal">$params</code>. With route and params, the framework builds the URL. In this case, we check whether the route passed is equivalent to <code class="literal">news/item-detail</code> and if it is so, return the corresponding URL.</p><p>The second <a id="id146" class="indexterm"/>method, <code class="literal">parseRequest()</code> receives <code class="literal">$manager</code> and <code class="literal">$request</code>. A match with a custom regular expression will be done to extract the required parts, using the <code class="literal">$request</code> data. The process will return the route, to be executed.</p><p>Now, link these components to <code class="literal">urlManager</code> of the <code class="literal">web.php</code> file located at <code class="literal">config/</code>, appending the following lines in the <code class="literal">rule</code> property of the <code class="literal">urlManager</code> component:</p><div class="informalexample"><pre class="programlisting">[
'class' =&gt; 'app\components\NewsUrlRule',
// ...configure other properties...
],</pre></div><p>The next thing to do is to create <code class="literal">actionItemDetail</code> in <code class="literal">NewsController</code>, as follows:</p><div class="informalexample"><pre class="programlisting">public function actionItemDetail()
{
    $title = Yii::$app-&gt;request-&gt;get('title');
    
    $data = $this-&gt;data();
    
    $itemFound = null;
    
    foreach($data as $d)
    {
        if($d['title'] == $title) $itemFound = $d;
    }        
    
    return $this-&gt;render('itemDetail', ['title' =&gt; $title, 'itemFound' =&gt; $itemFound]);
}</pre></div><p>In this action, we simply find the item starting from the title received from the route. We pass the title and <code class="literal">itemFound</code> to view.</p><p>The last file to create is <code class="literal">view</code> under <code class="literal">views/news/itemDetail.php</code>:</p><div class="informalexample"><pre class="programlisting">Detail item with title &lt;b&gt;&lt;?php echo $title ?&gt;&lt;/b&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;?php if($itemFound != null) { ?&gt;
    &lt;table border="1"&gt;
        &lt;?php foreach($itemFound as $key=&gt;$value) { ?&gt;
        &lt;tr&gt;
            &lt;th&gt;&lt;?php echo $key ?&gt;&lt;/th&gt;
            &lt;td&gt;&lt;?php echo $value ?&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;?php } ?&gt;
    &lt;/table&gt;
    
    &lt;br /&gt;
    
    Url for this items is: &lt;?php echo yii\helpers\Url::to(['news/item-detail', 'title' =&gt; $title]); ?&gt;
    
&lt;?php } else { ?&gt;
    &lt;i&gt;No item found&lt;/i&gt;
&lt;?php } ?&gt;</pre></div><div class="mediaobject"><img src="graphics/B04656_03_06.jpg" alt="Creating the rule class"/><div class="caption"><p>Item detail output</p></div></div><p>In this view, the<a id="id147" class="indexterm"/> item details (if the item is found) along with how to build the URL of the item detail will be displayed.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec29"/>Summary</h1></div></div></div><p>In this chapter, we saw how to implement pretty URLs, which is useful for search engine optimization. We also created examples where we used custom rules to parse and create the URL. Finally, we learned how to build more customized URL rules through Rule classes.</p><p>In the next chapter, we will cover the use of a database, which is a fundamental aspect of every web application. We will start from the configuration of a database connection through to the tools that Yii2 makes available to developers, and to build a complete reservation system based on database data, using framework widgets.</p></div></body></html>
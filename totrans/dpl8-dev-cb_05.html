<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Frontend for the Win</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will explore the world of frontend development in Drupal 8. In this chapter, we will cover the following recipes:</p>
<ul>
<li>Creating a custom theme based on Classy</li>
<li>Using the new asset management system</li>
<li>Twig templating</li>
<li>Using the Breakpoint module</li>
<li>Using the Responsive Image module</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>Drupal 8 brought many changes with regard to the frontend. It is now focused on mobile-first responsive design. Frontend performance has been given a high priority, unlike in the previous versions of Drupal. There is a new asset management system based on libraries that will deliver only the minimum required assets for a page that comes with Drupal 8.</p>
<p>In Drupal 8, we have a new feature, the Twig templating engine, that replaces the previously used PHPTemplate engine. Twig is part of the large PHP community and embraces more of Drupal 8's <em>made elsewhere</em> initiative. Drupal 7 supported libraries to define JavaScript and CSS resources. However, it was very rudimentary and did not support the concept of library dependencies.</p>
<p>There are two modules provided by the Drupal core that implement the responsive design with server-side components. The Breakpoint module provides a representation of media queries that modules can utilize. The Responsive Image module implements the HTML5 picture tag for image fields.</p>
<p>This chapter dives into harnessing Drupal 8's frontend features to get the most out of them.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a custom theme based on Classy</h1>
                </header>
            
            <article>
                
<p>Drupal 8 ships with a new base theme that is intended to demonstrate best practice and CSS class management. The Classy theme is provided by the Drupal core and is the base theme for the default frontend theme, Bartik, and the administrative theme, Seven.</p>
<p>Unlike the previous versions of Drupal, Drupal 8 provides two base themes--Classy and Stable--to jump start Drupal theming. Stable provides a leaner approach to frontend theming with fewer classes and wrapping elements and is guaranteed to not introduce changes that may disrupt your child theme. In this recipe, we will create a new theme called <kbd>mytheme</kbd> that uses Classy as its base.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>In the root directory of your Drupal site, create a folder called <kbd>mytheme</kbd> in the <kbd>themes</kbd> folder.</li>
<li>Inside the <kbd>mytheme</kbd> folder, create a <kbd>mytheme.info.yml</kbd> file so that Drupal can discover the <kbd>theme</kbd>. We will then edit this file:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" src="assets/31ad8eef-a265-4180-8da8-bf1479b9cdf4.png"/></div>
<ol start="3">
<li>First, we will need to define the <kbd>themes</kbd> name using the <kbd>name</kbd> key:</li>
</ol>
<pre style="padding-left: 60px">name: My Theme </pre>
<ol start="4">
<li>All the themes need to provide a <kbd>description</kbd> key, that will be displayed on the <span class="packt_screen">Appearance</span> page:</li>
</ol>
<pre style="padding-left: 60px">description: My custom theme </pre>
<ol start="5">
<li>Next, we will need to define the type of extension, that is, a theme and the version of core that is supported:</li>
</ol>
<pre style="padding-left: 60px">type: theme 
core: 8.x </pre>
<ol start="6">
<li>The <kbd>base theme</kbd> call allows us to instruct Drupal to use a specific theme as a base:</li>
</ol>
<pre style="padding-left: 60px">base theme: classy </pre>
<ol start="7">
<li>The final item is a <kbd>regions</kbd> key that is used to define the regions of the blocks that can be placed, which is a YAML-based array of key/value pairs:</li>
</ol>
<pre style="padding-left: 60px">regions: 
  header: 'Header' 
  primary_menu: 'Primary menu' 
  page_top: 'Page top' 
  page_bottom: 'Page bottom' 
  breadcrumb: 'Breadcrumb' 
  content: 'Content' </pre>
<p style="padding-left: 90px">Regions are rendered in the page <kbd>template</kbd> file, which will be covered in the next recipe, <em>Twig templates</em>.</p>
<ol start="8">
<li>Log in to your Drupal site, and go to <span class="packt_screen">Appearance</span> from the administrative toolbar.</li>
</ol>
<p>Â </p>
<ol start="9">
<li>Click on <span class="packt_screen">Install and set default</span> in the <span class="packt_screen">My theme</span> entry to enable and use the new custom theme:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" src="assets/0a1f5947-7ce8-4c93-9e80-daaafbaa253f.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>In Drupal 8, the <kbd>info.yml</kbd> files define Drupal themes and modules. The first step to create a theme is to provide the <kbd>info.yml</kbd> file so that the theme can be discovered. Drupal will parse these values and register the theme.</p>
<p>The following keys are required, as a minimum, when you define a theme:</p>
<ul>
<li><kbd>name</kbd></li>
<li><kbd>description</kbd></li>
<li><kbd>type</kbd></li>
<li><kbd>base theme</kbd></li>
<li><kbd>core</kbd></li>
</ul>
<p>The <kbd>name</kbd> key defines the human-readable name of the theme that will be displayed on the <span class="packt_screen">Appearance</span> page. The <span class="packt_screen">description</span> will be shown under the <span class="packt_screen">themes</span> display name on the <span class="packt_screen">Appearance</span> page. All Drupal projects need to define the <kbd>type</kbd> key to indicate the kind of extension that is being defined. For themes, the type must always be <kbd>theme</kbd>. You will also need to define which version of Drupal the project is compatible with using the core value. All Drupal 8 projects will use the <kbd>core: 8.x</kbd> value. When you define a theme, you will also need to provide the base <kbd>theme</kbd> key. If your theme does not use a base theme, then you need to set the value to <kbd>false</kbd>.</p>
<p>The <kbd>libraries</kbd> and <kbd>region</kbd> keys are optional, but these are keys that most themes provide. Drupal's asset management system parses a theme's <kbd>info.yml</kbd> and adds those libraries, if required. Regions are defined in an <kbd>info.yml</kbd> file and provide the areas into which the Block module may place blocks.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Next, we will dive into additional information on themes.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Theme screenshots</h1>
                </header>
            
            <article>
                
<p>Themes can provide a screenshot that shows up on the <span class="packt_screen">Appearance</span> page. A theme's screenshot can be provided by placing a <kbd>screenshot.png</kbd> image file in the <kbd>theme</kbd> folder or a file specified in the <kbd>info.yml</kbd> file under the <kbd>screenshot</kbd> key.</p>
<p>If the screenshot is missing, a <kbd>default</kbd> is used, as seen with the Classy and Stark themes. Generally, a screenshot is a Drupal site with generic content using the theme.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Themes, logos, and favicons</h1>
                </header>
            
            <article>
                
<p>Drupal controls the site's favicon and logo settings as a theme setting. Theme settings are active on a theme-by-theme basis and are not global. Themes can provide a default logo by providing <kbd>logo.svg</kbd> in the <kbd>theme</kbd> root folder. A <kbd>favicon.ico</kbd> placed in a <kbd>theme</kbd> folder will also be the default value of the <kbd>favicon</kbd> for the website.</p>
<div class="packt_infobox">Currently, there is no way to specify a logo of a different file type for a theme. Previous versions of Drupal looked for <kbd>logo.png</kbd>. A feature has been planned for Drupal 8.5 to allow the <kbd>themes</kbd> to define the logo's filename and extension. Refer to the core issue for more information at <a href="https://www.drupal.org/node/1507896"><span class="URLPACKT">https://www.drupal.org/node/1507896</span></a>.</div>
<p>You can change the site's logo and favicon by navigating to <span class="packt_screen">Appearance</span> and then clicking on <span class="packt_screen">Settings</span> for your current theme. Unchecking the <span class="packt_screen">use default</span> checkboxes for the favicon and logo settings allows you to provide custom files:</p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" src="assets/fb646694-4b53-4ba0-86cc-2f2d14fdca9b.png"/></div>
<div class="packt_figure"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Base themes and shared resources</h1>
                </header>
            
            <article>
                
<p>Many content management systems that have a theme system which supports base (or parent) themes differ mostly in the terminology used. The concept of a base theme is used to provide established resources that are shared, reducing the amount of work required to create a new theme.</p>
<p>All libraries defined in the base theme will be inherited and used by default, allowing subthemes to reuse existing styles and JavaScript. This allows frontend developers to reuse their work and only create specific changes that are required for the subtheme.</p>
<p>The subthemes will also inherit all Twig template overrides provided by the base theme. This was one of the initiatives used for the creation of the Classy theme. Drupal 8 makes many fewer assumptions compared to the previous version as to what class names to provide on elements. Classy overrides all the core's templates and provides sensible default classes, giving themes the ability to use them and accept those class names or be given a blank slate.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">CKEditor style sheets</h1>
                </header>
            
            <article>
                
<p>As discussed in <a href="953ad256-0342-45c8-84d9-5cda80d2d099.xhtml"><em><span class="ChapterrefPACKT">Chapter 2</span></em></a>, <em>The Content Authoring Experience</em>, Drupal ships with the WYSIWYG support and CKEditor as the default editor. The CKEditor module will inspect the active theme and its base theme, if provided, and load any style sheets defined in the <kbd>ckeditor_stylesheets</kbd> key as an array of values.</p>
<p>For example, the following code can be found in <kbd>bartik.info.yml</kbd>:</p>
<pre>ckeditor_stylesheets: 
  - css/base/elements.css 
  - css/components/captions.css 
  - css/components/table.css </pre>
<p>This allows themes to provide style sheets that will style elements within the CKEditor module to enhance the <em>what you see is what you get</em> experience of the editor.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<ul>
<li>To define a theme with an <kbd>info.yml</kbd> file, refer to <a href="https://www.drupal.org/node/2349827"><span class="URLPACKT">https://www.drupal.org/node/2349827</span></a></li>
<li>To use Classy as a base theme, refer to the community documentation at <a href="https://www.drupal.org/theme-guide/8/classy"><span class="URLPACKT">https://www.drupal.org/theme-guide/8/classy</span></a></li>
<li>Refer to Core themes documentation at <a href="https://www.drupal.org/docs/8/core/themes"><span class="URLPACKT">https://www.drupal.org/docs/8/core/themes</span></a></li>
<li>To create a Drupal 8 subtheme, refer to the community documentation at <a href="https://www.drupal.org/node/2165673"><span class="URLPACKT">https://www.drupal.org/node/2165673</span></a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using the new asset management system</h1>
                </header>
            
            <article>
                
<p>The asset management system is the most <span>recent one to Drupal 8</span>. The asset management system allows modules and themes to register libraries. Libraries define CSS style sheets and JavaScript files that need to be loaded with the page. Drupal 8 takes this approach for the frontend performance. Rather than loading all CSS or JavaScript assets, only those required for the current page in the specified libraries will be loaded.</p>
<p>In this recipe, we will define a <kbd>libraries.yml</kbd> file that will define a CSS style sheet and JavaScript file provided by a custom theme.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe assumes that you have <span>created</span> a custom theme, such as the one you created in the first recipe. When you see <kbd>mytheme</kbd> in this recipe, use the machine name of the theme that you created.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Create a folder named <kbd>css</kbd> in your theme's base directory.</li>
<li>In your <kbd>css</kbd> folder, add a <kbd>style.css</kbd> file that will hold the theme's CSS declarations. For the purpose of demonstration, add the following CSS declaration to <kbd>style.css</kbd>:</li>
</ol>
<pre style="padding-left: 60px">body { <br/>  background: cornflowerblue;<br/>} </pre>
<ol start="3">
<li>Then, create a <kbd>js</kbd> folder in your theme's directory and add a <kbd>scripts.js</kbd> file that will hold the theme's JavaScript items.</li>
</ol>
<p>Â </p>
<ol start="4">
<li>In your theme folder, create a <kbd>mytheme.libraries.yml</kbd> file, as shown in the following screenshot:
<div class="packt_figure CDPAlignCenter CDPAlign"><img height="280" width="466" class=" image-border" src="assets/5b3e3c44-541a-4a36-ba9c-9b81e2d511c1.png"/></div>
</li>
<li>Edit the <kbd>mytheme.libraries.yml</kbd> file. Add the following <kbd>YAML</kbd> text to define the <kbd>global-styling</kbd> library for your theme that will load the CSS and JavaScript files:</li>
</ol>
<pre style="padding-left: 60px">global-styling: 
  version: VERSION 
  css: 
    theme: 
      css/style.css: {} 
  js: 
    js/scripts.js: {} </pre>
<ol start="6">
<li>The preceding text tells Drupal that there is a <kbd>global-styling</kbd> library. You can specify a library version and use the <kbd>VERSION</kbd> defaults for your themes. It also defines the <kbd>css/styles.css</kbd> style sheet as part of the library under the <kbd>theme</kbd> group.</li>
</ol>
<p>Â </p>
<ol start="7">
<li>Edit your <kbd>mytheme.info.yml</kbd>, and add the declaration to your <kbd>global-styling</kbd> library:</li>
</ol>
<pre style="padding-left: 60px">name: My Theme <br/>description: My custom theme <br/>type: theme<br/>core: 8.x <br/>base theme: classy<br/><strong>libraries: 
  - mytheme/global-styling</strong> </pre>
<ol start="8">
<li>Themes can specify a <kbd>libraries</kbd> key that defines the libraries that should always be loaded. This <kbd>YAML</kbd> array lists libraries to be loaded for each page.</li>
<li>Go to <span class="packt_screen">Configuration</span> and then to <span class="packt_screen">Performance</span> under the <span class="packt_screen">DEVELOPMENT</span> section to rebuild Drupal's caches.</li>
<li>With your theme set to the default, navigate to your Drupal site's home page.</li>
<li>Your theme's <kbd>global-styling</kbd> library will be loaded, and the page's background color will be styled appropriately:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" src="assets/0cea031b-c85d-4c20-8719-1031c5eb9063.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Drupal aggregates all the available <kbd>library.yml</kbd> files and passes them to the <kbd>library.discovery.parser</kbd> service. The <kbd>default</kbd> class for this service provider is <kbd>\Drupal\Core\Asset\LibraryDiscoveryParser</kbd>. This service reads the library definition from each <kbd>library.yml</kbd> and returns its value to the system. Before parsing the file, the parser allows themes to provide overrides and extensions to the library.</p>
<p>Libraries are enqueuers, as they are attached to rendered elements. Themes can generically add libraries through their <kbd>info.yml</kbd> files via the <kbd>libraries</kbd> key. These libraries will always be loaded on the page when the theme is active.</p>
<p>CSS style sheets are added to the data that will build the head tag of the page. JavaScript resources, by default, are rendered in the footer of the page for performance reasons.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>We will explore the options surrounding libraries in Drupal 8 in more detail in the next section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">CSS groups</h1>
                </header>
            
            <article>
                
<p>With libraries, you can specify CSS by different groups. Drupal's asset management system provides the following CSS groups:</p>
<ul>
<li>Base</li>
<li>Layout</li>
<li>Component</li>
<li>State</li>
<li>Theme</li>
</ul>
<p>Style sheets are loaded in the order in which the groups are listed. Each one of them relates to a PHP constant defined in <kbd>/core/includes/common.inc</kbd>. This allows separation of concerns when working with style sheets. Drupal 8's CSS architecture borrows concepts from the <span><strong>Scalable and Modular Architecture for CSS</strong> (</span><strong>SMACSS</strong>) system to organize CSS declarations. You can learn more about this technique for building flexible and scalable CSS style sheets at <a href="https://smacss.com/">https://smacss.com/</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Library asset options</h1>
                </header>
            
            <article>
                
<p>Library assets can have configuration data attached to them. If there are no configuration items provided, a simple set of empty brackets is added. Therefore, in each example, lines end with <kbd>{}</kbd>.</p>
<p>The following example, taken from <kbd>core.libraries.yml</kbd>, adds <kbd>HTML5shiv</kbd>:</p>
<pre>assets/vendor/html5shiv/html5shiv.min.js: { weight: -22, browsers: { IE: 'lte IE 8', '!IE': false }, minified: true } </pre>
<p>Let's take a look at the attributes of <kbd>html5shiv.min.js</kbd>:</p>
<ul>
<li>The <kbd>weight</kbd> key ensures that the script is rendered earlier than other libraries</li>
<li>The <kbd>browser</kbd> tag allows you to specify conditional rules to load the scripting</li>
<li>You should always pass <kbd>minified</kbd> as <kbd>true</kbd> if the asset has already been minified</li>
</ul>
<p>For CSS assets, you can pass a media option to specify a media query for the asset. Reviewing classes that implement <kbd>\Drupal\Core\Asset\AssetCollectionRendererInterface</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Library dependencies</h1>
                </header>
            
            <article>
                
<p>Libraries can specify other libraries as dependencies. This allows Drupal to provide a minimum footprint on the frontend performance.</p>
<div class="packt_infobox">jQuery is only loaded if a JavaScript library specifies it as a dependency; for more information on library dependencies, refer to <a href="https://www.drupal.org/node/1541860"><span class="URLPACKT">https://www.drupal.org/node/1541860</span></a>.</div>
<p>Here's an example from the Quick Edit module's <kbd>libraries.yml</kbd> file:</p>
<pre>quickedit: 
  version: VERSION 
  js:  
    ... 
  css: 
    ... 
  dependencies: 
    - core/jquery 
    - core/jquery.once 
    - core/underscore 
    - core/backbone 
    - core/jquery.form 
    - core/jquery.ui.position 
    - core/drupal 
    - core/drupal.displace 
    - core/drupal.form 
    - core/drupal.ajax 
    - core/drupal.debounce 
    - core/drupalSettings 
- core/drupal.dialog </pre>
<p>The Quick Edit module defines <em>jQuery</em>, the <em>jQuery Once plugin</em>, <em>Underscore</em>, and <em>Backbone</em>, and selects other defined libraries as dependencies. Drupal will ensure that these are present whenever the <kbd>quickedit/quickedit</kbd> library is attached to a page.</p>
<p>A complete list of the default libraries provided by Drupal core can be found in <kbd>core.libraries.yml</kbd>, which is in <kbd>core/core.libraries.yml</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Overriding and extending other libraries</h1>
                </header>
            
            <article>
                
<p>Themes have the ability to override libraries using the <kbd>libraries-override</kbd> and <kbd>libraries-extend</kbd> keys in their <kbd>info.yml</kbd>. This allows themes to easily customize the existing libraries without having to add the logic to conditionally remove or add their assets when a particular library is attached to a page.</p>
<p>The <kbd>libraries-override</kbd> key can be used to replace an entire library, replace selected files in a library, remove an asset from a library, or disable an entire library. The following code will allow a theme to provide a custom jQuery UI theme:</p>
<pre>libraries-override: 
  core/jquery.ui: 
    css: 
      component: 
         assets/vendor/jquery.ui/themes/base/core.css: false 
      theme: 
         assets/vendor/jquery.ui/themes/base/theme.css: css/jqueryui.css </pre>
<p>The override declaration mimics the original configuration. Specifying <kbd>false</kbd> will remove the asset, or else a supplied path will replace that asset.</p>
<p>The <kbd>libraries-extend</kbd> key can be used to load additional libraries with an existing library. The following code will allow a theme to associate a CSS style sheet with selected jQuery UI declaration overrides, without always having them included in the rest of the theme's assets:</p>
<pre>libraries-extend: 
  core/jquery.ui: 
    - mytheme/jqueryui-theme </pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using a CDN or external resource as a library</h1>
                </header>
            
            <article>
                
<p>Libraries also work with external resources, such as assets loaded over a CDN. This is done by providing a URL for the file location along with selected file parameters.</p>
<p>Here is an example to add the <kbd>FontAwesome</kbd> font icon library from the <kbd>BootstrapCDN</kbd> provided by MaxCDN:</p>
<pre>mytheme.fontawesome: 
  remote: http://fontawesome.io/ 
  version: 4.4.0 
  license: 
    name: SIL OFL 1.1 
    url: http://fontawesome.io/license/ 
    gpl-compatible: true 
  css: 
    base: 
      https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css: { type: external, minified: true } </pre>
<p>Remote libraries require additional metainformation to work properly:</p>
<pre>remote: http://fontawesome.io/ </pre>
<p>The <kbd>remote</kbd> key describes the library as using external resources. While this key is not validated beyond its existence, it is best to define it with the external resource's primary website:</p>
<pre>version: 4.4.0 </pre>
<p>Like all libraries, a version is required. This should match the version of the external resource being added:</p>
<pre>license: 
    name: SIL OFL 1.1 
    url: http://fontawesome.io/license/ 
    gpl-compatible: true </pre>
<p>If a library defines the <kbd>remote</kbd> key, it <span>also</span> needs to define the <kbd>license</kbd> key. This defines the license name, the URL for the license, and checks whether it is GPL-compatible. If this key is not provided, a <kbd>\Drupal\Core\Asset\Extension\LibraryDefinitionMissingLicenseException</kbd> will be thrown:</p>
<pre>  css: 
    base: 
      https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css: { type: external, minified: true } </pre>
<p>Finally, specific external resources are added as normal. Instead of providing a relative file path, the external URL is provided.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Manipulating libraries from hooks</h1>
                </header>
            
            <article>
                
<p>Modules have the ability to provide dynamic library definitions and alter libraries. A module can use the <kbd>hook_library_info()</kbd> hook to provide a library definition. This is not the recommended way to define a library, but it is provided for edge use cases.</p>
<p>Modules do not have the ability to use <kbd>libraries-override</kbd> or <kbd>libraries-extend</kbd>, and need to rely on the <kbd>hook_library_info_alter()</kbd> hook. You can check out this hook in <kbd>core/lib/Drupal/Core/Render/theme.api.php</kbd> or at <a href="https://api.drupal.org/api/drupal/core!lib!Drupal!Core!Render!theme.api.php/function/hook_library_info_alter/8"><span class="URLPACKT">https://api.drupal.org/api/drupal/core!lib!Drupal!Core!Render!theme.api.php/function/hook_library_info_alter/8</span></a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Placing JavaScript in the header</h1>
                </header>
            
            <article>
                
<p>By default, Drupal ensures that JavaScript is placed last on the page. This improves the page's load performance by allowing the critical portions of the page to load first. Placing JavaScript in the header is now an opt-in option.</p>
<p>In order to render a library in the header, you will need to add the <kbd>header: true</kbd> key/value pair:</p>
<pre>js-library: 
  header: true 
  js: 
    js/myscripts.js: {} </pre>
<p>This will load a custom JavaScript library and its dependencies into the header of a page.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<ul>
<li>Refer to the CSS architecture for Drupal 8: Separate concerns at <a href="https://www.drupal.org/node/1887918#separate-concerns"><span class="URLPACKT">https://www.drupal.org/node/1887918#separate-concerns</span></a></li>
<li>For more information on SMACSS, refer to <a href="http://smacss.com/book/"><span class="URLPACKT">http://smacss.com/book/</span></a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Twig templating</h1>
                </header>
            
            <article>
                
<p>Drupal 8's theming layer is complemented by Twig, a component of the Symfony framework. Twig is a template language that uses a syntax similar to Django and Jinja templates. The preceding version of Drupal used PHPTemplate, which required frontend developers to have a rudimentary understanding of PHP.</p>
<p>In this recipe, we will override the Twig template to provide customizations for the email form element. We will use the basic Twig syntax to add a new class and provide a default placeholder.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe assumes that you have already <span>created</span> a custom theme, such as the one you created in the first recipe. When you see <kbd>mythemein</kbd> in the following recipe, use the machine name of the theme you created.</p>
<div class="packt_infobox">At the time of writing this book, the Classy theme does not provide a template suggestion for the email input nor any customization for the input template that differs from Drupal core.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Create a <kbd>templates</kbd> folder in your theme's base directory to hold your Twig templates.</li>
<li>To begin, you will need to copy the <kbd>input.html.twig</kbd> file from <kbd>core/themes/classy/templates/form/input.html.twig</kbd> to your theme's <kbd>templates</kbd> folder.</li>
<li>Rename the <kbd>input.html.twig</kbd> file to <kbd>input--email.html.twig</kbd> in order to use the proper theme hook suggestion, as shown in the following screenshot:</li>
</ol>
<p>Â </p>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" src="assets/4b8aaf85-7a43-4539-ac62-7f7884ecc04b.png"/></div>
<ol start="4">
<li>We will use the <kbd>addClass</kbd> Twig function to add an <kbd>input__email</kbd> class:</li>
</ol>
<pre style="padding-left: 60px">&lt;input{{ attributes.addClass('input__email') }}/&gt;{{ children }} </pre>
<ol start="5">
<li>Before the <span>preceding</span> line, we will create a Twig variable using ternary operators to provide a customer placeholder:</li>
</ol>
<pre style="padding-left: 60px"><strong>{% set placeholder = attributes.placeholder ? attributes.placeholder : 'email@example.com' %}</strong> <br/>&lt;input{{ attributes.addClass('input__email')<strong>.setAttribute('placeholder', placeholder)</strong> }}/&gt;{{ children }} </pre>
<ol start="6">
<li class="packt_nosymbol">This creates a new variable called <kbd>placeholder</kbd> using the set operator. The question mark (<kbd>?</kbd>) operator checks whether the <kbd>placeholder</kbd> property is empty in the <kbd>attributes</kbd> object. If it is not empty, it uses the existing value. If the value is empty, it provides a default value.</li>
</ol>
<p>Â </p>
<ol start="7">
<li>Go to the <span class="packt_screen">Configuration</span> tab and then to <span class="packt_screen">Performance</span> under the <span class="packt_screen">DEVELOPMENT</span> section to rebuild Drupal's cache. We need to do this because Drupal caches the generated Twig output and template overrides.</li>
</ol>
<div class="packt_tip">New Twig template overrides provided by a theme and any changes made to a Twig template require a cache rebuild.</div>
<ol start="8">
<li>Assuming that you have used the standard Drupal install, go to the Feedback contact form installed at <kbd>/contact/feedback</kbd>, while logged out, and review the changes to the email field:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" src="assets/97730123-1102-4190-b3d4-e253f0d36829.png"/></div>
<div class="packt_infobox">This screenshot contains theme debug output. In the <em>There's more...</em> section of this chapter, we will discuss how to enable the output of theming debug comments.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>Drupal's theme system is built around hooks and hook suggestions. The element definition of the email input element defines the <kbd>input__email</kbd> theme hook. If there is no <kbd>input__email</kbd> hook implemented through a Twig template or PHP function, it will step down to just input.</p>
<div class="packt_infobox">Drupal theme hooks are defined with underscores (<kbd>_</kbd>), but use hyphens (<kbd>-</kbd>) when used in Twig template files.</div>
<p>A processor, such as Drupal's theme layer, passes variables to Twig. Variables or properties of objects can be printed by wrapping the variable name with curly brackets. All of Drupal core's default templates provide information in the file's document block that details the available Twig variables.</p>
<p>Twig has a simplistic syntax with basic logic and functions. The <kbd>addClass</kbd> method will take the <kbd>attributes</kbd> variable and add the class provided in addition to the existing contents.</p>
<p>When providing a theme hook suggestion or altering an existing template, you will need to rebuild Drupal's cache. The compiled Twig template, as PHP, is cached by Drupal so that Twig does not need to compile each time the template is invoked.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>We will discuss more on using Twig in the following sections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Security first</h1>
                </header>
            
            <article>
                
<p>Twig automatically escapes the output by default, making Drupal 8 one of the most secure versions yet. For Drupal 7, most security advisors were for <strong>cross-site scripting</strong> (<strong>XSS</strong>) vulnerabilities in contributed projects. With Drupal core, these security advisories should be severely reduced <span>using Twig</span>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Theme hook suggestions</h1>
                </header>
            
            <article>
                
<p>Drupal utilizes theme hook suggestions for ways to allow output variations based on different conditions. It allows site themes to provide a more specific template for certain instances.</p>
<p>When a theme hook has double underscores (<kbd>__</kbd>), Drupal's theme system understands this, and it can break apart the theme hook to find a more generic template. For instance, the email element definition provides <kbd>input__email</kbd> as its theme hook. Drupal understands this as follows:</p>
<ul>
<li>Look for a Twig template named <kbd>input--email.html.twig</kbd> or a theme hook that defines <kbd>input__email</kbd></li>
<li>If you are not satisfied, look for a Twig template named <kbd>input.html.twig</kbd> or a theme hook that defines the input</li>
</ul>
<p>Theme hook suggestions can be provided by the <kbd>hook_theme_suggestions()</kbd> hook in a <kbd>.module</kbd> or <kbd>.theme</kbd> file.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Debugging template file selection and hook suggestions</h1>
                </header>
            
            <article>
                
<p>Debugging can be enabled to inspect the various template files that make up a page and their theme hook suggestions, and check which are active. This can be accomplished by editing the <kbd>sites/default/services.yml</kbd> file. If a <kbd>services.yml</kbd> file does not exist, copy the <kbd>default.services.yml</kbd> to create one.</p>
<p>You need to change <kbd>debug: false</kbd> to <kbd>debug: true</kbd> under the <kbd>twig.config</kbd> section of the file. This will cause the Drupal theming layer to print out the source code comments containing the template information. When debug is on, Drupal will not cache the compiled versions of Twig templates and render them on the fly.</p>
<p>There is another setting that prevents you from having to rebuild Drupal's cache on each template file change, but do not leave debug enabled. The <kbd>twig.config.auto_reload boolean</kbd> can be set to <kbd>true</kbd>. If this is set to <kbd>true</kbd>, the Twig templates will be recompiled if the source code changes.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The Twig logic and operators</h1>
                </header>
            
            <article>
                
<p>The Twig has ternary operators for logic. Using a question mark (<kbd>?</kbd>), we can perform a basic <em>is true or not empty</em> operation, whereas a question mark and colon (<kbd>?:</kbd>) perform a basic <em>is false or is empty</em> operation.</p>
<p>You may also use the <kbd>if</kbd> and <kbd>else</kbd> logic to provide different outputs based on variables.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<ul>
<li>Refer to the Twig documentation at <a href="http://twig.sensiolabs.org/documentation"><span class="URLPACKT">http://twig.sensiolabs.org/documentation</span></a></li>
<li>Refer to the API documentation for <kbd>hook_theme_suggestions</kbd> at <a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Render%21theme.api.php/function/hook_theme_suggestions_HOOK/8"><span class="URLPACKT">https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Render%21theme.api.php/function/hook_theme_suggestions_HOOK/8</span></a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using the Breakpoint module</h1>
                </header>
            
            <article>
                
<p>The Breakpoint module provides a method to create media query breakpoint definitions within Drupal. These can be used by other components, such as the responsive image and toolbar modules, to make Drupal responsive.</p>
<p>Breakpoints are a type of plugin that can be defined in a module's or theme's <kbd>breakpoints.yml</kbd> in its directory. In this recipe, we will define three different breakpoints under a custom group.</p>
<div class="packt_infobox">Breakpoints are defined solely in <kbd>YAML</kbd> files from installed modules and themes and are not configurable through the user interface.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Ensure that the Breakpoint module is enabled--if you have used the standard Drupal installation, the module is enabled.</p>
<p>This recipe assumes that you have <span>already created</span> a custom module. When you see <kbd>mymodule</kbd>, use the machine name of the module that you created.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Create <kbd>mymodule.breakpoints.yml</kbd> in your module's base directory. This file will hold the breakpoint configurations.</li>
<li>Firstly, we will add a standard mobile breakpoint that does not have a media query, following mobile first practices:</li>
</ol>
<pre style="padding-left: 60px">mymodule.mobile: 
  label: Mobile 
  mediaQuery: '' 
  weight: 0</pre>
<ol start="3">
<li>Secondly, we will create a standard breakpoint that will run on a larger viewport:</li>
</ol>
<pre style="padding-left: 60px">mymodule.standard: 
  label: Standard 
  mediaQuery: 'only screen and (min-width: 60em)' 
  weight: 1 </pre>
<ol start="4">
<li>Thirdly, we will create a wide breakpoint for devices that have a large viewport:</li>
</ol>
<pre style="padding-left: 60px">mymodule.wide: 
  label: Wide 
  mediaQuery: 'only screen and (min-width: 70em)' 
  weight: 2 </pre>
<ol start="5">
<li>Your <kbd>mymodule.breakpoints.yml</kbd> should resemble the following:</li>
</ol>
<pre style="padding-left: 60px">mymodule.mobile:<br/>  label: Mobile<br/>  mediaQuery: ''<br/>  weight: 0 <br/>mymodule.standard:<br/>  label: Standard<br/>  mediaQuery: 'only screen and (min-width: 60em)'<br/>  weight: 1 <br/>mymodule.wide:<br/>  label: Wide<br/>  mediaQuery: 'only screen and (min-width: 70em)'<br/>  weight: 2 </pre>
<ol start="6">
<li>Go to the <span class="packt_screen">Configuration</span> tab and then to <span class="packt_screen">Performance</span> to rebuild Drupal's cache and make the system aware of the new breakpoints.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>The Breakpoint module defines the breakpoint configuration entity. Breakpoints do not have any specific form of direct functionalities, beyond providing a way to save media queries and grouping them.</p>
<p>The Breakpoint module provides a default manager service. This service is used by other modules to discover breakpoint groups and then all of the breakpoints within a group.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>Additional information on using the Breakpoint module will be covered in the upcoming sections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Caveat for providing breakpoints from themes</h1>
                </header>
            
            <article>
                
<p>Themes have the ability to provide breakpoints; however, they cannot be automatically discovered if new ones are added once they have been installed. Drupal only reads breakpoints provided by themes when a theme is either installed or uninstalled.</p>
<p>Inside <kbd>breakpoint.manager</kbd>, there are two hooks: one for the <kbd>theme install</kbd>, and one for the <kbd>theme uninstall</kbd>. Each hook retrieves the breakpoint manager service and rebuilds the breakpoint definitions. Without any extra deployment steps, new breakpoints added to a theme will not be discovered unless these hooks are fired.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Accessing breakpoints programmatically</h1>
                </header>
            
            <article>
                
<p>Breakpoints are utility configurations for other modules. Breakpoints can be loaded using the breakpoint manager service and by specifying a group. For example, the following code returns all breakpoints used by the Toolbar module:</p>
<pre>\Drupal::service('breakpoint.manager')-&gt;getBreakpointsByGroup('toolbar');</pre>
<p>This code invokes the Drupal container to return the service to manage breakpoints, which, by default, is <kbd>\Drupal\breakpoint\BreakpointManager</kbd>. The <kbd>getBreakpointsByGroup</kbd> method returns all breakpoints within a group, which are initiated as the <kbd>\Drupal\breakpoint\BreakpointInterface</kbd> objects.</p>
<p>The Toolbar element class utilizes this workflow to push the breakpoint media query values as JavaScript settings for the JavaScript model to interact with.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Multipliers</h1>
                </header>
            
            <article>
                
<p>The multipliers value is used to support pixel resolution multipliers. This multiplier is used in coordination with <em>retina</em> displays. It is a measure of the viewport's device resolution as a ratio of the device's physical size and independent pixel size. The following is an example of standard multipliers:</p>
<ul>
<li>1x is normal</li>
<li>5x supports Android</li>
<li>2x supports Mac retina devices</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<ul>
<li>To work with breakpoints in Drupal 8, refer to the community documentation at <a href="https://www.drupal.org/documentation/modules/breakpoint"><span class="URLPACKT">https://www.drupal.org/documentation/modules/breakpoint</span></a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using the Responsive Image module</h1>
                </header>
            
            <article>
                
<p>The Responsive Image module provides a field formatter for image fields that use the HTML5 picture tag and source sets. Utilizing the Breakpoint module, mappings to breakpoints are made to denote an image style to be used at each breakpoint.</p>
<p>The responsive image field formatter works with using a defined responsive image style. Responsive image styles are configurations that map image formats to specific breakpoints and modifiers. First, you will need to define a responsive image style, and then you can apply it to an image field.</p>
<p>In this recipe, we will create a responsive image style set called <kbd>Article image</kbd> and apply it to the <kbd>Article</kbd> content type's image field.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>You will need to enable the <kbd>Responsive Image</kbd> module, as it is not automatically enabled with the standard installation.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Go to <span class="packt_screen">Configuration</span> and then to <span class="packt_screen">Responsive image styles</span> under the <span class="packt_screen">MEDIA</span> section. Click on <span class="packt_screen">Add responsive image style</span> to create a new style set.</li>
<li>Provide a label that will be used to administratively identify the <span class="packt_screen">Responsive image style</span> set.</li>
<li>Select a breakpoint group that will be used as a source of breakpoints to define the image style map.</li>
<li><span>Each breakpoint will have a</span> <kbd>fieldset</kbd><span>. Expand the</span> <kbd>fieldset</kbd> <span>and choose</span> <span class="packt_screen">S</span><span class="packt_screen">elect a single image style</span><span>, and then, pick an appropriate image style:</span></li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img style="text-align: center;color: black;font-size: 1em" height="445" width="502" class=" image-border" src="assets/e6781779-d7b6-4092-b65d-ed277fa5b03c.png"/></div>
<ol start="5">
<li>Additionally, choose a fallback image style in the event of a browser that doesn't support source sets, such as Internet Explorer 8.</li>
<li>Click on <span class="packt_screen">Save</span> to save the configuration, and add the new style set:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" src="assets/34d61df5-0fcc-4173-ab4a-b486c485a786.png"/></div>
<ol start="7">
<li>Go to <span class="packt_screen">Structure</span> and <span class="packt_screen">Content types</span> and select <span class="packt_screen">Manage Display</span> from the <span class="packt_screen">Article</span> content type's drop-down menu.</li>
<li>Change the <span class="packt_screen">Image</span> field's formatter to <span class="packt_screen">Responsive image</span>.</li>
<li>Click on the <span class="packt_screen">Settings</span> tab of the field formatter to choose your new <span class="packt_screen">Responsive image style</span> set. Select <span class="packt_screen">Article image</span> from the <span class="packt_screen">Responsive image style</span> dropdown:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class=" image-border" src="assets/0da6556d-b8aa-43f3-b4fe-1970272e97fa.png"/></div>
<ol start="10">
<li>Click on <span class="packt_screen">Update</span> to save the field formatter settings, and then click on <span class="packt_screen">Save</span> to save the field display settings.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How it works...</h1>
                </header>
            
            <article>
                
<p>The <span class="packt_screen">Responsive image style</span> provides three components: a responsive image element, the responsive image style configuration entity, and the responsive image field formatter. The configuration entity is consumed by the field formatter and displayed through the responsive image element.</p>
<p>The responsive image style entity contains an array of breakpoints to image style mappings. The available breakpoints are defined by the selected breakpoint groups. Breakpoint groups can be changed anytime; however, the previous mappings will be lost.</p>
<p>The responsive image element prints a <kbd>picture</kbd> element with each breakpoint, defining a new <kbd>source</kbd> element. The breakpoint's media query value is provided as the <kbd>media</kbd> attribute for the element.</p>
<div class="packt_infobox">For Internet Explorer 9, Drupal 8 ships with the <kbd>picturefill</kbd> polyfill. Internet Explorer 9 does not recognize source elements wrapped by a <kbd>picture</kbd> element. The polyfill wraps the sources around a video element within the <kbd>picture</kbd> element.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There's more...</h1>
                </header>
            
            <article>
                
<p>In the following sections, we will discuss the responsive image field in more detail.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Performance first delivery</h1>
                </header>
            
            <article>
                
<p>A benefit of using the responsive image formatter is performance. Browsers will only download the resources defined in the <kbd>srcset</kbd> of the appropriate <kbd>source</kbd> tag. This not only allows you to deliver a more appropriate image size, but also carries a smaller payload on smaller devices.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Removing picturefill polyfill</h1>
                </header>
            
            <article>
                
<p>The Responsive Image module attaches the <kbd>picturefill</kbd> library to the responsive image element definition. The element's template also provides HTML to implement the polyfill. The polyfill can be removed by overriding the element's template and overriding the <kbd>picturefill</kbd> library to be disabled.</p>
<p>The following snippet, when added to a theme's <kbd>info.yml</kbd>, will disable the <kbd>picturefill</kbd> library:</p>
<pre>libraries-override: 
  core/picturefill: false </pre>
<p>Then, the <kbd>responsive-image.html.twig</kbd> must be overridden by the theme to remove the extra HTML generated in the template for the polyfill:</p>
<ol>
<li>Copy <kbd>responsive-image.html.twig</kbd> from <kbd>core/modules/responsive_image/templates</kbd> to the <kbd>theme</kbd> templates folder.</li>
<li>Edit <kbd>responsive-image.html.twig</kbd> and delete the Twig comment and IE conditional to output the initial video tag.</li>
<li>Remove the last conditional, that provides the closing video tag.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">See also</h1>
                </header>
            
            <article>
                
<ul>
<li>Refer to the picture element on the <strong>Mozilla Developer Network</strong> (<strong>MDN</strong>) at <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture"><span class="URLPACKT">https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture</span></a></li>
<li>Refer to <kbd>picturefill</kbd> for IE9 at <a href="http://scottjehl.github.io/picturefill/#ie9"><span class="URLPACKT">http://scottjehl.github.io/picturefill/#ie9</span></a></li>
</ul>


            </article>

            
        </section>
    </body></html>
<html><head></head><body><div class="chapter" title="Chapter&#xA0;7.&#xA0;Creating a New MOD"><div class="titlepage"><div><div><h1 class="title"><a id="ch07"/>Chapter 7. Creating a New MOD</h1></div></div></div><p>As your community grows, you may find that you need to expand the capabilities of your forum. You might need to introduce new BBCode tags, file attachments, photo galleries, or some new administration tool. Almost anything that you would need can be added by installing a modification, as you learned in <a class="link" href="ch04.html" title="Chapter 4. Customizing Your Forum">Chapter 4</a>. The key word here is<span class="emphasis"><em> almost</em></span>. Eventually you may need a feature and find yourself unable to locate an existing modification for it. When this happens, you have two options: ask someone for help in locating a modification or create a new one yourself. In this chapter, you will learn:<a id="id236" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">What modifications are</li><li class="listitem" style="list-style-type: disc">Skills and tools you need to create a modification</li><li class="listitem" style="list-style-type: disc">How to create a simple modification</li><li class="listitem" style="list-style-type: disc">Ways to make your modification available to other phpBB users</li></ul></div><div class="section" title="Introduction to MODs and Hacks"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec01"/>Introduction to MODs and Hacks</h1></div></div></div><p>As you may recall from <a class="link" href="ch04.html" title="Chapter 4. Customizing Your Forum">Chapter 4</a>, modifications are most commonly known as<span class="strong"><strong> MODs</strong></span> or<span class="strong"><strong> Hacks</strong></span>, and are downloads containing files that add, remove, or alter features on a phpBB forum. You also learned that there are thousands of modifications available for download and how to install a modification on your forum. These things were presented to you from the viewpoint of a modification<span class="emphasis"><em> user</em></span>, but now it is time to look at them from the flip side, as a MOD or Hack<span class="emphasis"><em> author</em></span>.<a id="id237" class="indexterm"/>
</p><p>The most basic form of a standard modification is a simple text file containing instructions for editing a forum’s files. These instructions are typically formatted using a modification template, consisting of a header and list of actions. Slightly more complex modifications also have commands for editing the forum database in the same file or a SQL query installer such as a<code class="literal"> db_update.php</code> file. Modifications that are even more complex include new forum files as well. All of the files are placed together in a compressed archive file (usually a ZIP file) and are made available for download on the World Wide Web.</p></div></div>
<div class="section" title="Before You Begin"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec02"/>Before You Begin</h1></div></div></div><p>To create a modification, you need to have some skills and tools to make development and testing of modifications easier. Your exact needs will depend on the scope and purpose of the modifications you develop. Smaller modifications generally require a more basic setup, but large modifications are sometimes better left to professionals.</p><div class="section" title="Building Your Skillset"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec01"/>Building Your Skillset</h2></div></div></div><p>As you already know, phpBB operates on a combination of four programming languages: PHP: Hypertext Preprocessor, Structured Query Language (SQL), Hypertext Markup Language (HTML), and JavaScript. If you have never heard of these before, don’t worry! You do not have to be a highly experienced programmer to start creating modifications. Many people have actually learned the basics of programming by working with phpBB. As you develop modifications, you will become more familiar with phpBB and these languages. Essentially, you can (and will) learn as you go.<a id="id238" class="indexterm"/>
</p><p>
<span class="strong"><strong>PHP: Hypertext Preprocessor</strong></span>, better known simply as PHP, is the main programming language used for almost every task in phpBB. As you may have noticed,<span class="emphasis"><em> phpBB</em></span> is even named after this language. Every file in your forum that has a name ending in<code class="literal"> .php</code> contains PHP code, as do a few other files. Knowledge of PHP is one of the most essential skills in creating modifications, so you may want to take the time to locate and read some tutorials on basic PHP programming. You will also want to bookmark the online PHP manual, located at<a class="ulink" href="http://www.php.net/manual/"> http://www.php.net/manual/</a>. The manual is also available for download and is useful for offline work. Take the time to read the first three to four chapters of the manual. They focus on important details like code syntax that you will see time and time again.</p><p>
<span class="strong"><strong>Structured Query Language</strong></span>, or SQL, is coding used to access an SQL database. Your forum’s PHP files use<span class="strong"><strong> SQL queries</strong></span> (or commands written in SQL coding) to store information in, and later retrieve it from, several database tables. If you want to create a modification that tracks some data, like a page hit counter, you will need to know how to write some SQL queries. You should try to locate a manual for your site’s database software to learn the correct structure of queries. Most software will support an official standard form of SQL, but may add unique extensions to the standard. The manual for MySQL, which is the most popular database choice for phpBB, is available at<a class="ulink" href="http://www.mysql.com/"> http://www.mysql.com/</a>.</p><p>
<span class="strong"><strong>Hypertext Markup Language</strong></span> is not really a programming language. As the name suggests, HTML is used for marking up the display of documents. In this case, those documents are forum pages. You learned in <a class="link" href="ch04.html" title="Chapter 4. Customizing Your Forum">Chapter 4</a> that HTML code, or that of another markup language, used to display your forum is stored in template files located within directories such as<code class="literal"> templates/subSilver</code>. The closest thing you can find to a manual for HTML is the World Wide Web Consortium’s HTML 4.01 specification at<a class="ulink" href="http://www.w3.org/TR/html401"> http://www.w3.org/TR/html401</a>. There is an abundance of easier to understand HTML tutorials that can be located through any major search engine, however.</p><p>Lastly,<span class="strong"><strong> JavaScript</strong></span> is a client-side scripting language that phpBB uses for certain types of user interaction. Client-side scripting languages are programming languages that run on the remote user’s computer, even though the code is located on your website. JavaScript code will be run within the confines of the viewer’s web browser and is therefore not something you can always rely on.</p><p>Most modern web browsers have features that allow disabling of JavaScript or certain JavaScript operations. Several older browsers do not support JavaScript at all. Most modifications do not use JavaScript code, but some are based entirely on JavaScript. As with HTML, there are many online tutorials and websites devoted entirely to teaching aspects of this language.</p><p>Beyond the programming languages, you will also need a passing familiarity with the purpose of each phpBB file. This is one skill that will definitely be formed as you work with phpBB, but there are some online resources in phpBB communities that will be helpful. In those communities, you will also find members that are experienced MOD and Hack authors. Some of them can often give useful advice on a wide range of issues related to these subjects, so do not hesitate to ask for help if you need it.</p></div><div class="section" title="The Right Tools for the Job"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec02"/>The Right Tools for the Job</h2></div></div></div><p>Anyone can create a new modification, but it will be much easier if you have the right materials and working environment. Most authors use specialized tools that provide many helpful features. There are several types of resources you should get if you plan to create many modifications.<a id="id239" class="indexterm"/>
</p><p>The first and most important resource is phpBB itself. Many authors will create a second phpBB installation, sometimes on their own computers, for testing and developing code. One benefit of this approach is that any problems arising during the development will not affect a live website that people are currently visiting. Greater control of the testing environment is usually another factor that authors favor.</p><p>The downside of creating a phpBB installation on your own computer is that you might have to install several other pieces of software first. Those include a web server program, such as Apache, the PHP language, an SQL database package, and possibly other software as well. Some authors will use a package that contains more than one of these. For example, EasyPHP from<a class="ulink" href="http://www.easyphp.org"> http://www.easyphp.org</a> installs and manages Apache, PHP, and MySQL. With all three of those installed, you should be able to install phpBB.</p><p>It is always a good idea to keep a completely unaltered copy of phpBB on hand for backups and reference. You should make certain you are working with the latest version of phpBB 2.0 to ensure that you have the most secure and up-to-date code. On the other hand, keep in mind that not all communities are based on the latest phpBB version. Over eleven updates to phpBB 2.0 have been released and some people do not have the time to upgrade with each release.</p><p>If you release the modification to the public, some of those forum administrators may try to use it and ask you for help if they encounter a problem in that phpBB version. For these reasons, you may also want to have copies of older phpBB versions around, even if you do not test your modification on those versions. Every release of phpBB can be downloaded from the following web pages:<a id="id240" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The phpBB Project Filelist on SourceForge:<a class="ulink" href="http://sourceforge.net/project/showfiles.php?group_id=7885"> http://sourceforge.net/project/showfiles.php?group_id=7885</a></li><li class="listitem" style="list-style-type: disc">phpBBHacks phpBB downloads:<a class="ulink" href="http://www.phpbbhacks.com/phpbbinfo.php"> http://www.phpbbhacks.com/phpbbinfo.php</a></li></ul></div><p>When developing your modification, ensure that you do so using an unmodified installation of phpBB. If you create the modification on a forum where other modifications have already been installed, those modifications may adversely affect the development process. They may add code that causes your modification to behave differently than if those modifications were absent. Since you cannot anticipate what modifications have already been installed on another person’s forum, distributing a modification developed on a hacked phpBB installation is an invitation to problems. You might also accidentally include code from another modification in your own modification’s installation file. That can cause any number of unexpected reactions.<a id="id241" class="indexterm"/>
</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note18"/>Note</h3><p>It is possible that you might develop a modification that<span class="emphasis"><em> does require</em></span> the presence of another, such as a portal add-on block. In such cases, only the absolutely required modifications should be installed on your testing forum.</p></div><p>Another very important tool to use is a good program for editing phpBB files. For the simple work of installing a modification like that in <a class="link" href="ch04.html" title="Chapter 4. Customizing Your Forum">Chapter 4</a>, Microsoft WordPad was all you needed. You can continue to use WordPad for this chapter, but if you intend to develop several modifications, you will probably want something with a wider range of useful features.</p><p>There are many text-editing programs that have syntax-highlighting features that make coding much easier. With syntax highlighting, different aspects of code are displayed in different colors. This feature can allow you to spot incorrect code just by looking at the colors used in a file. Other features like multiple line searching, find and replace, or code auto-completion can also save time. You can find listings and reviews for many text-editing programs with these features at the PHP-Editors site,<a class="ulink" href="http://www.php-editors.com/"> http://www.php-editors.com/</a>.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note19"/>Note</h3><p>Microsoft WordPad will be sufficient for completing the examples presented in this chapter.</p></div></div></div>
<div class="section" title="Creating a Simple MOD: A New BBCode Tag"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec03"/>Creating a Simple MOD: A New BBCode Tag</h1></div></div></div><p>One of the best ways to learn is through hands-on experience, so now it is time for you to create your very first phpBB modification. As you follow along in this section, you will progress through the entire process of creating modifications. Since this is your first modification, the focus will be on adding a simple but useful new feature: a new BBCode tag. Modifications of this type have been in development since the very early releases of phpBB. You will follow the same process that has traditionally been used to create many BBCode tags over the years. If you downloaded this modification from a website, it would be just a single file of instructions, without any extra files or database alterations.<a id="id242" class="indexterm"/>
</p><div class="section" title="Step 1—Determine Your Goal"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec03"/>Step 1—Determine Your Goal</h2></div></div></div><p>The first step of any project is to figure out exactly what it is you intend to achieve. Maybe you want to rearrange the display of topics. Or perhaps add a new entry in the registration form. Whatever you choose, you need to know what you are trying to do before you can actually do it.</p><p>As you now know, the goal of this modification will be to add a new BBCode tag to your forum. By installing BBCode modifications, you give forum members new ways of formatting their posts. phpBB includes BBCodes for bold, italic, and underlined text, text colors and sizes, images, bulleted and numbered lists, and several other formatting options when first installed. You can download modifications for dozens of different new tags. Some examples include glowing, shadowed, highlighted, moving, and blinking text. The<span class="strong"><strong> [s]</strong></span> BBCode tag that we will add to the forum creates struck-through text, which is a series of normal words with a line through the middle of each character. The effect of the Strike BBCode can be seen in the following screenshot:</p><div class="mediaobject"><img src="graphics/1132_07_01.jpg" alt="Step 1—Determine Your Goal"/></div></div><div class="section" title="Step 2—Plan Your Database Changes"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec04"/>Step 2—Plan Your Database Changes</h2></div></div></div><p>When creating a modification that tracks some new kind of information, you’ll usually have to edit or create a database table through SQL queries. The Strike BBCode does not require any database changes, but this is such an important part of modification creation that it still needs to be addressed. The types of database changes that an author decides to make often determine the remaining structure of the modification.<a id="id243" class="indexterm"/>
</p><p>There are generally three types of database changes used in most modifications: adding a new database table column, adding an entire database table, and adding new data into a table. Which of these changes you make will depend very much on what the modification does. If you are simply adding a new field to user registration and profiles, you would add a new column to the users database table, typically called<code class="literal"> phpbb_users</code>. To record information about the websites people visited before reaching your forum, you would need a new database table. When your modification has configuration features that should be changed in the<span class="strong"><strong> Administration Control Panel</strong></span>, adding new data to the<code class="literal"> phpbb_config</code> table would be expected.</p><p>All of your database changes can be made using phpMyAdmin or similar database-management software. You can either write your own SQL queries and execute them through phpMyAdmin’s SQL tab, or accomplish the same ends through a series of point and click operations that phpMyAdmin provides.</p></div><div class="section" title="Step 3—Choose Your Files"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec05"/>Step 3—Choose Your Files</h2></div></div></div><p>Your modification will need to edit phpBB files, and possibly add new ones, to accomplish your goal. At this point, you need to decide which files are the best ones to edit, and make backups of those files. If your modification needs to add new files, you need to decide what each file will be named and where it will be placed within phpBB’s directory structure. Certain types of new files will need to be located in certain places. If you need to add a new section to the<span class="strong"><strong> Administration Control Panel</strong></span>, for instance, you will have to add at least one file in phpBB’s<code class="literal"> admin</code> directory. The Appendices of this book include descriptions of the phpBB files and directories that should be helpful in this step.<a id="id244" class="indexterm"/>
</p><p>To add a BBCode tag, including our Strike BBCode, only two files need to be edited:<code class="literal"> includes/bbcode.php</code> and<code class="literal"> templates/subSilver/bbcode.tpl</code>. These files manage all BBCode operations in phpBB.<code class="literal"> bbcode.tpl</code> contains HTML code for each BBCode tag in a special format, and<code class="literal"> bbcode.php</code> replaces BBCode tags with that HTML code in posts. The latter file also does any special processing needed to format text correctly.</p><p>However, we will also edit some other files. If you have made a post on any phpBB forum, you have undoubtedly noted the posting form contained special buttons that, when clicked, inserted BBCode tags into the posting form. Forum members love these buttons, so we will add one for the Strike BBCode too. Three other files will need to be edited for this:<code class="literal"> posting.php, language/lang_english/lang_main.php</code>, and<code class="literal"> templates/subSilver/posting_body.tpl</code>. The following screenshot shows a final version of the posting form after adding a<span class="strong"><strong> Strike</strong></span> button:</p><div class="mediaobject"><img src="graphics/1132_07_02.jpg" alt="Step 3—Choose Your Files"/></div></div><div class="section" title="Step 4—File Editing and Creation"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec06"/>Step 4—File Editing and Creation</h2></div></div></div><p>At last, the good part. During this step, you should be editing the existing phpBB files chosen in the previous step and creating any new files needed. The new files would be filled with code to create whatever type of effects might be needed by the modification. Since the Strike BBCode does not need any new files, we can focus on altering those listed in Step 3. As you’ll see, this step can be quite long for even a simple modification. To create the Strike BBCode, you will need to do the following:<a id="id245" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Develop code to process the BBCode tags in posts</li><li class="listitem" style="list-style-type: disc">Modify existing HTML code that will replace the tags in the posts</li><li class="listitem" style="list-style-type: disc">Build a button for the posting form, complete with a mouse-hover tool tip</li><li class="listitem" style="list-style-type: disc">Learn how and why each step is included</li><li class="listitem" style="list-style-type: disc">Examine some alternative methods of creating the Strike BBCode<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note20"/>Note</h3><p>When creating or editing PHP files, it is a good idea to follow phpBB’s coding standards. Doing so makes your code easier for others to read and use. A copy of these guidelines is included in phpBB downloads and can also be found online at<a class="ulink" href="http://area51.phpbb.com/docs/guide-coding.html"> http://area51.phpbb.com/docs/guide-coding.html</a>.</p></div></li></ul></div><p>The first file to edit,<code class="literal"> includes/bbcode.php</code>, processes BBCode tags once before a post is inserted into the database, and then again each time the post is displayed. Several<span class="strong"><strong> PHP functions</strong></span> are used to accomplish this. Functions are snippets of code used to perform a task, usually one that needs to be repeated often or used in several different places. A basic function might look like the following example:</p><div class="informalexample"><pre class="programlisting">function do_some_thing($string)
{
// Lines of code inside the function perform some task
$string = ‘Some random text’;
return $string;
}
</pre></div><p>This is a very simple function named<code class="literal"> do_some_thing()</code>. It merely stores the words<code class="literal"> Some random text</code> in a variable called<code class="literal"> $string</code>, and then returns the value of<code class="literal"> $string</code> to the code that uses the function. You can recognize functions by their first line of code, which always starts with the word<code class="literal"> function</code>. This is followed by the name of the function, in turn followed by a set of parentheses that may contain arguments (if any). A<span class="strong"><strong> variable</strong></span> is a name for a piece of data or other value of some sort. Variables always begin with a<span class="strong"><strong> dollar sign</strong></span>,<code class="literal"> $</code>. Some functions in<code class="literal"> bbcode.php</code> include<code class="literal"> load_bbcode_template(), prepare_bbcode_template(), bbencode_second_pass(), bbencode_first_pass()</code>, and<code class="literal"> make_clickable()</code>. Many of the functions are preceded by<span class="strong"><strong> comment lines</strong></span>, which describe the purpose of the code without actually affecting anything.</p><p>The<code class="literal"> bbencode_second_pass()</code> and<code class="literal"> bbencode_first_pass()</code> functions contain code that must be expanded to add any BBCode tag.<code class="literal"> bbencode_first_pass()</code> must add a special, unique identification string to each BBCode tag in every post before that message is placed into the forum’s database for later retrieval.<code class="literal"> bbencode_second_pass()</code> will replace the altered BBCode tag with matching HTML stored in<code class="literal"> bbcode.tpl</code>. You need to add some code so that each function recognizes the Strike BBCode. Since<code class="literal"> bbencode_second_pass()</code> is actually listed before<code class="literal"> bbencode_first_pass()</code> in the file, you should edit<code class="literal"> bbencode_second_pass()</code> first. This is not really a requirement, but editing files in a "top to bottom" manner is usually a good practice.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec01"/></h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec01"/></h4></div></div></div><div class="section" title="Time For Action—The First Edit"><div class="titlepage"><div><div><h5 class="title"><a id="ch08lvl5sec01"/>Time For Action—The First Edit</h5></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Locate the following lines within the<code class="literal"> bbencode_second_pass()</code> function of<code class="literal"> includes/bbcode.php</code>. It is the only place these lines appear in the file together:<a id="id246" class="indexterm"/><div class="informalexample"><pre class="programlisting">// [u] and [/u] for underlining text.
$text = str_replace("[u:$uid]", $bbcode_tpl[‘u_open’], $text);
$text = str_replace("[/u:$uid]", $bbcode_tpl[‘u_close’], $text);
</pre></div></li><li class="listitem">Highlight (or select) these lines. Copy them and paste a duplicate set of lines into the file beneath the existing lines. The code should now look like this (after our duplication):<div class="informalexample"><pre class="programlisting">$text = str_replace("[/b:$uid]", $bbcode_tpl[‘b_close’], $text);
// [u] and [/u] for underlining text.
$text = str_replace("[u:$uid]", $bbcode_tpl[‘u_open’], $text);
$text = str_replace("[/u:$uid]", $bbcode_tpl[‘u_close’], $text);
<span class="strong"><strong>// [u] and [/u] for underlining text.
$text = str_replace("[u:$uid]", $bbcode_tpl[‘u_open’], $text);
$text = str_replace("[/u:$uid]", $bbcode_tpl[‘u_close’], $text);</strong></span>
// [i] and [/i] for italicizing text.
</pre></div></li><li class="listitem">In the first duplicated line, replace the tags<code class="literal"> [u] and [/u] for underlining</code> with the<code class="literal"> [s] and [/s] for strike out</code>.</li><li class="listitem">Within the second duplicated line, change<code class="literal"> [u:$uid]</code> to<code class="literal"> [s:$uid]</code> and<code class="literal"> u_open</code> to<code class="literal"> s_open</code>.</li><li class="listitem">Alter the third duplicate lines<code class="literal"> [/u:$uid]</code> to read<code class="literal"> [/s:$uid]</code> and<code class="literal"> u_close</code> to<code class="literal"> s_close</code>. Your duplicate lines should look like these examples when fully edited:<div class="informalexample"><pre class="programlisting">// [s] and [/s] for strike out text.
$text = str_replace("[s:$uid]", $bbcode_tpl[‘s_open’], $text);
$text = str_replace("[/s:$uid]", $bbcode_tpl[‘s_close’], $text);
</pre></div></li></ol></div><div class="section" title="What Just Happened?"><div class="titlepage"><div><div><h6 class="title"><a id="ch08lvl6sec01"/>What Just Happened?</h6></div></div></div><p>You have now finished making the alterations needed for the<code class="literal"> bbencode_second_pass()</code> function to work with your Strike BBCode tag. With this done, let us take a moment to look at the lines you have changed and some important points about them.</p><p>The lines that you duplicated are part of the Underline BBCode tag. Duplicating the lines allows you to maintain a working Underline BBCode while altering the second set of lines to create Strike. The Strike BBCode is actually very similar to Underline, so you will use lines of code related to that as a basis for many of the coming file alterations as well. Each line will become a unique part of the Strike BBCode as it is transformed by the changes you make.</p><p>The first line you made a copy of and then edited was:</p><div class="informalexample"><pre class="programlisting">// [u] and [/u] for underlining text.
</pre></div><p>A pair of forward slashes,<code class="literal"> //</code>, at the beginning of this line mark it as a comment line. This particular comment line says that the next two lines are dealing with the opening and closing underline BBCode tags, or<code class="literal"> [u]</code> and<code class="literal"> [/u]</code>. You replaced the tags<code class="literal"> [u] and [/u] for underlining</code> in the comment with the tags<code class="literal"> [s] and [/s] for strike out</code>. Now the comment line has been updated to reflect the changes that will follow for the other copied lines.</p><p>The other two lines are PHP code that is used to process posts before they are displayed on your forum, and as such can be rather delicate things. Make certain that your final lines match the examples given exactly. If you edit these in the wrong way, you may see an error message on your forum later. Be especially careful with the double and single quotation marks and the<code class="literal"> $uid</code> variables. These should not be changed at all when editing these lines.</p><p>The<code class="literal"> [s:$uid]</code> and<code class="literal"> [/s:$uid]</code> edits are related to the BBCode format that will allow users to access the Strike BBCode,<code class="literal"> [s]</code> and<code class="literal"> [/s]</code>. That may not have been clear when editing the lines, but you should see the correlation now. The<code class="literal"> s_open</code> and<code class="literal"> s_close</code> edits are also significant, but their exact purpose is best examined later when you have edited<code class="literal"> bbcode.tpl</code>.</p></div></div><div class="section" title="Time For Action—The Second Edit"><div class="titlepage"><div><div><h5 class="title"><a id="ch08lvl5sec02"/>Time For Action—The Second Edit</h5></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Locate the following lines within the<code class="literal"> bbencode_first_pass()</code> function of<code class="literal"> includes/bbcode.php</code>. Again, this is the only place the lines appear in the file in this direct order.<a id="id247" class="indexterm"/><div class="informalexample"><pre class="programlisting">// [u] and [/u] for underlining text.
$text = preg_replace("#\[u\](.*?)\[/u\]#si", "[u:$uid]\\1[/u:$uid]",
$text);
</pre></div></li><li class="listitem">Duplicate the lines in the same manner as the previous<span class="emphasis"><em> Time For Action</em></span>.</li><li class="listitem">Locate the comment line identical to that of the earlier code. Edit it in the same way as described in the previous<span class="emphasis"><em> Time For Action</em></span> example. After doing this, your file should resemble the following.<div class="informalexample"><pre class="programlisting">$text = preg_replace("#\[b\](.*?)\[/b\]#si", "[b:$uid]\\1[/b:$uid]",
$text);
// [u] and [/u] for underlining text.
$text = preg_replace("#\[u\](.*?)\[/u\]#si", "[u:$uid]\\1[/u:$uid]",
$text);
// [s] and [/s] for strike out text.
$text = preg_replace("#\[u\](.*?)\[/u\]#si", "[u:$uid]\\1[/u:$uid]", $text);
// [i] and [/i] for italicizing text.
</pre></div></li><li class="listitem">On the second line duplicated here, change<code class="literal"> [u\]</code> to<code class="literal"> [s\], [/u\]</code> to<code class="literal"> [/s\]</code>, and<code class="literal"> [u:$uid]\\1[/u:$uid]</code> to<code class="literal"> [s:$uid]\\1[/s:$uid]</code>. Now fully altered, these lines will be:<div class="informalexample"><pre class="programlisting">// [s] and [/s] for strike out text.
$text = preg_replace("#\[s\](.*?)\[/s\]#si", "[s:$uid]\\1[/s:$uid]", $text);
</pre></div></li></ol></div><div class="section" title="What Just Happened?"><div class="titlepage"><div><div><h6 class="title"><a id="ch08lvl6sec02"/>What Just Happened?</h6></div></div></div><p>After completing the changes to<code class="literal"> bbencode_second_pass()</code>, you have now moved on to the<code class="literal"> bbencode_first_pass()</code> function. Here we again used existing code of the Underline BBCode as the basis of your Strike BBCode. You saw another comment line identical to that in the first set of changes in this file and also altered it in the same manner as the other.</p><p>Only one other line was edited here, and this important line will process posts containing the Strike BBCode tags before the posts are stored in the forum’s SQL database. The main purpose of the line is to add the<code class="literal"> $uid</code> variables to the tags for later reference. You need not worry about this too much, but be aware that it is one of phpBB’s many built-in security measures. When displaying posts, phpBB will treat those without a<code class="literal"> $uid</code> added here as plain text.</p><p>That was the last change required in<code class="literal"> includes/bbcode.php</code>. Now you are ready to move on to the second file to be edited,<code class="literal"> templates/subSilver/bbcode.tpl</code>. This file contains several snippets of HTML code that create the visual effects of each BBCode. The functions stored in<code class="literal"> includes/bbcode.php</code> read this file and replace the BBCode tags like<code class="literal"> [s]</code> and<code class="literal"> [/s]</code> with snippets.</p></div></div><div class="section" title="Time For Action—Editing BBCode HTML"><div class="titlepage"><div><div><h5 class="title"><a id="ch08lvl5sec03"/>Time For Action—Editing BBCode HTML</h5></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Locate the following lines in<code class="literal"> templates/subSilver/bbcode.tpl</code>:<a id="id248" class="indexterm"/><div class="informalexample"><pre class="programlisting">&lt;!-- BEGIN u_open --&gt;&lt;span style="text-decoration: underline"&gt;&lt;!-- END u_open --&gt;
&lt;!-- BEGIN u_close --&gt;&lt;/span&gt;&lt;!-- END u_close --&gt;
</pre></div></li><li class="listitem">Copy these lines and paste a duplicate set into the file, just as you did with the<code class="literal"> includes/bbcode.php</code>.</li><li class="listitem">Replace both instances of<code class="literal"> u_open</code> in the first duplicate line with<code class="literal"> s_open</code>.</li><li class="listitem">On the same line, replace<code class="literal"> underline</code> with<code class="literal"> line-through</code>.</li><li class="listitem">On the second line, change both occurrences of<code class="literal"> u_close</code> to<code class="literal"> s_close</code>.</li><li class="listitem">The final, complete code should be:<div class="informalexample"><pre class="programlisting">&lt;!-- BEGIN s_open --&gt;&lt;span style="text-decoration: line-through"&gt;&lt;!-- END s_open --&gt;
&lt;!-- BEGIN s_close --&gt;&lt;/span&gt;&lt;!-- END s_close --&gt;
</pre></div></li></ol></div><div class="section" title="What Just Happened?"><div class="titlepage"><div><div><h6 class="title"><a id="ch08lvl6sec03"/>What Just Happened?</h6></div></div></div><p>To create the HTML that will be displayed in place of the Strike BBCode’s<code class="literal"> [s]</code> and<code class="literal"> [/s]</code> tags, we once again used the existing code for the Underline BBCode. If you take a moment to look at the other code snippets in this file, you may notice that most of them begin with some text like <code class="literal">&lt;!-- BEGIN u_open --&gt;</code> and end with text similar to <code class="literal">&lt;!-- END u_close --&gt;</code>. These are HTML comments, as marked by the <code class="literal">&lt;!--</code> and<code class="literal"> --&gt;</code> character sequences. phpBB uses these comments to mark the beginning and ending of each snippet of code for a single BBCode tag. For the Underline BBCode,<code class="literal"> [u]</code> is replaced with the<code class="literal"> u_open</code> code and<code class="literal"> [/u]</code> is replaced with the<code class="literal"> u_close</code> code. You may also remember editing<code class="literal"> u_open</code> and<code class="literal"> u_close</code> in the<code class="literal"> includes/bbcode.php</code> file, where you changed them to<code class="literal"> s_open</code> and<code class="literal"> s_close</code> respectively. As a result,<code class="literal"> s_open</code> and<code class="literal"> s_close</code> must also be used in the HTML comments here.</p><p>One more change was needed here, and it creates the actual striking effect. The Underline BBCode uses a Cascading Style Sheet property called<code class="literal"> text-decoration</code> to draw a line below text. The code for this is<code class="literal"> text-decoration: underline</code>. The text-decoration property also supports a value of<span class="emphasis"><em> line-through</em></span>, which renders text with a line marked horizontally through the middle. So, by changing<code class="literal"> underline</code> in your<code class="literal"> s_open</code> line to<span class="strong"><strong> line-through</strong></span>, you created the Strike BBCode.</p><p>This completes the changes required to use the Strike BBCode; you can now make posts on your forum using the<code class="literal"> [s]</code> and<code class="literal"> [/s]</code> tags. However, you would have to type the tags in manually. Many, if not most, forum users prefer the point-and-click convenience of buttons in the posting form over manual entry of BBCode tags, so now you should create a new button for the Strike BBCode.</p><p>To start, we can look at the components of a BBCode button. Each button does two things: insert the BBCode tags into the message body when clicked, and display a line of help text, between the BBCode controls and the message area, when hovered over with the mouse pointer. The majority of the code for these tasks is in<code class="literal"> templates/subSilver/posting_body.tpl</code>, but the help text is partially set up in<code class="literal"> language/lang_english/lang_main.php</code> and<code class="literal"> posting.php</code>. The latter two files have very small changes, so it is easiest to edit them first.</p></div></div><div class="section" title="Time For Action—Adding a Language String"><div class="titlepage"><div><div><h5 class="title"><a id="ch08lvl5sec04"/>Time For Action—Adding a Language String</h5></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Find the following line in your forums<code class="literal"> language/lang_english/lang_main.php</code> file. Duplicate it as you have with other lines in previous examples:<a id="id249" class="indexterm"/><div class="informalexample"><pre class="programlisting">$lang[‘bbcode_f_help’] = ‘Font size: [size=x-small]small text[/size]’;
</pre></div></li><li class="listitem">Change the<code class="literal"> bbcode_f_help</code> portion of the line to<code class="literal"> bbcode_st_help</code>.</li><li class="listitem">Replace the text between the last two single quotes with:<code class="literal"> Strike out: [s]Line through text[/s] (alt+t)</code>.</li><li class="listitem">The altered line now appears as:<div class="informalexample"><pre class="programlisting">$lang[‘bbcode_st_help’] = ‘Strike out: [s]Line through text[/s] (alt+t)’;
</pre></div></li></ol></div><div class="section" title="What Just Happened?"><div class="titlepage"><div><div><h6 class="title"><a id="ch08lvl6sec04"/>What Just Happened?</h6></div></div></div><p>Most of the built-in text that’s displayed on the public portions of a phpBB forum is stored in<code class="literal"> language/lang_english/lang_main.php</code>. This file is part of phpBB’s multi-lingual support, one of the factors that has made phpBB very popular worldwide. Help text for all of the BBCode buttons is one of the many things you can find in the<code class="literal"> lang_main.php</code>. The line you just located and copied contains the help text for the Font Size BBCode. The other lines of help text are above this one, and you have placed the new help text of the Strike BBCode below this line.<a id="id250" class="indexterm"/>
</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note21"/>Note</h3><p>There is a<code class="literal"> lang_main.php</code> file for each language installed on a forum. If you want to locate this line in a file for a language other than English, search for the<code class="literal"> $lang[‘bbcode_f_help’]</code> portion of the line.</p></div><p>If you compare this line to the other help text lines, you will notice some clear differences. The<code class="literal"> f</code> in<code class="literal"> bbcode_f_help</code> is replaced with a different letter on the other lines. This part of the line is a name that is used to reference the help text later, so it needs to be unique from all other names here. A line with the name<code class="literal"> bbcode_s_help</code> already exists, so you cannot use that letter here. Instead, we can use the letters<code class="literal"> st</code>. There is no need to limit ourselves to only one letter. The text between the second pair of single quotes on each line is the actual text that will be displayed on the posting form. None of the present lines are really fitting for the Strike BBCode, so you can rewrite this text in the new line. The only restrictions on the content of the help text are that they cannot contain single or double quotation marks.</p><p>The next file we will look at,<code class="literal"> posting.php</code>, handles many aspects of making posts on a forum. For the moment, we only care about one of these: the creation of the posting form. The form is created using a combination of phpBB’s language and template systems. We have already added the help text to the language system, so now we need to incorporate it into the template system.</p></div></div><div class="section" title="Time For Action—Adding a Template Variable"><div class="titlepage"><div><div><h5 class="title"><a id="ch08lvl5sec05"/>Time For Action—Adding a Template Variable</h5></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Find the following line in<code class="literal"> posting.php</code> and duplicate it for editing:<a id="id251" class="indexterm"/><div class="informalexample"><pre class="programlisting">‘L_BBCODE_F_HELP’ =&gt; $lang[‘bbcode_f_help’],
</pre></div></li><li class="listitem">Replace<code class="literal"> bbcode_f_help</code> with<code class="literal"> bbcode_st_help</code> to match the changes you made in the language file.</li><li class="listitem">Alter the<code class="literal"> F</code> in<code class="literal"> L_BBCODE_F_HELP</code> to a matching<code class="literal"> ST</code>.</li><li class="listitem">The final line incorporating these alterations is:<div class="informalexample"><pre class="programlisting">‘L_BBCODE_ST_HELP’ =&gt; $lang[‘bbcode_st_help’],
</pre></div></li></ol></div><div class="section" title="What Just Happened?"><div class="titlepage"><div><div><h6 class="title"><a id="ch08lvl6sec05"/>What Just Happened?</h6></div></div></div><p>In this last example, you added a new template variable. It will represent the help text for the Strike BBCode and make that text available to the template system. phpBB sends information to the template system using lines like the following:<a id="id252" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">$template-&gt;assign_vars(array(
‘L_INFO’ =&gt; $l_info,
‘MESSAGE’ =&gt; $message,
‘MORE’ =&gt; $more)
);
</pre></div><p>The first and last line of this code, along with the closing parenthesis on the<code class="literal"> ‘MORE’</code> line, are required for the file to function, so you should leave them alone. If you needed to add a section of code to send data to the template system in a file that did not already do so, you would need to include these lines when editing the file. Fortunately,<code class="literal"> posting.php</code> already has them, so we move on to the other lines, which specify the actual information to be sent. The<code class="literal"> ‘L_INFO’</code> line, is a good example. It sends the value of a variable,<code class="literal"> $l_info</code> in this case, to the template system with the name<code class="literal"> L_INFO</code>. This tells the template system that all instances of<code class="literal"> {L_INFO}</code> in a template file should be replaced with the value of the variable.<code class="literal"> {L_INFO}</code> is called a<span class="strong"><strong> template variable</strong></span> because it is replaced with some value by the template system.<code class="literal"> L_INFO</code> is the<span class="strong"><strong> name</strong></span> of the template variable.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note22"/>Note</h3><p>It is an accepted convention that most template variables and their names are written in all uppercase letters, numbers, or underscores, and do not contain other characters. This is mostly not required, but you should not use a period in the name of a template variable. The period is considered a special, reserved character in template variable names.</p></div><p>The third file we need to alter to add a BBCode button,<code class="literal"> templates/subSilver/ posting_body.tpl</code>, is also the most complicated. Only one line needs to be added in the files you edited previously, but this time there are several changes (some of them rather awkward). This is one of several sections of phpBB that was not designed with ease of expansion in mind. Many schools of thought on the proper way to add a new BBCode button in this file exist, but most require replacing large parts of this file or installing another modification first.</p></div></div><div class="section" title="Time For Action—Adding a Posting Form Button"><div class="titlepage"><div><div><h5 class="title"><a id="ch08lvl5sec06"/>Time For Action—Adding a Posting Form Button</h5></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the<code class="literal"> templates/subSilver/posting_body.tpl</code> file and locate the following line. Duplicate it as usual. This time, however, place the duplicated line<span class="emphasis"><em> before</em></span> the existing code. The order of the lines does not really matter, but it will create a useful example later on in the chapter.<a id="id253" class="indexterm"/><div class="informalexample"><pre class="programlisting">f_help = "{L_BBCODE_F_HELP}";
</pre></div></li><li class="listitem">In the copy of the line, you should replace the template variable with that for the Strike help line. Also remove the lowercase<code class="literal"> f</code> at the beginning of the line and add<code class="literal"> st</code> in its place. This is the easiest change in this file. The resulting lines would be:<div class="informalexample"><pre class="programlisting">st_help = "{L_BBCODE_ST_HELP}";
f_help = "{L_BBCODE_F_HELP}";
</pre></div></li><li class="listitem">Now find the following (rather long) line of code. Depending on the settings of your text editor, it may be wrapped onto two or more lines when displayed on your screen. Do your best to find the entire line.<div class="informalexample"><pre class="programlisting">bbtags = new Array(‘[b]’,’[/b]’,’[i]’,’[/i]’,’[u]’,’[/u]’,’[quote]’,’[/quote]’, ‘[code]’,’[/code]’,’[list]’,’[/list]’,’[list=]’,’[/list]’,’[img]’, ‘[/img]’,’[url]’,’[/url]’);
</pre></div></li><li class="listitem">Add the following lines after the<code class="literal"> bbtags</code> line that you just found.<div class="informalexample"><pre class="programlisting">// Begin further bbtags indexing at 22 to avoid font size/color conflicts.
bbtags[22] = ‘[s]’;
bbtags[23] = ‘[/s]’;
</pre></div></li><li class="listitem">The altered code now looks like:<div class="informalexample"><pre class="programlisting">bbcode = new Array();
bbtags = new Array(‘[b]’,’[/b]’,’[i]’,’[/i]’,’[u]’,’[/u]’,’[quote]’,’[/quote]’,’[code]’,’[/code]’,’[list]’,’[/list]’,’[list=]’,’[/list]’,’[img]’,’[/img]’,’[url]’,’[/url]’);
// Begin further bbtags indexing at 22 to avoid font size/color conflicts.
bbtags[22] = ‘[s]’;
bbtags[23] = ‘[/s]’;
imageTag = false;
</pre></div></li><li class="listitem">Locate and duplicate the following HTML code in the file:<div class="informalexample"><pre class="programlisting">&lt;td&gt;&lt;span class="genmed"&gt;
&lt;input type="button" class="button" accesskey="w" name="addbbcode16" value="URL" style="text-decoration: underline; width: 40px" onClick="bbstyle(16)" onMouseOver="helpline(‘w’)" /&gt;
&lt;/span&gt;&lt;/td&gt;
</pre></div></li><li class="listitem">Alter the duplicated line to look like the following.<div class="informalexample"><pre class="programlisting">&lt;td&gt;&lt;span class="genmed"&gt;
&lt;input type="button" class="button" accesskey="t" name="addbbcode22" value="Strike" style="text-decoration: line-through; width: 44px" onClick="bbstyle(22)" onMouseOver="helpline(‘st’)" /&gt;
&lt;/span&gt;&lt;/td&gt;
</pre></div></li></ol></div><div class="section" title="What Just Happened?"><div class="titlepage"><div><div><h6 class="title"><a id="ch08lvl6sec06"/>What Just Happened?</h6></div></div></div><p>Now you have added the actual button in the posting form and completed the file changes for the Strike BBCode modification. Since this last<span class="emphasis"><em> Time For Action</em></span> example was much longer, a detailed look at the changes is in order now, beginning with the additions after the long<code class="literal"> bbtags</code> line.<a id="id254" class="indexterm"/>
</p><p>That particular line is where several authors would begin to alter the file in different manners. Some of these alternatives will be examined later, but for now a simple addition after this line keeps the Strike BBCode as simple as possible. Using this method has a few benefits and disadvantages that will also be addressed later in the chapter.</p><p>With that code added, you moved on to the final alteration of this file: adding the actual button! Every change related to the button that you have made up to this point was geared toward making the button work, but not making the button itself. You duplicated and edited the code for the URL button, which is the last in the row of buttons on the posting form. These lines are HTML code, with the middle line being HTML for a clickable form button.</p><p>There was no need to alter the first or last line here. However, the middle line needed several changes to make it unique from the other buttons. The HTML for the button contains several attributes, in the form of<span class="emphasis"><em> name="value"</em></span> pairs. All of these attributes except the first two,<code class="literal"> button</code> and<code class="literal"> class</code>, were changed when you finished. Let’s go through a complete break down of these changes now.</p><p>The first attribute you may have noticed is<code class="literal"> accesskey</code>. Access keys are a method of allowing a user to "click" a button without actually touching it. By pressing a special key (<span class="emphasis"><em>Alt</em></span> on Windows or the Apple key on Macintosh systems) in combination with the key for the letter defined as an access key, the user triggers the effect of the button. When a user on your forum presses<span class="emphasis"><em> Alt+B</em></span> at the posting form, the Bold BBCode tag is inserted into the post as if they had clicked the form button for that BBCode. During the process of adding new buttons, you should change the value of this attribute to a letter or digit that is not already used on your posting form. The letter "t" is a good not-in-use choice on unmodified forums, so<code class="literal"> accesskey="w"</code> was changed to<code class="literal"> accesskey="t"</code>.</p><p>Next up is the<code class="literal"> name</code> attribute. It provides a unique name for the button that can be referenced inside JavaScript code. There is a large amount of JavaScript at the top of this file, and it works with the buttons and message body to add BBCodes, keep track of open BBCode tags in the message, and change the text displayed on the buttons. The value of<code class="literal"> name</code> is used to access the buttons, especially for changing the text. When a user clicks on a BBCode button to insert an opening tag, like<span class="strong"><strong> [b]</strong></span>, an asterisk is added to the button to remind you that the tag is open. The value of this attribute will be similar for all your BBCode buttons—addbbcodeXX, where<code class="literal"> XX</code> is some even number. If you recall, we used "22" when adding code related to the<code class="literal"> bbtags</code> line earlier. This is the first place it comes into play (the number is important for reasons we’ll discuss later). The name of this button must be<code class="literal"> addbbcode22</code>, so<code class="literal"> name="addbbcode16"</code> was altered to<code class="literal"> name="addbbcode22"</code>. Skipping ahead slightly to the<code class="literal"> onClick</code> attribute,<code class="literal"> 16</code> was again replaced with<code class="literal"> 22</code>.</p><p>The third attribute,<code class="literal"> value</code>, is simply the text displayed on the BBCode button. Since you are creating a Strike BBCode,<code class="literal">"Strike"</code> seems like a logical choice to display.<code class="literal"> value="URL"</code> is thus replaced with<code class="literal"> value="Strike"</code>.</p><p>The<code class="literal"> style</code> attribute allows you to apply specific Cascading Style Sheet properties to HTML elements having that attribute. With BBCode buttons,<code class="literal"> style</code> is usually used to demonstrate the effect of the BBCode and control the width of the button. You altered the<code class="literal"> text-decoration</code> property from<code class="literal"> underline</code> to<code class="literal"> line-through</code>, as you did in<code class="literal"> bbcode.tpl</code>. Increasing the<code class="literal"> width</code> property from<code class="literal"> 40px</code> (forty pixels) to<code class="literal"> 44px</code> is also recommended to ensure that the asterisk of the Strike button can be seen when added.</p><p>The final attribute,<code class="literal"> onMouseOver</code>, triggers the display of the help line text. The complete attribute is<code class="literal"> onMouseOver="helpline(‘w’)"</code>, but you need to be careful when editing this one. Only the<code class="literal"> w</code>
<span class="emphasis"><em> inside</em></span> the single quotes should be changed. If you think back to the other help-line related changes, you may recall that you were often replacing the letter<code class="literal"> f</code> with<code class="literal"> st</code>. This is the same situation, but you are replacing a<code class="literal"> w</code> now.</p><p>At last, you have finished all the file editing needed to use your new Strike BBCode! Congratulations on making it this far.</p></div></div></div></div><div class="section" title="Pros and Cons of the Strike BBCode Methods"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec02"/>Pros and Cons of the Strike BBCode Methods</h3></div></div></div><p>As mentioned earlier, there are a few advantages and disadvantages to some of the methods we just used when editing<code class="literal"> posting_body.tpl</code>. Some of the changes could have been made in several different ways. To better understand how the BBCode buttons work and why there are different methods of creating BBCodes, let’s look at some alternatives.<a id="id255" class="indexterm"/>
</p><p>When creating a BBCode modification such as Strike, many authors would require that another modification, the Multi BBCode MOD, be installed on the forum first. This modification replaces and extends much of the BBCode system in<code class="literal"> posting_body.tpl</code> and other files with the goal of making additional BBCodes easier to install. In fact, if an author wishes to distribute a BBCode modification at phpBB’s official website, that modification is<span class="emphasis"><em> required</em></span> to rely on the Multi BBCode MOD. One disadvantage of the process you just completed is that it was designed independently of Multi BBCode. The resulting modification is thus likely to be incompatible with the other modification.</p><p>Another possible alternative to the method you have learned centers on the<code class="literal"> bbtags</code> code near the top of the file. You added two new lines after this code, but for a long time there has been a very different method considered as a standard way of editing this area. This method called for the<code class="literal"> bbtags</code> code to be edited within that line. With that type of alteration, the<code class="literal"> bbtags</code> line would be changed to the following by the Strike BBCode:</p><div class="informalexample"><pre class="programlisting">bbtags = new Array(‘[b]’,’[/b]’,’[i]’,’[/i]’,’[u]’,’[/u]’,’[quote]’,’[/quote]’,’[code]’,’[/code]’,’[list]’,’[/list]’,’[list=]’,’[/list]’,’[img]’,’[/img]’,’[url]’,’[/url]’,’[s]’,’[/s]’);
</pre></div><p>The<code class="literal"> bbtags</code> line of code creates an<span class="strong"><strong> array</strong></span>, or a stack of data, containing all the possible BBCode tags—except the size and color tags—and their closing tag counterparts, numbered in the order listed on the line. The numbering starts at 0;<code class="literal"> [b]</code> would be number 0,<code class="literal"> [/b]</code> would be number 1, and so on. The Strike BBCode’s<code class="literal"> [s]</code> becomes number 18 in this scheme.</p><p>However, this creates a problem. Remember that you used<code class="literal"> addbbcode22</code> as the value of the<code class="literal"> name</code> attribute in the HTML for the Strike button? Using the method just described, you would need to use<code class="literal"> addbbcode18</code>. If you search through<code class="literal"> posting_body.tpl</code>, you will find that<code class="literal"> addbbcode18</code> is already used for the name of the Font Color drop-down list and<code class="literal"> addbbcode20</code> is likewise used for Font Size. Since the value of<code class="literal"> name</code> must be unique, editing the<code class="literal"> bbtags</code> line directly forces you to also change the<code class="literal"> name</code> attributes of the Font Color and Size lists. You would have to do that for every BBCode installed, which is quite a lot of repetitive work if you add several BBCodes.</p><p>When you added new lines for<code class="literal"> [s]</code> and<code class="literal"> [/s]</code> after the<code class="literal"> bbtags</code> line, the new lines assigned the Strike tags to numbers 22 and 23 respectively. Essentially, you skipped the numbers 18 through 21, which were used by the Size and Color BBCodes.</p><p>This removed the need to edit the HTML for Size and Color. If you wanted to add new BBCodes using the method presented in this chapter, your code might look like this example. Notice how the number is incremented once on each line.</p><div class="informalexample"><pre class="programlisting">bbtags[22] = ‘[s]’;
bbtags[23] = ‘[/s]’;
bbtags[24] = ‘[flash]’;
bbtags[25] = ‘[/flash]’;
bbtags[26] = ‘[hide]’;
bbtags[27] = ‘[/hide]’;
</pre></div></div></div><div class="section" title="Step 5—Break It and Fix It"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec07"/>Step 5—Break It and Fix It</h2></div></div></div><p>With the changes for your first modification completed, the next step is to test your changes. While testing, do everything you can think of that might cause a problem in the modification. Any problems that do appear need to be fixed before someone else can find them. Lack of proper testing can be very dangerous, and in some cases might create new security holes in your forum.<a id="id256" class="indexterm"/>
</p><p>Try to test out every aspect of the Strike BBCode. Try making a new topic, previewing a post, and even replying to and editing posts containing the BBCode. Check out every aspect of the posting form, from the buttons to the help line. If you have multiple styles installed on your forum, make sure you have edited the template files for every style, and test the BBCode and button on all of them. When there are multiple languages, test those as well!</p><p>You should not find any problems with the Strike BBCode, since it is a very simple modification. However, even simple modifications need thorough testing. There are many places where the lack of a single comma can make parts of a forum inaccessible.</p></div></div>
<div class="section" title="Make Your MOD Accessible to the World"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec04"/>Make Your MOD Accessible to the World</h1></div></div></div><p>Once you have created a modification, you may wish to distribute it to other phpBB forum operators. Many modifications are made freely available by their authors as a way of giving something back to the global phpBB community. Not all modifications are free, of course, but those that are can often be found on several websites and may eventually even be translated to other languages.<a id="id257" class="indexterm"/>
</p><p>There are several ways you can distribute a modification. You might write an essay or tutorial describing the changes made to install it, which could be similar to the previous pages of this chapter. The most widely used method is to create an installation file that uses simple instructions, like those explained in the section discussing modification installation in <a class="link" href="ch04.html" title="Chapter 4. Customizing Your Forum">Chapter 4</a>, to guide users through the changes.</p><p>You can also choose to make the modification available at one or more websites. Authors of multiple modifications usually have their own website dedicated to their works, often with phpBB-powered forums providing support and demonstrations. Several more general websites covering phpBB also carry modifications. The sites with the largest modification communities are<a class="ulink" href="http://www.phpbb.com/"> http://www.phpbb.com/</a>, the official phpBB website, and<a class="ulink" href="http://www.phpbbhacks.com/"> http://www.phpbbhacks.com/</a>, the largest modification website. There are other websites offering modifications that you can use to distribute your work, including many based primarily on non-English languages.</p><p>Each of these large websites has its own rules regarding how modifications can be distributed on that site. phpBB.com has very strict rules, while phpBBHacks.com is much more relaxed. Both sites have forums with development areas that are available for help in creating and testing modifications, but are not used specifically for distributing any works. The two sites have a database of modifications for that purpose.</p><p>The modification database of phpBB.com can be found in its<span class="strong"><strong> Mods</strong></span> section. To be included in this database, a modification must be submitted through a special form and has to pass a series of special validation procedures. The validation process tests several aspects of the download. If the modification fails in any those tests, which are conducted by the phpBB.com "MOD Team", it is rejected from inclusion on the website. Authors are typically informed of reason(s) for this rejection and are allowed to resubmit the work after making any required changes. In contrast, phpBBHacks.com allows authors to have more freedom in these areas with rules that are much less strict. Authors are expected to extensively test modifications before submitting them through a simple form.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note23"/>Note</h3><p>You can find links to all of phpBB.com’s modification-submission requirements through the post at<a class="ulink" href="http://www.phpbb.com/phpBB/viewtopic.php?t=160827"> http://www.phpbb.com/phpBB/viewtopic.php?t=160827</a>. The validation procedures are also described in posts at this forum.</p></div><p>Once you have decided where you wish to distribute your modification, look around that website for its specific rules and submission procedure. The process of distributing a modification at any given site generally encompasses the following steps:<a id="id258" class="indexterm"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create the code, including any PHP, HTML, and so forth.</li><li class="listitem">Assemble that code into a packaged collection (detailed in the next section).</li><li class="listitem">If the site has a modification development forum, create a topic about the modification there. Other users may try it out and give you feedback, bug reports, or other advice.</li><li class="listitem">Make any revisions to the code you desire based on the feedback, bug reports, etc., and then repeat steps 1-4 until you are satisfied that the modification is completely finished.</li><li class="listitem">Submit the modification through the procedures available at the site.</li></ol></div><div class="section" title="Packaging Your MOD"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec08"/>Packaging Your MOD</h2></div></div></div><p>Before making your modification available anywhere, it must first be collected into a set of files. This process of preparing your modification for distribution is called<span class="strong"><strong> packaging</strong></span>. This typically involves creating the instruction file and placing it, along with any new forum files created for the modification, into a single ZIP file. Extremely large modifications often include other files, such as upgrading instructions, lists of tips or hints, and modified copies of original phpBB files that are also placed into this ZIP file.<a id="id259" class="indexterm"/>
</p><p>In order to distribute a modification at phpBB.com, the instruction file must be created using a special "MOD Template" provided at that site. This template consists of three sections: a header, a list of several blank commands, and a footer containing an ending command. Each section is required; leaving out even one of them will cause the modification submission to be rejected. phpBBHacks.com accepts modifications created using this template or any other, including no template at all, as long as the instructions are understandable. Specific sections are also not required if a template is used. There is an official phpBBHacks.com template, but its use is optional. phpBB.com, however, only accepts modifications created with its own template.</p><p>The Strike BBCode modification you made earlier in this chapter could not be submitted at phpBB.com because it does not rely on the Multi BBCode modification, as required for all BBCode modifications listed there. Likewise, phpBBHacks.com would not accept it because Strike is not your original creation. However, creating an instruction file for this modification is still a good method of learning how to use the MOD Template in order to make installation files that can be submitted to phpBB.com and other sites.</p><div class="section" title="Using the MOD Template Header"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec03"/>Using the MOD Template Header</h3></div></div></div><p>To begin, create a new text file. In most text editors for Windows, this involves opening the<span class="strong"><strong> File</strong></span> menu and selecting<span class="strong"><strong> New | New Text File</strong></span> or something similar. Save your new file with the name<code class="literal"> strike.mod</code>. Most text files that you may be familiar with use a file extension of<code class="literal"> txt</code>, resulting in a file name like<code class="literal"> strike.txt</code>. phpBB.com requires modification instruction files to use the<code class="literal"> .mod</code> file extension, also widely known as an extension for music files, instead.<a id="id260" class="indexterm"/>
</p><p>Next, type the following lines in your file, or copy and paste them from the phpBB.com MOD Template. These lines compose the entire MOD Template header. If you type them in, be sure to match the exact grammar, spelling, and spacing of the MOD Template (in the printed book, the text appears wrapped). Changing any one of those aspects, even if you think them to be incorrect, will cause the modification to be rejected.<a id="id261" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">##############################################################
## MOD Title: mod_title_goes_here
## MOD Author: your_phpBB_username &lt; your_email &gt; (your_real_name) your_url
## MOD Description: some_description_goes_here
## MOD Version: x.x.x
##
## Installation Level: (Easy/Intermediate/Advanced)
## Installation Time: x Minutes
## Files To Edit: file_1, file_2, file_3, etc
## Included Files: (n/a, or list of included/required files)
##############################################################
## For Security Purposes, Please Check: http://www.phpbb.com/mods/ for the
## latest version of this MOD. Downloading this MOD from other sites could cause malicious code
## to enter into your phpBB Forum. As such, phpBB will not offer support for MOD’s not offered
## in our MOD-Database, located at: http://www.phpbb.com/mods/
##############################################################
## Author Notes:
##
##############################################################
## MOD History:
##
## YYYY-MM-DD - Version x.x.x
## - version notes go here
##
##############################################################
## Before Adding This MOD To Your Forum, You Should Back Up All Files Related To This MOD
##############################################################
</pre></div><p>Several of these lines need to be edited for each modification. Let’s take them one at a time, beginning at the top and working our way down. The header itself is organized into smaller sections by a few lines made completely of<span class="strong"><strong> #</strong></span> characters. These separators should be left as presented.</p><div class="section" title="MOD Title"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec02"/>MOD Title</h4></div></div></div><p>The first line to change is the<code class="literal"> MOD Title</code> line. As you have probably guessed, this is where you will place the name of the modification for all to see.</p><div class="informalexample"><pre class="programlisting">## MOD Title: mod_title_goes_here
</pre></div><p>The text<code class="literal"> mod_title_goes_here</code> should be replaced with the correct name. In this case, you would type<code class="literal"> Strike BBCode</code>.</p></div><div class="section" title="MOD Author"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec03"/>MOD Author</h4></div></div></div><p>Next is the<code class="literal"> MOD Author</code> line, which lists the creators of the modification. Contact information can also be included here.</p><div class="informalexample"><pre class="programlisting">## MOD Author: your_phpBB_username &lt; your_email &gt; (your_real_name) your_url
</pre></div><p>The line itself has four subparts that need to be altered. The first of these,<code class="literal"> your_phpBB_username</code>, is to be replaced with the username of an account registered on the phpBB.com community forums. That same account would later be used to submit the modification. Second is the <code class="literal">&lt; your_email &gt;</code> section, which is a placeholder for your e-mail address. The arrow brackets here should not be removed, so the final version of this will resemble <code class="literal">&lt; jon@doe.com &gt;</code>. Next comes a location for your given name, in (<code class="literal">your_real_name</code>). Again, the brackets (parentheses this time) should be left in place. Last but not least is<code class="literal"> your_url</code>, a place for a website address that might contain a demonstration of the modification. Only the forum username entry is required. If you do not wish to enter your e-mail address, real name, or a website address, you can place<code class="literal"> N/A</code> in those sections instead. Be sure to include the brackets, however. A final version of this line might be:</p><div class="informalexample"><pre class="programlisting">## MOD Author: MyAccount &lt; jon@doe.com &gt; (N/A) N/A
</pre></div></div><div class="section" title="MOD Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec04"/>MOD Description</h4></div></div></div><p>The third line you should edit is for the<code class="literal"> MOD Description</code>. It is a fairly simple line.</p><div class="informalexample"><pre class="programlisting">## MOD Description: some_description_goes_here
</pre></div><p>The<code class="literal"> some_description_goes_here</code> text should be replaced with one or two very short sentences describing the purpose of the modification. An example you can use here would be<code class="literal"> Adds a strike out BBCode to posting</code>.</p></div><div class="section" title="MOD Version"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec05"/>MOD Version</h4></div></div></div><p>With the <code class="literal"> x.x.x</code> of the<code class="literal"> MOD Version</code> line, you can provide a three-part number describing this particular release of the modification. If for some reason you need to release more than one version, this number would be different for each of those releases.</p><div class="informalexample"><pre class="programlisting">## MOD Version: x.x.x
</pre></div><p>The first digit represents a stable release number, the second a minor addition number, and the third a simple alteration number. A modification that has a version number of 1.2.0 has seen one stable release followed by two releases with new features added. When a version number such as 2.3.4 is seen, that indicates two stable releases, three more releases with new features, and finally four other releases with minor changes (like small bug fixes). The version number of the first release of a modification submitted to phpBB.com is generally 1.0.0. Anything with a leading number less than one is considered to be a beta or alpha release.<span class="strong"><strong> Beta</strong></span> and<span class="strong"><strong> alpha</strong></span> releases are preview releases that may contain bugs, errors, or other problems. It might often be a bad idea to use beta or alpha releases on live forums.</p></div><div class="section" title="Installation Level"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec06"/>Installation Level</h4></div></div></div><p>
<code class="literal">Installation Level</code> describes, in a single word, how difficult it will be to install the modification.<code class="literal"> (Easy/Intermediate/Advanced)</code> would be replaced with just one of those words:<code class="literal"> Easy, Intermediate</code>, or<code class="literal"> Advanced</code>.</p><div class="informalexample"><pre class="programlisting">## Installation Level: (Easy/Intermediate/Advanced)
</pre></div><p>The Strike BBCode would be fairly<code class="literal"> Easy</code> to install. Generally, the longer an installation file is, the higher the installation level of the modification.</p></div><div class="section" title="Installation Time"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec07"/>Installation Time</h4></div></div></div><p>Like the previous line,<code class="literal"> Installation Time</code> deals with the difficulty of installing a modification. This time you should replace the<code class="literal"> x</code> with a number representing the approximate number of minutes it might take to install a modification.</p><div class="informalexample"><pre class="programlisting">## Installation Time: x Minutes
</pre></div><p>For the Strike BBCode,<code class="literal"> 5</code> would be a fair, although slightly high, number. When in doubt, try to overestimate this number. Ideally, you should time yourself when installing the modification on a forum to get an idea of the time needed.</p></div><div class="section" title="Files to Edit"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec08"/>Files to Edit</h4></div></div></div><p>The<code class="literal"> Files to Edit</code> line lists every phpBB file edited by the modification. You may recall editing five files for the Strike BBCode:<code class="literal"> posting.php, language/lang_english/lang_main.php, includes/bbcode.php, templates/subSilver/bbcode.tpl</code>, and<code class="literal"> templates/subSilver/posting_body.tpl</code>. All these files would be listed here, with a comma separating one from the other. Since that is a rather long list, it would often be broken onto multiple lines in the file. Each line must start with<span class="strong"><strong> ##</strong></span> like all of the other header lines.</p><div class="informalexample"><pre class="programlisting">## Files To Edit: file_1, file_2, file_3, etc
</pre></div></div><div class="section" title="Included Files"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec09"/>Included Files</h4></div></div></div><p>This last line in the upper part of the header provides a list of all new forum files included in the modification. When there are no new files, as with the Strike BBCode, replace the parenthesized text with a simple<code class="literal"> n/a</code>, which stands for not applicable.</p><div class="informalexample"><pre class="programlisting">## Included Files: (n/a, or list of included/required files)
</pre></div></div><div class="section" title="phpBB.com’s Security Notice"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec10"/>phpBB.com’s Security Notice</h4></div></div></div><p>The next section of the header includes a security notice created by phpBB.com. This notice is required to appear in all modifications submitted to phpBB.com and should not be altered in any way. Even a small change, such as altering capitalization or line length, will result in the refusal of a submission.</p><div class="informalexample"><pre class="programlisting">## For Security Purposes, Please Check: http://www.phpbb.com/mods/ for the
## latest version of this MOD. Downloading this MOD from other sites could cause malicious code
## to enter into your phpBB Forum. As such, phpBB will not offer support for MOD’s not offered
## in our MOD-Database, located at: http://www.phpbb.com/mods/
</pre></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note24"/>Note</h3><p>Regardless of what the security notice may or may not imply, using a modification from other websites is not necessarily going to place intentionally harmful code into your forum. It can happen, but it is rare. Because there is a risk when installing any software you did not create, you should never install<span class="emphasis"><em> any code</em></span> on your site unless you know what it does and what problems it may present. Security holes have been discovered even in earlier with phpBB, but such problems are rarely intentional.</p></div></div><div class="section" title="Author Notes"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec11"/>Author Notes</h4></div></div></div><p>Following the separator under the security notice is an<code class="literal"> Author Notes</code> section. In this area you can add extra instructions or cautions related to using or installing the modification. For example, you might explain what the modification does in more detail than in the<code class="literal"> MOD Description</code> line. This is also a good place to mention post-installation tasks like changing settings found or added in the<span class="strong"><strong> Administration Control Panel</strong></span>.</p><p>There are some things you should not include in the<code class="literal"> Author Notes</code> section. Among these are addresses of other websites at which the modification can be found, contact information, licensing information, and installation instructions that can be covered by action commands (which you will see in a moment). Placing any one of these seemingly harmless things in the<code class="literal"> Author Notes</code> can cause a modification to fail the validation process. The administration of phpBB.com has problems with links to other websites placed on their own; this is also reflected in their forum rules, which disallow most links of that type, and the security notice. The only contact information allowed by this template must be placed on the<code class="literal"> MOD Author</code> line. All modifications released on phpBB.com are required to be released under the GNU General Public License that phpBB itself falls under. A copy of this license is included with phpBB, but do not mention it in this section.</p><p>After the<code class="literal"> Author Notes</code>, an area is provided to describe each release of the modification. The<code class="literal"> MOD History</code> is a list of every release, with dates in a year-month-day format as well as version numbers. The entries for the versions should provide brief descriptions of changes made from one version to another. For the first version of a modification, it is common to see a line saying "Initial version," "First release," or a similar short statement.</p><p>The MOD Template header ends with another section that should not be edited; this section is a quick reminder to the users of the modification, pointing out that they should make backups of files. A complete header for the Strike BBCode, with all of the changes you have made so far, should resemble the example after this paragraph. This would also be a good time to save your file. Save your work periodically to ensure that you do not lose everything you have accomplished due to an accident or, worse yet, a power failure:</p><div class="informalexample"><pre class="programlisting">##############################################################
## MOD Title: Strike BBCode
## MOD Author: MyAccount &lt; jon@doe.com &gt; (N/A) N/A
## MOD Description: Adds a strike out BBCode to posting.
## MOD Version: 1.0.0
##
## Installation Level: Easy
## Installation Time: 5 Minutes
## Files To Edit: posting.php, includes/bbcode.php,
## language/lang_english/lang_main.php,
## templates/subSilver/bbcode.tpl,
## templates/subSilver/posting_body.tpl
## Included Files: n/a
##############################################################
## For Security Purposes, Please Check: http://www.phpbb.com/mods/ for the
## latest version of this MOD. Downloading this MOD from other sites could cause malicious code
## to enter into your phpBB Forum. As such, phpBB will not offer support for MOD’s not offered
## in our MOD-Database, located at: http://www.phpbb.com/mods/
##############################################################
## Author Notes:
##
## Once this modification is installed on your forum, users can include
## a strike out BBCode in their posts. The format of the BBCode is:
## [s]This text will have a line through it.[/s]
## A button is also added to the posting form.
##
##############################################################
## MOD History:
##
## 2004-12-06 - Version 1.0.0
## - Initial version.
##
##############################################################
## Before Adding This MOD To Your Forum, You Should Back Up All Files Related To This MOD
##############################################################
</pre></div></div></div><div class="section" title="Creating the List of Actions"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec04"/>Creating the List of Actions</h3></div></div></div><p>The second major portion of your modification’s instruction file, as defined by the MOD Template, is a list of actions.<span class="strong"><strong> Actions</strong></span> are commands for making changes needed to install a modification. Each action is presented with a header followed by a file name, one or more lines of code, or other information. Action headers look like the following example, with the text<code class="literal"> ACTION NAME</code> being replaced by the actual name of the command.<a id="id262" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">#
#-----[ ACTION NAME ]------------------------------------------
#
</pre></div><p>Consult the table under the<span class="emphasis"><em> The Last Action</em></span> section in <a class="link" href="ch04.html" title="Chapter 4. Customizing Your Forum">Chapter 4</a> for a list of the most commonly used actions and brief descriptions. phpBB.com allows the use of only twelve specific commands, all of which are listed in that table. The Add SQL action at the end of the table is not allowed for submissions to phpBB.com; you need to use the SQL action instead. Actions should generally be used in the order listed in the table. The Copy and SQL actions appear first, if needed, followed by an Open action, which in turn will proceed to combinations of the Find, Addition, and In-Line actions.</p><p>To create an action list for your instruction file for the Strike BBCode, review the steps you took in creating your modification. Since no new files were added, you will not need a Copy action. In the same vein, you did not make any database changes. That will render the SQL action unnecessary for these instructions. You edited five files, so you will need a matching Open action for each file.</p><div class="section" title="The Open Action"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec12"/>The Open Action</h4></div></div></div><p>The header of each Open action should be followed by a single line naming the file to be prepared for editing. Always include the full path to this file, relative to the main phpBB directory with this name. File paths in Open actions, and also Copy actions, should not start with something like<code class="literal"> root/, phpBB2/</code>, or even a simple slash,<code class="literal"> /</code>.</p><p>This is the correct Open action for the first file that was edited:<a id="id263" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">#
#-----[ OPEN ]------------------------------------------
#
includes/bbcode.php
</pre></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note25"/>Note</h3><p>You do not have to list the files for editing in any specific order, but remember that Open actions are always followed by a Find action and<span class="emphasis"><em> then</em></span> other actions.</p></div></div><div class="section" title="The Find Action"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec13"/>The Find Action</h4></div></div></div><p>The second thing you did, after opening that file, was to locate some code within it. You should instruct your modification’s users to do the same by including that code in a Find action. This is the first Find action for the Strike BBCode:<a id="id264" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">#
#-----[ FIND ]------------------------------------------
#
// [u] and [/u] for underlining text.
$text = str_replace("[u:$uid]", $bbcode_tpl[‘u_open’], $text);
$text = str_replace("[/u:$uid]", $bbcode_tpl[‘u_close’], $text);
</pre></div></div><div class="section" title="The Addition Actions"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec14"/>The Addition Actions</h4></div></div></div><p>After locating that code, it was duplicated and then altered to our needs. Several steps were involved in that process, but you do not need to describe every aspect of it in these instructions. Instead, you only want to give the user the final code and tell them where to place it, relative to the code in the Find action. The new code was placed after the code you located, so an After, Add action is needed here. If you had inserted the new code before the existing lines, then a Before, Add action would be appropriate. When removing old code and putting new code in the same location, use a Replace With action.<a id="id265" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
// [s] and [/s] for strike out text.
$text = str_replace("[s:$uid]", $bbcode_tpl[‘s_open’], $text);
$text = str_replace("[/s:$uid]", $bbcode_tpl[‘s_close’], $text);
// Strike BBCode - End Code Addition
// ------------------------------------------------
</pre></div><p>You might notice that the After, Add action example includes some comment lines that you did not place into<code class="literal"> includes/bbcode.php</code>. These lines mark the beginning and end of the code added by the modification. Although such lines are not required in your modification, try to add them whenever possible as a courtesy to the end users. If it becomes necessary to remove or upgrade your modification later, the users will be able to use lines such as these to quickly locate the code of the modification. You can format these lines any way you like; the format used here is just an example based on the author’s personal style.</p><p>Create a set of a Find and After, Add action for the other changes you made to this file. The process is the same as that you just completed, and will complete the actions for<code class="literal"> bbcode.php</code>. The resulting pair should resemble the following code:</p><div class="informalexample"><pre class="programlisting">#
#-----[ FIND ]------------------------------------------
#
// [u] and [/u] for underlining text.
$text = preg_replace("#\[u\](.*?)\[/u\]#si", "[u:$uid]\\1[/u:$uid]", $text);
#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
// [s] and [/s] for strike out text.
$text = preg_replace("#\[s\](.*?)\[/s\]#si", "[s:$uid]\\1[/s:$uid]", $text);
// Strike BBCode - End Code Addition
// ------------------------------------------------
</pre></div></div><div class="section" title="Additional Open, Find, and Addition Action Examples"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec15"/>Additional Open, Find, and Addition Action Examples</h4></div></div></div><p>We edited the<code class="literal"> bbcode.tpl</code> file of your template; the next step is to create an Open action for it. A problem arises here: you need to include the path to the file, which will mention a template directory like<code class="literal"> subSilver</code>. Suppose someone does not have<code class="literal"> subSilver</code> present on their forum, but only other templates with different names. Will this prevent them from using your modification? Should you list instructions for every template?</p><p>The answer to both questions is a resounding "No". Anyone can use the modification on any template, although they may have to improvise a little if the content of the template files is extremely different from that of subSilver. There is no way you can predict what templates are installed on any forum, and there are hundreds of templates available (not counting private templates made for a single website!). Adding instructions for more than one template is impractical and more trouble than it is worth. The solution to this problem is to always base your modifications and their instructions on the subSilver template files, which are installed by default on every original phpBB 2.0 forum. Doing this is also required if you want your modification to appear on phpBB.com.</p><p>So, with all of that in mind, the Open action for<code class="literal"> bbcode.tpl</code> would be:</p><div class="informalexample"><pre class="programlisting">#
#-----[ OPEN ]------------------------------------------
#
templates/subSilver/bbcode.tpl
</pre></div><p>You can again create a Find and After, Add instruction combination for the changes to this file. One important thing to remember is that you cannot include comment lines marking the new code in this file. Doing so would result in a forum displaying a<span class="strong"><strong> parse error</strong></span>, which means there is incorrect syntax in a file or portion of code. A final set of commands for this file could be the following.</p><div class="informalexample"><pre class="programlisting">#
#-----[ FIND ]------------------------------------------
#
&lt;!-- BEGIN u_open --&gt;&lt;span style="text-decoration: underline"&gt;&lt;!-- END u_open --&gt;
&lt;!-- BEGIN u_close --&gt;&lt;/span&gt;&lt;!-- END u_close --&gt;
#
#-----[ AFTER, ADD ]------------------------------------------
#
&lt;!-- BEGIN s_open --&gt;&lt;span style="text-decoration: line-through"&gt;&lt;!-- END s_open --&gt;
&lt;!-- BEGIN s_close --&gt;&lt;/span&gt;&lt;!-- END s_close --&gt;
</pre></div><p>Next in the list of files altered is the<code class="literal"> language/lang_english/lang_main.php</code> file. A problem similar to that of the template file path also exists with language files. Files for non-English languages will have different file paths, such as<code class="literal"> language/lang_dutch</code> or<code class="literal"> language/lang_french</code>. For this situation, the resolution is also the same: use the files and file path of the default installed on forums, which is the English language. Including other languages in your instructions is usually allowed, but again, using the default is required if you want your work listed in phpBB.com’s database.</p><p>The other actions for this file are the standard pair of a single Find and one After, Add action. Combined with the Open action, the full instructions for the file are:</p><div class="informalexample"><pre class="programlisting">#
#-----[ OPEN ]------------------------------------------
#
language/lang_english/lang_main.php
#
#-----[ FIND ]------------------------------------------
#
$lang[‘bbcode_f_help’] = ‘Font size: [size=x-small]small text[/size]’;
#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
$lang[‘bbcode_st_help’] = ‘Strike out: [s]Line through text[/s] (alt+t)’;
// Strike BBCode - End Code Addition
// ------------------------------------------------
</pre></div><p>Moving along, the next file edited for the Strike BBCode was<code class="literal"> posting.php</code>—just another Open, Find, and After, Add sequence:</p><div class="informalexample"><pre class="programlisting">#
#-----[ OPEN ]------------------------------------------
#
posting.php
#
#-----[ FIND ]------------------------------------------
#
‘L_BBCODE_F_HELP’ =&gt; $lang[‘bbcode_f_help’],
#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
‘L_BBCODE_ST_HELP’ =&gt; $lang[‘bbcode_st_help’],
// Strike BBCode - End Code Addition
// ------------------------------------------------
</pre></div><p>Last but not least, the edits of<code class="literal"> posting_body.tpl</code> were rather extensive compared to others in this modification. Since this is a template file, remember to use the path to subSilver template files in the Open action.</p><div class="informalexample"><pre class="programlisting">#
#-----[ OPEN ]------------------------------------------
#
templates/subSilver/posting_body.tpl
</pre></div><p>Do you remember the one time you duplicated code, but added it before an existing line instead of after that line? The reason for adding this before the line you copied was to create an example of using the Before, Add action instead of After, Add in this step of creating the instruction file. The only real difference, as far as appearance in the instructions, is that<code class="literal"> AFTER</code> is replaced with<code class="literal"> BEFORE</code>.</p><div class="informalexample"><pre class="programlisting">#
#-----[ FIND ]------------------------------------------
#
f_help = "{L_BBCODE_F_HELP}";
#
#-----[ BEFORE, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
st_help = ‘{L_BBCODE_ST_HELP}’;
// Strike BBCode - End Code Addition
// ------------------------------------------------
</pre></div><p>Now you have another basic Find and After, Add action combination for the next alteration you made in this file.</p><div class="informalexample"><pre class="programlisting">#
#-----[ FIND ]------------------------------------------
#
bbtags = new Array(‘[b]’,’[/b]’,’[i]’,’[/i]’,’[u]’,’[/u]’,’[quote]’,’[/quote]’,’[code]’,’[/code]’,’[list]’,’[/list]’,’[list=]’,’[/list]’,’[img]’,’[/img]’,’[url]’,’[/url]’);
#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
bbtags[22] = ‘[s]’;
bbtags[23] = ‘[/s]’;
// Strike BBCode - End Code Addition
// ------------------------------------------------
</pre></div><p>The actions for the last steps are, once again, Find and After, Add. This combination, as you may have noticed, is the one used most often in modification instructions. For this round, the procedure is the same, but notice that the comment lines in the After, Add instruction are very different.</p><div class="informalexample"><pre class="programlisting">#
#-----[ FIND ]------------------------------------------
#
&lt;td&gt;&lt;span class="genmed"&gt;
&lt;input type="button" class="button" accesskey="w" name="addbbcode16" value="URL" style="text-decoration: underline; width: 40px" onClick="bbstyle(16)" onMouseOver="helpline(‘w’)" /&gt;
&lt;/span&gt;&lt;/td&gt;
#
#-----[ AFTER, ADD ]------------------------------------------
#
&lt;!-- Strike BBCode - Begin Code Addition --&gt;
&lt;td&gt;&lt;span class="genmed"&gt;
&lt;input type="button" class="button" accesskey="t" name="addbbcode22" value="Strike" style="text-decoration: line-through; width: 44px" onClick="bbstyle(22)" onMouseOver="helpline(‘st’)" /&gt;
&lt;/span&gt;&lt;/td&gt;
&lt;!-- Strike BBCode - End Code Addition --&gt;
</pre></div><p>Previously, the code snippets that were added with comment lines were lines of PHP or, earlier in this file, JavaScript code. This time you are adding HTML code instead. PHP and JavaScript have similar syntax for comment lines: anything after a pair of slashes,<code class="literal"> //</code>, is a comment. HTML comments, however, begin with <code class="literal">&lt;!--</code> and end with<code class="literal"> --&gt;</code>. If you used a PHP-style comment, like<code class="literal"> // Strike BBCode Begin Code Addition</code>, here, it would be displayed in plain text on the posting page.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note26"/>Note</h3><p>You might be tempted to use HTML-style comments in<code class="literal"> bbcode.tpl</code>. Sadly, this is not allowed in that file because HTML comments are used by phpBB to parse the file itself. Also, avoid using in other template files any HTML comments that start with <code class="literal">&lt;!-- BEGIN</code> or <code class="literal">&lt;!-- END</code>. phpBB will think those are special template switches and usually report a parse error.</p></div><p>That ends the list of actions for this particular modification. Do not forget to save what you have completed so far!</p></div></div><div class="section" title="Using Other Actions"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec05"/>Using Other Actions</h3></div></div></div><p>Although the Strike BBCode only uses a few of the actions—Open; Find; After, Add; and Before, Add—you may need to use several of the other actions when creating your own original modifications. With that in mind, here are some examples of the other actions.</p><div class="section" title="Copying Files—The Copy Action"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec16"/>Copying Files—The Copy Action</h4></div></div></div><p>When your modification includes new files, the first action that should appear in your list of commands is the Copy action. The Copy action indicates that users should upload the new files to their forum, and states the locations of these files. After the action header, you should include a line mentioning each file, including any folders that it might be in when the modification is uncompressed from a single file, and the path it should be placed in, relative to the forum’s main directory. You will learn how to place files within folders inside a compressed file later in this chapter. There are some special shortcuts you can use in a Copy action, so now is a good time to look at an example action.<a id="id266" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">#
#-----[ COPY ]------------------------------------------
#
my_new_file.php to my_new_file.php
my_functions.php to includes/my_functions.php
new_tpls/new_file.tpl to templates/subSilver/new_file.tpl
language/lang_english/*.* to language/lang_english/*.*
</pre></div><p>Files included in the modification are listed on the left, then the word<code class="literal"> to</code> is used as a separator followed by the file’s correct position within the forum’s structure. The first line of files is fairly simple in meaning: copy the<code class="literal"> my_new_file.php</code> file to the main directory of a forum (the directory that contains files such as<code class="literal"> viewtopic.php</code> and<code class="literal"> posting.php)</code>. On the second line, you are telling the user to place the remote copy of<code class="literal"> my_functions.php</code> inside their forum’s<code class="literal"> includes/</code> directory. With the third line, you can see that the files being copied are in a folder named<code class="literal"> new_tpls</code> here. After the directory names on the final line, the<code class="literal"> *.*</code> shortcut means that the user would be copying<span class="emphasis"><em> all files</em></span> within that directory. You can also use shortcuts like<code class="literal"> *.php</code> or<code class="literal"> *.tpl</code> to represent all files with a particular extension.</p></div><div class="section" title="Altering the Database—The SQL Action"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec17"/>Altering the Database—The SQL Action</h4></div></div></div><p>For making changes or additions to the SQL database of a forum, use the SQL action. Always include the SQL action near the top of your actions list; it should be the first or second action users complete. This action’s header is followed by one or more SQL queries. Make sure that the queries you use are correctly structured and valid; they need to work exactly as presented. Note that most SQL actions will use queries created for MySQL databases, but this is not required. A sample of a SQL action that creates a simple database table could be:<a id="id267" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">#
#-----[ SQL ]------------------------------------------
#
CREATE TABLE phpbb_newtable (
newtable_id int(8) NOT NULL default ‘0’,
newtable_item varchar(255) NOT NULL default ‘’,
PRIMARY KEY (newtable_id)
);
</pre></div></div><div class="section" title="Replacing Code—The Replace With Action"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec18"/>Replacing Code—The Replace With Action</h4></div></div></div><p>Sometimes you will need to alter an existing line of code instead of adding something before or after it. The Replace With action can be useful for this. Like the Before, Add and After, Add actions, Replace With will always follow a Find action. If you can use comment lines, it is also a good idea to include a commented out copy of the replaced lines in the Replace With action. That practice will make it easier for users to locate the code again later if another modification uses it in a Find action.<a id="id268" class="indexterm"/>
</p><p>Suppose you wanted to replace the Underline BBCode with the Strike BBCode, instead of just adding the latter. In such a case, you might have a series of actions like these:</p><div class="informalexample"><pre class="programlisting">#
#-----[ FIND ]------------------------------------------
#
// [u] and [/u] for underlining text.
$text = preg_replace("#\[u\](.*?)\[/u\]#si", "[u:$uid]\\1[/u:$uid]", $text);
#
#-----[ REPLACE WITH ]------------------------------------------
#
/* Original phpBB Code removed by Strike BBCode.
// [u] and [/u] for underlining text.
$text = preg_replace("#\[u\](.*?)\[/u\]#si", "[u:$uid]\\1[/u:$uid]", $text);
*/
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
// [s] and [/s] for strike out text.
$text = preg_replace("#\[s\](.*?)\[/s\]#si", "[s:$uid]\\1[/s:$uid]", $text);
// Strike BBCode - End Code Addition
// ------------------------------------------------
</pre></div></div><div class="section" title="Modifying Portions of a Line—In-Line Actions"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl4sec19"/>Modifying Portions of a Line—In-Line Actions</h4></div></div></div><p>Do you remember the alternative methods of editing<code class="literal"> posting_body.tpl</code> that were discussed after you created the Strike BBCode? Some of those make good examples of using the In-Line actions: In-Line Find; In-Line After, Add; In-Line Before, Add; and In-Line Replace With. In-Line actions are identical in use to their shorter named counterparts, with the exception that they always operate inside a single line of code. Typically when using these actions, you should start with a normal Find action, followed by an In-Line Find, and then one or more of the remaining three In-Line actions. Usually you will have a sequence such as Find, In-Line Find, and finally In-Line After, Add. This sequence would be used to add the<code class="literal"> [s]</code> and<code class="literal"> [/s]</code> Strike tags within the<code class="literal"> bbtags</code> code line.<a id="id269" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">#
#-----[ FIND ]------------------------------------------
#
bbtags = new Array(‘[b]’,’[/b]’,’[i]’,’[/i]’,’[u]’,’[/u]’,’[quote]’,’[/quote]’,’[code]’,’[/code]’,’[list]’,’[/list]’,’[list=]’,’[/list]’,’[img]’,’[/img]’,’[url]’,’[/url]’);
#
#-----[ IN-LINE FIND ]------------------------------------------
#
‘[/url]’
#
#-----[ IN-LINE AFTER, ADD ]------------------------------------------
#
,’[s]’,’[/s]’
</pre></div></div></div><div class="section" title="Adding the MOD Template Footer"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec06"/>Adding the MOD Template Footer</h3></div></div></div><p>To finish off the modification’s instruction file, you need to add the footer of the MOD Template. The term "footer" is a bit misleading; you are actually placing one last action at the bottom of the file. All modifications submitted to phpBB.com must end with this action, and a variation of this is usually seen at the end of most other modifications as well. This action is explained in <a class="link" href="ch04.html" title="Chapter 4. Customizing Your Forum">Chapter 4</a>.<a id="id270" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">#
#-----[ SAVE/CLOSE ALL FILES ]------------------------------------------
#
# EoM
</pre></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note27"/>Note</h3><p>
<code class="literal">EoM</code> is an acronym for the phrase<span class="emphasis"><em> End of MOD</em></span> or<span class="emphasis"><em> End of Modification</em></span>. Some authors use<code class="literal"> End</code> or another label instead of<code class="literal"> EoM</code> when submitting hacks to sites other than phpBB.com.</p></div></div><div class="section" title="The Completed Instruction File"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec07"/>The Completed Instruction File</h3></div></div></div><p>With the full header, list of actions, and the footer compiled, you have finished the instruction file for the Strike BBCode. Here’s a sample instruction file (text-wrapped here in the book) if you would like to compare your own to a working example (this file has also been included in the code download as<code class="literal"> 1132_07_strike.txt</code>).<a id="id271" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">##############################################################
## MOD Title: Strike BBCode
## MOD Author: Thoul &lt; thoul@users.sourceforge.net &gt; (Jeremy Rogers) http://darkmods.sourceforge.net
## MOD Description: Adds a strike out BBCode to posting.
## MOD Version: 1.0.0
##
## Installation Level: Easy
## Installation Time: 5 Minutes
## Files To Edit: posting.php, includes/bbcode.php,
## language/lang_english/lang_main.php,
## templates/subSilver/bbcode.tpl,
## templates/subSilver/posting_body.tpl
## Included Files: n/a
##############################################################
## For Security Purposes, Please Check: http://www.phpbb.com/mods/ for the
## latest version of this MOD. Downloading this MOD from other sites could cause malicious code
## to enter into your phpBB Forum. As such, phpBB will not offer support for MOD’s not offered
## in our MOD-Database, located at: http://www.phpbb.com/mods/
##############################################################
## Author Notes:
##
## Once this modification is installed on your forum, users can include
## a strike out BBCode in their posts. The format of the BBCode is:
## [s]This text will have a line through it.[/s]
## A button is also added to the posting form.
##
##############################################################
## MOD History:
##
## 2004-12-06 - Version 1.0.0
## - Initial version.
##
##############################################################
## Before Adding This MOD To Your Forum, You Should Back Up All Files Related To This MOD
##############################################################
#
#-----[ OPEN ]------------------------------------------
#
includes/bbcode.php
#
#-----[ FIND ]------------------------------------------
#
// [u] and [/u] for underlining text.
$text = str_replace("[u:$uid]", $bbcode_tpl[‘u_open’], $text);
$text = str_replace("[/u:$uid]", $bbcode_tpl[‘u_close’], $text);
#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
// [s] and [/s] for strike out text.
$text = str_replace("[s:$uid]", $bbcode_tpl[‘s_open’], $text);
$text = str_replace("[/s:$uid]", $bbcode_tpl[‘s_close’], $text);
// Strike BBCode - End Code Addition
// ------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
// [u] and [/u] for underlining text.
$text = preg_replace("#\[u\](.*?)\[/u\]#si", "[u:$uid]\\1[/u:$uid]", $text);
#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
// [s] and [/s] for strike out text.
$text = preg_replace("#\[s\](.*?)\[/s\]#si", "[s:$uid]\\1[/s:$uid]", $text);
// Strike BBCode - End Code Addition
// ------------------------------------------------
#
#-----[ OPEN ]------------------------------------------
#
templates/subSilver/bbcode.tpl
#
#-----[ FIND ]------------------------------------------
#
&lt;!-- BEGIN u_open --&gt;&lt;span style="text-decoration: underline"&gt;&lt;!-- END u_open --&gt;
&lt;!-- BEGIN u_close --&gt;&lt;/span&gt;&lt;!-- END u_close --&gt;
#
#-----[ AFTER, ADD ]------------------------------------------
#
&lt;!-- BEGIN s_open --&gt;&lt;span style="text-decoration: line-through"&gt;&lt;!-- END s_open --&gt;
&lt;!-- BEGIN s_close --&gt;&lt;/span&gt;&lt;!-- END s_close --&gt;
#
#-----[ OPEN ]------------------------------------------
#
language/lang_english/lang_main.php
#
#-----[ FIND ]------------------------------------------
#
$lang[‘bbcode_f_help’] = ‘Font size: [size=x-small]small text[/size]’;
#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
$lang[‘bbcode_st_help’] = ‘Strike out: [s]Line through text[/s] (alt+t)’;
// Strike BBCode - End Code Addition
// ------------------------------------------------
#
#-----[ OPEN ]------------------------------------------
#
posting.php
#
#-----[ FIND ]------------------------------------------
#
‘L_BBCODE_F_HELP’ =&gt; $lang[‘bbcode_f_help’],
#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
‘L_BBCODE_ST_HELP’ =&gt; $lang[‘bbcode_st_help’],
// Strike BBCode - End Code Addition
// ------------------------------------------------
#
#-----[ OPEN ]------------------------------------------
#
templates/subSilver/posting_body.tpl
#
#-----[ FIND ]------------------------------------------
#
f_help = "{L_BBCODE_F_HELP}";
#
#-----[ BEFORE, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
st_help = ‘{L_BBCODE_ST_HELP}’;
// Strike BBCode - End Code Addition
// ------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
bbtags = new Array(‘[b]’,’[/b]’,’[i]’,’[/i]’,’[u]’,’[/u]’,’[quote]’,’[/quote]’,’[code]’,’[/code]’,’[list]’,’[/list]’,’[list=]’,’[/list]’,’[img]’,’[/img]’,’[url]’,’[/url]’);
#
#-----[ AFTER, ADD ]------------------------------------------
#
// ------------------------------------------------
// Strike BBCode - Begin Code Addition
bbtags[22] = ‘[s]’;
bbtags[23] = ‘[/s]’;
// Strike BBCode - End Code Addition
// ------------------------------------------------
#
#-----[ FIND ]------------------------------------------
#
&lt;td&gt;&lt;span class="genmed"&gt;
&lt;input type="button" class="button" accesskey="w" name="addbbcode16" value="URL" style="text-decoration: underline; width: 40px" onClick="bbstyle(16)" onMouseOver="helpline(‘w’)" /&gt;
&lt;/span&gt;&lt;/td&gt;
#
#-----[ AFTER, ADD ]------------------------------------------
#
&lt;!-- Strike BBCode - Begin Code Addition --&gt;
&lt;td&gt;&lt;span class="genmed"&gt;
&lt;input type="button" class="button" accesskey="t"
name="addbbcode22" value="Strike" style="text-decoration: line-through; width: 44px" onClick="bbstyle(22)" onMouseOver="helpline(‘st’)" /&gt;
&lt;/span&gt;&lt;/td&gt;
&lt;!-- Strike BBCode - End Code Addition --&gt;
#
#-----[ SAVE/CLOSE ALL FILES ]------------------------------------------
#
# EoM
</pre></div></div><div class="section" title="Creating a ZIP File"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl3sec08"/>Creating a ZIP File</h3></div></div></div><p>Now that you have an instruction file, you can place it into a ZIP file for distributing on websites. For a simple single file modification like this Strike BBCode, you could simply make it available as that one file. Larger modifications with multiple files, however, need to be packaged into a single compressed file. This makes them easier to distribute. As an example, consider the popular File Attachment modification, which contains over 140 individual files. Downloading these files one at a time would be a nightmare, so they are combined compressed into one ZIP file. Not only does this allow you to download the entire modification in one file, but the size of this file is significantly smaller and makes for an even faster download.</p><p>The actual process of creating a ZIP file will vary depending on the software used. There are many programs that can be used. Several were listed in <a class="link" href="ch04.html" title="Chapter 4. Customizing Your Forum">Chapter 4</a>’s <span class="emphasis"><em>Installing a New Style</em></span> section. The Windows XP and Mac OS X operating systems also have built-in abilities to create ZIP files. When you’ve chosen the software you will use, consult its Help files or website to determine how to create ZIP files with that software.</p><p>First, place all the files that need to be distributed as part of your modification in one folder and name this folder after the modification. For the Strike BBCode, you could create a<code class="literal"> Strike</code> folder and place your<code class="literal"> strike.mod</code> file in it. If the modification adds new forum files, you may wish to create folders within that first folder reflecting the correct locations of the new files, such as<code class="literal"> templates/subSilver/</code>, for new template files, and place the additional files within those folders.</p><p>Once the files and folders are all arranged to your satisfaction, navigate to the folder containing the modification’s folder (<code class="literal">Strike</code>, for the example). Right-click on the modification’s folder to open the Windows context menu. There should be an entry in this menu for WinZip; hover over it with the mouse pointer to expand a submenu with several options for creating ZIP files. Click the<span class="strong"><strong> Add to Strike.zip</strong></span> line to create a new file called<code class="literal"> Strike.zip</code> containing all the files and folders within the<code class="literal"> Strike</code> folder. The name used in<span class="strong"><strong> Add to Strike.zip</strong></span> and<code class="literal"> Strike.zip</code> will be different if you chose a different name for the modification folder. The image that follows illustrates using the context menu for this process. Test your new ZIP file by double-clicking the filename or icon. WinZip, or your chosen archive software, should open the file and allow you to extract the files.</p><div class="mediaobject"><img src="graphics/1132_07_03.jpg" alt="Creating a ZIP File"/></div></div></div><div class="section" title="Submitting Your Modification"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec09"/>Submitting Your Modification</h2></div></div></div><p>With all the files of your modification gathered into a package of one compressed file, you are finally ready to make it available to others. To submit the file to phpBB.com’s modification database, you will need to log in to an account on that community’s forums. If you do not already have an account there, you will need to register before you can submit any files.<a id="id272" class="indexterm"/>
</p><p>Once logged in, click on the<span class="strong"><strong> Mods</strong></span> image in the menu running across the top (of every page). This takes you to the website’s modifications area, where you can find the modification database and documentation related to submitting and creating modifications. Click on the<span class="strong"><strong> MODS-Database</strong></span> link on this page to view the categories of the database. All downloads in this database are gathered into sections based on the type of modification as you will see. Choose the most appropriate category for your modification—<code class="literal">BBCode</code> in the case of BBCode modifications—and click that category to view the downloads currently listed there. A list of links will be present on the left of the listing page. Click on the<span class="strong"><strong> Add Link</strong></span>; this leads to the submission form.</p><p>The submission form has several fields for entering the same information that you placed into the header of your instructions file, such as<span class="strong"><strong> MOD Author, MOD Description, Installation Time</strong></span>, and so on. You can also enter a private message for the modification validation team and other information related to the submission process. Clicking the<span class="strong"><strong> Browse</strong></span> button on the last form entry will open a dialog window in which you can select the ZIP file on your computer. Submitting the form will upload the file from your computer. Make sure you do not close your web browser until the upload is complete, or your submission will not be received.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note28"/>Note</h3><p>You<span class="emphasis"><em> cannot</em></span> submit the Strike BBCode to websites for reasons stated earlier in this chapter. However, you can distribute any original modifications you create.</p></div><p>When you submit a modification to phpBB.com’s database, it is placed into a queue where it remains until reviewed by the site’s MOD Team. Once it has been reviewed, the modification will either be listed in the database, or will be rejected, in which case you should receive a private message on the forum explaining why and what must be changed before you can resubmit. The validation may take some time, especially when there is a large backlog of unreviewed submissions, so you should be patient during this stage. This process has been known to take as long as six months in the past. If the modification is accepted and listed in the modification database, a topic announcing the release will be created in the community forums. You can use this topic for supporting the modification if any problems are found later.</p><p>The submission process for other sites is different. phpBBHacks.com has a much simpler procedure, for example. On that site, you only have to click a<span class="strong"><strong> Submit</strong></span> link on the site’s menu and then choose another link based on the type of download you are submitting. There are separate submissions forms for modifications and other downloads. The submission form at this site allows you to enter the same sort of information as phpBB.com’s form: a title, description, version number, staff message, and so on. There are some other fields as well, such as phpBB version compatibility. One important difference is that you will not upload the modification using this form. Instead, you must first upload it to a website of your own and provide the URL of the uploaded file. As phpBBHacks.com allows authors to be responsible for testing their own work, this site does not have a detailed validation procedure. The submitted hacks are processed regularly, so your submission should appear within a few days. Again, however, try to be patient: there are times when the processing might take a little longer.</p><p>Since you have to upload the ZIP file containing the modification in order to submit it to phpBBHacks.com, you can also release it on your own website. Many modification authors do this, and may even set up a special phpBB forum on their sites. Such forums often help provide support for modifications, and demonstrations for curious users.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec05"/>Summary</h1></div></div></div><p>Creating modifications can be a very rewarding experience for you as a forum administrator. By making more modifications and making them progressively more complex, you can learn many things about the inner workings of phpBB and PHP programming. You will not only be able to improve the forums of an online community, but will also gain experience that can help you enhance other aspects. Some authors have even gone on to do work-for-hire, like writing chapters in phpBB books!</p><p>By progressing through the examples of this chapter, you learned:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">That modifications can be written using any combination of four major programming languages</li><li class="listitem" style="list-style-type: disc">That developing should be done in a sound testing environment with the latest phpBB release</li><li class="listitem" style="list-style-type: disc">How to create a brand-new BBCode for your community</li><li class="listitem" style="list-style-type: disc">Skills and techniques that will allow you to create other modifications</li><li class="listitem" style="list-style-type: disc">The methods of submitting your modification to two of the largest modification databases</li></ul></div></div></body></html>
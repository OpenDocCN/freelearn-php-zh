<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Installing Phalcon"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Installing Phalcon</h1></div></div></div><p>This chapter will walk you through installing Phalcon on your chosen platform. The installation process differs a little bit depending on which operating system you happen to be using. Since Phalcon<a id="id0" class="indexterm"/> is a PHP extension written in C, installation is a little bit more involved than downloading an archive of PHP files and uploading them to your server.</p><p>But installation should still take you less than an hour. Depending on your system and experience with PHP extensions, it could take only minutes. At the end of this chapter, you will have a high performance PHP framework that will simplify the process of developing your application and help you get your project up and running faster.</p><p>In this chapter, you will learn how to:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Meet Phalcon's system requirements</li><li class="listitem" style="list-style-type: disc">Find the correct Phalcon DLL for use on a Windows machine</li><li class="listitem" style="list-style-type: disc">Install the Phalcon DLL on a Windows machine</li><li class="listitem" style="list-style-type: disc">Install Phalcon on Linux</li><li class="listitem" style="list-style-type: disc">Install Phalcon on Mac</li><li class="listitem" style="list-style-type: disc">Install Phalcon on FreeBSD</li><li class="listitem" style="list-style-type: disc">Edit your <code class="literal">php.ini</code> to use Phalcon</li><li class="listitem" style="list-style-type: disc">Configure Apache for Phalcon</li></ul></div><div class="section" title="Phalcon system requirements"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec07"/>Phalcon system requirements</h1></div></div></div><p>You will of course need a web server in order to use Phalcon. Apache is the most common, but if you have an<a id="id1" class="indexterm"/> Nginx or Cherokee web server, that will work too. You can even use PHP's built-in web server as your Phalcon development server if you wish. For the purposes of this book, we will assume you have Apache installed.</p><p>Along with that, you will need PHP installed. While Phalcon will work with any version of PHP higher than Version 5.3.1, it is recommended that you use PHP 5.3.11 or greater. Versions of PHP before 5.3.11 still <a id="id2" class="indexterm"/>have security flaws and memory leaks that were fixed in the later versions.</p><p>But that is about all you need. Phalcon is not really very picky. There are a few other requirements you may need to meet on each specific operating system, and we will cover them in the individual installation processes.</p></div></div>
<div class="section" title="Installing Phalcon on Windows"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Installing Phalcon on Windows</h1></div></div></div><p>In this section, we will walk through installing Phalcon on Windows. Even if you aren't installing the extension on <a id="id3" class="indexterm"/>Windows, please read through this section. Many of the steps involved, such as locating your <code class="literal">php.ini</code>, apply to all operating systems.</p><p>The Phalcon extension for <a id="id4" class="indexterm"/>Windows comes compiled as a DLL. However, you must locate the correct DLL for your version of PHP. The first requirement when installing Phalcon in Windows is a PHP binary compiled with Windows Visual Studio 9.0. It is possible to have a Windows PHP installation compiled with another version of Visual Studio. If you have one of these other versions, you will have to install the correct version of PHP if you want Phalcon to work on your system.</p><p>So, let's take a look at your PHP installation to discover just which version of PHP you have installed. First, you need to locate the document root of your web server. Or, in other words, you need to locate the folder on your computer that corresponds to the page you get when you browse to <code class="literal">http://localhost</code> or the folder on your server that maps to the home page of <code class="literal">http://yourdomain.com</code>. We are going to create a PHP file that will tell us everything we need to know to pick the right version of the PhalconPHP DLL and drop it in that folder.</p><p>So, open up your text editor or IDE and create a new file. Name it <code class="literal">info.php</code>. In that file, insert the following code:</p><div class="informalexample"><pre class="programlisting">&lt;?php
  phpinfo();
?&gt;</pre></div><p>Save the file to your document root. Where your document root is depends upon which web server stack you have installed on your machine. It could be Apache directly from the official site, such as XAMPP, Wamp, or AMPPS, or one of the other versions of Apache, PHP, and MySQL stacks available. Your best bet is to visit the site where you downloaded your chosen version of Apache and read the documentation.</p><p>Once you have saved the file, browse to <code class="literal">http://localhost/inf</code>
<code class="literal">o.php</code> and you should see a page like the following screenshot:</p><div class="mediaobject"><img src="graphics/7673OS_01_01.jpg" alt="Installing Phalcon on Windows"/></div><p>You will notice the PHP version at the top of the page. We will be paying attention to the first two numbers separated by a dot. They will either be <span class="strong"><strong>5.3</strong></span> as shown in the previous screenshot or 5.4. If they are<a id="id5" class="indexterm"/> 5.2 or less, you will need to update your PHP installation.</p><p>Next, you want to make sure that your version of PHP was compiled with Microsoft Visual Studio 9.0. <a id="id6" class="indexterm"/>So, search for the word <span class="strong"><strong>Compiler</strong></span> in your browser window. The command to open the search box on most browsers is <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>F</em></span>. It is usually near the top of the page as shown in the following screenshot. If your PHP was compiled with Visual Studio 9.0, you should see <span class="strong"><strong>MSVC9 (Visual C++ 2008)</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/7673OS_01_02.jpg" alt="Installing Phalcon on Windows"/></div><p>Below the <span class="strong"><strong>Compiler</strong></span>, you will see the <span class="strong"><strong>Architecture</strong></span> listing. It will say <span class="strong"><strong>x86</strong></span> or <span class="strong"><strong>x64</strong></span>. In the previous screenshot, PHP was compiled for the <span class="strong"><strong>x86</strong></span> architecture.</p><p>Next, we need to see if you<a id="id7" class="indexterm"/> have a thread-safe version of PHP or not. So, search for PHP Extension Build in your browser window. Next to this, you will see the<a id="id8" class="indexterm"/> build version of your PHP installation. If you see an NTS at the end of this number, then you do not have a thread-safe version of PHP.</p><p>Now that we have these pieces of information, we can go to <a class="ulink" href="http://phalconphp.com/en/download/windows">http://phalconphp.com/en/download/windows</a>.</p><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p><span class="strong"><strong>Downloading the example code</strong></span></p><p>You can download the example code files for all Packt books you have purchased from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you. You can also find all the code used in the book by visting GitHub page <a class="ulink" href="http://eristoddle.github.io/phalconBlog/">http://eristoddle.github.io/phalconBlog/</a>.</p></div></div><p>Here, we will see the page as shown in the following screenshot, which lists multiple versions of the Phalcon PHP extension:</p><div class="mediaobject"><img src="graphics/7673OS_01_03.jpg" alt="Installing Phalcon on Windows"/></div><p>It may look daunting, but we just did the research that will enable us to choose the correct version. We know whether we have a thread-safe version or not. We know whether we have an x86 or x64 architecture. And we know whether we have PHP 5.3 or 5.4. Don't worry about the last number in the PHP version. We just need to download the extension that fits our configuration. <a id="id9" class="indexterm"/>The Phalcon extension for PHP 5.3.9 will work for all versions of PHP 5.3 and the extension for PHP 5.4.0 will work for all versions of PHP 5.4.</p><p>After downloading the extension, <a id="id10" class="indexterm"/>unzip it. Inside the zip file will be a DLL. Next, we need to move this DLL into the folder where your other PHP extensions exist. If you have XAMPP installed, this folder will most likely be <code class="literal">c:\xampp\php\ext</code>, and with Wamp, that would be <code class="literal">c:\wamp\bin\php_version_number\ext</code>, where <code class="literal">php_version_number</code> is replaced with the version number of PHP you have installed. For other versions of web server stacks, you will have to visit the documentation to find the PHP extension folder.</p><p>Now we have the extension where it needs to be, but we aren't done yet. We need to have PHP load the extension when it runs. So we have to locate the <code class="literal">php.ini</code> file and edit it. But guess what, we can use our <code class="literal">info.php</code> file to tell us where this file is. So load it again in your browser and search for <span class="strong"><strong>Loaded Configuration File</strong></span>. Listed beside this entry is its location, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/7673OS_01_04.jpg" alt="Installing Phalcon on Windows"/></div><p>Once you locate this file, open it with your text editor or IDE and scroll to the very bottom. This file can be quite<a id="id11" class="indexterm"/> long. At the very bottom of this file, you will want to add the following line to tell PHP to load Phalcon:</p><div class="informalexample"><pre class="programlisting">extension=php_phalcon.dll</pre></div><p>Save the file. Some server stacks like XAMPP have desktop software to stop and start Apache, while others like Apache from the official site only have a tray icon to control stopping and starting of the server. Or, you can just restart Apache from the command line. Restart Apache now and Phalcon is installed. But let's check to make sure. Load <code class="literal">http://localh</code>
<code class="literal">ost/info.php</code> in your<a id="id12" class="indexterm"/> browser again and search for Phalcon and you should be greeted by a page as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/7673OS_01_05.jpg" alt="Installing Phalcon on Windows"/></div></div>
<div class="section" title="Installing Phalcon on Linux"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Installing Phalcon on Linux</h1></div></div></div><p>Linux is the most common operating system for a web server. Phalcon does require you to have root access to your web <a id="id13" class="indexterm"/>server. If you are on a shared server, you won't get root access, but you may be able to talk to your hosting provider to install Phalcon for you. If you have a VPS, cloud server, or dedicated server, you most likely have root access. If not, you can ask your hosting provider to give you access.</p><p>It is beyond the scope of this book<a id="id14" class="indexterm"/> to walk you through installing Phalcon on each and every Linux installation, but there are prebuilt versions of the Phalcon extension for some versions of Linux.</p><p>For Debian Linux, you will find a repo<a id="id15" class="indexterm"/> at the following link:</p><p><a class="ulink" href="http://debrepo.frbit.com/">http://debrepo.frbit.com/</a></p><p>For Arch Linux, you can <a id="id16" class="indexterm"/>go to the following link to download a PKGBUILD:</p><p><a class="ulink" href="http://aur.archlinux.org/packages.php?ID=61950">http://aur.archlinux.org/packages.php?ID=61950</a></p><p>And for OpenSUSE, you can find a package at the following link:<a id="id17" class="indexterm"/></p><p><a class="ulink" href="http://software.opensuse.org/package/php5-phalcon">http://software.opensuse.org/package/php5-phalcon</a></p><p>For all other versions of Linux, we will have to compile Phalcon ourselves. This is not hard, and if you have been using Linux for a while, you are probably used to compiling your own software by now. First, we have to be sure we have the following software installed:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Git</li><li class="listitem" style="list-style-type: disc">GCC Compiler</li><li class="listitem" style="list-style-type: disc">PHP development resources</li></ul></div><p>If you don't have these installed, you can install them via the command line.</p><p>For Ubuntu, the command line is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install git</strong></span>
<span class="strong"><strong>sudo apt-get php5-devphp-mysqlgcc</strong></span>
</pre></div><p>For Fedora, CentOS, and RHEL, the command line is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo yum install git</strong></span>
<span class="strong"><strong>sudo yum install php-develphp-mysqlnd ccc libtool</strong></span>
</pre></div><p>For OpenSUSE, the command line is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>yast2 -igit</strong></span>
<span class="strong"><strong>yast2 -iphp5-pear php5-develphp5-mysqlgcc</strong></span>
</pre></div><p>For Solaris, the command line is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>pkginstall git</strong></span>
<span class="strong"><strong>pkg install gcc-45 php-53 apache-php53</strong></span>
</pre></div><p>Once you have met all the requirements, open up a terminal window and type the following commands to download the Git repository and compile the Phalcon extension:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>git clone git://github.com/phalcon/phalcon.git</strong></span>
<span class="strong"><strong>cd cphalcon/build</strong></span>
<span class="strong"><strong>sudo ./install</strong></span>
</pre></div><p>On some Linux installations, the <a id="id18" class="indexterm"/>compilation may fail because <code class="literal">libpcre3-dev</code> is missing. You can fix this issue by installing this package with your Linux package manager.</p><p>You just compiled your first PHP extension. Now we need to add the reference to our extension to the <code class="literal">php.ini</code> file. We can<a id="id19" class="indexterm"/> find it by creating the <code class="literal">info.php</code> file as discussed in the <span class="emphasis"><em>Installing Phalcon on Windows</em></span> section of this chapter, loading it in our browser, and searching the resulting page for <span class="strong"><strong>Loaded Configuration File</strong></span>. Locate the file listed here in your file-system and add the following line to the very bottom of the file:</p><div class="informalexample"><pre class="programlisting">extension=phalcon.so</pre></div><p>Now save the file. If you do happen to be installing Phalcon for PHP 5.4 on a Debian type Linux, the procedure for installing a new PHP extension has changed. It is no longer a best practice to edit the main <code class="literal">php.ini</code> file. In the same folder where you found the <code class="literal">php.ini</code> file, usually with the <code class="literal">/etc/apache5/</code> path, you will find a <code class="literal">mods-available</code> folder. It is in this folder that you will be creating a custom <code class="literal">.ini</code> file just for Phalcon, and you will call it <code class="literal">phalcon.ini</code>. This file will be empty because we aren't adding any custom configuration settings to Phalcon. Then, to enable the extension, we just run the following in the command line:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>php5enmod phalcon</strong></span>
</pre></div><p>Now restart your web server. The <a id="id20" class="indexterm"/>command to restart Apache differs depending on the type of Linux. For Debian and Ubuntu type Linuxes, you can type the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo service apache2 restart</strong></span>
<span class="strong"><strong>And for Red Hat, CentOS or Fedora, you would type:</strong></span>
<span class="strong"><strong>sudo service httpd restart</strong></span>
</pre></div></div>
<div class="section" title="Installing Phalcon on Mac"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Installing Phalcon on Mac</h1></div></div></div><p>To install Phalcon on Mac, the steps are basically the same as installing it on Linux. You must compile the extension from the<a id="id21" class="indexterm"/> source code. But first there are some requirements. You need to have Git, php5-devel, and Xcode with the command line tools installed. Xcode is available for free from<a id="id22" class="indexterm"/> the official Mac site, but is not installed by default.</p><p>Also, Xcode's command line tools are not installed with Xcode by default. In order to make sure to install these tools, open Xcode's <span class="strong"><strong>Preference</strong></span> panel, choose the <span class="strong"><strong>Download</strong></span> tab, and click on the <span class="strong"><strong>Install</strong></span> button<a id="id23" class="indexterm"/> located next to the <span class="strong"><strong>Command Line Tools</strong></span> listing.</p><p>To install Git, just point<a id="id24" class="indexterm"/> your web browser to <a class="ulink" href="http://git-scm.com/download/mac">http://git-scm.com/download/mac</a>, download the file, and install it. You will also need to install php5-devel if you don't already have it on your system. How you install this depends on the package manager you have installed on your Mac.<a id="id25" class="indexterm"/> There are also some prebuilt php5-devel binaries available for the Mac. A search on Google for "install Mac php5-devel" should point you in the right direction.</p><p>Now that we have met all the requirements, the steps are the same as installing Phalcon on Linux. First, use Git to pull the source code down to your computer and build the extension by issuing the following commands in the Terminal:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>git clone git://github.com/phalcon/phalcon.git</strong></span>
<span class="strong"><strong>cd cphalcon/build</strong></span>
<span class="strong"><strong>sudo ./install</strong></span>
</pre></div><p>Then, use the steps we went over in the <span class="emphasis"><em>Installing Phalcon on Windows</em></span> section of this chapter to locate your <code class="literal">php.ini</code> file. Once you have found your <code class="literal">php.ini</code> file, open it and add the following line to the very bottom of your file:</p><div class="informalexample"><pre class="programlisting">extension=phalcon.so</pre></div><p>Next, restart Apache and you're set.</p></div>
<div class="section" title="Installing Phalcon on FreeBSD"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Installing Phalcon on FreeBSD</h1></div></div></div><p>If you happen to be installing Phalcon on FreeBSD, you've got it easy. There<a id="id26" class="indexterm"/> is a port of Phalcon available. It can be<a id="id27" class="indexterm"/> installed with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>pkg_add -r phalcon</strong></span>
</pre></div><p>Or</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>export CFLAGS="-O2 -fno-delete-null-pointer-checks"cd/usr/ports/www/phalcon&amp;&amp; make install clean</strong></span>
</pre></div></div>
<div class="section" title="Optional Phalcon dependencies"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Optional Phalcon dependencies</h1></div></div></div><p>By now, you should have a <a id="id28" class="indexterm"/>working installation of Phalcon. But to use some of Phalcon's functionality, you may need to install one, some, or all of the<a id="id29" class="indexterm"/> following PHP extensions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">PDO</li><li class="listitem" style="list-style-type: disc">PDO/MySQL</li><li class="listitem" style="list-style-type: disc">PDO/PostgreSQL</li><li class="listitem" style="list-style-type: disc">PDO/SQLite</li><li class="listitem" style="list-style-type: disc">PDO/Oracle</li><li class="listitem" style="list-style-type: disc">mbstring</li><li class="listitem" style="list-style-type: disc">Mcrypt</li><li class="listitem" style="list-style-type: disc">openSSL</li><li class="listitem" style="list-style-type: disc">Mongo<a id="id30" class="indexterm"/></li></ul></div><p>You will only need these if you plan to use the functionality they provide. For the purposes of this book, you<a id="id31" class="indexterm"/> will need to make sure that you have the PDO, PDO/MySQL, Mcrypt, and mbstring extensions installed.</p></div>
<div class="section" title="Finding help"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Finding help</h1></div></div></div><p>Phalcon is constantly being improved, but every now and then, you may run into issues where the standard installation<a id="id32" class="indexterm"/> process may not work or you may run into other bugs. It is beyond the scope of this book to cover everything that could happen while installing or using Phalcon. To find help with issues like this, I suggest three places to look:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Phalcon's official forum: <a class="ulink" href="http://forum.phalconphp.com/">http://forum.phalconphp.com/</a><a id="id33" class="indexterm"/></li><li class="listitem" style="list-style-type: disc">Phalcon's bugtracker: <a class="ulink" href="https://github.com/phalcon/cphalcon/issues">https://github.com/phalcon/cphalcon/issues</a><a id="id34" class="indexterm"/></li><li class="listitem" style="list-style-type: disc">Phalcon's official documentation: <a class="ulink" href="http://docs.phalconphp.com/en/latest/">http://docs.phalconphp.com/en/latest/</a></li></ul></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Summary</h1></div></div></div><p>In this chapter, we learned how to choose the correct version of the Phalcon PHP extension for our operating system. We also learned how to install the extension on a multitude of systems. We edited our <code class="literal">php.ini</code> file so that Phalcon will now load with our PHP installation and become an integral part of the language.</p><p>In the next chapter, we will begin developing our Phalcon blog by putting together the skeleton structure of our site.</p></div></body></html>
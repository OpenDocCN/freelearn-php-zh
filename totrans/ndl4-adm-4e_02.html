<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer051">
<h1 class="chapter-number" id="_idParaDest-40" lang="en-GB"><a id="_idTextAnchor039"/>2</h1>
<h1 id="_idParaDest-41" lang="en-GB"><a id="_idTextAnchor040"/>Exploring the Moodle System</h1>
<p lang="en-GB">Now that your Moodle system is up and running, we will look at the components that make up the learning platform. Think of these as the foundation on which Moodle <span class="No-Break" lang="">is built.</span></p>
<p lang="en-GB">In this chapter, you will learn about the architecture of Moodle, what the main components of Moodle are, and where its data is stored. Moodle has a modern and intuitive user interface that takes a little bit of time to get used to. You will learn about its main navigation and where to find help if required. Dealing with files in web-based applications is not always straightforward. Therefore, you will learn how Moodle’s file management works and how to configure the <span class="No-Break" lang="">recycle bin.</span></p>
<p lang="en-GB">In this chapter, we will cover the <span class="No-Break" lang="">following topics:</span></p>
<ul>
<li lang="en-GB">Understanding the <span class="No-Break" lang="">Moodle architecture</span></li>
<li lang="en-GB">Navigating Moodle as <span class="No-Break" lang="">an administrator</span></li>
<li lang="en-GB">File management <span class="No-Break" lang="">in Moodle</span></li>
<li lang="en-GB"><span class="No-Break" lang="">Recycle bin</span></li>
</ul>
<p lang="en-GB">By the end of this chapter, you will know more about how Moodle is structured internally, how to work with it as an admin, and how files <span class="No-Break" lang="">are managed.</span></p>
<h1 id="_idParaDest-42" lang="en-GB"><a id="_idTextAnchor041"/>Understanding the Moodle architecture</h1>
<p lang="en-GB">First, we will <a id="_idIndexMarker087"/>look at the overall architecture on which Moodle is based before we cover the internal components of the LMS’s <span class="No-Break" lang="">application layer.</span></p>
<p lang="en-GB">We will take a top-down approach and look at the overall architecture first before zooming into how Moodle Core is structured. We will conclude at the lowest level, where we will be dealing with files and the <span class="No-Break" lang="">management thereof.</span></p>
<h2 id="_idParaDest-43" lang="en-GB"><a id="_idTextAnchor042"/>The LAMP architecture</h2>
<p lang="en-GB">Moodle has <a id="_idIndexMarker088"/>been developed on the open-source LAMP framework, which consists of Linux (operating system), Apache (web server), MySQL (database), and PHP (programming language). Due to the portability of these components and the modularity of Moodle itself (that’s what the “M” stands for), a wide range of operating systems, database systems, and web servers are supported. However, while Moodle runs on other technology stacks, we will focus on LAMP since it has proven the most popular setup among <span class="No-Break" lang="">Moodle administrators.</span></p>
<p lang="en-GB">The following diagram shows a simple overview of the <span class="No-Break" lang="">overall architecture:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer032">
<img alt="Figure 2.1 – Moodle’s overall architecture " height="782" src="image/Figure_2.01_B18779.jpg" width="1386"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.1 – Moodle’s overall architecture</p>
<p lang="en-GB">Let’s have a closer look at the components of Moodle’s <span class="No-Break" lang="">overall architecture:</span></p>
<ul>
<li lang="en-GB"><strong class="bold" lang="">Moodle Core</strong> is what <a id="_idIndexMarker089"/>is often referred to <a id="_idIndexMarker090"/>when people talk about Moodle. This is also what we installed in the previous chapter and will be covered in <span class="No-Break" lang="">this book.</span></li>
<li lang="en-GB"><strong class="bold" lang="">Moodle plugins</strong>: While Moodle Core is a powerful and comprehensive LMS, few sites <a id="_idIndexMarker091"/>solely rely on the base system. Instead, add-on modules supplement the feature set of standard Moodle to customize the platform <a id="_idIndexMarker092"/>to individual requirements. These add-ons are called Moodle plugins and are mostly community-contributed additions to standard Moodle, extending its functionality for a specific use case. At the time of writing, there are almost 2,000 (!) entries in <a id="_idIndexMarker093"/>the official Moodle plugins database <span class="No-Break" lang="">at </span><a href="http://moodle.org/plugins"><span class="No-Break" lang="">moodle.org/plugins</span></a><span class="No-Break" lang="">.</span></li>
</ul>
<p class="callout-heading" lang="en-GB">Important note</p>
<p class="callout" lang="en-GB"><strong class="bold" lang="">Moodle LMS</strong> is effectively <a id="_idIndexMarker094"/>standard Moodle plus – optionally – one or many <span class="No-Break" lang="">Moodle plugins.</span></p>
<p lang="en-GB">An exciting set of plugins has been made available by Moodle HQ. <strong class="bold" lang="">Moodle Workplace</strong> is a commercial <a id="_idIndexMarker095"/>offering designed for corporate and organizational training, resulting in a powerful and flexible platform for <a id="_idIndexMarker096"/>workplace learning. More information on Moodle Workplace can be found at <a href="http://moodle.com/workplace">moodle.com/workplace</a> or in the title <em class="italic" lang="">Corporate Learning with Moodle Workplace</em>, by <span class="No-Break" lang="">Packt Publishing.</span></p>
<ul>
<li lang="en-GB"><strong class="bold" lang="">PHP</strong> is the <a id="_idIndexMarker097"/>programming language in which Moodle is <a id="_idIndexMarker098"/>written (accompanied by HTML, JavaScript, and CSS files). It is the only component that cannot be replaced with any other counterpart. Specific PHP libraries must be installed – see <a href="B18779_01.xhtml#_idTextAnchor020"><span class="No-Break" lang=""><em class="italic" lang="">Chapter 1</em></span></a>, <span class="No-Break" lang=""><em class="italic" lang="">Installing Moodle</em></span><span class="No-Break" lang="">.</span></li>
<li lang="en-GB"><strong class="bold" lang="">MySQL</strong> is the <a id="_idIndexMarker099"/>database of choice for most opensource <a id="_idIndexMarker100"/>applications, but other systems, such as Microsoft SQL Server, Oracle, and PostgreSQL, are fully supported. MariaDB, a MySQL fork, has become very popular among Moodle administrators after Oracle <span class="No-Break" lang="">acquired MySQL.</span></li>
<li lang="en-GB"><strong class="bold" lang="">Apache</strong> has become <a id="_idIndexMarker101"/>the de facto standard for large-scale <a id="_idIndexMarker102"/>web applications, closely followed by Microsoft IIS. Both web servers are supported like any other that supports PHP, such as nginx. This book will focus on Apache, the most popular option for <span class="No-Break" lang="">Moodle setups.</span></li>
<li lang="en-GB"><strong class="bold" lang="">Operating system</strong>: The <a id="_idIndexMarker103"/>lowest level is <a id="_idIndexMarker104"/>the operating <a id="_idIndexMarker105"/>system. While <strong class="bold" lang="">Linux</strong> is the preferred platform – since this is where all code is developed and tested –other operating systems are also supported, such as Windows, Mac OS X, and various <span class="No-Break" lang="">Unix derivatives.</span></li>
</ul>
<p lang="en-GB">The following diagram shows the interaction among the elements in the <span class="No-Break" lang="">Moodle architecture:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer033">
<img alt="Figure 2.2 – Moodle’s interaction among underlying components " height="477" src="image/Figure_2.02_B18779.jpg" width="1642"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.2 – Moodle’s interaction among underlying components</p>
<p lang="en-GB">The user makes <a id="_idIndexMarker106"/>requests via the web browser interface or a mobile Moodle application. The web browser passes the request to the web server(s), which calls the PHP module responsible for the call. The PHP module calls the database(s) with an action (a query, update, insert, or delete operation) that returns the requested data. Based on this information, the PHP module returns data (usually in HTML or JavaScript) to the web server(s), which passes the information to be displayed back to the user’s browser <span class="No-Break" lang="">or application.</span></p>
<p lang="en-GB">The component of most interest to us is Moodle Core, which we will dive into in more <span class="No-Break" lang="">detail next.</span></p>
<h2 id="_idParaDest-44" lang="en-GB"><a id="_idTextAnchor043"/>Moodle Core</h2>
<p lang="en-GB">Now, let’s look <a id="_idIndexMarker107"/>at the Moodle Core layer in more detail. Moodle’s <a id="_idIndexMarker108"/>main building blocks are shown in the <span class="No-Break" lang="">following diagram:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer034">
<img alt="Figure 2.3 – Moodle’s building blocks " height="642" src="image/Figure_2.03_B18779.jpg" width="1155"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.3 – Moodle’s building blocks</p>
<p lang="en-GB">Moodle distinguishes between code (primarily written in PHP, HTML, and CSS) and data (mostly values and files added via the <span class="No-Break" lang="">Moodle interface).</span></p>
<p lang="en-GB">Moodle libraries, modules (such as resources and activities), blocks, plugins, admin tools, and other entities are represented in code. It is always stored in the filesystem in a Moodle directory referred to as <strong class="source-inline" lang="">dirroot</strong>, which was specified during the installation process in the previous chapter. The code includes all the elements that deal with the backend (server) and frontend (user <span class="No-Break" lang="">interface) operations.</span></p>
<p lang="en-GB">Moodle courses, users, roles, groups, competencies, learning plans, grades, and other data, such as learning resources added by educators, forum posts added by learners, and system settings added by the administrator, are mostly stored in the Moodle database. However, files such as user pictures or uploaded assignments are stored in another Moodle directory, known as <strong class="source-inline" lang="">moodledata</strong>, located in a directory called <strong class="source-inline" lang="">dataroot</strong>. Information about files (metadata such as the name, location, last modification, license, and size) is stored in the database, referencing the <span class="No-Break" lang="">respective files.</span></p>
<p class="callout-heading" lang="en-GB">Important note</p>
<p class="callout" lang="en-GB">Moodle manages its files internally, and it is important to stress that interfering with any files in <strong class="source-inline" lang="">moodledata</strong> will break <span class="No-Break" lang="">the application.</span></p>
<p lang="en-GB">Even copying <a id="_idIndexMarker109"/>a file from one folder to another or adding a file manually <a id="_idIndexMarker110"/>will break the consistency of your system, which means that further behavior cannot be predicted. Internally, Moodle uses a mechanism called SHA1 hashing. Moodle fully supports Unicode filenames and avoids redundant storage when the same file is used twice (even by different users). Again, you must not modify any Moodle files at the <span class="No-Break" lang="">system level!</span></p>
<p lang="en-GB">Now, let’s have a closer look at how the Moodle files area – the directory structure – <span class="No-Break" lang="">is organized.</span></p>
<h2 id="_idParaDest-45" lang="en-GB"><a id="_idTextAnchor044"/>Code and data locations</h2>
<p lang="en-GB">Though Moodle <a id="_idIndexMarker111"/>takes care of organizing its code and data, it is <a id="_idIndexMarker112"/>usually good to know where a file is located in your learning system, for example, when installing add-ons or manually <span class="No-Break" lang="">applying patches.</span></p>
<p lang="en-GB">System files – files required to run Moodle – are located in several directories under <strong class="source-inline" lang="">dirroot</strong> (the root directory of your Moodle installation). The following table shows the folder name, a brief description, and the chapter in which the topic is covered in <span class="No-Break" lang="">this book:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer035">
<img alt="Figure 2.4 – Code and data locations " height="656" src="image/Figure_2.04_B18779.jpg" width="1210"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.4 – Code and data locations</p>
<p lang="en-GB">The <strong class="source-inline" lang="">moodledata</strong> directory (<strong class="source-inline" lang="">dataroot</strong>) is <a id="_idIndexMarker113"/>organized <a id="_idIndexMarker114"/><span class="No-Break" lang="">as follows:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer036">
<img alt="Figure 2.5 – moodledata directories " height="520" src="image/Figure_2.05_B18779.jpg" width="1209"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.5 – moodledata directories</p>
<p lang="en-GB">If problems occur before carrying out an update, it is sometimes necessary to delete caching data and any temporary information Moodle has created. This data is located in the respective directories in the structure shown in the preceding table. In other words, once everybody has logged out, you can safely delete any files in the directories named <strong class="source-inline" lang="">cache</strong>, <strong class="source-inline" lang="">filter</strong>, <strong class="source-inline" lang="">localcache</strong>, <strong class="source-inline" lang="">lock</strong>, <strong class="source-inline" lang="">models</strong>, <strong class="source-inline" lang="">muc</strong>, <strong class="source-inline" lang="">sessions</strong>, <strong class="source-inline" lang="">temp</strong>, and <strong class="source-inline" lang="">trashdir</strong>. Purging can either be done ma<a id="_idTextAnchor045"/>nually or, better, via <strong class="bold" lang="">Site administration</strong> | <strong class="bold" lang="">Development</strong> | <strong class="bold" lang="">Purge caches</strong> | <strong class="bold" lang="">Purge all caches</strong> in the <span class="No-Break" lang="">Moodle interface.</span></p>
<p lang="en-GB">This concludes <a id="_idIndexMarker115"/>this section on the Moodle architecture, which dealt <a id="_idIndexMarker116"/>with the LAMP framework and Moodle’s main components before we drilled down to Moodle Core and the location of code and <span class="No-Break" lang="">data files.</span></p>
<h1 id="_idParaDest-46" lang="en-GB"><a id="_idTextAnchor046"/>Navigating Moodle as an administrator</h1>
<p lang="en-GB">In this section, you will learn how to work with Moodle, which covers the horizontal navigation <a id="_idIndexMarker117"/>of the site administration section and handy tools such as admin search, bookmarks, and access to various help and support sites <span class="No-Break" lang="">and channels.</span></p>
<p lang="en-GB">The essential navigational items for administrators are <span class="No-Break" lang="">as follows:</span></p>
<ul>
<li lang="en-GB"><strong class="bold" lang="">Site menu</strong>: The <a id="_idIndexMarker118"/>main menu across all pages; the <strong class="bold" lang="">Site administration</strong> item opens up the <span class="No-Break" lang="">admin menu.</span></li>
<li lang="en-GB"><strong class="bold" lang="">Admin menu</strong>: Access <a id="_idIndexMarker119"/>to all admin sections and subsections. As an administrator, you will be performing most tasks from here. We will cover all aspects of these menus and sub-menus throughout the remainder of <span class="No-Break" lang="">this book.</span></li>
<li lang="en-GB"><strong class="bold" lang="">User menu</strong>: Access <a id="_idIndexMarker120"/>to personal settings, such as the user profile, preferences, or the <span class="No-Break" lang="">selected language.</span></li>
<li lang="en-GB"><strong class="bold" lang="">Admin search</strong>: Search <a id="_idIndexMarker121"/>facility, which we will <span class="No-Break" lang="">cover later.</span></li>
<li lang="en-GB"><strong class="bold" lang="">Edit mode toggle</strong>: Switch <a id="_idIndexMarker122"/>between editing mode and <span class="No-Break" lang="">non-editing mode.</span></li>
<li lang="en-GB"><strong class="bold" lang="">Block drawer</strong>: Moodle <a id="_idIndexMarker123"/>blocks are placed here; edit mode must be activated to make changes to the <span class="No-Break" lang="">block drawer.</span></li>
</ul>
<p lang="en-GB">These navigation elements have been highlighted in the <span class="No-Break" lang="">following screenshot:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer037">
<img alt="Figure 2.6 – Moodle navigation " height="664" src="image/Figure_2.06_B18779.jpg" width="1651"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.6 – Moodle navigation</p>
<p lang="en-GB">The items <a id="_idIndexMarker124"/>displayed in the preceding screenshot might be different on your system. Depending on which features have been activated, the theme used, and your screen size, some admin menu items might move to the <strong class="bold" lang="">More</strong> dropdown, or the <strong class="bold" lang="">Language</strong> setting might appear in the <span class="No-Break" lang="">user menu.</span></p>
<p lang="en-GB">Moodle’s user interface has been built from the ground up in version 4 – gone is the breadcrumb trail, and previously omnipresent blocks have been downgraded to the block drawer. This redevelopment also impacts the navigational admin facilities, which we will <span class="No-Break" lang="">cover next.</span></p>
<h2 id="_idParaDest-47" lang="en-GB"><a id="_idTextAnchor047"/>Administrator search facility</h2>
<p lang="en-GB">A search <a id="_idIndexMarker125"/>facility is provided to help you identify any setting in the administration section, which is located above the <strong class="bold" lang="">Site administration</strong> menu (encircled in the <span class="No-Break" lang="">previous screenshot).</span></p>
<p lang="en-GB">Moodle displays the results in an expanded form when searching for any term that allows you to change settings immediately. For example, when searching for “calendar,” numerous sections appear as a result, which can be changed in each section straight away, rather than having to navigate to each separate section to <span class="No-Break" lang="">make changes.</span></p>
<p lang="en-GB">The search facility is also highly beneficial when upgrading from older versions of Moodle, where configuration settings have been reorganized, and their location is sometimes difficult <span class="No-Break" lang="">to trace.</span></p>
<p lang="en-GB">Next up are admin bookmarks, which can potentially reduce the usage of the admin <span class="No-Break" lang="">search facility.</span></p>
<h2 id="_idParaDest-48" lang="en-GB"><a id="_idTextAnchor048"/>Admin bookmarks</h2>
<p lang="en-GB">Bookmarks <a id="_idIndexMarker126"/>are shown in the <strong class="bold" lang="">Admin bookmarks</strong> block, which can be added by turning on <strong class="bold" lang="">Edit mode</strong>, opening the block drawer, and selecting the block from the <strong class="bold" lang="">Add a block</strong> list. They allow you to bookmark any admin menu to access regularly required pages easily. Select <strong class="bold" lang="">Bookmark this page</strong> to add a bookmark and <strong class="bold" lang="">Unbookmark this page</strong> to delete it. Moodle automatically displays the latter option when you are on a <span class="No-Break" lang="">bookmarked page:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer038">
<img alt="Figure 2.7 – Admin bookmarks " height="597" src="image/Figure_2.07_B18779.jpg" width="629"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.7 – Admin bookmarks</p>
<p lang="en-GB">In the preceding screenshot, two pages have already been bookmarked (<strong class="bold" lang="">Browse list of users</strong> and <strong class="bold" lang="">Custom reports</strong>), and the mentioned link is provided to unbookmark the <span class="No-Break" lang="">current marker.</span></p>
<p lang="en-GB">Admin search and bookmarks are useful when you know what you are looking for. Next up is Moodle Docs, which assists you when you are stuck with a feature or require <span class="No-Break" lang="">further support.</span></p>
<h2 id="_idParaDest-49" lang="en-GB"><a id="_idTextAnchor049"/>Moodle Docs and help</h2>
<p lang="en-GB">The entire <a id="_idIndexMarker127"/>Moodle documentation is online at <a href="http://docs.moodle.org">docs.moodle.org</a>. If you wish to provide your own documentation, modify the <strong class="bold" lang="">Moodle Docs document root</strong> setting by going to <strong class="bold" lang="">Site administration</strong> | <strong class="bold" lang="">Appearance</strong> | <strong class="bold" lang="">Moodle Docs</strong>. You can also select the <strong class="bold" lang="">Language for docs used</strong> option in links for the documentation pages and enable the <strong class="bold" lang="">Open in new window</strong> option on <span class="No-Break" lang="">this screen.</span></p>
<p lang="en-GB">At the bottom of each page, you will see a <strong class="bold" lang="">Support icon</strong>. Once selected, it will display the following <span class="No-Break" lang="">help-related links:</span></p>
<ul>
<li lang="en-GB"><strong class="bold" lang="">Help and documentation</strong>: Reference to the relevant page in <span class="No-Break" lang="">Moodle Docs.</span></li>
<li lang="en-GB"><strong class="bold" lang="">Services and support</strong>: Link to <a href="http://moodle.com/help">moodle.com/help</a>, where professional services from Moodle Certified Service Providers <span class="No-Break" lang="">are offered.</span></li>
<li lang="en-GB"><strong class="bold" lang="">Contact site support</strong>: The standard email client will be opened, and the recipient of the support contact will be filled in. You can change the support email address by going to <strong class="bold" lang="">Site administration</strong> | <strong class="bold" lang="">Server</strong> | <strong class="bold" lang="">Support contact</strong>. This feature is more relevant to your users rather than to you as <span class="No-Break" lang="">an administrator.</span></li>
</ul>
<p lang="en-GB">In addition to the online documentation, some features provide inline help, indicated by a question mark symbol. When clicked, a help window will appear to provide assistance that’s relevant to the respective topic <span class="No-Break" lang="">or setting:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer039">
<img alt="Figure 2.8 – Moodle help " height="1286" src="image/Figure_2.08_B18779.jpg" width="1635"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.8 – Moodle help</p>
<p lang="en-GB">For instance, when <a id="_idIndexMarker128"/>clicking on the <strong class="bold" lang="">Help and documentation</strong> link in the <strong class="bold" lang="">Upload users</strong> section, the following article will be opened: <a href="http://docs.moodle.org/400/en/Upload_users">docs.moodle.org/400/en/Upload_users</a>. For each version of Moodle, separate Moodle Docs are published. The preceding link is from version 4.0, where documentation for most pages exists in <span class="No-Break" lang="">different languages.</span></p>
<p lang="en-GB">When you access certain pages for the first time, Moodle will display a so-called user tour. For example, when you navigate to <strong class="bold" lang="">My courses</strong>, the following popup will <span class="No-Break" lang="">be displayed:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer040">
<img alt="Figure 2.9 – User tour " height="894" src="image/Figure_2.09_B18779.jpg" width="742"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.9 – User tour</p>
<p lang="en-GB">We will <a id="_idIndexMarker129"/>cover user tours in detail in <a href="B18779_07.xhtml#_idTextAnchor140"><span class="No-Break" lang=""><em class="italic" lang="">Chapter 7</em></span></a>, <em class="italic" lang="">Enhancing Moodle’s Look </em><span class="No-Break" lang=""><em class="italic" lang="">and Feel</em></span><span class="No-Break" lang="">.</span></p>
<p lang="en-GB">The Moodle community is growing continuously and, at the time of writing, has well over 1 million registered users (yes, that’s 1 million!), of which over 5% are active. If you cannot find a solution to your Moodle problems in Moodle Docs, use the <strong class="bold" lang="">Search</strong> functionality at the top of the screen at <a href="http://moodle.org">moodle.org</a>. In order of priority, the search brings forth the <a id="_idIndexMarker130"/>already mentioned Moodle Docs, the most active user forums, and the Moodle Tracker, which keeps track of all issues and feature requests (<a href="http://tracker.moodle.org">tracker.moodle.org</a>). A search in Moodle forums can often result in a large number of links. Use the <strong class="bold" lang="">Advanced search</strong> area in the <strong class="bold" lang="">Search forums</strong> block to narrow the search space. If you still cannot find the solution to your problem, which is relatively rare, post a question on the relevant forum; somebody is likely to assist <span class="No-Break" lang="">you further.</span></p>
<p lang="en-GB">A popular site that might <a id="_idIndexMarker131"/>also be of interest is Moodle Academy (<a href="http://moodle.academy">moodle.academy</a>), which includes an administrator learning pathway covering short, self-paced courses on basic <span class="No-Break" lang="">Moodle administration.</span></p>
<p lang="en-GB">This concludes <a id="_idIndexMarker132"/>this section on navigating Moodle, which introduced you to the site administration menu and various helpful tools such as admin search, admin bookmarks, and <span class="No-Break" lang="">Moodle Docs.</span></p>
<h1 id="_idParaDest-50" lang="en-GB"><a id="_idTextAnchor050"/>File management in Moodle</h1>
<p lang="en-GB">This section is all about files: how to access them, how they are organized in folders, how to <a id="_idIndexMarker133"/>upload them, how to configure private files, the difference between copying and linking, file types, increasing the upload file limit, and how to deal with deleted files via the recycle bin. This is a lot to take in, so let’s <span class="No-Break" lang="">get started.</span></p>
<p lang="en-GB">Dealing with files in web-based applications is not always straightforward. While Moodle provides a user interface to perform this task, it is sometimes necessary that, as the administrator, you will have to bypass this mechanism and use other means. First, let’s look at the built-in file handling that students and teachers <span class="No-Break" lang="">also use.</span></p>
<h2 id="_idParaDest-51" lang="en-GB"><a id="_idTextAnchor051"/>Moodle file management interface</h2>
<p lang="en-GB">Moodle offers <a id="_idIndexMarker134"/>a basic file management interface that lets you upload, move, delete, and rename files and directories. It is also possible to copy or link to files from third-party services such as Dropbox; on the same note, Moodle isn’t a content <span class="No-Break" lang="">management system.</span></p>
<p lang="en-GB">We have already talked about how Moodle stores files at the system level—the ones we shouldn’t touch! At the application level, it arranges files according to <span class="No-Break" lang="">Moodle’s structure:</span></p>
<p class="callout-heading" lang="en-GB">Important note</p>
<p class="callout" lang="en-GB">In Moodle, a file is always connected to the particular bit of Moodle that <span class="No-Break" lang="">uses it.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer041">
<img alt="Figure 2.10 – Moodle files " height="512" src="image/Figure_2.10_B18779.jpg" width="1191"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.10 – Moodle files</p>
<p lang="en-GB">Files are <a id="_idIndexMarker135"/>organized in a tree-like structure, which has three types of <span class="No-Break" lang="">main branches:</span></p>
<ul>
<li lang="en-GB">Categories/Courses/Activities <span class="No-Break" lang="">and Resources</span></li>
<li lang="en-GB">Users (private files and <span class="No-Break" lang="">personal backups)</span></li>
<li lang="en-GB">Site home (Moodle’s <span class="No-Break" lang="">front page)</span></li>
</ul>
<p lang="en-GB">We will be dealing with all those concepts at later stages, so, for now, let’s just take them for granted. Courses are arranged in categories (and subcategories) and consist of activities and resources, and there are usually further subdirectories inside activities <span class="No-Break" lang="">and resources.</span></p>
<p lang="en-GB">There are multiple users on your system, each with a dedicated file area that can be accessed from anywhere in Moodle, but there is only a single Site Home. Remember, a file is always connected to the particular bit of Moodle content that uses it, reflected by the <span class="No-Break" lang="">directory-like structure:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer042">
<img alt="Figure 2.11 – Moodle folders " height="1326" src="image/Figure_2.11_B18779.jpg" width="1310"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.11 – Moodle folders</p>
<p lang="en-GB">Now that <a id="_idIndexMarker136"/>we know how files and folders are organized, let’s look at how to upload data and <span class="No-Break" lang="">create directories.</span></p>
<h2 id="_idParaDest-52" lang="en-GB"><a id="_idTextAnchor052"/>Uploading files</h2>
<p lang="en-GB">Uploading files <a id="_idIndexMarker137"/>usually takes place via drag and drop. While this feature is vital for learners and trainers, as an administrator, you will also have to upload files from time to time, for instance, uploading users in batch mode via a <span class="No-Break" lang="">CSV file.</span></p>
<p lang="en-GB">Adding single or multiple files is straightforward: simply select the files in your Explorer (Windows) or Finder (Mac) and drag them onto the provided area inside the dotted lines shown in the <span class="No-Break" lang="">following screenshot:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer043">
<img alt="Figure 2.12 – Moodle files and folders " height="804" src="image/Figure_2.12_B18779.jpg" width="1639"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.12 – Moodle files and folders</p>
<p lang="en-GB">When you <a id="_idIndexMarker138"/>click on a file once it has been uploaded, you have the option to <strong class="bold" lang="">Download</strong> or <strong class="bold" lang="">Delete</strong> the file. If the selected file is a compressed archive, you have the option to <strong class="bold" lang="">Unzip</strong> it. Additionally, meta-information about the file (name, author, license, path, icon, last modified, created, and size) is displayed at the bottom of the window, as shown in the <span class="No-Break" lang="">following screenshot:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer044">
<img alt="Figure 2.13 – Moodle file details " height="973" src="image/Figure_2.13_B18779.jpg" width="955"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.13 – Moodle file details</p>
<p lang="en-GB">For some file operations, it is necessary <a id="_idIndexMarker139"/>to use the <strong class="bold" lang="">File picker</strong>, a tool utilized <a id="_idIndexMarker140"/>whenever files have to be added to a particular object in Moodle. A user can choose from multiple file sources, known as repositories. The File picker can be accessed using the <strong class="bold" lang="">Add…</strong> button at the top left of the files area. We will be dealing with repositories in <a href="B18779_10.xhtml#_idTextAnchor204"><span class="No-Break" lang=""><em class="italic" lang="">Chapter 10</em></span></a>, <em class="italic" lang="">Configuring </em><span class="No-Break" lang=""><em class="italic" lang="">Technical Features</em></span><span class="No-Break" lang="">.</span></p>
<p lang="en-GB">Closely related to uploading files is configuring the <span class="No-Break" lang="">upload limit.</span></p>
<h2 id="_idParaDest-53" lang="en-GB"><a id="_idTextAnchor053"/>Upload limit</h2>
<p lang="en-GB">Your site <a id="_idIndexMarker141"/>has a file upload limit set to 2 MB by default. If you need to support files larger than the 2 MB threshold, you will have to increase <span class="No-Break" lang="">the limit.</span></p>
<p lang="en-GB">In your <strong class="source-inline" lang="">php.ini</strong> file (find its location using the <strong class="source-inline" lang="">php -i</strong> command and locate the <strong class="source-inline" lang="">Loaded Configuration File</strong> entry), modify the following two lines; <strong class="source-inline" lang="">&lt;value&gt;</strong> represents the maximum limit (multiple input formats are supported, for example, 20M <span class="No-Break" lang="">or 20971520):</span></p>
<ul>
<li lang="en-GB"><strong class="source-inline" lang="">upload_max_filesize = &lt;</strong><span class="No-Break" lang=""><strong class="source-inline" lang="">value&gt;</strong></span></li>
<li lang="en-GB"><strong class="source-inline" lang="">post_max_size = &lt;</strong><span class="No-Break" lang=""><strong class="source-inline" lang="">value&gt;</strong></span></li>
</ul>
<p lang="en-GB">If you don’t have access to the <strong class="source-inline" lang="">php.ini</strong> file, create a <strong class="source-inline" lang="">.htaccess</strong> file in your main Moodle directory and add the following <span class="No-Break" lang="">two lines:</span></p>
<ul>
<li lang="en-GB"><strong class="source-inline" lang="">php_value upload_max_filesize = &lt;</strong><span class="No-Break" lang=""><strong class="source-inline" lang="">value&gt;</strong></span></li>
<li lang="en-GB"><strong class="source-inline" lang="">php_value post_max_size = &lt;</strong><span class="No-Break" lang=""><strong class="source-inline" lang="">value&gt;</strong></span></li>
</ul>
<p lang="en-GB">You will also have to increase the <strong class="source-inline" lang="">LimitRequestBody</strong> parameter on some systems, usually found in the Apache <strong class="source-inline" lang="">httpd.conf</strong> configuration file. You may also need to modify your database configuration, such as the <span class="No-Break" lang=""><strong class="source-inline" lang="">max_allowed_packet</strong></span><span class="No-Break" lang=""> size:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer045">
<img alt="Figure 2.14 – Moodle upload limit " height="363" src="image/Figure_2.14_B18779.jpg" width="1576"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.14 – Moodle upload limit</p>
<p lang="en-GB">Once these changes have been applied, ensure the <strong class="bold" lang="">Maximum upload file size</strong> parameter under <strong class="bold" lang="">Site administration</strong> | <strong class="bold" lang="">Security</strong> | <strong class="bold" lang="">Site security settings</strong> has been set to <strong class="bold" lang="">Site upload limit</strong>. You can also change the user quota for private files via the <strong class="bold" lang="">Private file space</strong> parameter. When changing these two values, bear in mind that they will potentially impact the bandwidth and disk <span class="No-Break" lang="">space, respectively.</span></p>
<p lang="en-GB">For very <a id="_idIndexMarker142"/>large files such as high-quality learning resources, it would be helpful to be able to upload the content via (secure) FTP and then use the built-in unzip functionality in the File picker. However, it is not possible to upload files directly via FTP. Instead, you have to make use of the filesystem repository, which will be discussed in detail in <a href="B18779_10.xhtml#_idTextAnchor204"><span class="No-Break" lang=""><em class="italic" lang="">Chapter 10</em></span></a>, <em class="italic" lang="">Configuring </em><span class="No-Break" lang=""><em class="italic" lang="">Technical Features</em></span><span class="No-Break" lang="">.</span></p>
<p lang="en-GB">Now that you are familiar with uploading files, let’s deal with personal files that belong to <span class="No-Break" lang="">individual users.</span></p>
<h2 id="_idParaDest-54" lang="en-GB"><a id="_idTextAnchor054"/>Private files</h2>
<p lang="en-GB">Every user has an area where personal files can be stored and managed. These are only visible to <a id="_idIndexMarker143"/>the user to whom the private files belong. Any item stored in this protected area can be used throughout the site. Private files can be accessed via the File picker, the <strong class="bold" lang="">Private files</strong> block, or directly via the <strong class="bold" lang="">Private files</strong> link in the <span class="No-Break" lang="">user menu:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer046">
<img alt="Figure 2.15 – Moodle File picker " height="534" src="image/Figure_2.15_B18779.jpg" width="822"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.15 – Moodle File picker</p>
<p lang="en-GB">Handling files and directories is identical to handling other files. However, you might have spotted the <strong class="bold" lang="">Link</strong> icon in the PDF file in the preceding screenshot, which leads us nicely to the <span class="No-Break" lang="">following subsection.</span></p>
<h2 id="_idParaDest-55" lang="en-GB"><a id="_idTextAnchor055"/>To link or to copy?</h2>
<p lang="en-GB">By default, files in Moodle are copied. When you add a file from a source (for instance, your <a id="_idIndexMarker144"/>computer or your private files), it will be copied, which means that the source and the resulting file will be logically separated. For example, if you <a id="_idIndexMarker145"/>have stored an image in your private files and you use this in three different courses, there are three logical copies. The three images will not be affected if you change the source in your <span class="No-Break" lang="">private files.</span></p>
<p lang="en-GB">Moodle also supports linking files, also known as file aliases. Let’s stick to the same example, but this time round, the three images are linked. If the source is changed, the three files in the courses will also have changed. Beware that there are some access restrictions with linked files; for example, instructor A might not be able to link to instructor <span class="No-Break" lang="">B’s file.</span></p>
<p lang="en-GB">When you select a file from a source (repository) that supports linking, an option is provided to <strong class="bold" lang="">Link to </strong><span class="No-Break" lang=""><strong class="bold" lang="">the file</strong></span><span class="No-Break" lang="">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer047">
<img alt="Figure 2.16 – Moodle files – copy and link " height="970" src="image/Figure_2.16_B18779.jpg" width="889"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.16 – Moodle files – copy and link</p>
<p lang="en-GB">Moodle keeps <a id="_idIndexMarker146"/>track of linked files and guarantees <a id="_idIndexMarker147"/>that inconsistencies <span class="No-Break" lang="">cannot occur:</span></p>
<ul>
<li lang="en-GB">When deleting a linked file, copies of the file will be created for <span class="No-Break" lang="">each link</span></li>
<li lang="en-GB">When a linked file is overwritten, all links <span class="No-Break" lang="">are updated</span></li>
<li lang="en-GB">When a file overwrites a link, the files <span class="No-Break" lang="">are “separated”</span></li>
</ul>
<p lang="en-GB">Linking and copying are about how files are being dealt with internally; next up are file types, which dictate how they are dealt with when users <span class="No-Break" lang="">download them.</span></p>
<h2 id="_idParaDest-56" lang="en-GB"><a id="_idTextAnchor056"/>File types</h2>
<p lang="en-GB">Moodle does not restrict which types of files users can upload, for instance, an assignment <a id="_idIndexMarker148"/>in a course. Moodle comes with predefined values for the most popular file types in terms of the icon displayed and the program that will be opened, for example, PDF files or PowerPoint documents. However, as depicted in the following screenshot, you can add new file types and view, modify, and delete existing file types by going to <strong class="bold" lang="">Site administration</strong> | <strong class="bold" lang="">Server</strong> | <span class="No-Break" lang=""><strong class="bold" lang="">File types</strong></span><span class="No-Break" lang="">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer048">
<img alt="Figure 2.17 – Moodle file types " height="585" src="image/Figure_2.17_B18779.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.17 – Moodle file types</p>
<p lang="en-GB">When you add a new file type via the button at the bottom of the screen, you must provide the file’s <strong class="bold" lang="">Extension</strong> and its <strong class="bold" lang="">MIME type</strong>. Furthermore, you have the option to select <strong class="bold" lang="">File icon</strong>, <strong class="bold" lang="">Type groups</strong> (such as image or document), <strong class="bold" lang="">Description type</strong>, <strong class="bold" lang="">Custom description</strong> (if <strong class="bold" lang="">Description type</strong> is <strong class="bold" lang="">Custom description specified in this form</strong>), <strong class="bold" lang="">Alternative language string</strong> (if selected in <strong class="bold" lang="">Description type</strong>) and <strong class="bold" lang="">Default icon for </strong><span class="No-Break" lang=""><strong class="bold" lang="">MIME type</strong></span><span class="No-Break" lang="">.</span></p>
<p lang="en-GB">So far, we have <a id="_idIndexMarker149"/>covered how files are stored, organized, and added to Moodle. Now, let’s look at what happens when files are deleted (<span class="No-Break" lang="">by accident).</span></p>
<h1 id="_idParaDest-57" lang="en-GB"><a id="_idTextAnchor057"/>Recycle bin</h1>
<p lang="en-GB">As an administrator, we have all been there: a user has deleted a file, an assignment with all its submissions, or even an entire course – all by accident, of course, and usually very <a id="_idIndexMarker150"/>close to an urgent deadline. Recovering the lost data is, as always, the highest priority, and you will spend the next hour or so trawling through last night’s backup to help out your <span class="No-Break" lang="">panicking colleague.</span></p>
<p lang="en-GB">To avoid scenarios like the ones described, Moodle provides a recycle bin, allowing users to retrieve course elements and courses that were mistakenly deleted. The feature is turned on by default, but you have a range of options to configure the tool’s behavior as <span class="No-Break" lang="">an administrator.</span></p>
<p lang="en-GB">To access the <strong class="bold" lang="">Recycle bin</strong> configuration, navigate to <strong class="bold" lang="">Site administration</strong> | <strong class="bold" lang="">Plugins</strong> | <strong class="bold" lang="">Admin tools</strong> | <strong class="bold" lang="">Recycle bin</strong>, where you will see three groups <span class="No-Break" lang="">of settings:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer049">
<img alt="Figure 2.18 – Moodle’s Recycle bin settings " height="740" src="image/Figure_2.18_B18779.jpg" width="1339"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.18 – Moodle’s Recycle bin settings</p>
<p lang="en-GB">The <strong class="bold" lang="">Recycle bin</strong> options <a id="_idIndexMarker151"/>are <span class="No-Break" lang="">as follows:</span></p>
<ul>
<li lang="en-GB">The <strong class="bold" lang="">Enable course recycle bin</strong> option collects any deleted resources and activities inside a course. The items will be kept for the period set in the <strong class="bold" lang="">Item </strong><span class="No-Break" lang=""><strong class="bold" lang="">lifetime</strong></span><span class="No-Break" lang=""> parameter.</span></li>
<li lang="en-GB">The <strong class="bold" lang="">Enable category recycle bin</strong> option collects any deleted courses inside a category. The courses will be kept for the period set in the <strong class="bold" lang="">Course </strong><span class="No-Break" lang=""><strong class="bold" lang="">lifetime</strong></span><span class="No-Break" lang=""> parameter.</span></li>
<li lang="en-GB">When the <strong class="bold" lang="">Auto hide</strong> checkbox is selected, the corresponding menu item will only be shown if the user’s bin contains any elements; otherwise, it will be hidden from the <strong class="bold" lang="">More</strong> menu in the course <span class="No-Break" lang="">or category.</span></li>
</ul>
<p lang="en-GB">Items and courses will be purged permanently from the recycle bin when the respective lifetime expiry dates have passed. The life cycle of a deleted course item or a course category is depicted in the <span class="No-Break" lang="">following diagram:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer050">
<img alt="Figure 2.19 – Moodle Recycle bin " height="670" src="image/Figure_2.19_B18779.jpg" width="1209"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.19 – Moodle Recycle bin</p>
<p lang="en-GB">Initially, the recycle <a id="_idIndexMarker152"/>bin is empty or may already contain removed items or courses (in our example, two). When an element is deleted, it is moved to the user’s recycle bin, which can either be restored or purged permanently. Suppose, in the meantime, the specified lifetime of the element has expired. In that case, the file or course will be deleted permanently, alongside any other elements where the expiry date has also <span class="No-Break" lang="">been reached.</span></p>
<p lang="en-GB">As mentioned previously, the recycle bin works out of the box; if yours doesn’t function as expected, double-check <a id="_idIndexMarker153"/>the following <span class="No-Break" lang="">three configurations:</span></p>
<ul>
<li lang="en-GB">Most processes of the recycle bin are kicked off by the cron process, for example, the regular purging mechanism we just mentioned. Therefore, it is crucial that the cron process is set up correctly and runs every minute (see the dedicated <em class="italic" lang="">Setting up the cron process</em> section in <a href="B18779_01.xhtml#_idTextAnchor020"><span class="No-Break" lang=""><em class="italic" lang="">Chapter 1</em></span></a>, <span class="No-Break" lang=""><em class="italic" lang="">Installing Moodle</em></span><span class="No-Break" lang="">).</span></li>
<li lang="en-GB">Internally, the recycle bin uses Moodle’s backup and restore functionality. In particular, the following two settings have to be enabled on the <strong class="bold" lang="">Automated backup setup</strong> page: <strong class="bold" lang="">Include activities and resources</strong> (<strong class="source-inline" lang="">backup_auto_activities</strong>) and <strong class="bold" lang="">Automated backup setup</strong> (<strong class="source-inline" lang="">backup_auto_users</strong>). Additionally, <strong class="bold" lang="">General restore defaults</strong> (<strong class="source-inline" lang="">restore_general_users</strong>) must be ticked on the <strong class="bold" lang="">General restore</strong> defaults page. You can find more detailed information on these settings in <a href="B18779_16.xhtml#_idTextAnchor308"><span class="No-Break" lang=""><em class="italic" lang="">Chapter 16</em></span></a>, <em class="italic" lang="">Avoiding Sleepless Nights – Moodle Backup </em><span class="No-Break" lang=""><em class="italic" lang="">and Restore</em></span><span class="No-Break" lang="">.</span></li>
<li lang="en-GB">If your users <a id="_idIndexMarker154"/>experience difficulties working with the recycle bin, ensure none of the required capabilities have been revoked from their roles. These are <strong class="bold" lang="">tool/recyclebin:viewitems</strong>, <strong class="bold" lang="">tool/recyclebin:restoreitems</strong>, and <strong class="bold" lang="">tool/recyclebin:deleteitems</strong>. More on roles and capabilities will be provided in <a href="B18779_06.xhtml#_idTextAnchor116"><span class="No-Break" lang=""><em class="italic" lang="">Chapter 6</em></span></a>, <em class="italic" lang="">Managing Permissions, Roles, </em><span class="No-Break" lang=""><em class="italic" lang="">and Capabilities</em></span><span class="No-Break" lang="">.</span></li>
</ul>
<p lang="en-GB">Learning how to use the recycle bin concludes this section on files and the <span class="No-Break" lang="">management thereof.</span></p>
<h1 id="_idParaDest-58" lang="en-GB"><a id="_idTextAnchor058"/>Summary</h1>
<p lang="en-GB">In this chapter, we learned what the building blocks of Moodle Core look like and where they are located. Furthermore, we looked at the new intuitive user interface in an administrator’s context. Lastly, we dealt with files, folders, and the <span class="No-Break" lang="">recycle bin.</span></p>
<p lang="en-GB">As we learned in the previous chapter, Moodle can be installed on multiple operating systems, supports a wide range of databases, and can be used with different web servers. Due to the openness of Moodle, all its components can be accessed without any restrictions. Similarly, any type of file can be handled in Moodle, regardless of its type or size. An intuitive and modern user interface accompanies this setup for learners, educators, <span class="No-Break" lang="">and administrators.</span></p>
<p lang="en-GB">Now that your system is up and running and you know what its insides look like, it’s time to deal with courses, users, and roles in the <span class="No-Break" lang="">next chapter.</span></p>
</div>
</div></body></html>
<html><head></head><body><div class="chapter" title="Chapter&#xA0;7.&#xA0;jQuery"><div class="titlepage"><div><div><h1 class="title"><a id="ch07"/>Chapter 7. jQuery</h1></div></div></div><p>I find <span class="strong"><strong>jQuery</strong></span> to be one of the coolest things in web development. I was doing some self study, following the hours of the <a id="id557" class="indexterm"/>class I mentioned, at the wonderful university town of Leuven, which had an equally wonderful computer book store. This is where I discovered jQuery.</p><p>Every chapter that follows relies/depends on, and uses, jQuery so it is very important to know jQuery well from the get go. So, what exactly is jQuery? It is a popular JavaScript library, and the overall benefit of using it is that you can write cleaner, more compact code.</p><p>So, what is a library? Well, it can <a id="id558" class="indexterm"/>be a place with a lot of books in it. I, myself, like the one of the Plantijn-Moretus Museum in Antwerp, where they all printed their books themselves centuries ago. Rubens was the illustrator and house portraitist. UNIX and Java folks think of libraries as already compiled code, typically containing predefined functions, which are placed in a file of a special format and can be loaded with the program itself. JavaScript libraries also can contain predefined functions, but, other than that, they just contain readable JavaScript code.</p><p>Most JavaScript libraries come in two formats, regular or minimized, typically called <code class="literal">name.js</code> and <code class="literal">name.min.js</code>. Those minimized versions have all spaces, new lines, and so on, stripped out to make them smaller, and thus reduce download time. To use them, you can simply include them with your program.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>jQuery uses CSS style selectors, which we already know from <a class="link" href="ch03.html" title="Chapter 3. CSS">Chapter 3</a>, <span class="emphasis"><em>CSS</em></span>, to access DOM elements. Besides allowing you to write JavaScript code faster and cleaner, jQuery will take care of certain things, such as workarounds for browser incompatibilities, so you no longer have to write these yourself.</p></div></div><div class="section" title="Obtaining the jQuery library"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec57"/>Obtaining the jQuery library</h1></div></div></div><p>You can always download jQuery<a id="id559" class="indexterm"/> from <a class="ulink" href="http://jquery.com">jquery.com</a>. You may want to use the minimized version once you go to production. During development, I would stay with the easier to read version so that you can, from time to time, add code for debugging purposes, as long as you do not forget to<a id="id560" class="indexterm"/> remove it later on.</p></div></div>
<div class="section" title="Where to place the jQuery library on your page?"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec58"/>Where to place the jQuery library on your page?</h1></div></div></div><p>Not everyone agrees <a id="id561" class="indexterm"/>on what the right thing to do here is. There is always a concern about the amount of time it takes to load a file. There is going to be a difference if you put the statement in the <code class="literal">&lt;head&gt;</code> section of your document or right before the closing <code class="literal">&lt;/body&gt;</code> tag to load the jQuery library - for example:</p><div class="informalexample"><pre class="programlisting">&lt;script src="./js/jquery/jquery.js"&gt;&lt;/script&gt;</pre></div><p>The concern is the time it takes to load the library. I sometimes place everything that is a library, in other words, something that delivers functionality without actually doing anything, in the head section of the file. This means that the functionality will be loaded before the HTML.</p><p>You will always use jQuery in conjunction with your own JavaScript file, for example, <code class="literal">mycode.js</code>. This file will contain your jQuery lines of code inside the following:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function(){
  }</pre></div><p>All the code you put there will be executed after your page is loaded. As a consequence, this file needs to be placed in your file after all the HTML that makes up your page, preferably right before the closing <code class="literal">&lt;/body&gt;</code> tag:</p><div class="informalexample"><pre class="programlisting">&lt;script type="text/javascript" src="./js/mycode.js"&gt;&lt;/script&gt;</pre></div></div>
<div class="section" title="jQuery UI and jQuery Mobile"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec59"/>jQuery UI and jQuery Mobile</h1></div></div></div><p>
<span class="strong"><strong>jQuery UI</strong></span> and <span class="strong"><strong>jQuery Mobile</strong></span> are two<a id="id562" class="indexterm"/> additional libraries of the jQuery family. jQuery <span class="strong"><strong>User Interface</strong></span> (<span class="strong"><strong>UI</strong></span>) offers you a <a id="id563" class="indexterm"/>number of widgets that you can use in the user interface part of your site. My favorite ones are <code class="literal">accordion</code> and <code class="literal">datepicker</code>. Unlike jQuery itself, which is JavaScript only, jQuery UI also comes with a whole bunch of CSS files. This means that as soon as you use one of those widgets, they will have their own look and feel.</p><p>Not to worry, jQuery provides a cool tool called<a id="id564" class="indexterm"/> <span class="strong"><strong>Themeroller</strong></span>. With this tool, you can generate a customized set of CSS files so that the colors and other look and feel features of the jQuery UI elements match those of your own stylesheets.</p><p>jQuery mobile is another jQuery based CSS/JavaScript extension that offers you user interface elements to create<a id="id565" class="indexterm"/> <span class="strong"><strong>mobile first</strong></span> sites and applications. You can create web pages that will work on phones, tablets, and desktops. We will dedicate an entire chapter to mobile first, and then responsive design later in this book. For now, take away that jQuery Mobile is a framework that allows you<a id="id566" class="indexterm"/> to take advantage of the hardware and gadgets of your phone in your web app, such as having a datepicker that behaves in the same way you set your alarm on your phone, automatically dialing the phone number that is on a web page<a id="id567" class="indexterm"/> by clicking on it, and so on.</p><p>We are not going to use jQuery Mobile in this book. Instead, we will present a different CSS/JavaScript framework called<a id="id568" class="indexterm"/> <span class="strong"><strong>Foundation</strong></span>.</p></div>
<div class="section" title="Using jQuery selectors and methods"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec60"/>Using jQuery selectors and methods</h1></div></div></div><p>One of the things that make jQuery so easy to use is that you can use CSS style selectors to look for elements in <a id="id569" class="indexterm"/>your page. So rather than having to learn more JavaScript methods, you just use what you already know. In real code, this means instead of using the following:</p><div class="informalexample"><pre class="programlisting">var content = document.getElementById("content");</pre></div><p>You can use:</p><div class="informalexample"><pre class="programlisting">var content = $('#content');</pre></div><p>
<code class="literal">$ ()</code> is a shorthand notation for <code class="literal">jQuery()</code>. If you use jQuery together with a similar library, such as <code class="literal">Dojo</code>, check the documentation on how to keep the two apart.</p><p>The above statement will create a jQuery object, which will contain zero or one DOM elements (because there can only be one element with the <code class="literal">id</code> content). The next statement can potentially contain a lot more elements, as many as there are with the class <code class="literal">green</code>:</p><div class="informalexample"><pre class="programlisting">var greens = $('.green');</pre></div><p>As you can tell, this is the same as in CSS, <code class="literal">#</code> for an <code class="literal">id</code>, <code class="literal">.</code> for a class.</p><p>Now we can start using methods. What if we wanted to change all elements of the class <code class="literal">green</code> to be of the class <code class="literal">yellow</code>? For this purpose, we can use the <code class="literal">addClass</code> method:</p><div class="informalexample"><pre class="programlisting">$('green').addClass('yellow');</pre></div><p>Of course, you probably want to replace green with yellow, so the class <code class="literal">green</code> has to be removed as well, for which you can use the <code class="literal">removeClass</code> method. One of the great features of jQuery methods is that you can nest them, so we can do all of these things in a single line of code:</p><div class="informalexample"><pre class="programlisting">$('green').removeClass('green').addClass('yellow');</pre></div><p>We will now walk<a id="id570" class="indexterm"/> you through a number of very useful methods that you can use to change your web page on the fly, or to figure out what is on the page right now. Most of these are <span class="emphasis"><em>getters</em></span> as well as <span class="emphasis"><em>setters</em></span>. What this means is that you can <code class="literal">get</code> the value of an element, or, if you specify an argument, this will be used to set the value. Here we go.</p><div class="section" title="html()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec100"/>html()</h2></div></div></div><p>With this method, you<a id="id571" class="indexterm"/> can either get or set the HTML contents of an<a id="id572" class="indexterm"/> element:</p><div class="informalexample"><pre class="programlisting">var contenthtml = $('#content).html(); // Get all the html code inside #content

var newcontent = 
'&lt;div&gt;&lt;h2 class="unique"&gt;This is a header&lt;/h2&gt;&lt;p&gt;This is a paragraph&lt;/p&gt;&lt;p&gt;This is a second paragraph&lt;/p&gt;&lt;/div&gt;';

$('#content').html(newcontent);</pre></div><p>The second set of instructions will replace the contents of <code class="literal">#content</code> with the preceding HTML code.</p></div><div class="section" title="text()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec101"/>text()</h2></div></div></div><p>Similar, but different to<a id="id573" class="indexterm"/> the previous method, this<a id="id574" class="indexterm"/> gets/sets the text inside an HTML tag:</p><div class="informalexample"><pre class="programlisting">var oldheader = $('h2.unique').text();  // Get only the text inside the h2 element

$('h2.unique').text("This is the new text in the header"); // Replace the text</pre></div></div><div class="section" title="attr()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec102"/>attr()</h2></div></div></div><p>This<a id="id575" class="indexterm"/> method lets us<a id="id576" class="indexterm"/> manipulate the value of an attribute:</p><div class="informalexample"><pre class="programlisting">var linkvalue = $('a.unique').attr('href'); // get the href attribute value of an anchor tag

$('a.unique').attr('href', 'http://www.paulpwellens.com');</pre></div></div><div class="section" title=".val()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec103"/>.val()</h2></div></div></div><p>This<a id="id577" class="indexterm"/> method gets or <a id="id578" class="indexterm"/>sets the value of an element:</p><div class="informalexample"><pre class="programlisting">var inputvalue =  $('input.name').val();</pre></div></div><div class="section" title="show() and hide()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec104"/>show() and hide()</h2></div></div></div><p>These are extremely useful<a id="id579" class="indexterm"/> methods to use in dynamic web pages. Very often, you want to generate HTML code for a part of the screen, and then<a id="id580" class="indexterm"/> display that code, and also do the opposite: make part of the screen disappear. The simple<a id="id581" class="indexterm"/> technique to achieve this is to <a id="id582" class="indexterm"/>prepare the content of a <code class="literal">&lt;div&gt;</code> element, insert it into the <code class="literal">&lt;div&gt;</code> element, and then make it visible. You would do this by having the following statement in your custom JavaScript file:</p><div class="informalexample"><pre class="programlisting">$('#content').show();

$('#content').hide();</pre></div><p>These methods are also very useful to prevent a phenomenon known as <span class="strong"><strong>Flickering Of Unprocessed Content</strong></span> (<span class="strong"><strong>FOUC</strong></span>). What do we <a id="id583" class="indexterm"/>mean by this? Remember the discussion about where to place your jQuery library and custom JavaScript files inside the page? Let's assume you use a JavaScript plugin that creates a slideshow by manipulating an unordered list (<code class="literal">&lt;ul&gt;</code>) of images (<code class="literal">&lt;img&gt;</code>). So, your original HTML may look like this:</p><div class="informalexample"><pre class="programlisting">&lt;div id="slideshow"&gt;
&lt;ul&gt;
   &lt;li&gt;
   &lt;img src="photos/mono.png" alt="Mono Lake"&gt;
   &lt;/li&gt;
   &lt;li&gt;
   &lt;img src="photos/monumentvalley.png" alt="Monument Valley"&gt;
   &lt;/li&gt;
   &lt;li&gt;
   &lt;img src="photos/centraalstation.png" alt="Central Station"&gt;
   &lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;</pre></div><p>The jQuery plugin you are using, for instance, <a id="id584" class="indexterm"/>the <span class="strong"><strong>OWL Carousel</strong></span> (<a class="ulink" href="http://owlgraphic.com">owlgraphic.com</a>) will take this HTML code and turn it into a fancy slideshow. However, if the connection is rather slow, you may end up seeing all your images stacked on top of each other first, with a silly bullet in front of them, and only seconds later your slideshow appears. You can work your way around this by placing the following in your stylesheet:</p><div class="informalexample"><pre class="programlisting">#slideshow {
display:none;
}</pre></div><p>Then, in your <a id="id585" class="indexterm"/>custom JavaScript file, after the code that builds the <a id="id586" class="indexterm"/>slideshow animation, you include:</p><div class="informalexample"><pre class="programlisting">$('#slideshow').show();</pre></div><p>This will cause nothing<a id="id587" class="indexterm"/> to be rendered on that part of the screen until the slideshow is<a id="id588" class="indexterm"/> ready.</p></div><div class="section" title=".find()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec105"/>.find()</h2></div></div></div><p>The <code class="literal">.find</code> method is<a id="id589" class="indexterm"/> extremely powerful. You can find almost anything in your page and then do things with the result. Here is an example:</p><div class="informalexample"><pre class="programlisting">var address = $('#record').find('p.address');</pre></div><p>This will look for and find all <code class="literal">&lt;p&gt;</code> elements with the class <code class="literal">address</code> in the element with the ID <code class="literal">record</code>. Once again, you can nest or chain it with other methods. The next example looks for an element with the attribute name set to <code class="literal">id</code> and then looks up its value:</p><div class="informalexample"><pre class="programlisting">var id = $('#record').find('input[name="id"]').val();</pre></div></div><div class="section" title=".parent()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec106"/>.parent()</h2></div></div></div><p>Using <code class="literal">.parent()</code> can be even <a id="id590" class="indexterm"/>more powerful. The first <a id="id591" class="indexterm"/>example looks up the <code class="literal">&lt;tr&gt;</code> element(s) of the specified <code class="literal">&lt;td&gt;</code>, and the next example goes up three levels:</p><div class="informalexample"><pre class="programlisting">var tablerow = $('td.name').parent().html()  ;// obtain the html code of the parent table row

var greatgranddad = $('a.threedeep').parent().parent().parent() ;</pre></div></div><div class="section" title=".next()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec107"/>.next()</h2></div></div></div><p>The <code class="literal">.next()</code> method looks <a id="id592" class="indexterm"/>sideways. It returns the sibling of the <a id="id593" class="indexterm"/>element to the right of the DOM structure, or not, if the optional selector does not have a match .<code class="literal">next()</code> only looks for the very next, so you will need to<a id="id594" class="indexterm"/> chain it if you want more:</p><div class="informalexample"><pre class="programlisting">var maybe =  $('div.left').next('.middle'); // only returns something if the element to the
//next is of class middle

var  threetotheright = 
$('#thistable').find('td.first').next().next().next();
    // in a table with first last address zipcode city records this would get us the zip</pre></div></div><div class="section" title=".css()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec108"/>.css()</h2></div></div></div><p>Using jQuery, you can also<a id="id595" class="indexterm"/> get or set the CSS values of any given element. In the first example, we retrieve the <code class="literal">background-color</code>; in the second<a id="id596" class="indexterm"/> example, we set the <code class="literal">color</code>:</p><div class="informalexample"><pre class="programlisting">var bgcolor = $('#content').css("background-color");
$('#color').css("color", "teal");</pre></div></div></div>
<div class="section" title="jQuery documentation"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec61"/>jQuery documentation</h1></div></div></div><p>The complete jQuery documentation <a id="id597" class="indexterm"/>and description of many more cool methods and features can be found at <a class="ulink" href="http://jquery.com">jquery.com</a>.</p><p>There are many jQuery books on<a id="id598" class="indexterm"/> the market, maybe too many to determine which is the one for you; this book is not one of them. We will only walk you through all the technologies you need to do web development - jQuery being an important one.</p><p>If you need to choose your first book on jQuery, I recommend the latest edition of <span class="emphasis"><em>Learning jQuery</em></span> by Packt Publishing.</p></div>
<div class="section" title="Event handlers and jQuery"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec62"/>Event handlers and jQuery</h1></div></div></div><p>Congratulations, you have<a id="id599" class="indexterm"/> reached a major milestone in the book. This page introduces a few new concepts all at once and you are going to use a lot of them daily. Let's<a id="id600" class="indexterm"/> assume that you are building a website with a menu. The menu is built using an ordered list, and here is the code for one menu item:</p><div class="informalexample"><pre class="programlisting">&lt;li id="intnews"&gt;&lt;a href="oldsite/intnews.php" class="news"&gt;International&lt;/a&gt;&lt;/li&gt;</pre></div><p>In your custom JavaScript file, you have:</p><div class="informalexample"><pre class="programlisting">$("#mainmenu<span class="strong"><strong>"</strong></span>)<span class="strong"><strong>.on("click</strong></span>", "a.news", function(e){

<span class="strong"><strong>e.preventDefault</strong></span>();

var nav = <span class="strong"><strong>$(this)</strong></span>.parent().attr("id");

updateNewsContent(nav);

});</pre></div><p>Let's first discuss the <code class="literal">.on()</code> part. This is the jQuery way of performing <a id="id601" class="indexterm"/>
<span class="strong"><strong>event handling</strong></span>. An event occurs when the<a id="id602" class="indexterm"/> visitor of your site performs a certain action. A typical action is the click of a mouse on a button or a link. We can then catch that event and perform certain tasks inside the function that is our event handler. In the<a id="id603" class="indexterm"/> previous example, we perform them all in a function that we called <code class="literal">updateNewsContent()</code>.</p><p>It is important to repeat that your jQuery code can only access and manipulate DOM elements after they have been loaded. So, if you dynamically create HTML after your JavaScript has been executed, they will be not manipulated by your JavaScript code.</p><p>The way the <code class="literal">.on()</code> method is used can only help. In the example, we attach the <code class="literal">.on()</code> method to the <code class="literal">#mainmenu</code> element; in all likelihood a <code class="literal">&lt;div&gt;</code> that is always there from the initial page loading.</p><p>The first argument of the <code class="literal">.on()</code> method<a id="id604" class="indexterm"/> is the event itself; in our example, the <code class="literal">click</code> event. The second argument is optional, but I use all the time, and it describes the selector that we want to trigger an event. This makes this event a so-called <span class="strong"><strong>delegated</strong></span> event. We <a id="id605" class="indexterm"/>could have also written it in this way:</p><div class="informalexample"><pre class="programlisting">$("#mainmenu a.news").on("click",  function(e){

// same code here

});</pre></div><p>This makes it a so-called <a id="id606" class="indexterm"/>
<span class="strong"><strong>direct event</strong></span>. What is the difference? If an <code class="literal">&lt;a&gt;</code> tag with class news is dynamically added inside the <code class="literal">#mainmenu</code> div after the initial page load and it is clicked on, the delegated event will catch that, whereas the direct event will not.</p><p>This is a common surprise during the development process, noticing that what worked before, suddenly, does not appear to be doing anything. Often the remedy is to start a new event handler inside your event handler. We will provide an example in a later chapter.</p><p>Finally, there is the function itself. Notice that it can have an argument. Inside the function, you can access that event object and apply methods and access properties. You will see some examples in the next chapter.</p><div class="section" title="preventDefault()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec109"/>preventDefault()</h2></div></div></div><p>The sample HTML<a id="id607" class="indexterm"/> code contains an anchor tag (<code class="literal">&lt;a&gt;</code>) with a <code class="literal">href</code> attribute, basically creating a link to a PHP file <code class="literal">intnews.php</code>. Let's assume that we use an ancient browser, or a browser with JavaScript turned off. The user clicking on the <code class="literal">&lt;a&gt;</code> tag would cause the <code class="literal">intnews.php</code> to be opened.</p><p>With JavaScript, we have determined what we want to happen in our event handler code, so we do not want the link to occur, we just want to stay on the same page. The <code class="literal">preventDefault()</code> method will, indeed, do what its<a id="id608" class="indexterm"/> name suggests. This technique is part of what is referred to as <span class="strong"><strong>Progressive Enhancement</strong></span>, which will be discussed in a later chapter.</p></div><div class="section" title="$(this)"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec110"/>$(this)</h2></div></div></div><p>Whereas you may find from<a id="id609" class="indexterm"/> time to time <span class="strong"><strong>this</strong></span> in sample JavaScript code, in jQuery we<a id="id610" class="indexterm"/> use <code class="literal">$(this)</code>. Inside the function, it represents the jQuery object of the matching element(s).</p></div><div class="section" title="updateNewsContent()"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec111"/>updateNewsContent()</h2></div></div></div><p>We deliberately did not<a id="id611" class="indexterm"/> describe what happens inside this sample function. In this section of the program, what typically goes on is that data is retrieved from the web server using PHP and possibly a database. You have seen just a few examples using classical web development techniques, such as specifying a PHP file as the action argument in a form, which will force us to go to another page.</p><p>We will, however, use jQuery methods that will allow us to execute PHP code on the server while remaining on the same page. The underlying technique used by these methods is called<a id="id612" class="indexterm"/> <span class="strong"><strong>AJAX</strong></span>, and that is the subject of the next chapter.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec63"/>Summary</h1></div></div></div><p>In this chapter, we started moving away from classical web development for the first time. We introduced jQuery, a powerful JavaScript library that allows us to write cleaner and more compact JavaScript code. Moreover, it is going to be easier for us to do so, as it uses CSS style selectors to specify DOM elements, rather than JavaScript methods that we would have to learn.</p><p>How to download and where to place the jQuery library was explained. We illustrated the remainder of the chapter with examples using jQuery's most useful and powerful methods. To conclude the chapter, we introduced the jQuery way of creating event handlers, possibly the most important concept to grasp at this stage of the book.</p><p>In the next chapter, we will continue to use jQuery, not to traverse the DOM and change a little bit of content here and there, but to generate entire chunks of our page on the Web server by executing PHP code that is called using jQuery methods. Then we can use the data to update parts of our page, without ever leaving it. All of this is using a technique called AJAX.</p></div></body></html>
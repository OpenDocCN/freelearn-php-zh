["```php\napplication/\n├── core/\n│   ├── MY_Controller.php\n├── controllers/\n│   ├── me.php\n│   ├── password.php\n│   ├── register.php\n│   ├── signin.php\n│   ├── users.php\n├── models/\n│   ├── password_model.php\n│   ├── register_model.php\n│   ├── signin_model.php\n│   ├── users_model.php\n├── views/users/\n│   ├── new_user.php\n│   ├── view_all_users.php\n│   ├── delete_user.php\n│   ├── edit_user.php\n│   ├── forgot_password.php\n│   ├── me.php\n│   ├── new_password.php\n│   ├── register.php\n│   ├── signin.php\n│   ├── change_password.php\n├── views/email_scripts/\n│   ├── welcome.txt\n│   ├── new_password.txt\n│   ├── reset_password.txt\n├── views/nav/\n│   ├── top_nav.php\n├── views/common/\n│   ├── login_header.php\n├── language/english/\n│   ├── en_admin_lang.php\nbootstrap/\n├── css/\n    ├── signin.css\n```", "```php\nCREATE DATABASE `user_auth`;\nUSE `user_auth`;\n\nCREATE TABLE `ci_sessions` (\n  `session_id` varchar(40) COLLATE utf8_bin NOT NULL DEFAULT '0',\n  `ip_address` varchar(16) COLLATE utf8_bin NOT NULL DEFAULT '0',\n  `user_agent` varchar(120) COLLATE utf8_bin DEFAULT NULL,\n  `last_activity` int(10) unsigned NOT NULL DEFAULT '0',\n  `user_data` text COLLATE utf8_bin NOT NULL,\n  PRIMARY KEY (`session_id`),\n  KEY `last_activity_idx` (`last_activity`)\n) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin;\n\nCREATE TABLE `users` (\n  `usr_id` int(11) NOT NULL AUTO_INCREMENT,\n  `acc_id` int(11) NOT NULL COMMENT 'account id',\n  `usr_fname` varchar(125) NOT NULL,\n  `usr_lname` varchar(125) NOT NULL,\n  `usr_uname` varchar(50) NOT NULL,\n  `usr_email` varchar(255) NOT NULL,\n  `usr_hash` varchar(255) NOT NULL,\n  `usr_add1` varchar(255) NOT NULL,\n  `usr_add2` varchar(255) NOT NULL,\n  `usr_add3` varchar(255) NOT NULL,\n  `usr_town_city` varchar(255) NOT NULL,\n  `usr_zip_pcode` varchar(10) NOT NULL,\n  `usr_access_level` int(2) NOT NULL COMMENT 'up to 99',\n  `usr_is_active` int(1) NOT NULL COMMENT '1 (active) or 0 (inactive)',\n  `usr_created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `usr_pwd_change_code` varchar(50) NOT NULL,\n  PRIMARY KEY (`usr_id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;\n```", "```php\n$password = random_string('alnum', 8);\n$hash = $this->encrypt->sha1($password);\n```", "```php\n$db['default']['hostname'] = 'localhost';\n$db['default']['username'] = 'your username';\n$db['default']['password'] = 'your password';\n$db['default']['database'] = 'user_auth';\n```", "```php\n    $config['encryption_key'] = '';\n    ```", "```php\n    $config['encryption_key'] = 'a-random-string-of-alphanum-characters';\n    ```", "```php\n    $config['sess_cookie_name'] = 'ci_session';\n    $config['sess_expiration'] = 7200;\n    $config['sess_expire_on_close'] = FALSE;\n    $config['sess_encrypt_cookie'] = FALSE;\n    $config['sess_use_database'] = FALSE;\n    $config['sess_table_name'] = 'ci_sessions';\n    $config['sess_match_ip'] = FALSE;\n    $config['sess_match_useragent'] = TRUE;\n    $config['sess_time_to_update'] = 300;\n    ```", "```php\n    $config['sess_cookie_name'] = 'ci_session';\n    $config['sess_expiration'] = 7200;\n    $config['sess_expire_on_close'] = TRUE;\n    $config['sess_encrypt_cookie'] = TRUE;\n    $config['sess_use_database'] = TRUE;\n    $config['sess_table_name'] = 'ci_sessions';\n    $config['sess_match_ip'] = TRUE;\n    $config['sess_match_useragent'] = TRUE;\n    $config['sess_time_to_update'] = 300;\n    ```", "```php\n    $route['default_controller'] = \"welcome\";\n    $route['404_override'] = '';\n    ```", "```php\n    $route['default_controller'] = \"welcome\";\n    ```", "```php\n    $route['default_controller'] = \"signin\";\n    ```", "```php\n<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n\nclass Password_model extends CI_Model {\n  function __construct() {\n      parent::__construct();\n  }\n```", "```php\n  function does_code_match($code, $email) {\n    $query = \"SELECT COUNT(*) AS `count` \n              FROM `users` \n              WHERE `usr_pwd_change_code` = ?\n              AND `usr_email` = ? \";\n\n        $res = $this->db->query($query, array($code, $email));\n    foreach ($res->result() as $row) {\n      $count = $row->count;\n    }\n\n    if ($count == 1) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n```", "```php\n<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n\nclass Register_model extends CI_Model {\n  function __construct() {\n    parent::__construct();\n  }\n\n  public function register_user($data) {\n    if ($this->db->insert('users', $data)) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n```", "```php\n<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n\nclass Users_model extends CI_Model {\n  function __construct() {\n    parent::__construct();\n  }\n\n  function get_all_users() {\n    return $this->db->get('users');\n  } \n\n  function process_create_user($data) {\n    if ($this->db->insert('users', $data)) {\n      return $this->db->insert_id();\n    } else {\n      return false;\n    }\n  }\n\n  function process_update_user($id, $data) {\n    $this->db->where('usr_id', $id);\n    if ($this->db->update('users', $data)) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  function get_user_details($id) {\n    $this->db->where('usr_id', $id);\n    $result = $this->db->get('users');\n\n    if ($result) {\n      return $result;\n    } else {\n      return false;\n    }\n  }\n\n  function get_user_details_by_email($email) {\n    $this->db->where('usr_email', $email);\n    $result = $this->db->get('users');\n\n    if ($result) {\n      return $result;\n    } else {\n      return false;\n    }\n  }\n\n  function delete_user($id) {\n    if($this->db->delete('users', array('usr_id' => $id))) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n```", "```php\ndo {\n// something\n} while ('…a condition is met');\n```", "```php\nfunction make_code() {\n  do {\n    $url_code = random_string('alnum', 8); \n\n    $this->db->where('usr_pwd_change_code = ', $url_code);\n    $this->db->from('users');\n    $num = $this->db->count_all_results();\n  } while ($num >= 1);\n\n  return $url_code;\n}\n\nfunction count_results($email) {\n  $this->db->where('usr_email', $email);\n  $this->db->from('users');\n  return $this->db->count_all_results();\n}\n```", "```php\n  function update_user_password($data) {\n    $this->db->where('usr_id', $data['usr_id']);\n    if ($this->db->update('users', $data)) {\n        return true;\n    } else {\n        return false;\n    }\n  }\n\n  function does_code_match($data, $email) {\n    $query = \"SELECT COUNT(*) AS `count` \n                    FROM `users` \n                    WHERE `usr_pwd_change_code` = ?\n                    AND `usr_email` = ? \";\n\n    $res = $this->db->query($query, array($data['code'], $email));\n    foreach ($res->result() as $row) {\n      $count = $row->count;\n    }\n\n    if ($count == 1) {\n        return true;\n    } else {\n        return false;\n    }\n  }\n\n  function update_user_code($data) {\n    $this->db->where('usr_email', $data['usr_email']);\n    if ($this->db->update('users', $data)) {\n        return true;\n    } else {\n        return false;\n    }\n  }\n}\n```", "```php\n<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n\nclass Signin_model extends CI_Model {\n    function __construct() {\n        parent::__construct();\n    } \n\n    public function does_user_exist($email) {\n        $this->db->where('usr_email', $email);\n        $query = $this->db->get('users');\n        return $query;\n    }\n}\n```", "```php\n$query = $this->Signin_model->does_user_exist($usr_email);\nif ($query->num_rows() == 1) {\n...\n```", "```php\n<div class=\"container\">\n  <?php echo validation_errors(); ?>\n  <?php echo form_open('register/index', 'role=\"form\" class=\"form-signin\"') ; ?> \n    <h2 class=\"form-signin-heading\"><?php echo $this->lang->line('register_page_title'); ?></h2>\n    <input type=\"text\" class=\"form-control\" name=\"usr_fname\" placeholder=\"<?php echo $this->lang->line('register_first_name'); ?>\" autofocus>\n    <input type=\"text\" class=\"form-control\" name=\"usr_lname\" placeholder=\"<?php echo $this->lang->line('register_last_name'); ?>\" >\n    <input type=\"email\" class=\"form-control\" name=\"usr_email\" placeholder=\"<?php echo $this->lang->line('register_email'); ?>\" >\n    <?php echo form_submit('submit', 'Register', 'class=\"btn btn-lg btn-primary btn-block\"'); ?>\n  </form>\n</div>\n```", "```php\nDear %usr_fname% %usr_lname%,\n\nWelcome to the site.  Your password is:\n\n%password%\n\nRegards,\nThe Team\n```", "```php\nDear Robert Foster,\nWelcome to the site.  Your password is:\n\n<this-is-the-password>\n\nRegards,\nThe Team\n```", "```php\n<?php if (isset($login_fail)) : ?>\n  <div class=\"alert alert-danger\"><?php echo $this->lang->line('admin_login_error') ; ?></div>\n<?php endif ; ?>\n  <?php echo validation_errors(); ?>\n  <?php echo form_open('password/forgot_password', 'class=\"form-signin\" role=\"form\"') ; ?>\n    <h2 class=\"form-signin-heading\"><?php echo $this->lang->line('forgot_pwd_header') ; ?></h2>\n    <p class=\"lead\"><?php echo $this->lang->line('forgot_pwd_instruction') ;?></p>\n    <?php echo form_input(array('name' => 'usr_email', 'class' => 'form-control', 'placeholder' => $this->lang->line('admin_login_email'),'id' => 'email', 'value' => set_value('email', ''), 'maxlength' => '100', 'size' => '50', 'style' => 'width:100%')); ?>\n    <br />\n    <button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\"><?php echo $this->lang->line('common_form_elements_go') ; ?></button>\n    <br />\n  <?php echo form_close() ; ?>\n</div>\n```", "```php\n<?php if (isset($login_fail)) : ?>\n  <div class=\"alert alert-danger\"><?php echo $this->lang->line('admin_login_error') ; ?></div>\n<?php endif ; ?>\n  <?php echo validation_errors(); ?>\n  <?php echo form_open('signin/index', 'class=\"form-signin\" role=\"form\"') ; ?>\n    <h2 class=\"form-signin-heading\"><?php echo $this->lang->line('admin_login_header') ; ?></h2>\n    <input type=\"email\" name=\"usr_email\" class=\"form-control\" placeholder=\"<?php echo $this->lang->line('admin_login_email') ; ?>\" required autofocus>\n    <input type=\"password\" name=\"usr_password\" class=\"form-control\" placeholder=\"<?php echo $this->lang->line('admin_login_password') ; ?>\" required>\n    <button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\"><?php echo $this->lang->line('admin_login_signin') ; ?></button>\n    <br />\n    <?php echo anchor('password',$this->lang->line('signin_forgot_password')); ?>\n  <?php echo form_close() ; ?>\n</div>\n```", "```php\n<h2><?php echo $page_heading ; ?></h2>\n<table class=\"table table-bordered\">\n    <thead>\n        <tr>\n          <th>#</th>\n          <th>First Name</th>\n          <th>Last Name</th>\n          <th>Email</th>\n         <td>Actions</td>\n        </tr>\n    </thead>\n    <tbody>\n    <?php if ($query->num_rows() > 0) : ?>\n        <?php foreach ($query->result() as $row) : ?>\n          <tr>\n            <td><?php echo $row->usr_id ; ?></td>\n            <td><?php echo $row->usr_fname ; ?></td>\n            <td><?php echo $row->usr_lname ; ?></td>\n            <td><?php echo $row->usr_email ; ?></td>\n            <td><?php echo anchor('users/edit_user/'.\n              $row->usr_id,$this->lang->line('common_form_elements_action_edit')) . ' ' . anchor('users/delete_user/'.\n              $row->usr_id,$this->lang->line('common_form_elements_action_delete')) ; ?>\n            </td>\n          </tr>\n        <?php endforeach ; ?>\n        <?php else : ?>\n          <tr>\n            <td colspan=\"5\" class=\"info\">No users here!</td>\n          </tr>\n        <?php endif; ?>\n    </tbody>\n</table>\n```", "```php\n<?php echo validation_errors() ; ?>\n<div class=\"page-header\">\n  <h1><?php echo $page_heading ; ?></h1>\n</div> \n  <p class=\"lead\"><?php echo $this->lang->line('usr_form_instruction_edit');?></p>\n  <div class=\"span8\"> \n<?php echo form_open('users/new_user','role=\"form\" class=\"form\"') ; ?>\n    <div class=\"form-group\">\n      <?php echo form_error('usr_fname'); ?>\n      <label for=\"usr_fname\"><?php echo $this->lang->line('usr_fname');?></label>\n      <?php echo form_input($usr_fname); ?>\n    </div>\n    <div class=\"form-group\">\n      <?php echo form_error('usr_lname'); ?>\n      <label for=\"usr_lname\"><?php echo $this->lang->line('usr_lname');?></label>\n      <?php echo form_input($usr_lname); ?>\n    </div>\n    <div class=\"form-group\">\n      <?php echo form_error('usr_uname'); ?>\n      <label for=\"usr_uname\"><?php echo $this->lang->line('usr_uname');?></label>\n      <?php echo form_input($usr_uname); ?>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"usr_email\"><?php echo $this->lang->line('usr_email');?></label>\n      <?php echo form_input($usr_email); ?>\n    </div>\n    <div class=\"form-group\">\n      <label for=\"usr_confirm_email\"><?php echo $this->lang->line('usr_confirm_email');?></label>\n      <?php echo form_input($usr_confirm_email); ?>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"usr_add1\"><?php echo $this->lang->line('usr_add1');?></label>\n      <?php echo form_input($usr_add1); ?>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"usr_add2\"><?php echo $this->lang->line('usr_add2');?></label>\n      <?php echo form_input($usr_add2); ?>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"usr_add3\"><?php echo $this->lang->line('usr_add3');?></label>\n      <?php echo form_input($usr_add3); ?>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"usr_town_city\"><?php echo $this->lang->line('usr_town_city');?></label>\n      <?php echo form_input($usr_town_city); ?>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"usr_zip_pcode\"><?php echo $this->lang->line('usr_zip_pcode');?></label>\n      <?php echo form_input($usr_zip_pcode); ?>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"usr_access_level\"><?php echo $this->lang->line('usr_access_level');?></label>\n      <?php echo form_dropdown('usr_access_level', $usr_access_level, 'large'); ?>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"usr_is_active\"><?php echo $this->lang->line('usr_is_active');?></label>\n      <input type=\"radio\" name=\"usr_is_active\" value=\"<?php echo set_value('usr_is_active') ; ?>\" /> Active\n      <input type=\"radio\" name=\"usr_is_active\" value=\"<?php echo set_value('usr_is_active') ; ?>\" /> Inactive\n     </div>\n\n    <div class=\"form-group\">\n      <button type=\"submit\" class=\"btn btn-success\"><?php echo $this->lang->line('common_form_elements_go');?></button>  or <? echo anchor('users',$this->lang->line('common_form_elements_cancel'));?>\n    </div>\n<?php echo form_close() ; ?>\n  </div>\n</div>\n```", "```php\n<div class=\"page-header\">\n  <h1><?php echo $page_heading ; ?></h1>\n</div> \n  <p class=\"lead\"><?php echo $this->lang->line('usr_form_instruction_edit');?></p>\n\n  <div class=\"span8\"> \n    <?php echo form_open('users/edit_user','role=\"form\" class=\"form\"') ; ?>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_fname'); ?>\n        <label for=\"usr_fname\"><?php echo $this->lang->line('usr_fname');?></label>\n        <?php echo form_input($usr_fname); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_lname'); ?>\n        <label for=\"usr_lname\"><?php echo $this->lang->line('usr_lname');?></label>\n        <?php echo form_input($usr_lname); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_uname'); ?>\n        <label for=\"usr_uname\"><?php echo $this->lang->line('usr_uname');?></label>\n        <?php echo form_input($usr_uname); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_email'); ?>\n        <label for=\"usr_email\"><?php echo $this->lang->line('usr_email');?></label>\n        <?php echo form_input($usr_email); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_confirm_email'); ?>\n        <label for=\"usr_confirm_email\"><?php echo $this->lang->line('usr_confirm_email');?></label>\n        <?php echo form_input($usr_confirm_email); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_add1'); ?>\n        <label for=\"usr_add1\"><?php echo $this->lang->line('usr_add1');?></label>\n        <?php echo form_input($usr_add1); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_add2'); ?>\n        <label for=\"usr_add2\"><?php echo $this->lang->line('usr_add2');?></label>\n        <?php echo form_input($usr_add2); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_add3'); ?>\n        <label for=\"usr_add3\"><?php echo $this->lang->line('usr_add3');?></label>\n        <?php echo form_input($usr_add3); ?>\n      </div> \n      <div class=\"form-group\">\n        <?php echo form_error('usr_town_city'); ?>\n        <label for=\"usr_town_city\"><?php echo $this->lang->line('usr_town_city');?></label>\n        <?php echo form_input($usr_town_city); ?>\n      </div> \n      <div class=\"form-group\">\n        <?php echo form_error('usr_zip_pcode'); ?>\n        <label for=\"usr_zip_pcode\"><?php echo $this->lang->line('usr_zip_pcode');?></label>\n        <?php echo form_input($usr_zip_pcode); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_access_level'); ?>\n        <label id=\"usr_access_level\" for=\"usr_access_level\"><?php echo $this->lang->line('usr_access_level');?></label>\n        <?php echo form_dropdown('usr_access_level', $usr_access_level_options, $usr_access_level); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_is_active'); ?>\n        <label for=\"usr_is_active\"><?php echo $this->lang->line('usr_is_active');?></label>\n        <input type=\"radio\" name=\"usr_is_active\" <?php if ($usr_is_active == 1) { echo 'checked' ;} ?> /> Active\n        <input type=\"radio\" name=\"usr_is_active\" <?php if ($usr_is_active == 0) { echo 'checked' ;} ?> /> Inactive\n      </div>\n\n      <?php echo form_hidden($id); ?>\n\n      <div class=\"form-group\">\n        <button type=\"submit\" class=\"btn btn-success\"><?php echo $this->lang->line('common_form_elements_go');?></button> or <? echo anchor('users',$this->lang->line('common_form_elements_cancel'));?>\n      </div>\n    <?php echo form_close() ; ?>\n  </div>\n\n  <?php echo anchor('users/pwd_email/'.$id['usr_id'],'Send Password Reset Email') ; ?>\n\n</div>\n```", "```php\n<?php echo validation_errors() ; ?>\n<div class=\"page-header\">\n  <h1><?php echo $page_heading ; ?></h1>\n</div> \n  <p class=\"lead\"><?php echo $this->lang->line('usr_form_instruction');?></p>\n\n  <div class=\"span8\"> \n    <?php echo form_open('me/index','role=\"form\"') ; ?>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_fname'); ?>\n        <label for=\"usr_fname\"><?php echo $this->lang->line('usr_fname');?></label>\n        <?php echo form_input($usr_fname); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_lname'); ?>\n        <label for=\"usr_lname\"><?php echo $this->lang->line('usr_lname');?></label>\n        <?php echo form_input($usr_lname); ?>\n      </div>\n      <div class=\"form-group\">\n        <?php echo form_error('usr_uname'); ?>\n        <label for=\"usr_uname\"><?php echo $this->lang->line('usr_uname');?></label>\n        <?php echo form_input($usr_uname); ?>\n      </div>\n\n      <div class=\"form-group\">\n        <label for=\"usr_email\"><?php echo $this->lang->line('usr_email');?></label>\n        <?php echo form_input($usr_email); ?>\n      </div>\n      <div class=\"form-group\">\n        <label for=\"usr_confirm_email\"><?php echo $this->lang->line('usr_confirm_email');?></label>\n        <?php echo form_input($usr_confirm_email); ?>\n      </div>\n\n      <div class=\"form-group\">\n        <label for=\"usr_add1\"><?php echo $this->lang->line('usr_add1');?></label>\n        <?php echo form_input($usr_add1); ?>\n      </div>\n      <div class=\"form-group\">\n        <label for=\"usr_add2\"><?php echo $this->lang->line('usr_add2');?></label>\n        <?php echo form_input($usr_add2); ?>\n      </div>\n      <div class=\"form-group\">\n        <label for=\"usr_add3\"><?php echo $this->lang->line('usr_add3');?></label>\n        <?php echo form_input($usr_add3); ?>\n      </div> \n      <div class=\"form-group\">\n        <label for=\"usr_town_city\"><?php echo $this->lang->line('usr_town_city');?></label>\n        <?php echo form_input($usr_town_city); ?>\n      </div>\n      <div class=\"form-group\">\n        <label for=\"usr_zip_pcode\"><?php echo $this->lang->line('usr_zip_pcode');?></label>\n        <?php echo form_input($usr_zip_pcode); ?>\n      </div>\n\n      <?php echo form_hidden($id); ?>\n\n      <div class=\"form-group\">\n        <button type=\"submit\" class=\"btn btn-success\"><?php echo $this->lang->line('common_form_elements_go');?></button> or <? echo anchor('users',$this->lang->line('common_form_elements_cancel'));?>\n      </div>\n    <?php echo form_close() ; ?>\n  </div>\n\n  <?php echo anchor('me/pwd_email/'.$id,'Reset Email') ; ?>\n```", "```php\n<div class=\"container\">\n  <?php echo validation_errors(); ?>\n  <?php echo form_open('register/index', 'role=\"form\" class=\"form-signin\"') ; ?>\n    <h2 class=\"form-signin-heading\"><?php echo $this->lang->line('register_page_title'); ?></h2>\n    <input type=\"text\" class=\"form-control\" name=\"usr_fname\" placeholder=\"<?php echo $this->lang->line('register_first_name'); ?>\" required autofocus>\n    <input type=\"text\" class=\"form-control\" name=\"usr_lname\" placeholder=\"<?php echo $this->lang->line('register_last_name'); ?>\" required>\n    <input type=\"email\" class=\"form-control\" name=\"usr_email\" placeholder=\"<?php echo $this->lang->line('register_email'); ?>\" required>\n    <?php echo form_submit('submit', 'Register', 'class=\"btn btn-lg btn-primary btn-block\"'); ?>\n  </form>\n</div>\n```", "```php\n<?php if (isset($login_fail)) : ?>\n  <div class=\"alert alert-danger\"><?php echo $this->lang->line('admin_login_error') ; ?></div>\n<?php endif ; ?>\n  <?php echo validation_errors(); ?>\n  <?php echo form_open('signin/index', 'class=\"form-signin\" role=\"form\"') ; ?>\n    <h2 class=\"form-signin-heading\"><?php echo $this->lang->line('admin_login_header') ; ?></h2>\n    <input type=\"email\" name=\"usr_email\" class=\"form-control\" placeholder=\"<?php echo $this->lang->line('admin_login_email') ; ?>\" required autofocus>\n    <input type=\"password\" name=\"usr_password\" class=\"form-control\" placeholder=\"<?php echo $this->lang->line('admin_login_password') ; ?>\" required>\n    <button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\"><?php echo $this->lang->line('admin_login_signin') ; ?></button>\n    <br />\n    <?php echo anchor('password',$this->lang->line('signin_forgot_password')); ?>\n  <?php echo form_close() ; ?>\n</div>\n```", "```php\n<?php if (isset($login_fail)) : ?>\n  <div class=\"alert alert-danger\"><?php echo $this->lang->line('admin_login_error') ; ?></div>\n<?php endif ; ?>\n  <?php echo validation_errors(); ?>\n  <?php echo form_open('me/change_password', 'class=\"form-signin\" role=\"form\"') ; ?>\n    <h2 class=\"form-signin-heading\"><?php echo $this->lang->line('forgot_pwd_header') ; ?></h2>\n    <p class=\"lead\"><?php echo $this->lang->line('forgot_pwd_instruction') ;?></p>\n    <table border=\"0\">\n        <tr>\n            <td><?php $this->lang->line('signin_new_pwd_email') ; ?></td>\n        </tr>\n        <tr>\n            <td><?php echo form_input($usr_new_pwd_1); ?></td>\n        </tr>\n        <tr>\n            <td><?php echo form_input($usr_new_pwd_2); ?></td>\n        </tr>\n    </table>\n    <button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\"><?php echo $this->lang->line('common_form_elements_go') ; ?></button>\n    <br />\n  <?php echo form_close() ; ?>\n</div>\n```", "```php\n<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\nclass MY_Controller extends CI_Controller {\n  function __construct() {\n    parent::__construct();\n    $this->load->helper('form');\n    $this->load->helper('url');\n    $this->load->helper('security');\n    $this->load->helper('language');\n    $this->load->library('session');\n    $this->load->library('form_validation');\n    $this->form_validation->set_error_delimiters('<div class=\"alert alert-warning\" role=\"alert\">', '</div>');\n    $this->lang->load('en_admin', 'english');\n  }\n}\n```", "```php\n<?php if (!defined('BASEPATH')) exit('No direct script access allowed');\nclass Password extends CI_Controller {\n  function __construct() {\n    parent::__construct();\n    $this->load->library('session');\n    $this->load->helper('form');\n    $this->load->helper('file');\n    $this->load->helper('url');\n    $this->load->helper('security');\n    $this->load->model('Users_model');\n    $this->lang->load('en_admin', 'english'); \n    $this->load->library('form_validation');\n    $this->form_validation->set_error_delimiters('<div class=\"bs-callout bs-callout-error\">', '</div>'); \n  }\n\n  public function index() {\n    redirect('password/forgot_password');\n  }\n```", "```php\npublic function forgot_password() {\n  $this->form_validation->set_rules('usr_email', $this->lang->line('signin_new_pwd_email'), 'required|min_length[5]|max_length[125]|valid_email');\n```", "```php\nif ($this->form_validation->run() == FALSE) {\n  $this->load->view('common/login_header');\n  $this->load->view('users/forgot_password');\n  $this->load->view('common/footer');\n```", "```php\n} else {\n  $email = $this->input->post('usr_email');\n  $num_res = $this->Users_model->count_results($email);\n```", "```php\nif ($num_res == 1) {\n```", "```php\n$code = $this->Users_model->make_code();\n$data = array(\n  'usr_pwd_change_code' => $code,\n  'usr_email' => $email\n);\n\nif ($this->Users_model->update_user_code($data)) { // Update okay, so send email\n  $result = $this->Users_model->get_user_details_by_email($email);\n\n  foreach ($result->result() as $row) {\n    $usr_fname = $row->usr_fname;\n    $usr_lname = $row->usr_lname;\n  }\n```", "```php\n$link = \"http://www.domain.com/password/new_password/\".$code;\n```", "```php\n          $path = '/path/to/codeigniter/application/views/email_scripts/reset_password.txt';\n$file = read_file($path);\n```", "```php\n$file = str_replace('%usr_fname%', $usr_fname, $file);\n$file = str_replace('%usr_lname%', $usr_lname, $file);\necho $file = str_replace('%link%', $link, $file);\n```", "```php\n        if (mail ($email, $this->lang->line('email_subject_reset_password'),$file, 'From: me@domain.com')) {\n          redirect('signin');\n        }\n      } else {\n        // Some sort of error happened, redirect user back to form\n        redirect('password/forgot_password');\n      }\n    } else { // Some sort of error happened, redirect user back to form\n      redirect('password/forgot_password');\n    } \n  }\n}\n```", "```php\n  public function new_password() {\n    $this->form_validation->set_rules('code', $this->lang->line('signin_new_pwd_code'), 'required|min_length[4]|max_length[8]');\n    $this->form_validation->set_rules('usr_email', $this->lang->line('signin_new_pwd_email'), 'required|min_length[5]|max_length[125]');\n    $this->form_validation->set_rules('usr_password1', $this->lang->line('signin_new_pwd_email'), 'required|min_length[5]|max_length[125]');\n    $this->form_validation->set_rules('usr_password2', $this->lang->line('signin_new_pwd_email'), 'required|min_length[5]|max_length[125]|matches[usr_password1]');\n\n    if ($this->input->post()) {\n      $data['code'] = xss_clean($this->input->post('code'));\n    } else { \n      $data['code'] = xss_clean($this->uri->segment(3));\n    }\n```", "```php\n    if ($this->form_validation->run() == FALSE) {\n      $data['usr_email']     = array('name' => 'usr_email',     'class' => 'form-control', 'id' => 'usr_email',     'type' => 'text',     'value' => set_value('usr_email', ''),     'maxlength'   => '100', 'size' => '35', 'placeholder' => $this->lang->line('signin_new_pwd_email'));\n      $data['usr_password1'] = array('name' => 'usr_password1', 'class' => 'form-control', 'id' => 'usr_password1', 'type' => 'password', 'value' => set_value('usr_password1', ''), 'maxlength'   => '100', 'size' => '35', 'placeholder' => $this->lang->line('signin_new_pwd_pwd'));\n      $data['usr_password2'] = array('name' => 'usr_password2', 'class' => 'form-control', 'id' => 'usr_password2', 'type' => 'password', 'value' => set_value('usr_password2', ''), 'maxlength'   => '100', 'size' => '35', 'placeholder' => $this->lang->line('signin_new_pwd_confirm'));\n\n      $this->load->view('common/login_header', $data);\n      $this->load->view('users/new_password', $data);\n      $this->load->view('common/footer', $data);\n    } else {\n```", "```php\n// Does code from input match the code against the email\n$email = xss_clean($this->input->post('usr_email'));\n```", "```php\n  if (!$this->Users_model->does_code_match($data, $email)) { // Code doesn't match\n        redirect ('users/forgot_password');\n      } else {  // Code does match\n```", "```php\n$hash = $this->encrypt->sha1($this->input->post('usr_password1'));\n```", "```php\n$data = array(\n  'usr_hash' => $hash,\n  'usr_email' => $email\n);\n```", "```php\nif ($this->Users_model->update_user_password($data)) {\n```", "```php\n$link = 'http://www.domain.com/signin';\n$result = $this->Users_model->get_user_details_by_email($email);\n\nforeach ($result->result() as $row) {\n  $usr_fname = $row->usr_fname;\n  $usr_lname = $row->usr_lname;\n}\n```", "```php\n$path = '/ path/to/codeigniter/application/views/email_scripts/new_password.txt';\n$file = read_file($path);\n```", "```php\n          $file = str_replace('%usr_fname%', $usr_fname, $file);\n          $file = str_replace('%usr_lname%', $usr_lname, $file);\n          $file = str_replace('%password%', $password, $file);\n          $file = str_replace('%link%', $link, $file);\n          if (mail ($email, $this->lang->line('email_subject_new_password'),$file, 'From: me@domain.com') ) {\n            redirect ('signin');\n          }\n        }\n      }\n    }\n  }\n}\n```", "```php\n<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n\nclass Me extends CI_Controller {\n```", "```php\nif ( ($this->session->userdata('logged_in') == FALSE) || \n     (!$this->session->userdata('usr_access_level') >= 2) ) {\n        redirect('signin');\n}\n```", "```php\nfunction __construct() {\n  parent::__construct();\n  $this->load->helper('form');\n  $this->load->helper('url');\n  $this->load->helper('security');\n  $this->load->helper('file'); // for html emails\n  $this->load->helper('language');\n  $this->load->model('Users_model');\n  $this->load->library('session');\n\n  // Load language file\n  $this->lang->load('en_admin', 'english');\n  $this->load->library('form_validation');\n  $this->form_validation->set_error_delimiters('<div class=\"alert alert-warning\" role=\"alert\">', '</div>');\n\n  if ( ($this->session->userdata('logged_in') == FALSE) || \n       (!$this->session->userdata('usr_access_level') >= 2) ) {\n          redirect('signin/signout');\n  }\n}\n```", "```php\npublic function index() {\n  // Set validation rules\n  $this->form_validation->set_rules('usr_fname', $this->lang->line('usr_fname'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_lname', $this->lang->line('usr_lname'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_uname', $this->lang->line('usr_uname'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_email', $this->lang->line('usr_email'), 'required|min_length[1]|max_length[255]|valid_email');\n  $this->form_validation->set_rules('usr_confirm_email', $this->lang->line('usr_confirm_email'), 'required|min_length[1]|max_length[255]|valid_email|matches[usr_email]');\n  $this->form_validation->set_rules('usr_add1', $this->lang->line('usr_add1'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_add2', $this->lang->line('usr_add2'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_add3', $this->lang->line('usr_add3'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_town_city', $this->lang->line('usr_town_city'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_zip_pcode', $this->lang->line('usr_zip_pcode'), 'required|min_length[1]|max_length[125]');\n\n  $data['id'] = $this->session->userdata('usr_id');\n\n  $data['page_heading'] = 'Edit my details';\n  // Begin validation\n```", "```php\nif ($this->form_validation->run() == FALSE) { // First load, or problem with form\n```", "```php\n$query = $this->Users_model->get_user_details($data['id']);\nforeach ($query->result() as $row) {\n  $usr_fname = $row->usr_fname;\n  $usr_lname = $row->usr_lname;\n  $usr_uname = $row->usr_uname;\n  $usr_email = $row->usr_email;\n  $usr_add1 = $row->usr_add1;\n  $usr_add2 = $row->usr_add2;\n  $usr_add3 = $row->usr_add3;\n  $usr_town_city = $row->usr_town_city;\n  $usr_zip_pcode = $row->usr_zip_pcode;\n}\n```", "```php\n  $data['usr_fname'] = array('name' => 'usr_fname', 'class' => 'form-control', 'id' => 'usr_fname', 'value' => set_value('usr_fname', $usr_fname), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_lname'] = array('name' => 'usr_lname', 'class' => 'form-control', 'id' => 'usr_lname', 'value' => set_value('usr_lname', $usr_lname), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_uname'] = array('name' => 'usr_uname', 'class' => 'form-control', 'id' => 'usr_uname', 'value' => set_value('usr_uname', $usr_uname), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_email'] = array('name' => 'usr_email', 'class' => 'form-control', 'id' => 'usr_email', 'value' => set_value('usr_email', $usr_email), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_confirm_email'] = array('name' => 'usr_confirm_email', 'class' => 'form-control', 'id' => 'usr_confirm_email', 'value' => set_value('usr_confirm_email', $usr_email), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_add1'] = array('name' => 'usr_add1', 'class' => 'form-control', 'id' => 'usr_add1', 'value' => set_value('usr_add1', $usr_add1), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_add2'] = array('name' => 'usr_add2', 'class' => 'form-control', 'id' => 'usr_add2', 'value' => set_value('usr_add2', $usr_add2), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_add3'] = array('name' => 'usr_add3', 'class' => 'form-control', 'id' => 'usr_add3', 'value' => set_value('usr_add3', $usr_add3), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_town_city'] = array('name' => 'usr_town_city', 'class' => 'form-control', 'id' => 'usr_town_city', 'value' => set_value('usr_town_city', $usr_town_city), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_zip_pcode'] = array('name' => 'usr_zip_pcode', 'class' => 'form-control', 'id' => 'usr_zip_pcode', 'value' => set_value('usr_zip_pcode', $usr_zip_pcode), 'maxlength'   => '100', 'size' => '35');\n\n  $this->load->view('common/header', $data);\n  $this->load->view('nav/top_nav', $data);\n  $this->load->view('users/me', $data);\n  $this->load->view('common/footer', $data);\n} else { // Validation passed, now escape the data\n```", "```php\n    $data = array(\n        'usr_fname' => $this->input->post('usr_fname'),\n        'usr_lname' => $this->input->post('usr_lname'),\n        'usr_uname' => $this->input->post('usr_uname'),\n        'usr_email' => $this->input->post('usr_email'),\n        'usr_add1' => $this->input->post('usr_add1'),\n        'usr_add2' => $this->input->post('usr_add2'),\n        'usr_add3' => $this->input->post('usr_add3'),\n        'usr_town_city' => $this->input->post('usr_town_city'),\n        'usr_zip_pcode' => $this->input->post('usr_zip_pcode')\n    );\n\n    if ($this->Users_model->process_update_user($id, $data)) {\n        redirect('users');\n    }\n  }\n}\n```", "```php\n  public function change_password() {\n    $this->load->library('form_validation');\n    $this->form_validation->set_rules('usr_new_pwd_1', $this->lang->line('signin_new_pwd_pwd'), 'required|min_length[5]|max_length[125]');\n    $this->form_validation->set_rules('usr_new_pwd_2', $this->lang->line('signin_new_pwd_confirm'), 'required|min_length[5]|max_length[125]|matches[usr_new_pwd_1]');\n\n    if ($this->form_validation->run() == FALSE) {\n      $data['usr_new_pwd_1'] = array('name' => 'usr_new_pwd_1', 'class' => 'form-control', 'type' => 'password', 'id' => 'usr_new_pwd_1', 'value' => set_value('usr_new_pwd_1', ''), 'maxlength'   => '100', 'size' => '35', 'placeholder' => $this->lang->line('signin_new_pwd_pwd'));\n      $data['usr_new_pwd_2'] = array('name' => 'usr_new_pwd_2', 'class' => 'form-control', 'type' => 'password', 'id' => 'usr_new_pwd_2', 'value' => set_value('usr_new_pwd_2', ''), 'maxlength'   => '100', 'size' => '35', 'placeholder' => $this->lang->line('signin_new_pwd_confirm'));\n      $data['submit_path'] = 'me/change_password';\n\n      $this->load->view('common/login_header', $data);\n      $this->load->view('users/change_password', $data);\n      $this->load->view('common/footer', $data);\n    } else {\n      $hash = $this->encrypt->sha1($this->input->post('usr_new_pwd_1')); \n\n      $data = array(\n        'usr_hash' => $hash,\n        'usr_id' => $this->session->userdata('usr_id')\n      );\n\n      if ($this->Users_model->update_user_password($data)) {\n        redirect('signin/signout');\n      }\n    }\n  }\n}\n```", "```php\n<?php if (!defined('BASEPATH')) exit('No direct script access allowed'); \n\nclass Register extends CI_Controller {\n  function __construct() {\n  parent::__construct();\n  $this->load->helper('form');\n  $this->load->helper('url');\n  $this->load->helper('security');\n  $this->load->model('Register_model');\n  $this->load->library('encrypt');\n  $this->lang->load('en_admin', 'english');\n  $this->load->library('form_validation');\n  $this->form_validation->set_error_delimiters('<div class=\"alert alert-warning\" role=\"alert\">', '</div>');\n  }\n```", "```php\npublic function index() {\n  // Set validation rules\n  $this->form_validation->set_rules('usr_fname', $this->lang->line('first_name'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_lname', $this->lang->line('last_name'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_email', $this->lang->line('email'), 'required|min_length[1]|max_length[255]|valid_email|is_unique[users.usr_email]');\n\n  // Begin validation \n  if ($this->form_validation->run() == FALSE) { // First load, or problem with form\n    $this->load->view('common/login_header');\n    $this->load->view('users/register'); \n    $this->load->view('common/footer');\n  } else { \n```", "```php\n// Create hash from user password \n$password = random_string('alnum', 8);\n```", "```php\n$hash = $this->encrypt->sha1($password);\n```", "```php\n$data = array( \n  'usr_fname' => $this->input->post('usr_fname'), \n  'usr_lname' => $this->input->post('usr_lname'), \n  'usr_email' => $this->input->post('usr_email'), \n  'usr_is_active' => 1,\n  'usr_access_level' => 2,\n  'usr_hash' => $hash \n); \n```", "```php\n      if ($this->Register_model->register_user($data)) {\n        $file = read_file('../views/email_scripts/welcome.txt');\n        $file = str_replace('%usr_fname%', $data['usr_fname'], $file);\n        $file = str_replace('%usr_lname%', $data['usr_lname'], $file);\n        $file = str_replace('%password%', $password, $file);\n        redirect('signin');\n      } else {\n        redirect('register');\n      }\n    } \n  }\n}\n```", "```php\n<?php if (!defined('BASEPATH')) exit('No direct script access allowed');\n\nclass Signin extends CI_Controller {\n  function __construct() {\n    parent::__construct();\n    $this->load->library('session');\n    $this->load->helper('form');\n    $this->load->helper('url');\n    $this->load->helper('security');\n    $this->lang->load('en_admin', 'english'); \n    $this->load->library('form_validation');\n    $this->form_validation->set_error_delimiters('<div class=\"alert alert-warning\" role=\"alert\">', '</div>'); \n  }\n```", "```php\npublic function index() {\n  if ($this->session->userdata('logged_in') == TRUE) {\n    if ($this->session->userdata('usr_access_level') == 1) {\n      redirect('users');\n    } else {\n      redirect('me');\n    }\n  } else {\n```", "```php\n      // Set validation rules for view filters\n      $this->form_validation->set_rules('usr_email', $this->lang->line('signin_email'), 'required|valid_email|min_length[5]|max_length[125]');\n      $this->form_validation->set_rules('usr_password', $this->lang->line('signin_password'), 'required|min_length[5]|max_length[30]');\n\n      if ($this->form_validation->run() == FALSE) {\n        $this->load->view('common/login_header');\n        $this->load->view('users/signin');\n        $this->load->view('common/footer');\n      } else {\n```", "```php\n$usr_email = $this->input->post('usr_email');\n$password = $this->input->post('usr_password');\n\n$this->load->model('Signin_model');\n$query = $this->Signin_model->does_user_exist($usr_email);\n```", "```php\nif ($query->num_rows() == 1) { // One matching row found\n  foreach ($query->result() as $row) {\n    // Call Encrypt library\n    $this->load->library('encrypt');\n```", "```php\n// Generate hash from a their password\n$hash = $this->encrypt->sha1($password);\n\nif ($row->usr_is_active != 0) { // See if the user is active or not\n  // Compare the generated hash with that in the database\n  if ($hash != $row->usr_hash) {\n```", "```php\n  // Didn't match so send back to login\n  $data['login_fail'] = true;\n  $this->load->view('common/login_header');\n  $this->load->view('users/signin', $data);\n  $this->load->view('common/footer'); \n} else {\n```", "```php\n$data = array(\n    'usr_id' => $row->usr_id,\n    'acc_id' => $row->acc_id,\n    'usr_email' => $row->usr_email,\n    'usr_access_level' => $row->usr_access_level,\n    'logged_in' => TRUE\n);\n```", "```php\n// Save data to session\n$this->session->set_userdata($data);\n```", "```php\nif ($data['usr_access_level'] == 2) {\n                  redirect('me');\n                } elseif ($data['usr_access_level'] == 1) {\n                  redirect('users');\n                } else {\n                  redirect('me');\n                }\n              }\n            } else {\n              // User currently inactive\n              redirect('signin');\n            }\n          }\n        } \n      }\n    }\n  }\n```", "```php\n  public function signout() {\n    $this->session->sess_destroy();\n    redirect ('signin');\n  } \n}\n```", "```php\n<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n\nclass Users extends MY_Controller {\n  function __construct() {\n    parent::__construct();\n    $this->load->helper('file'); // for html emails\n    $this->load->model('Users_model');\n    $this->load->model('Password_model');\n\n    if ( ($this->session->userdata('logged_in') == FALSE) || \n       ($this->session->userdata('usr_access_level') != 1) ) {\n        redirect('signin');\n    }\n  }\n```", "```php\npublic function index() {\n  $data['page_heading'] = 'Viewing users';\n  $data['query'] = $this->Users_model->get_all_users();\n  $this->load->view('common/header', $data);\n  $this->load->view('nav/top_nav', $data);\n  $this->load->view('users/view_all_users', $data);\n  $this->load->view('common/footer', $data);\n}\n```", "```php\npublic function new_user() {\n  // Set validation rules\n  $this->form_validation->set_rules('usr_fname', $this->lang->line('usr_fname'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_lname', $this->lang->line('usr_lname'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_uname', $this->lang->line('usr_uname'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_email', $this->lang->line('usr_email'), 'required|min_length[1]|max_length[255]|valid_email|is_unique[users.usr_email]');\n  $this->form_validation->set_rules('usr_confirm_email', $this->lang->line('usr_confirm_email'), 'required|min_length[1]|max_length[255]|valid_email|matches[usr_email]');\n  $this->form_validation->set_rules('usr_add1', $this->lang->line('usr_add1'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_add2', $this->lang->line('usr_add2'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_add3', $this->lang->line('usr_add3'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_town_city', $this->lang->line('usr_town_city'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_zip_pcode', $this->lang->line('usr_zip_pcode'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_access_level', $this->lang->line('usr_access_level'), 'min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_is_active', $this->lang->line('usr_is_active'), 'min_length[1]|max_length[1]|integer|is_natural');\n\n  $data['page_heading'] = 'New user';\n  // Begin validation\n```", "```php\nif ($this->form_validation->run() == FALSE) { // First load, or problem with form\n  $data['usr_fname'] = array('name' => 'usr_fname', 'class' => 'form-control', 'id' => 'usr_fname', 'value' => set_value('usr_fname', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_lname'] = array('name' => 'usr_lname', 'class' => 'form-control', 'id' => 'usr_lname', 'value' => set_value('usr_lname', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_uname'] = array('name' => 'usr_uname', 'class' => 'form-control', 'id' => 'usr_uname', 'value' => set_value('usr_uname', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_email'] = array('name' => 'usr_email', 'class' => 'form-control', 'id' => 'usr_email', 'value' => set_value('usr_email', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_confirm_email'] = array('name' => 'usr_confirm_email', 'class' => 'form-control', 'id' => 'usr_confirm_email', 'value' => set_value('usr_confirm_email', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_add1'] = array('name' => 'usr_add1', 'class' => 'form-control', 'id' => 'usr_add1', 'value' => set_value('usr_add1', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_add2'] = array('name' => 'usr_add2', 'class' => 'form-control', 'id' => 'usr_add2', 'value' => set_value('usr_add2', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_add3'] = array('name' => 'usr_add3', 'class' => 'form-control', 'id' => 'usr_add3', 'value' => set_value('usr_add3', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_town_city'] = array('name' => 'usr_town_city', 'class' => 'form-control', 'id' => 'usr_town_city', 'value' => set_value('usr_town_city', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_zip_pcode'] = array('name' => 'usr_zip_pcode', 'class' => 'form-control', 'id' => 'usr_zip_pcode', 'value' => set_value('usr_zip_pcode', ''), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_access_level'] = array(1=>1, 2=>2, 3=>3, 4=>4, 5=>5);\n\n  $this->load->view('common/header', $data);\n  $this->load->view('nav/top_nav', $data);\n  $this->load->view('users/new_user',$data);\n  $this->load->view('common/footer', $data);\n} else { // Validation passed, now escape the data\n```", "```php\n$password = random_string('alnum', 8);\n$hash = $this->encrypt->sha1($password);\n```", "```php\n$data = array(\n  'usr_fname' => $this->input->post('usr_fname'),\n  'usr_lname' => $this->input->post('usr_lname'),\n  'usr_uname' => $this->input->post('usr_uname'),\n  'usr_email' => $this->input->post('usr_email'),\n  'usr_hash' => $hash,\n  'usr_add1' => $this->input->post('usr_add1'),\n  'usr_add2' => $this->input->post('usr_add2'),\n  'usr_add3' => $this->input->post('usr_add3'),\n  'usr_town_city' => $this->input->post('usr_town_city'),\n  'usr_zip_pcode' => $this->input->post('usr_zip_pcode'),\n  'usr_access_level' => $this->input->post('usr_access_level'),\n  'usr_is_active' => $this->input->post('usr_is_active')\n);\n```", "```php\n    if ($this->Users_model->process_create_user($data)) {\n      $file = read_file('../views/email_scripts/welcome.txt');\n      $file = str_replace('%usr_fname%', $data['usr_fname'], $file);\n      $file = str_replace('%usr_lname%', $data['usr_lname'], $file);\n      $file = str_replace('%password%', $password, $file);\n      redirect('users');\n    } else {\n\n    }\n  }\n}\n```", "```php\npublic function edit_user() {\n  // Set validation rules\n  $this->form_validation->set_rules('usr_id', $this->lang->line('usr_id'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_fname', $this->lang->line('usr_fname'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_lname', $this->lang->line('usr_lname'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_uname', $this->lang->line('usr_uname'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_email', $this->lang->line('usr_email'), 'required|min_length[1]|max_length[255]|valid_email');\n  $this->form_validation->set_rules('usr_confirm_email', $this->lang->line('usr_confirm_email'), 'required|min_length[1]|max_length[255]|valid_email|matches[usr_email]');\n  $this->form_validation->set_rules('usr_add1', $this->lang->line('usr_add1'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_add2', $this->lang->line('usr_add2'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_add3', $this->lang->line('usr_add3'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_town_city', $this->lang->line('usr_town_city'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_zip_pcode', $this->lang->line('usr_zip_pcode'), 'required|min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_access_level', $this->lang->line('usr_access_level'), 'min_length[1]|max_length[125]');\n  $this->form_validation->set_rules('usr_is_active', $this->lang->line('usr_is_active'), 'min_length[1]|max_length[1]|integer|is_natural');\n```", "```php\nif ($this->input->post()) {\n  $id = $this->input->post('usr_id');\n} else {\n  $id = $this->uri->segment(3); \n}\n\n$data['page_heading'] = 'Edit user';\n// Begin validation\n```", "```php\nif ($this->form_validation->run() == FALSE) { // First load, or problem with form\n      $query = $this->Users_model->get_user_details($id);\n      foreach ($query->result() as $row) {\n        $usr_id = $row->usr_id;\n        $usr_fname = $row->usr_fname;\n        $usr_lname = $row->usr_lname;\n        $usr_uname = $row->usr_uname;\n        $usr_email = $row->usr_email;\n        $usr_add1 = $row->usr_add1;\n        $usr_add2 = $row->usr_add2;\n        $usr_add3 = $row->usr_add3;\n        $usr_town_city = $row->usr_town_city;\n        $usr_zip_pcode = $row->usr_zip_pcode;\n        $usr_access_level = $row->usr_access_level;\n        $usr_is_active = $row->usr_is_active;\n      }\n```", "```php\n  $data['usr_fname'] = array('name' => 'usr_fname', 'class' => 'form-control', 'id' => 'usr_fname', 'value' => set_value('usr_fname', $usr_fname), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_lname'] = array('name' => 'usr_lname', 'class' => 'form-control', 'id' => 'usr_lname', 'value' => set_value('usr_lname', $usr_lname), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_uname'] = array('name' => 'usr_uname', 'class' => 'form-control', 'id' => 'usr_uname', 'value' => set_value('usr_uname', $usr_uname), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_email'] = array('name' => 'usr_email', 'class' => 'form-control', 'id' => 'usr_email', 'value' => set_value('usr_email', $usr_email), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_confirm_email'] = array('name' => 'usr_confirm_email', 'class' => 'form-control', 'id' => 'usr_confirm_email', 'value' => set_value('usr_confirm_email', $usr_email), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_add1'] = array('name' => 'usr_add1', 'class' => 'form-control', 'id' => 'usr_add1', 'value' => set_value('usr_add1', $usr_add1), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_add2'] = array('name' => 'usr_add2', 'class' => 'form-control', 'id' => 'usr_add2', 'value' => set_value('usr_add2', $usr_add2), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_add3'] = array('name' => 'usr_add3', 'class' => 'form-control', 'id' => 'usr_add3', 'value' => set_value('usr_add3', $usr_add3), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_town_city'] = array('name' => 'usr_town_city', 'class' => 'form-control', 'id' => 'usr_town_city', 'value' => set_value('usr_town_city', $usr_town_city), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_zip_pcode'] = array('name' => 'usr_zip_pcode', 'class' => 'form-control', 'id' => 'usr_zip_pcode', 'value' => set_value('usr_zip_pcode', $usr_zip_pcode), 'maxlength'   => '100', 'size' => '35');\n  $data['usr_access_level_options'] = array(1=>1, 2=>2, 3=>3, 4=>4, 5=>5);\n  $data['usr_access_level'] = array('value' => set_value('usr_access_level', ''));\n  $data['usr_is_active'] = $usr_is_active;\n  $data['id'] = array('usr_id' => set_value('usr_id', $usr_id));\n\n  $this->load->view('common/header', $data);\n  $this->load->view('nav/top_nav', $data);\n  $this->load->view('users/edit_user', $data);\n  $this->load->view('common/footer', $data);\n} else { // Validation passed, now escape the data\n```", "```php\n$data = array(\n  'usr_fname' => $this->input->post('usr_fname'),\n  'usr_lname' => $this->input->post('usr_lname'),\n  'usr_uname' => $this->input->post('usr_uname'),\n  'usr_email' => $this->input->post('usr_email'),\n  'usr_add1' => $this->input->post('usr_add1'),\n  'usr_add2' => $this->input->post('usr_add2'),\n  'usr_add3' => $this->input->post('usr_add3'),\n  'usr_town_city' => $this->input->post('usr_town_city'),\n  'usr_zip_pcode' => $this->input->post('usr_zip_pcode'),\n  'usr_access_level' => $this->input->post('usr_access_level'),\n  'usr_is_active' => $this->input->post('usr_is_active')\n);\n```", "```php\n    if ($this->Users_model->process_update_user($id, $data)) {\n      redirect('users');\n    }\n  }\n}\n```", "```php\n  public function delete_user() {\n    // Set validation rules\n    $this->form_validation->set_rules('id', $this->lang->line('usr_id'), 'required|min_length[1]|max_length[11]|integer|is_natural');\n    if ($this->input->post()) {\n      $id = $this->input->post('id');\n    } else {\n      $id = $this->uri->segment(3);\n    }\n\n    $data['page_heading'] = 'Confirm delete?';\n    if ($this->form_validation->run() == FALSE) { // First load, or problem with form\n      $data['query'] = $this->Users_model->get_user_details($id);\n      $this->load->view('common/header', $data);\n      $this->load->view('nav/top_nav', $data);\n      $this->load->view('users/delete_user', $data);\n      $this->load->view('common/footer', $data);\n    } else {\n      if ($this->Users_model->delete_user($id)) {\n        redirect('users');\n      }\n    }\n  }\n\n  public function pwd_email() {\n    $id = $this->uri->segment(3);\n    send_email($data, 'reset');\n    redirect('users');\n  }\n}\n```", "```php\n<?php if (!defined('BASEPATH')) exit('No direct script access allowed');\n\n// General\n$lang['system_system_name'] = \"Auth System\";\n\n// Top Nav\n$lang['top_nav_users'] = \"Users\";\n$lang['top_nav_new'] = 'New';\n$lang['top_nav_signin'] = \"Login\";\n$lang['top_nav_signout'] = \"Logout\";\n\n// Login\n$lang['signin_email'] = \"Email\";\n$lang['signin_password'] = \"Password\";\n$lang['admin_login_header'] = \"Please sign in\";\n$lang['admin_login_email'] = \"Email\";\n$lang['admin_login_password'] = \"Password\";\n$lang['admin_login_signin'] = \"Signin...\";\n$lang['admin_login_error'] = \"Whoops!  Something went wrong - have another go!\";\n$lang['forgot_pwd_header'] = 'Reset Password...';\n$lang['forgot_pwd_instruction'] = 'Enter your email in the box below and if your email is in the database we will send you a new password' ;\n\n$lang['signin_forgot_password'] = \"Forgot Password?\";\n\n// Register\n$lang['register_page_title'] = \"Register...\";\n$lang['register_first_name'] = \"First Name\";\n$lang['register_last_name'] = \"Last Name\";\n$lang['register_email'] = \"Email\";\n\n// Emails\n$lang['email_subject_new_password'] = \"Your new password.\";\n$lang['email_subject_reset_password'] = \"Reset your password.\";\n\n// New/Edit User\n$lang['usr_form_instruction_new'] = \"New User Details\";\n$lang['usr_form_instruction_edit'] = \"Edit User Details\";\n$lang['usr_id'] = \"ID\";\n$lang['usr_fname'] = \"First name\";\n$lang['usr_lname'] = \"Last Name\";\n$lang['usr_uname'] = \"Username\";\n$lang['usr_email'] = \"Email\";\n$lang['usr_confirm_email'] = \"Confirm Email\";\n$lang['usr_add1'] = \"Address 1\";\n$lang['usr_add2'] = \"Address 2\";\n$lang['usr_add3'] = \"Address 3\";\n$lang['usr_town_city'] = \"Town/City\";\n$lang['usr_zip_pcode'] = \"Zip/Postal Code\";\n$lang['usr_access_level'] = \"User Access Level\";\n$lang['is_active'] = \"User is active?\";\n\n// Forgot password\n$lang['forgot_pwd_success_heading'] = \"Email Sent:\";\n$lang['forgot_pwd_success_msg'] = \"An email has been sent to the address provided.\";\n\n// New password\n$lang['signin_new_pwd_instruction'] = \"Reset your password\";\n$lang['signin_new_pwd_email'] = \"Your email\";\n$lang['signin_new_pwd_pwd'] = \"Password\";\n$lang['signin_new_pwd_confirm'] = \"Confirm password\";\n$lang['signin_new_pwd_code'] = \"Code\";\n\n// Delete\n$lang['delete_confirm_message'] = \"Are you sure you want to delete the user: \";\n```", "```php\nif ( ($this->session->userdata('logged_in') == FALSE) || \n ($this->session->userdata('usr_access_level') != 1) ) {\n   redirect('signin');\n}\n```"]
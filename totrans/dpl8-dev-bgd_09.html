<html><head></head><body><div class="chapter" title="Chapter&#xA0;9.&#xA0;Advanced Views Development"><div class="titlepage"><div><div><h1 class="title"><a id="ch09"/>Chapter 9. Advanced Views Development</h1></div></div></div><p><span class="emphasis"><em>This chapter will give you an in-depth introduction to the Views module and introduce some of the Views plugin architecture. We will dive into some of the advanced features of Views available in the Views UI, including an introduction to taxonomy-based Views. We will be developing a Views style plugin to display our new Recipes view as semantic tabs. We will also contribute Views semantic tabs module to Drupal as a sandbox project.</em></span></p><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Advanced Views configuration</li><li class="listitem" style="list-style-type: disc">Views plugin development</li><li class="listitem" style="list-style-type: disc">Creating a Drupal sandbox project</li></ul></div><div class="section" title="Views revisited – advanced configuration"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec109"/>Views revisited – advanced configuration</h1></div></div></div><p>In the last<a class="indexterm" id="id465"/> few chapters, Custom Content Types and an Introduction to Module Development, we had a quick introduction to Views, and saw how easy it is to create a view with the new Views wizard's user interface. The new wizard-based creation for new views makes it easy to get started with Views, but does not include many of the more advanced Views configuration options. Even on the standard Views edit page, advanced configuration options are hidden away, so as not to overwhelm those who are new to Views. The beginning of this chapter will explore many of these advanced configuration options available with Views. Views configuration can get complex pretty quickly. So, in a way, advanced Views configuration is not any less complex than some of the PHP code we have written.</p></div></div>
<div class="section" title="Random top rated recipe block"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec110"/>Random top rated recipe block</h1></div></div></div><p>The home <a class="indexterm" id="id466"/>page is still a bit plain and boring. We are going to use Views to create a block that will randomly showcase one of the top-rated recipes on the site. This will involve using Views filters and sort settings.</p></div>
<div class="section" title="Time for action &#x2013; building a random top rated recipe block with Views"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec111"/>Time for action – building a random top rated recipe block with Views</h1></div></div></div><p>We are <a class="indexterm" id="id467"/>going to go beyond the basic Views wizard view creation user interface and learn a few more advanced features and configuration of Views.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open our d8dev site in your browser, click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, and click on the <span class="strong"><strong>Views</strong></span> link.</li><li class="listitem">Click on the <span class="strong"><strong>Add new view</strong></span> link at the top of the <span class="strong"><strong>Views</strong></span> page.</li><li class="listitem">Enter <code class="literal">Random Top Rated Recipe</code> as the <span class="strong"><strong>View name</strong></span>.</li><li class="listitem">Select <span class="strong"><strong>Recipe</strong></span> for the <span class="strong"><strong>of type</strong></span> options.</li><li class="listitem">Check the <span class="strong"><strong>Create a block</strong></span> checkbox.<div class="mediaobject"><img alt="Time for action – building a random top rated recipe block with Views" src="graphics/4659_09_01.jpg"/></div></li><li class="listitem">Next, click <a class="indexterm" id="id468"/>on the <span class="strong"><strong>Save and edit</strong></span> button, as we want to configure some more advanced options that are not available as part of the basic block creation wizard.<p>Now we are going to add the Recipe content fields that we want to display in this block. Remember, this block is going to be displayed on our d8dev site's front page, so we want to make it visually appealing. Note that the <span class="strong"><strong>Title</strong></span> field is already included by default.</p></li><li class="listitem">Click on the <span class="strong"><strong>Add</strong></span> button for <span class="strong"><strong>FIELDS</strong></span>, search for <code class="literal">image</code>, and select the checkbox for <span class="strong"><strong>Content: image</strong></span> and click on the <span class="strong"><strong>Apply (all displays)</strong></span> button. Note that Views shows you what node or content types the fields are associated with.<div class="mediaobject"><img alt="Time for action – building a random top rated recipe block with Views" src="graphics/4659_09_02.jpg"/></div></li><li class="listitem">For<a class="indexterm" id="id469"/> the <span class="strong"><strong>Configure field</strong></span> settings for the image field, select <span class="strong"><strong>Medium (220*220)</strong></span> as the <span class="strong"><strong>Image style</strong></span> and click on the <span class="strong"><strong>Apply (all displays)</strong></span> button.</li><li class="listitem">Click on the <span class="strong"><strong>Add</strong></span> button for <span class="strong"><strong>FIELDS</strong></span>, search for <code class="literal">Comment count</code>, and select the checkbox for <span class="strong"><strong>Comment Statistics: Comment count</strong></span>. Then click on the <span class="strong"><strong>Apply(all displays)</strong></span> button.</li><li class="listitem">For the <span class="strong"><strong>Configure field</strong></span> settings for <span class="strong"><strong>Comment count</strong></span>, select <span class="strong"><strong>Total:</strong></span> as the <span class="strong"><strong>Prefix</strong></span> and <span class="strong"><strong>Reviews</strong></span> as the <span class="strong"><strong>Suffix</strong></span> value. In the <span class="strong"><strong>STYLE SETTINGS</strong></span> section, check the <span class="strong"><strong>Customize field HTML</strong></span> checkbox, select <span class="strong"><strong>STRONG</strong></span> as the <span class="strong"><strong>HTML element</strong></span> field, and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button.<div class="mediaobject"><img alt="Time for action – building a random top rated recipe block with Views" src="graphics/4659_09_03.jpg"/></div></li><li class="listitem">Next, in the <span class="strong"><strong>SORT CRITERIA</strong></span> section, click on the <span class="strong"><strong>Add</strong></span> button, search for <code class="literal">Comment count</code>, and select the checkbox for <span class="strong"><strong>Comment Statistics: Comment count</strong></span>. Then click on the <span class="strong"><strong>Apply(all displays)</strong></span> button.</li><li class="listitem">For <a class="indexterm" id="id470"/>the <span class="strong"><strong>Configure sort criteria</strong></span> settings for <span class="strong"><strong>Comment count</strong></span>, select <span class="strong"><strong>Sort descending</strong></span> for the <span class="strong"><strong>Order</strong></span> field and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button.<div class="mediaobject"><img alt="Time for action – building a random top rated recipe block with Views" src="graphics/4659_09_04.jpg"/></div></li><li class="listitem">Next, in the <span class="strong"><strong>SORT CRITERIA</strong></span> section, click on the <span class="strong"><strong>Add</strong></span> button, search for <code class="literal">Random</code>, and select the checkbox for <span class="strong"><strong>Random</strong></span>. Then click on the <span class="strong"><strong>Apply(all displays)</strong></span> button.</li><li class="listitem">In the next screen, click on the <span class="strong"><strong>Apply(all displays)</strong></span> button. Then save the view and we can see a preview of this block as the following screenshot:<div class="mediaobject"><img alt="Time for action – building a random top rated recipe block with Views" src="graphics/4659_09_05.jpg"/></div></li><li class="listitem">Now <a class="indexterm" id="id471"/>your Views configuration should look similar to the following screenshot:<div class="mediaobject"><img alt="Time for action – building a random top rated recipe block with Views" src="graphics/4659_09_06.jpg"/></div></li><li class="listitem">Now we need to configure this new Views-based block to show up on the front page. Click on <span class="strong"><strong>Structure</strong></span> in the <span class="strong"><strong>Admin</strong></span> toolbar and click on the <span class="strong"><strong>Block Layout</strong></span> link.</li><li class="listitem">Scroll down towards <span class="strong"><strong>Sidebar first region</strong></span> and click on the <span class="strong"><strong>Place block</strong></span> link. In the popup, search for <code class="literal">Random top</code> and click on the <span class="strong"><strong>Place block</strong></span> button for the <span class="strong"><strong>Random Top Rated Recipe</strong></span> block.</li><li class="listitem">In the next screen, check the <span class="strong"><strong>Override title</strong></span> checkbox, enter <code class="literal">Top Recipe</code> as <span class="strong"><strong>Title</strong></span>, and click on the <span class="strong"><strong>Save block</strong></span> button.<div class="mediaobject"><img alt="Time for action – building a random top rated recipe block with Views" src="graphics/4659_09_07.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec74"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>We used Views and leveraged some advanced configuration options to display the image and title of the top most recent recipes and also learned how easy it can be to make our d8dev site more interesting by adding a dynamic Views-based block.</p></div></div>
<div class="section" title="Taxonomy-based View with tabs"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec112"/>Taxonomy-based View with tabs</h1></div></div></div><p>In this section, we <a class="indexterm" id="id472"/>are going to add another Views-based block to our front page. However, this will be a Taxonomy-based View instead of the Content-based Views that we have created so far. Taxonomy refers to the organization of information. As we learned in the previous chapter, taxonomy is a field-able entity. The Taxonomy module is a core module and it allows you to create vocabularies of terms to associate to other entity types so that they can be organized. So before that, we need to create a view with Taxonomy vocabulary with terms and associate those terms to our recipe content. We are going to add a vocabulary for organizing recipes by type of cuisine.</p></div>
<div class="section" title="Time for action &#x2013; creating a cuisine vocabulary to organize recipes"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec113"/>Time for action – creating a cuisine vocabulary to organize recipes</h1></div></div></div><p>Before we can create <a class="indexterm" id="id473"/>a Taxonomy-based view, we need to create a Drupal Taxonomy vocabulary:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open our d8dev site in your browser, click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, and click on the <span class="strong"><strong>Taxonomy</strong></span> link.</li><li class="listitem">On the <span class="strong"><strong>Taxonomy configuration</strong></span> page, click on the <span class="strong"><strong>Add vocabulary</strong></span> link.</li><li class="listitem">Enter <code class="literal">Type of Cuisine</code> as the <span class="strong"><strong>Name</strong></span> input and click on the <span class="strong"><strong>Save</strong></span> button. Now we will add some terms for our new vocabulary.</li><li class="listitem">Click on the <span class="strong"><strong>Add term</strong></span> link for our new <span class="strong"><strong>Type of Cuisine</strong></span> vocabulary (make sure you are in the <code class="literal">admin/structure/taxonomy/manage/type_of_cuisine/overview page</code>):<div class="mediaobject"><img alt="Time for action – creating a cuisine vocabulary to organize recipes" src="graphics/4659_09_08.jpg"/></div></li><li class="listitem">Enter <code class="literal">American</code> as <span class="strong"><strong>Name</strong></span> of our first term and click on the <span class="strong"><strong>Save</strong></span> button.</li><li class="listitem">Repeat the process and add the terms <code class="literal">Asian</code> and <code class="literal">Thai</code>. Now we are going to add a taxonomy field to our Recipe content type.</li><li class="listitem">Click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, click on the link for <span class="strong"><strong>Content types</strong></span>, and click on the <span class="strong"><strong>Manage fields</strong></span> link for our Recipe content type.</li><li class="listitem">Click on <a class="indexterm" id="id474"/>the <span class="strong"><strong>Add field</strong></span> link. In the next screen, select <span class="strong"><strong>Taxonomy term</strong></span> as <span class="strong"><strong>Add a new field</strong></span> and enter <code class="literal">recipeCuisine</code> as <span class="strong"><strong>Label</strong></span>. Click on the <span class="strong"><strong>Save and continue</strong></span> button.<div class="mediaobject"><img alt="Time for action – creating a cuisine vocabulary to organize recipes" src="graphics/4659_09_09.jpg"/></div></li><li class="listitem">In the next screen, select <span class="strong"><strong>Unlimited</strong></span> as <span class="strong"><strong>Allowed number of values</strong></span> and click on the <span class="strong"><strong>Save field settings</strong></span> button. In the next screen, check <span class="strong"><strong>Type of Cuisine</strong></span> under <span class="strong"><strong>REFERENCE TYPE</strong></span> | <span class="strong"><strong>Vocabularies</strong></span> and click on the <span class="strong"><strong>Save settings</strong></span> button.<div class="mediaobject"><img alt="Time for action – creating a cuisine vocabulary to organize recipes" src="graphics/4659_09_10.jpg"/></div></li><li class="listitem">Click <a class="indexterm" id="id475"/>on the <span class="strong"><strong>Content</strong></span> link in the <span class="strong"><strong>Admin</strong></span> bar, then click on the edit link for one of the recipes, scroll down to our new <span class="strong"><strong>recipeCuisine</strong></span> field, select American, and click on the <span class="strong"><strong>Save</strong></span> button. Repeat the process for selecting Asian for the Cashew Chicken with Edamame, and Thai and Asian for the other recipes.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec75"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>We got a quick introduction to Drupal Taxonomies and created a vocabulary to organize the d8dev recipes by the types of cuisine.</p><p>Now that we have added a new vocabulary for associating Recipe content to the types of cuisine, we are ready to use this in a new Views-based block. We are going to create a Views-based block that displays our d8dev site's newest recipe entries by cuisine type. In addition to that, we are going to sort the list of recipes by the cuisine type with the least number of associated recipes. This will help us to promote cuisine types with fewer recipes. Finally, we want a tab-based user interface with a tab for each cuisine type, and the contents of that tab to be the five most recent recipes for that cuisine type. Let's go through step by step.</p></div></div>
<div class="section" title="Time for action &#x2013; creating a Recipes by cuisine type Views block"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec114"/>Time for action – creating a Recipes by cuisine type Views block</h1></div></div></div><p>We have <a class="indexterm" id="id476"/>created a new vocabulary and associated it to our Recipe content type. Now we will learn how to use a custom vocabulary with a view.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, click on the <span class="strong"><strong>Views</strong></span> link, and click on the <span class="strong"><strong>Add new view</strong></span> button.</li><li class="listitem">On the next page, enter <code class="literal">Recipes by Cuisine</code> as the <span class="strong"><strong>View</strong></span> name, select <span class="strong"><strong>Taxonomy terms</strong></span> for the <span class="strong"><strong>Show</strong></span> select list, and select <span class="strong"><strong>Type of Cuisine</strong></span> for the of <span class="strong"><strong>Type</strong></span> select list.</li><li class="listitem">Check the <span class="strong"><strong>Create a block</strong></span> checkbox under the <span class="strong"><strong>Block settings</strong></span> section.</li><li class="listitem">Leave the remaining default settings as they are and click on the <span class="strong"><strong>Save and edit</strong></span> button.</li><li class="listitem">Views automatically adds the Taxonomy term <span class="strong"><strong>Name</strong></span> field, but we also want to display the most recent recipes associated to each of those cuisine terms. However, if you click on the <span class="strong"><strong>Add</strong></span> button for <span class="strong"><strong>FIELDS</strong></span>, you will note that there is no <span class="strong"><strong>Content</strong></span> field available. We will use the Views <span class="strong"><strong>RELATIONSHIPS</strong></span> configuration to add a relationship between the Recipe content and the taxonomy terms we are showing.</li><li class="listitem">Click on the <span class="strong"><strong>Add</strong></span> button for <span class="strong"><strong>RELATIONSHIPS</strong></span>, check the <span class="strong"><strong>Content using field_recipecuisine</strong></span> relationship, and then click on the <span class="strong"><strong>Apply(all displays)</strong></span> button.</li><li class="listitem">On the next screen, leave the remaining default settings as they are and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button.</li><li class="listitem">Now click on the <span class="strong"><strong>FIELDS add</strong></span> button; there are content fields available. Type <code class="literal">title</code> into the <span class="strong"><strong>Search</strong></span> input, select it, and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button.<p>Note that there is a <span class="strong"><strong>Relationship</strong></span> select list for the field configuration. All the content fields on a taxonomy terms-based view require a relationship. So this will default to the first relationship listed.</p><div class="mediaobject"><img alt="Time for action – creating a Recipes by cuisine type Views block" src="graphics/4659_09_11.jpg"/></div></li><li class="listitem">Leave <a class="indexterm" id="id477"/>the <span class="strong"><strong>Create a label</strong></span> checkbox unchecked, as we only want to display the title itself. We will leave the <span class="strong"><strong>Link to this Content…</strong></span> checkbox checked, so that the users have the ability to navigate to the full recipe. Click on the <span class="strong"><strong>Apply (all displays)</strong></span> button.<p>Now if you scroll down to the bottom of the Views configuration page, you will see a preview of this Views output and you will see that we are displaying cuisine type term names and recipe titles, but we want to group the recipe titles by term names.</p></li><li class="listitem">Next, under the <span class="strong"><strong>FORMAT</strong></span> section, click on the <span class="strong"><strong>Settings</strong></span> link for Format and then select <span class="strong"><strong>Taxonomy term: Name</strong></span> for the <span class="strong"><strong>Grouping field Nr.1</strong></span> field and click on the <span class="strong"><strong>Apply</strong></span> button<div class="mediaobject"><img alt="Time for action – creating a Recipes by cuisine type Views block" src="graphics/4659_09_12.jpg"/></div></li><li class="listitem">You<a class="indexterm" id="id478"/> will see a preview of this View's output and you will see that we are displaying cuisine type term names and recipe titles, as we grouped the recipe titles by term names and term names were displaying twice. So we will hide them in the <span class="strong"><strong>FIELDS</strong></span> settings.</li><li class="listitem">Now click on the <span class="strong"><strong>Taxonomy term: Name</strong></span> link and check the <span class="strong"><strong>Exclude from display</strong></span> checkbox, as we only want to display the content titles. Then click on the <span class="strong"><strong>Apply (all displays)</strong></span> button.</li><li class="listitem">Now we will add a sort criterion to display the grouped terms with the most recent recipes first. Click on the <span class="strong"><strong>Add</strong></span> button for <span class="strong"><strong>SORT CRITERIA</strong></span>, type <code class="literal">Authored on</code> in the <span class="strong"><strong>Search</strong></span> field, select the <span class="strong"><strong>Authored on</strong></span> field, and then click on the <span class="strong"><strong>Apply (all displays)</strong></span> button.</li><li class="listitem">On the next screen, select <span class="strong"><strong>Sort descending</strong></span> for the <span class="strong"><strong>Order</strong></span> field and click on the <span class="strong"><strong>Apply (all displays)</strong></span> button. The preview for this View should now look similar to the following screenshot. Note: the following content is Devel module generated content.<div class="mediaobject"><img alt="Time for action – creating a Recipes by cuisine type Views block" src="graphics/4659_09_13.jpg"/></div></li><li class="listitem">Next, click on the <span class="strong"><strong>Save</strong></span> button for this View.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec76"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>We created a Views-based block of recipes displayed by the cuisine type name. Although everything appears fine on the surface, there is a problem with the groupings and the limits for our new view. We wanted to display three different cuisines and five recipes per cuisine type, but the view we created is only limiting the total number of rows being returned. If we were to add one more recipe, then that recipe would be displayed. However, the sixth-oldest recipe would drop off, and if the newly added recipe happened to be of type Thai or Asian, then the American grouping would disappear. So, we would only be left with two groups of cuisine types. It turns out that this is a rather complex problem to solve with SQL, but there is a contrib module that will allow us to get the exact results that we want.</p><p>The <a class="indexterm" id="id479"/>Views Field View module (<a class="ulink" href="http://drupal.org/project/views_field_view">http://drupal.org/project/views_field_view</a>) enables a Global Views field that allows you to embed another View as a field of a parent view, sort of like a set of Russian dolls. For actual production use, however, do note that there are some pretty serious performance implications for using this approach, as there will be a total of four SQL queries instead of one. So you definitely want to make sure you understand Views caching and Drupal caching in general before you use an approach like this on a production site.</p></div></div>
<div class="section" title="Time for action &#x2013; installing and using the Views Field View module for our Recipe by Cuisine Type View"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec115"/>Time for action – installing and using the Views Field View module for our Recipe by Cuisine Type View</h1></div></div></div><p>By installing a<a class="indexterm" id="id480"/>nd using the Views Field View module, we are going to learn how there are a number of Views related contrib modules that extend the features and capabilities of the Views module.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">First, we need to install the View Field View module. Open the Terminal (Mac OS X) or Command Prompt (Windows) application and go to the root directory of our d8dev site.</li><li class="listitem">Use Drush to download and enable the Views Field View module:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ drush dl views_field_vies</strong></span>
<span class="strong"><strong>Project views_field_view (8.x-1.0-beta2) downloaded to /var/www/html/d8dev/modules/views_field_view.  [success] </strong></span>
<span class="strong"><strong>$ drush en views_field_view </strong></span>
<span class="strong"><strong>The following extensions will be enabled: views_field_view </strong></span>
<span class="strong"><strong>Do you really want to continue? (y/n): y </strong></span>
<span class="strong"><strong>views_field_view was enabled successfully. [ok]</strong></span>
</pre></div></li><li class="listitem">Now, before we modify our Recipes by Cuisine view, you need to understand how the Views Field View functionality works. We will remove the recipe title field and add a <span class="strong"><strong>Global: View</strong></span> field. The <span class="strong"><strong>Global: View</strong></span> field allows us to specify another view to use as the contents of the field, instead of a field on our Recipe content type. It allows us to pass any other field available for our view as an argument to pass as a contextual filter to the other view being used as the contents of the field. I know it sounds pretty complicated, and that is why we are going to walk through it together, nice and slow. To start with, we need to create a view to use as the Views Field View, where it will list out the recipes ordered by post date in descending order, so we will use the Views Field View field to display the contents of our Recipe List view inside the rows of our Recipes by Cuisine view.</li><li class="listitem">Click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, then click on the <span class="strong"><strong>Views</strong></span> link, and click on the <span class="strong"><strong>Edit</strong></span> button for our random top rated recipe View.</li><li class="listitem">At the top of the next page, click on the <span class="strong"><strong>Add</strong></span> button and then click on the <span class="strong"><strong>Block</strong></span> link.</li><li class="listitem">Click <a class="indexterm" id="id481"/>on the <span class="strong"><strong>Add Field</strong></span> link and search for node id in the input search box. Check the <span class="strong"><strong>Exclude from display</strong></span> checkbox and click on the <span class="strong"><strong>Apply (this displays)</strong></span> button.</li><li class="listitem">Again click on the <span class="strong"><strong>Add Field</strong></span> link and search for view in the input search box. On the next screen, in the <span class="strong"><strong>VIEW SETTINGS</strong></span> section, select <span class="strong"><strong>Recipe likes count</strong></span> as <span class="strong"><strong>View</strong></span>, <span class="strong"><strong>Block</strong></span> as <span class="strong"><strong>Display</strong></span>, and <code class="literal">{{ fields.nid }}</code> as <span class="strong"><strong>Contextual filters</strong></span>. Click on the <span class="strong"><strong>Apply (this displays)</strong></span> button.<div class="mediaobject"><img alt="Time for action – installing and using the Views Field View module for our Recipe by Cuisine Type View" src="graphics/4659_09_14.jpg"/></div></li><li class="listitem">Now, in the <span class="strong"><strong>ADVANCED</strong></span> section, click on the <span class="strong"><strong>Add</strong></span> link for <span class="strong"><strong>Contextual filters</strong></span>. In the popup, search for the node ID keywords. Now check the <span class="strong"><strong>Node ID</strong></span> checkbox and click on the <span class="strong"><strong>Apply (this displays)</strong></span> button. In the next screen, leave the settings as default and click on the <span class="strong"><strong>Apply and continue</strong></span> button. Note: make sure you selected <span class="strong"><strong>This block (override)</strong></span> at the top.</li><li class="listitem">On the next screen, under <span class="strong"><strong>WHEN THE FILTER VALUE IS NOT AVAILABLE</strong></span> section, select the <span class="strong"><strong>Provide default value</strong></span> radio button. Select <span class="strong"><strong>Type</strong></span> as <span class="strong"><strong>Content ID from URL</strong></span> and click on the <span class="strong"><strong>Apply(this displays)</strong></span> button at the bottom.<div class="mediaobject"><img alt="Time for action – installing and using the Views Field View module for our Recipe by Cuisine Type View" src="graphics/4659_09_15.jpg"/></div></li><li class="listitem">Then <a class="indexterm" id="id482"/>save the view and we can see a preview of this block as per the following screenshot:<div class="mediaobject"><img alt="Time for action – installing and using the Views Field View module for our Recipe by Cuisine Type View" src="graphics/4659_09_16.jpg"/></div></li><li class="listitem">Next, click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, then click on the <span class="strong"><strong>Views</strong></span> link, and click on the Edit button for our Recipes by Cuisine View.</li><li class="listitem">At the top of the next page, click on the <span class="strong"><strong>Add</strong></span> button and then click on the <span class="strong"><strong>Block</strong></span> link.</li><li class="listitem">Click on the <span class="strong"><strong>Add Field</strong></span> link and search for node ID in the input search box. Check the <span class="strong"><strong>Exclude from display</strong></span> checkbox and click on the <span class="strong"><strong>Apply (this displays)</strong></span> button.</li><li class="listitem">Again<a class="indexterm" id="id483"/> click on the <span class="strong"><strong>Add Field</strong></span> link and search for view in the input search box. On the next screen, in the <span class="strong"><strong>VIEW SETTINGS</strong></span> section, select <span class="strong"><strong>Random Top Rated Recipe</strong></span> as <span class="strong"><strong>View</strong></span>, <span class="strong"><strong>Block 2</strong></span> as <span class="strong"><strong>Display</strong></span>, and <code class="literal">{{ raw_fields.nid }}</code> as <span class="strong"><strong>Contextual filters</strong></span>. Click on the <span class="strong"><strong>Apply (this displays)</strong></span> button.<div class="mediaobject"><img alt="Time for action – installing and using the Views Field View module for our Recipe by Cuisine Type View" src="graphics/4659_09_17.jpg"/></div></li><li class="listitem">Then save the view and we can see preview of this block as per the following screenshot:<div class="mediaobject"><img alt="Time for action – installing and using the Views Field View module for our Recipe by Cuisine Type View" src="graphics/4659_09_18.jpg"/></div></li><li class="listitem">Now<a class="indexterm" id="id484"/> we need to configure this new Views-based block to show up on the front page. Click on <span class="strong"><strong>Structure</strong></span> in the <span class="strong"><strong>Admin</strong></span> toolbar and click on the <span class="strong"><strong>Block Layout</strong></span> link.</li><li class="listitem">Scroll down towards <span class="strong"><strong>Sidebar first Region</strong></span> and click on the <span class="strong"><strong>Place block</strong></span> link. In the popup, search for <code class="literal">Recipes by</code> and click on the <span class="strong"><strong>Place block</strong></span> button for the Recipes by Cuisine block.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec77"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>With the help of the Views Field View module, we created a view that displays our recipe content.</p></div></div>
<div class="section" title="Tabbed Views display"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec116"/>Tabbed Views display</h1></div></div></div><p>In order to make the Recipes by Cuisine and to make the block more visually appealing, and appear more<a class="indexterm" id="id485"/> organized in the viewable area of our d8dev front page, we are going to display each cuisine type as a tab, and have recipes for the active tab. We are going to use a JavaScript-based approach for displaying our groups of recipes by cuisine in a tabbed interface. Take a look at the jQuery UI tabs page (<a class="ulink" href="http://jqueryui.com/tabs/">http://jqueryui.com/tabs/</a>) and<a class="indexterm" id="id486"/> you will see an example of how we can display Recipe by Cuisine in a tab.</p><div class="mediaobject"><img alt="Tabbed Views display" src="graphics/4659_09_19.jpg"/></div><p>The reason I am pointing out jQuery based UI tabs is because Drupal 8 includes the JavaScript library. So, it makes a lot of sense to use a JavaScript widget for the tab that is already available to us as part of the core Drupal 8 install. However, the markup that is currently being generated for our Recipe by Cuisine View will be fairly difficult to integrate with the jQuery UI tabs, because jQuery UI tabs are intended to handle the tabs and the tab content in separate HTML containers. Take a look at the example markup from the jQuery UI tabs page in the previous screenshot to see what I mean.</p><div class="informalexample"><pre class="programlisting">&lt;div id="tabs"&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href="#tabs-1"&gt;Tab1 title&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#tabs-2"&gt;Tab2 title&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#tabs-3"&gt;Tab3 title&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;div id="tabs-1"&gt;
    &lt;p&gt;Tab1 content&lt;/p&gt;
  &lt;/div&gt;
  &lt;div id="tabs-2"&gt;
    &lt;p&gt;Tab2 content&lt;/p&gt;
  &lt;/div&gt;
  &lt;div id="tabs-3"&gt;
    &lt;p&gt;Tab3 content&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre></div><p>The markup<a class="indexterm" id="id487"/> that Views is generating for our Recipes by Cuisine is more semantic. It keeps the group titles with the associated content (Views actually generates a lot more markup than this, so take a look at the source output for our Recipes by Cuisine View in your browser). Basically, a simplified version of what Views generates for the default format of HTML list is closer to the following:</p><div class="informalexample"><pre class="programlisting">&lt;div&gt;
  &lt;ul&gt;
    &lt;li&gt;content 1&lt;/li&gt;
    &lt;li&gt;content 2&lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;</pre></div><p>Therefore, if we want to use jQuery UI tabs then we have to modify the markup that Views is generating for our Recipes by Cuisine View. A Views style plugin would allow us to generate exactly the type of markup that is typically used with jQuery UI tabs. However, since we are going to write a custom plugin for Views anyways, why write one for creating tabs that isn't very semantic and is limited in regards to progressive enhancement?</p></div>
<div class="section" title="Time for action &#x2013; developing a Views style plugin for semantic tabs"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec117"/>Time for action – developing a Views style plugin for semantic tabs</h1></div></div></div><p>We are going to create a <a class="indexterm" id="id488"/>new module for our introduction to plugins for Views. And we will contribute it to Drupal in the next topic.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open PhpStorm and navigate to the <code class="literal">/modules/custom</code> folder in our d8dev project.</li><li class="listitem">Create a new folder named <code class="literal">views_semantic_tabs</code>—the name of our new module.</li><li class="listitem">Create a new file named <code class="literal">views_semantic_tabs.info.yml</code> and enter the following information:<div class="informalexample"><pre class="programlisting">  name: Views semantic tabs
  type: module
  description: Provides a views style plugin to display views results in jQuery UI Tabs.
  core: 8.x
  package: Views
  dependencies:
    - views</pre></div><p>In Drupal 7, we use the <code class="literal">hook_views_plugins()</code> hook function to register new plugins. Drupal 8, on the other hand, depends on annotations and auto-loading to discover any plugins such as blocks and views styles. The auto-loading concept allows us to put a plugin file in a predefined directory, and Views/Blocks find it as needed. The metadata of any plugin specified inside the plugin's file using comment block, is called as annotations.</p></li><li class="listitem">To find<a class="indexterm" id="id489"/> our style plugin by views, we have to place it in the <code class="literal">src/Plugin/views/style</code> folder which is inside our custom module <code class="literal">modules/views_semantic_tabs</code> directory. So here we wish to build semantic tabs style plugin that displays jQuery UI tabs based style.</li><li class="listitem">Create a new file <code class="literal">ViewsSemanticTabs.php</code> inside the <code class="literal">/views_semantic_tabs/src/Plugin/views/style</code> directory. The skeleton of the semantic tabs style plugin looks like the following:<div class="informalexample"><pre class="programlisting">&lt;?php

/**
 * @file
 * Contains \Drupal\views\Plugin\views\style\HtmlList.
 */

namespace Drupal\views_semantic_tabs\Plugin\views\style;

use Drupal\Core\Form\FormStateInterface;
use Drupal\views\Plugin\views\style\StylePluginBase;

/**
 * Style plugin to render each item in an ordered or unordered list.
 *
 * @ViewsStyle(
 *   id = "views_semantic_tabs",
 *   title = @Translation("Semantic tabs"),
 *   help = @Translation("Configurable semantic tabs for views fields."),
 *   theme = "views_semantic_tabs_format",
 *   display_types = {"normal"}
 * )
 */
class ViewsSemanticTabs extends StylePluginBase {

  /**
   * Does the style plugin allows to use style plugins.
   *
   * @var bool
   */
  protected $usesRowPlugin = TRUE;

  /**
   * Does the style plugin support custom css class for the rows.
   *
   * @var bool
   */
  protected $usesRowClass = TRUE;

    /**
     * Does the style plugin support grouping of rows.
     *
     * @var bool
     */
    protected $usesGrouping = FALSE;

  /**
   * Set default options
   */
  protected function defineOptions() {
    $options = parent::defineOptions();
    $options['group'] = array('default' =&gt; array());
    return $options;}

  /**
   * Render the given style.
   */
  public function buildOptionsForm(&amp;$form, FormStateInterface $form_state) {
      parent::buildOptionsForm($form, $form_state);
      $options = array('' =&gt; $this-&gt;t('- None -'));
      $field_labels = $this-&gt;displayHandler-&gt;getFieldLabels(TRUE);
      $options += $field_labels;
      $grouping = $this-&gt;options['group'];
      $form['group'] = array(
          '#type' =&gt; 'select',
          '#title' =&gt; $this-&gt;t('Grouping field'),
          '#options' =&gt; $options,
          '#default_value' =&gt; $grouping,
          '#description' =&gt; $this-&gt;t('You should specify a field by which to group the records.'),
          '#required' =&gt; TRUE,
      );
  }
}</pre></div><p>Our class <code class="literal">ViewsSemanticTabs</code> needs to inherit from the <code class="literal">StylePluginBase</code> class, and therefore we are using a keyword. Also, we are using <code class="literal">FormStateInterface</code> to user forms inside our class. This file is in the correct<a class="indexterm" id="id490"/> location and we have an annotation above the class definition. This annotation was giving the ID of the style, theme, and display types. So views will find this plugin and it will be available for selection in the views format style settings. The protected <code class="literal">$usesRowPlugin</code> property is necessary to this plugin which lets us select whether we would like to display fields or rendered content in the view display. The protected <code class="literal">$usesRowClass</code> property also required for our case which does the style plugin support custom CSS class for the rows. The protected <code class="literal">defineOptions()</code> method is used to define default options which will show in the settings form. And the protected <code class="literal">buildOptionsForm()</code> method is used to define any custom form values which will show in the settings form. <code class="literal">parent::buildOptionsForm($form, $form_state);</code> allows us to access the output of the class we are extending and manipulate that output. We are making the <code class="literal">$form['group']</code> field required since the views HTML render output requires a grouping field name.</p></li><li class="listitem">The output of views will live in the template file and the template file will need to be placed inside the <code class="literal">templates</code> directory with <code class="literal">views-semantic-tabs-format.html.twig</code> as the filename inside our module. We don't need to implement the <code class="literal">hook_theme()</code> hook function because it will be automatically registered based on the specified theme name in the annotation <code class="literal">views_semantic_tabs_format</code>. The template filename is derived from the theme name by replacing the underscores with hyphens and followed by the <code class="literal">html.twig</code> extension.<div class="informalexample"><pre class="programlisting">&lt;div class="views-semantic-tabs"&gt;
    &lt;ul&gt;
        {% set i = 1 %}
        {% for row in rows.group %}
          &lt;li&gt;&lt;a href="#tabs-{{ i }}"&gt;{{ row }}&lt;/a&gt;&lt;/li&gt;
        {% set i = i + 1 %}
        {% endfor %}
    &lt;/ul&gt;
    {% set j = 1 %}
    {% for row in rows %}
            &lt;div id="tabs-{{ j }}"&gt;{{ row.content }}&lt;/div&gt;
        {% set j = j + 1 %}
    {% endfor %}
&lt;/div&gt;</pre></div><p>First, we need to understand that this template will be used for each tab. We had to wrap the group field values as a separate set which are part of <code class="literal">&lt;li&gt;</code> tags in <code class="literal">&lt;ul&gt;</code>. We are wrapping rows data which is the content for the tab and wrapped with the <code class="literal">div</code> tag with unique <code class="literal">tabs- id</code> attributes.</p></li><li class="listitem">The variables<a class="indexterm" id="id491"/> in the template is provided by views. Preparing variables for a <code class="literal">twig</code> file can be done with the <code class="literal">template_preprocess_views_semantic_tabs_format()</code> function in the <code class="literal">.module</code> file. This function name is defined based on the specified name in the annotation <code class="literal">views_semantic_tabs_format</code>. Create a new file <code class="literal">views_semantic_tabs.module</code> inside the <code class="literal">/modules/views_semantic_tabs</code> directory. The skeleton of the semantic tabs style plugin looks like the following:<div class="informalexample"><pre class="programlisting">&lt;?php

/**
 * @file
 * Contains views_semantic_tabs.module..
 */

use Drupal\Core\Routing\RouteMatchInterface;
use Drupal\Core\Template\Attribute;

/**
 * Implements hook_help().
 */
function views_semantic_tabs_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    // Main module help for the views_semantic_tabs module.
    case 'help.page.views_semantic_tabs':
      $output = '';
      $output .= '&lt;h3&gt;' . t('About') . '&lt;/h3&gt;';
      $output .= '&lt;p&gt;' . t('Provides a views style plugin to display views results in jQuery UI Tabs.') . '&lt;/p&gt;';
      return $output;

    default:
  }
}

/**
 * Prepares variables for Views HTML list templates.
 *
 * @param array $variables
 *   An associative array containing:
 *   - view: A View object.
 */
function template_preprocess_views_semantic_tabs_format(&amp;$variables) {
    $handler  = $variables['view']-&gt;style_plugin;
    $view = $variables['view'];
    $rows = $variables['rows'];
    $style = $view-&gt;style_plugin;
    $fields = &amp;$view-&gt;field;
    $options = $style-&gt;options;
    $variables['fields'] = $fields;

    // add jquery &amp; jquery ui
    $variables['view']-&gt;element['#attached']['library'][] = 'core/jquery.ui.tabs';
    $variables['view']-&gt;element['#attached']['library'][] = 'core/jquery';
    $variables['view']-&gt;element['#attached']['library'][] = 'views_semantic_tabs/views-semantic-tabs';

    // Get first group field selected
    if($options){
        $first_group_field = $options['group'];
    }

    // Add tabs id to main div
    $variables['attributes'] = new Attribute(array('id' =&gt; 'tabs'));
    $fields = &amp;$view-&gt;field;

    $variables['default_row_class'] = !empty($options['default_row_class']);
    foreach ($rows as $id =&gt; $row) {
        // todo : group field value should be plain text
        $field_output = $handler-&gt;getField($id, $first_group_field);
        $variables['rows']['group'][] = $field_output;
        $variables['rows'][$id] = array();
        $variables['rows'][$id]['content'] = $row;
        $variables['rows'][$id]['attributes'] = new Attribute();
        if ($row_class = $view-&gt;style_plugin-&gt;getRowClass($id)) {
          $variables['rows'][$id]['attributes']-&gt;addClass($row_class);
        }
    }

}</pre></div><p>There are two functions, <code class="literal">template_preprocess_views_semantic_tabs_format()</code> and <code class="literal">hook_help</code>. At the very top of our <code class="literal">template_preprocess_views_semantic_tabs_format()</code> function, we are getting the required handler, rows, fields, and style properties from the <code class="literal">$variables</code> variable. Then we are attaching <code class="literal">jquery.ui.tabs</code>, jQuery core jQuery libraries to the <code class="literal">$variable</code>, because it requires both jQuery libraries. And also <a class="indexterm" id="id492"/>we attaching the custom <code class="literal">views-semantic-tabs</code> library which has custom JS file where we will define jQuery code to work tabs. In the next lines, we are building rows data which is a part of tab content. And we declared the help function to define simple documentation about this module. For more information about the <code class="literal">hook_help()</code> function, go to <a class="ulink" href="https://api.drupal.org/api/drupal/core!modules!help!help.api.php/function/hook_help/8">https://api.drupal.org/api/drupal/core!modules!help!help.api.php/function/hook_help/8</a>.</p></li><li class="listitem">Next, right-click on the new theme folder, create a new file named <code class="literal">views_semantic_tabs.libraries.yml</code>, and add the following code to that file:<div class="informalexample"><pre class="programlisting">views-semantic-tabs:
  version: VERSION
  js:
    js/views-semantic-tabs.js: {}
  dependencies:
    - core/jquery
    - core/drupal</pre></div><p>This is the library file which we attached in the <code class="literal">template_preprocess_views_semantic_tabs_format()</code> function in the last step. This defines the <code class="literal">views-semantic-tabs.js</code> file which has tabs jQuery code to work jQuery tabs as per the rendered HTML structure defined in the twig file.</p></li><li class="listitem">Next, right-click on the module folder and create a new folder named <code class="literal">js</code>. Again, right click on the <code class="literal">js</code> folder and create a file named <code class="literal">views-semantic-tabs.js</code>. Add the following code to that file:<div class="informalexample"><pre class="programlisting">  (function ($) {
    $(function() {
        $( ".views-semantic-tabs" ).tabs();
    });
})(jQuery);</pre></div><p>Note how the entire block of JavaScript code is wrapped with <code class="literal">(function ($) { ... })(jQuery);</code>. This is a new JavaScript namespacing feature of Drupal 7 and Drupal 8, and allows other JavaScript libraries to be used with Drupal with less likelihood of conflicts. <code class="literal">$( ".views-semantic-tabs" ).tabs();</code> is the code which makes our twig rendered HTML code work as tabs.</p></li><li class="listitem">Now that we have completed all the code, our <code class="literal">views_semantic_tabs</code> folder should look similar to the following screenshot:<div class="mediaobject"><img alt="Time for action – developing a Views style plugin for semantic tabs" src="graphics/4659_09_20.jpg"/></div></li><li class="listitem">Now <a class="indexterm" id="id493"/>we are ready to test our new Views style plugin by applying it to our Recipes by Cuisine view, but first we need to enable our new module. We could use Drush for this, but I would like to enable custom modules in the browser so that I can see my new module.</li><li class="listitem">Open our d8dev site in your browser, click on the <span class="strong"><strong>Extend</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, and scroll down to the <span class="strong"><strong>Views</strong></span> section of the modules or search for <code class="literal">views semantic</code> in the search input box.</li><li class="listitem">You should see our new Views Semantic Tabs module listed along with the other Views modules that we had installed.<div class="mediaobject"><img alt="Time for action – developing a Views style plugin for semantic tabs" src="graphics/4659_09_21.jpg"/></div></li><li class="listitem">Check the checkbox to enable our new module and click on the <span class="strong"><strong>Install</strong></span> button.</li><li class="listitem">Next, click <a class="indexterm" id="id494"/>on the <span class="strong"><strong>Home</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, then click on the <span class="strong"><strong>Contextual links</strong></span> button for our Recipes by Cuisine view, and click on the <span class="strong"><strong>Edit view</strong></span> link.<div class="mediaobject"><img alt="Time for action – developing a Views style plugin for semantic tabs" src="graphics/4659_09_22.jpg"/></div></li><li class="listitem">Under <span class="strong"><strong>FORMAT</strong></span>, click on the <span class="strong"><strong>Unformatted list</strong></span> link. The view style settings form now includes our new Views style plugin: <span class="strong"><strong>Semantic tabs</strong></span>.<div class="mediaobject"><img alt="Time for action – developing a Views style plugin for semantic tabs" src="graphics/4659_09_23.jpg"/></div></li><li class="listitem">Select <a class="indexterm" id="id495"/>our <span class="strong"><strong>Semantic tabs</strong></span> style and click on the <span class="strong"><strong>Apply (this display)</strong></span> button.</li><li class="listitem">Next, on the <span class="strong"><strong>Style options</strong></span> screen, select <span class="strong"><strong>Taxonomy term: Name</strong></span> as <span class="strong"><strong>Grouping field</strong></span> and click on the <span class="strong"><strong>Apply</strong></span> button. Note that <span class="strong"><strong>Grouping field</strong></span> is required as we specified in our plugin class.<div class="mediaobject"><img alt="Time for action – developing a Views style plugin for semantic tabs" src="graphics/4659_09_24.jpg"/></div></li><li class="listitem">Now, click<a class="indexterm" id="id496"/> on the <span class="strong"><strong>Save</strong></span> button to save our changes to the view. You should now have a Recipe by Cuisine view block that looks similar to the following screenshot:<div class="mediaobject"><img alt="Time for action – developing a Views style plugin for semantic tabs" src="graphics/4659_09_25.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec78"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>Although this example was fairly complex, the actual code is pretty straightforward once you get your head wrapped around some of the development concepts for Views plugins. We were able to create a custom Views style plugin that will enhance the display of content on our d8dev site.</p></div></div>
<div class="section" title="Time for another Recipe"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec118"/>Time for another Recipe</h1></div></div></div><p>Here is a little bit of spicy Americana for you—Kurt's Classic Chili. Add it to the d8dev site and checkout the Recipes by Cuisine view from the previous section (the secret ingredient is the bay leaves).</p><div class="mediaobject"><img alt="Time for another Recipe" src="graphics/4659_09_25_01.jpg"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>name</strong></span>: Kurt's Classic Chili</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>description</strong></span>: There is nothing like a warm bowl of chili on a cold winter day.The homemade chili powder really gives this dish a distinct and delicious flavor.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>recipeYield</strong></span>: Eight servings</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>prepTime</strong></span>: 30 minutes</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>cookTime</strong></span>: 60 minutes</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>ingredients</strong></span>:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">One pound of ground beef</li><li class="listitem" style="list-style-type: disc">Two tablespoons of olive oil</li><li class="listitem" style="list-style-type: disc">One large sweet onion, chopped</li><li class="listitem" style="list-style-type: disc">Six cloves garlic, crushed</li><li class="listitem" style="list-style-type: disc">Eight ancho peppers, dried</li><li class="listitem" style="list-style-type: disc">Eight guajillo peppers, dried</li><li class="listitem" style="list-style-type: disc">Two tablespoons of molasses</li><li class="listitem" style="list-style-type: disc">One tablespoon of cocoa powder</li><li class="listitem" style="list-style-type: disc">Six oz lager beer</li><li class="listitem" style="list-style-type: disc">Three tablespoon of cumin</li><li class="listitem" style="list-style-type: disc">Half cup beef broth</li><li class="listitem" style="list-style-type: disc">Two cups tomato sauce</li><li class="listitem" style="list-style-type: disc">One large yellow bell pepper, diced</li><li class="listitem" style="list-style-type: disc">One large jalapeno pepper, diced</li><li class="listitem" style="list-style-type: disc">One cup light kidney beans</li><li class="listitem" style="list-style-type: disc">One cup dark kidney beans</li><li class="listitem" style="list-style-type: disc">Three Bay leaves</li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>instructions</strong></span>:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Combine the dried peppers in a food processor and process for two minutes.</li><li class="listitem" style="list-style-type: disc">Add crushed garlic, molasses, and cocoa powder, and process for two minutes.</li><li class="listitem" style="list-style-type: disc">Add oil to a large Dutch oven over medium low heat and heat up for three to four minutes.</li><li class="listitem" style="list-style-type: disc">Turn the heat to medium, add onions and cook, stirring frequently, until it just starts to caramelize for about four to eight minutes.</li><li class="listitem" style="list-style-type: disc">Add ground beef to onions, stirring frequently until meat is browned, for about eight minutes.</li><li class="listitem" style="list-style-type: disc">Combine the dried chilies mixture with ground beef and onions, and sauté for three to four minutes.</li><li class="listitem" style="list-style-type: disc">Add beer and stir to loosen any browned bits from the bottom of the Dutch oven, and simmer over medium heat for five minutes.</li><li class="listitem" style="list-style-type: disc">Add tomato sauce and cumin, and stir until combined. Simmer for five minutes.</li><li class="listitem" style="list-style-type: disc">Add diced pepper, kidney beans, and bay leaves. Reduce heat to low and simmer, stirring occasionally, for 30 minutes.</li></ul></div></li></ul></div></div>
<div class="section" title="Contributing the Views semantic tabs module to Drupal"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec119"/>Contributing the Views semantic tabs module to Drupal</h1></div></div></div><p>In this <a class="indexterm" id="id497"/>chapter, we have put a lot of effort in the semantic tabs module. It seems that it would make a lot of sense to make these enhancements available to the Drupal community as a whole. But, before we do that, there are a few things we need to do to ensure that the module is as useful as possible for the Drupal community.</p><p>Drupal has coding <a class="indexterm" id="id498"/>standards that are strictly enforced when promoting any code for the first time. A good overview of coding standards for Drupal is available at <a class="ulink" href="http://drupal.org/coding-standards">http://drupal.org/coding-standards</a>. Before any code is contributed to Drupal, it should be checked to make sure that it conforms to Drupal's coding standards. Thankfully, this is pretty easy, because as pointed out on the page mentioned previously, there is a Coder module that provides an automated process for checking standards compliance of your code.</p><p>However, we don't need to install this module as we have online tools available to do this job. <a class="ulink" href="http://pareview.sh">http://pareview.sh</a> is a service which performs automated reviews of Drupal projects using PHP CodeSniffer. This online service provides the recent pareview script without installing a local testing environment. Now it's time to create a sandbox module project in Drupal and push our views semantic tabs module code.</p></div>
<div class="section" title="Time for action &#x2013; creating a sandbox for the views semantic tabs module"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec120"/>Time for action – creating a sandbox for the views semantic tabs module</h1></div></div></div><p>Drupal allows us to <a class="indexterm" id="id499"/>create a new project type such as a module, theme, or distribution. In our case, we want to contribute a module.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to <a class="ulink" href="https://www.drupal.org/node/add">https://www.drupal.org/node/add</a> and click on the <span class="strong"><strong>Module project</strong></span> link.<div class="mediaobject"><img alt="Time for action – creating a sandbox for the views semantic tabs module" src="graphics/4659_09_27_02.jpg"/></div></li><li class="listitem">I'm filling<a class="indexterm" id="id500"/> out the form. Our new project will initially be a Sandbox project. And I already have permission to promote projects from Sandbox to Full projects. I can see a checkbox allowing you to choose <span class="strong"><strong>Full project</strong></span>, but normally it is best to start with a Sandbox anyway.<div class="mediaobject"><img alt="Time for action – creating a sandbox for the views semantic tabs module" src="graphics/4659_09_27.jpg"/></div></li><li class="listitem">By clicking <a class="indexterm" id="id501"/>on the <span class="strong"><strong>Save</strong></span> button, Drupal creates and loads a page for your new project: <a class="ulink" href="https://www.drupal.org/sandbox/krishnakanth17/2665888">https://www.drupal.org/sandbox/krishnakanth17/2665888</a>.<div class="mediaobject"><img alt="Time for action – creating a sandbox for the views semantic tabs module" src="graphics/4659_09_28.jpg"/></div></li><li class="listitem">Click<a class="indexterm" id="id502"/> the <span class="strong"><strong>Version control</strong></span> tab near the top of the new project page for instructions on how to start committing code to your sandbox repository.<div class="mediaobject"><img alt="Time for action – creating a sandbox for the views semantic tabs module" src="graphics/4659_09_29.jpg"/></div></li><li class="listitem">Setting up this repository for the first time, there are a few steps we need to follow with Git to push our module code. Note: you will be prompted to enter your Drupal password after the last step.<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mkdir views_semantic_tabs</strong></span>
<span class="strong"><strong>$ cd views_semantic_tabs</strong></span>
<span class="strong"><strong>$ git init</strong></span>
<span class="strong"><strong>$ git checkout -b 8.x-1.x</strong></span>
<span class="strong"><strong>$ echo "name = Views semantic tabs" &gt; views_semantic_tabs.info.yml</strong></span>
<span class="strong"><strong>$ git add views_semantic_tabs.info</strong></span>
<span class="strong"><strong>$ git commit -m "Initial commit."</strong></span>
<span class="strong"><strong>$ git remote add origin krishnakanth17@git.drupal.org:sandbox/krishnakanth17/2665888.git</strong></span>
<span class="strong"><strong>$ git push origin 8.x-1.x</strong></span>
</pre></div></li><li class="listitem">Next, all <a class="indexterm" id="id503"/>our module files need to be pushed to the sandbox. So copy and paste all the files inside this directory and follow these <code class="literal">git</code> commands as per the <a class="ulink" href="https://www.drupal.org/project/2665888/git-instructions">https://www.drupal.org/project/2665888/git-instructions</a> page.<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ git add -A</strong></span>
<span class="strong"><strong>$ git commit -m "Pushing all files of module"</strong></span>
<span class="strong"><strong>$ git push -u origin 8.x-1.x</strong></span>
</pre></div></li><li class="listitem">We are done with creating the sandbox project and pushing our module code to it. Next, we need to promote this module to the full project. I have permission to promote projects from Sandbox to Full projects, once our sandbox is in a state where we think it is ready to be promoted to a full project, can apply for that permission. If we don't have this permission then we must go through a one-time approval process. Check <a class="ulink" href="https://www.drupal.org/node/1011698">https://www.drupal.org/node/1011698</a> for more information.</li><li class="listitem">But we are proceeding to promoting to the full project, our code is contributed to drupal.org, and it should be checked to make sure that it conforms to Drupal's coding standards. So we will be using online tools to check Drupal standards. As we discussed earlier, we will be using <a class="ulink" href="http://pareview.sh">http://pareview.sh</a>. In the URL input box, enter the URL <code class="literal">http://git.drupal.org/sandbox/krishnakanth17/2665888.git</code> and click on the <span class="strong"><strong>Submit branch</strong></span> button.<div class="mediaobject"><img alt="Time for action – creating a sandbox for the views semantic tabs module" src="graphics/4659_09_30.jpg"/></div></li><li class="listitem">After submitting, it takes me to the <a class="ulink" href="http://pareview.sh/pareview/httpgitdrupalorgsandboxkrishnakanth172665888.git">http://pareview.sh/pareview/httpgitdrupalorgsandboxkrishnakanth172665888.git</a> page and it listed the things that need to be fixed.<div class="mediaobject"><img alt="Time for action – creating a sandbox for the views semantic tabs module" src="graphics/4659_09_32.jpg"/></div></li><li class="listitem">It will take some time to fix all those errors.</li></ol></div><p>In the next chapter, we will <a class="indexterm" id="id504"/>promote this sandbox module to a full project.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec121"/>Summary</h1></div></div></div><p>In this chapter, we learned a lot about Views and saw how Views allows you to add interesting components to your site through a web-based user interface. We also learned that Views offers a powerful development platform for custom extensions. We created a sandbox project for the views semantic tabs module. We also looked into some online tools to review our module to check Drupal coding standards.</p><p>In the next chapter, we are going to add some visually-striking banner components that will leverage the Views development from this chapter, and show off all the beautiful photos of the recipes on the d8dev site. Finally, we will promote the views semantic tabs module as the full project.</p></div></body></html>
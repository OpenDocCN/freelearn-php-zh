<html><head></head><body><div class="chapter" title="Chapter&#xA0;10.&#xA0;Running Your Website"><div class="titlepage"><div><div><h1 class="title"><a id="ch10"/>Chapter 10. Running Your Website</h1></div></div></div><p>By now, the vast majority of the development for the new site is complete! You should also feel confident that, from a development perspective, you can respond to whatever demands the site throws at you and work with Drupal with a high degree of proficiency. Like all things in the computing world, however, it is never sufficient to build something and then leave your creation to run by itself. There is always work to be done to ensure that everything runs smoothly.</p><p>Often, you will find that there are certain jobs that need to be performed every now and then that are not specifically related to Drupal, but are intrinsic to working with websites in general. These tasks can vary greatly in nature, but all those discussed here will be useful at some stage during the life of your website, even if you don't need them right now.</p><p>One of the problems with presenting a chapter like this is that we can't possibly hope to cover each and every nuance of the huge array of different platforms on which Drupal can be run. Internet Service Providers (ISPs) offer wildly varying packages, which can either be totally bereft of any type of helpful functionality, or packed full with all the latest gadgets—most ISPs offer a large variety of packages under one roof.</p><p>Because of this, we will look at functionality that is in common use and that, in the event you do not have access to the same software, will clearly demonstrate the tasks you need to perform so that you can still successfully operate with the software you<span class="emphasis"><em> do have access to</em></span>. For example, by using the Apache2Triad package, we already have certain useful technologies that we can make use of on the development machine, such as phpMyAdmin.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note43"/>Note</h3><p>It may be helpful to read through this chapter before selecting a hosting package (assuming you haven't already) so that you can get a feel for the type of functionality that you will need in the future.</p></div></div><p>There are also a few other web-related activities inherent to Drupal that we should take the time to look over quickly. As a result, this chapter will talk about:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Making backups</li><li class="listitem" style="list-style-type: disc">Cron and scheduled tasks</li><li class="listitem" style="list-style-type: disc">Throttling</li><li class="listitem" style="list-style-type: disc">Patching</li><li class="listitem" style="list-style-type: disc">Website activities—including search engine optimization and user maintenance</li></ul></div><p>Armed with the information presented in this the final chapter, you will be a fully equipped Drupal-website administrator. However, the experience you gain from running a live website in itself should prove to be far more valuable than this humble book. Hopefully, you will find the entire experience richly rewarding and share your hard-won knowledge with the rest of the community in the future.</p><p>We're on the home straight, so let's get on with it.</p><div class="section" title="Backups"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec01"/>Backups</h1></div></div></div><p>There are plenty of reasons to make backups of both the file system and database. As mentioned several times throughout the course of the book, you should back up anything that is at risk of being damaged whenever you modify code, or add a new module, or even upgrade versions of Drupal. It sounds like a real pain to do this because the vast majority of the time, nothing goes wrong with the application. However, sooner or later, for some unfathomable reason, if you don't make backups, you<span class="emphasis"><em> will</em></span> get stung in precisely the most painful spot.<a class="indexterm" id="id383"/>
</p><p>Most especially, corrupting or breaking a database, which in turn leads to a loss of precious data, can be a real pain in the… back end of your application! So, while it is fairly easy to back up the files on the file system by simply making copies of the directories in question, or indeed copying the entire<code class="literal"> drupal</code> folder (whatever you have named it), it is of paramount importance that you learn how to back up the database too, because this is not as trivial—it will become easy with practice, though.</p><p>Before continuing, it is important to have a<span class="emphasis"><em> strategy</em></span> for backing up files, folders, and data. It is good idea to back up the entire site at regular intervals, as well as backing up the database even more frequently. These backups should be clearly marked so that you know when they were made, making it easy to determine which one to use in the event of some sort of disaster. You might also consider holding these backups away from the main file system, perhaps on a CD, so that if something really bad happens, you don't have to rely on your host's disaster-recovery policy; you have your own.<a class="indexterm" id="id384"/>
</p><p>There are two ways of backing up your database (or any part of it) that we will consider here. One way is to make use of phpMyAdmin, which comes as part of the Apache2Triad package. Let's start with that.</p><div class="section" title="phpMyAdmin"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec01"/>phpMyAdmin</h2></div></div></div><p>phpMyAdmin is an exceptionally popular and commonplace tool for interacting with MySQL via the Web. Instead of having to learn how to use the MySQL command-line client, phpMyAdmin provides us with a graphical interface, which makes it a lot easier to view and maintain databases tables and content. Issuing commands is also made easier with the interface for many of the most commonplace data-related tasks.</p><p>The following steps can be followed in order to create a backup with phpMyAdmin:<a class="indexterm" id="id385"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log into phpMyAdmin and select the relevant Drupal database.<a class="indexterm" id="id386"/></li><li class="listitem">Click on the<span class="strong"><strong> Export</strong></span> tab along the top of the page, and set up the options as shown here:<div class="mediaobject"><img alt="phpMyAdmin" src="graphics/1800_10_01.jpg"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: none">In the screenshot, all the tables were selected for backup, all the Structure checkboxes were selected in order to prevent us having to manually drop a corrupted database, and a useful name (which automatically contains the database name once the backup file is generated) was provided—appending the date as shown is a good idea as it will help you to keep track of which backup is which.</li></ul></div></li><li class="listitem">Click<span class="strong"><strong> Go</strong></span> once you are satisfied with your options, and this will then create a SQL file (although there are other formats to choose from such as LaTeX or XML) from which you can recreate the database if needed.</li></ol></div><p>Once you have a backup file, it is a simply matter of causing MySQL to run its contents in order to recreate the database. In order to do this, click on the<span class="strong"><strong> SQL</strong></span> tab at the top of the page, and enter the name of the<code class="literal"> .sql</code> file you would like to run against the database, as shown here:<a class="indexterm" id="id387"/>
</p><div class="mediaobject"><img alt="phpMyAdmin" src="graphics/1800_10_02.jpg"/></div><p>That makes life fairly simple, but it isn't the only way. If you have gotten used to using the command line, or simply prefer it, then we have already seen how it is done, when we issued the command to load the original database:</p><div class="informalexample"><pre class="programlisting">C:\ mysql -udrupal -p drupal &lt; C:/apache2triad/htdocs/drupal-4.6.4/ database/database.mysql
</pre></div><p>You would simply modify the path and filename to reflect the specifics of your new backup file, like so:<a class="indexterm" id="id388"/>
</p><div class="informalexample"><pre class="programlisting">C:\ mysql -uroot -p drupal &lt; <span class="strong"><strong>C:/backups/drupal_13_04_06.sql</strong></span>
</pre></div><p>Another way of creating backups is by using the<code class="literal"> mysqldump</code> utility from the command line.</p></div><div class="section" title="The mysqldump Utility"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec02"/>The mysqldump Utility</h2></div></div></div><p>It is probably worthwhile spending some time using this because it provides greater flexibility should you ever need to perform anything out of the ordinary. I will confess, though, that for most database‑related tasks phpMyAdmin will perform admirably. If you don't have access to phpMyAdmin on your hosted site, or if you are keen to get to know<code class="literal"> mysqldump</code>, then by all means continue…<a class="indexterm" id="id389"/>
</p><p>To create a backup, simply type in something like the following at the command line:</p><div class="informalexample"><pre class="programlisting">C:\ mysqldump drupal &gt; drupal_13_04_06.sql
</pre></div><p>This will create a backup file called<code class="literal"> drupal_06_11_05.sql</code> in the current directory. You can then ensure that this has worked by viewing the contents of the file, which will contain reams and reams of SQL statements. There are plenty of different options that you can use to get a variety of different types of backup file; you can simply type in:</p><div class="informalexample"><pre class="programlisting">C:\ mysqldump help
</pre></div><p>in order to obtain a list of what's available.<code class="literal"> mysqldump</code> is a powerful and flexible tool, and knowing how it works will benefit you in the long run if you are going to attempt some more advanced backup options.</p><p>To reiterate, it is good practice to back up your database on a regular basis, regardless of whether your need to do so for upgrading purposes as doing this will protect you from a total loss of data in the event that some sort of disaster destroys the database or loses its information.</p></div></div></div>
<div class="section" title="Cron and Scheduled Tasks"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec02"/>Cron and Scheduled Tasks</h1></div></div></div><p>In order to keep the site running smoothly and keep it up to date, there are a variety of chores that need to be performed on a regular basis. For example, we saw earlier in the book that the aggregator module needed to be run on a regular basis so that it could update all its feeds and so forth. The Drupal developers are well aware of all the tasks that need to be handled; so they bundled everything up into one handy script—cron.php.<a class="indexterm" id="id390"/>
</p><p>You need to set the<span class="strong"><strong> crontab</strong></span> or<span class="strong"><strong> scheduled task</strong></span> to execute the<code class="literal"> cron.php</code> script, which is housed in the main folder of your Drupal installation, so that it can perform all the necessary tasks. The cron script basically searches through the site and executes any tasks that apply to modules or other things (like log handling) so that they all stay updated.</p><p>Let's take a look at how to control the crontab, followed by setting up a scheduled task for the Windows users among us.</p><div class="section" title="The Crontab"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec03"/>The Crontab</h2></div></div></div><p>If you are not particularly keen to learn how to make use of the crontab on your hosted site, then feel free to skip to the section entitled<span class="emphasis"><em> Poormanscron</em></span> a little later on in this chapter. It is recommended that you do learn how to make use of the crontab regardless, because it will no doubt come in handy someday when your Drupal site is not immediately available.</p><p>All the variables set in the crontab are numerical constants, with the exception of the asterisk character, which is a wildcard that allows any value. The ranges permitted for each field are as follows:<a class="indexterm" id="id391"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Minutes: 0-59</li><li class="listitem" style="list-style-type: disc">Hours: 0-23</li><li class="listitem" style="list-style-type: disc">Day of month: 1-31</li><li class="listitem" style="list-style-type: disc">Month: 1-12</li><li class="listitem" style="list-style-type: disc">Weekday: 0-7 (Sunday is either 0 or 7)</li></ul></div><p>You can include multiple values for each entry, simply by separating each value with a comma. The command you wish to issue can be any shell command, and can be used to execute web pages, like the<code class="literal"> cronfeed.php</code> file. Many hosting companies will have an interface such as the following one, which allows you to work with the crontab easily:<a class="indexterm" id="id392"/>
</p><div class="mediaobject"><img alt="The Crontab" src="graphics/1800_10_03.jpg"/></div><p>In the final entry you can see (hopefully) that the<code class="literal"> cron.php</code> script is set to run at midnight every day using the command:</p><div class="informalexample"><pre class="programlisting">/usr/bin/lynx source http://<span class="strong"><strong>www.cwc.com</strong></span>/cron.php
</pre></div><p>whereas, for example, the first task is set to run every hour (remember to substitute your own site's URL in place of the highlighted code in the previous snippet). Notice too that the<code class="literal"> php</code> command was not used to execute the cron script as it was for the other two scripts—this is because the<code class="literal"> cron.php</code> file needs to be accessed as a web page so that certain environment variables are properly set.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip03"/>Tip</h3><p>Set your cron job to run at regular intervals to ensure that your site is kept as up to date as possible! It is recommended that<code class="literal"> cron.php</code> is run several times a day.</p></div></div></div><div class="section" title="Windows Scheduled Tasks"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec04"/>Windows Scheduled Tasks</h2></div></div></div><p>On the off chance you are using a Windows-based server, or simply wish to enable scheduled tasks on your Windows PC while you are developing, you can make use of the<span class="strong"><strong> Scheduled Task</strong></span> wizard. The following instructions, taken from the Drupal site, explain exactly how this is done:<a class="indexterm" id="id393"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to<span class="strong"><strong> Start | Programs | Accessories | System Tools | Scheduled Tasks</strong></span>.</li><li class="listitem">Double-click<span class="strong"><strong> Add Scheduled Task</strong></span>.</li><li class="listitem">The<span class="strong"><strong> Scheduled Task</strong></span> wizard will appear. Click<span class="strong"><strong> Next</strong></span>.</li><li class="listitem">Select the program to run. Choose your<span class="strong"><strong> browser</strong></span> from the list (for example, Internet Explorer or Firefox). Click<span class="strong"><strong> Next</strong></span>.</li><li class="listitem">Give the task a<span class="strong"><strong> Name</strong></span>, such as<span class="strong"><strong> Drupal Cron Job</strong></span>, and choose the<span class="strong"><strong> Frequency</strong></span> with which to perform the task (for example,<span class="strong"><strong> Daily)</strong></span>. Click<span class="strong"><strong> Next</strong></span>.</li><li class="listitem">Choose specific<span class="strong"><strong> date and time options</strong></span> (this step will vary, depending on the option selected in the previous step). When finished, click<span class="strong"><strong> Next</strong></span>.</li><li class="listitem">Enter your<span class="strong"><strong> password</strong></span> if prompted. Change the<span class="strong"><strong> username</strong></span> if required (for example, if you'd like the task to run under a user with few privileges for security reasons). Click<span class="strong"><strong> Next</strong></span>.</li><li class="listitem">On the final page, select the checkbox<span class="strong"><strong> Open advanced properties for this task when I click Finish</strong></span> and click<span class="strong"><strong> Finish</strong></span>.</li><li class="listitem">Go to the task's setting page either by checking the checkbox at the end of the last step, or by double-clicking on the task.</li><li class="listitem">In the<span class="strong"><strong> Run</strong></span> box, after the text that is there now (for example,<span class="strong"><strong> C:\PROGRA~1\MOZILL~1\firefox.exe)</strong></span>, enter a space and then type the address of your website's<code class="literal"> cron.php</code> page in double quotation marks (for example,<span class="strong"><strong> C:\PROGRA~1\MOZILL~1\</strong></span>firefox.exe <span class="strong"><strong>"http://localhost/drupal/cron.php")</strong></span></li><li class="listitem">To set a frequency higher than<span class="strong"><strong> Daily</strong></span> (for example,<span class="strong"><strong> Hourly)</strong></span>, click the<span class="strong"><strong> Schedule</strong></span> tab, and then click<span class="strong"><strong> Advanced</strong></span>. Here you can set options such as<span class="strong"><strong> Repeat</strong></span> task, every<span class="strong"><strong> 1 hour</strong></span> for<span class="strong"><strong> 23 hours</strong></span>. Click<span class="strong"><strong> OK</strong></span> when finished.</li><li class="listitem">Change the<span class="strong"><strong> start time</strong></span> on the task to<span class="strong"><strong> one minute from the current time</strong></span>. This will allow you to test the task and make sure that it is working.</li><li class="listitem">When all settings have been configured to your liking, click<span class="strong"><strong> Apply</strong></span> and<span class="strong"><strong> OK</strong></span> (note that you may be prompted for your password).<a class="indexterm" id="id394"/></li></ol></div><p>If you find that you are unable to set a cron job to run on your host site once it is live, then you can use a neat trick and set your Windows scheduled task to access the<code class="literal"> cron.php</code> script directly from your home PC instead using the instructions just listed. This means that the cron script is executed, depending on your settings, as often as your PC is online and able to access web pages.</p><p>This last point highlights how easy Drupal has made things when it comes to performing necessary tasks on a regular basis. All that's required is a browser application of some sort to access the<code class="literal"> cron.php</code> script, and any tasks that need to be run by the Drupal site will be run. You could access this script from your own browser, or set your own PC to do it whenever you start it up, or any other number of things.</p></div><div class="section" title="Poormanscron"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec05"/>Poormanscron</h2></div></div></div><p>It should come as no surprise that there is a contribution that can make life even easier.<span class="strong"><strong> Poormanscron</strong></span> is a contributed module that does away with the need to set the crontab or a scheduled task entirely.<a class="indexterm" id="id395"/>
</p><p>It works by checking whether the cron script has been run in the last unit of time (whatever you have set this to be; by default it is every hour) each time a web page is browsed. If it finds that there is a cron run due, it will cause this to happen after the page has been served (so that the user does not have to wait for the tasks to complete before viewing the page).</p><p>Basically, Poormanscron means that you are freed from having to learn anything about cron jobs. This is convenient, but is also a double edged sword! It is quite likely that you will need to make use of cron jobs for other tasks, and if you use Poormanscron for Drupal, then all you are doing is postponing the time when you have to sit down and learn how to use the crontab or scheduled tasks. At any rate, you have seen examples of how to use all the options; so all that remains is for us to take a look at how to work with Poormanscron:<a class="indexterm" id="id396"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download the Poormanscron module from the Drupal website.</li><li class="listitem">Extract the files to your<code class="literal"> modules</code> folder.</li><li class="listitem">Enable the module in the<span class="strong"><strong> modules</strong></span> section under<span class="strong"><strong> administer</strong></span>.</li></ol></div><p>That's all there is to it—provided your site has regular use, your cron tasks will run smoothly and you need not worry about accessing the<code class="literal"> cron.php</code> script manually or setting the crontab.</p><p>After some time, however, you might get a bit sick of seeing logged cron messages all the time. If you want to administer the Poormanscron module, then head on over to<span class="strong"><strong> poormanscron</strong></span> under<span class="strong"><strong> settings</strong></span> in the administration area, to bring up the following page:<a class="indexterm" id="id397"/>
</p><div class="mediaobject"><img alt="Poormanscron" src="graphics/1800_10_04.jpg"/></div><p>As you can see from this, there are a number of options available to control how often cron jobs should be run, how long to wait before retrying after an error, and what your logging policy should be. In this instance logging is disabled because there is nothing that urgently requires manual verification on the demo site (for the moment). If you added new software and had to confirm that it was being properly executed by the<code class="literal"> cron.php</code> script, then you might consider switching logging back on.</p></div></div>
<div class="section" title="Throttling"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec03"/>Throttling</h1></div></div></div><p>Every once in a while someone makes a site that becomes wildly popular. Having loads of people visiting a site can put some serious strain on the server's resources and cause all sorts of problems as the congestion builds. Even if a site is not exceedingly popular, it is possible that it may come under a<span class="strong"><strong> denial of service</strong></span> attack from somewhere.<a class="indexterm" id="id398"/>
</p><p>Before even thinking about setting up the throttling mechanism on a site, it is important that you know what resources are at your disposal:</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note44"/>Note</h3><p>If you have already ensured that there are facilities in place to handle a<span class="emphasis"><em> large amount of traffic</em></span>, then you have made the throttle module redundant in effect.</p></div></div><p>If you are unsure about what resources are available on your site, check with the hosting service and find out what they are giving you.</p><p>Assuming you anticipate there will be a need for some sort of congestion control, a good way to deal with surges in traffic or bandwidth usage is to enable the throttling mechanism that comes with Drupal, in the form of the aforementioned throttle module. This is easy enough to accomplish by enabling it in the<span class="strong"><strong> modules</strong></span> section of the administration tool. Once that is done, you can configure how the module acts on the site in general by navigating to the<span class="strong"><strong> throttle</strong></span> page under settings in the administration area. This will bring up the following page:<a class="indexterm" id="id399"/>
</p><div class="mediaobject"><img alt="Throttling" src="graphics/1800_10_05.jpg"/></div><p>This page deals with congestion from the point of view of how many people are using the site. In this case, Drupal is instructed to engage the auto-throttle on anonymous users provided there are<span class="strong"><strong> 300</strong></span> or more online, and the same for authenticated users provided there are more than<span class="strong"><strong> 100</strong></span> of them online. The final option deals with actually limiting the amount of work the throttle mechanism has to do so that it itself does not become a resource hog.<a class="indexterm" id="id400"/>
</p><p>
<span class="emphasis"><em>But what if you know that it is a specific module that is consuming more than its fair share of resources?</em></span> In this case, you would simply enable the auto-throttle for that specific module in the<span class="strong"><strong> modules</strong></span> section of the administration tool, as shown here:</p><div class="mediaobject"><img alt="Throttling" src="graphics/1800_10_06.jpg"/></div><p>This can be done on a block-by-block basis as well, by navigating over to the<span class="strong"><strong> blocks</strong></span> section and doing the same thing.<span class="emphasis"><em> But what does throttling blocks ultimately mean?</em></span> Basically, if your server is under strain and you have set a block to be automatically throttled, it will be disabled and not contribute to the load on the server.<a class="indexterm" id="id401"/>
</p><p>You can take a look at your log message to determine what the throttle module is up to at any given time. For example, I set the throttle mechanism to engage after only one user visited the site. The following log message was then created:</p><div class="mediaobject"><img alt="Throttling" src="graphics/1800_10_07.jpg"/></div><p>It's not much, but at least it makes it clear when the throttle is on. Once the load has dropped sufficiently, a corresponding message will be sent stating that the throttle can be disengaged and things can return to normal.</p><p>While this next point is not directly related to throttling, it is important that you gain some idea about the performance of your site and what you can do to ensure it is good. Take a look at<a class="ulink" href="http://drupal.org/node/2601"> http://drupal.org/node/2601</a> to learn about how to:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Analyze your site's performance</li><li class="listitem" style="list-style-type: disc">Reduce the load on your servers by preventing access to certain parts of your site for web crawlers of various kinds, using the<code class="literal"> robot.txt</code> file</li><li class="listitem" style="list-style-type: disc">Learn about Apache performance and PHP and MySQL tuning</li></ul></div><p>Any knowledge you gain now can be put to good use preemptively to guard against poor performance which may discourage users in the future—even though it is unlikely that you will notice any performance-related issues early on.</p></div>
<div class="section" title="Patching"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec04"/>Patching</h1></div></div></div><p>From time to time, it becomes clear that there is a bug in a module or some other aspect of Drupal. This is especially a concern whenever there is a major overhaul of the software and everyone is working frantically to keep up—since Drupal is only just moving to the new 4.7 version at the time of writing, this is more pertinent now than at any other time. When this happens, invariably people head to the forums to find out if anyone else has had the same problem. Often, as is the case with a bug, other people have also been stricken with the same problem and it may be that someone has been able to fix the problem.<a class="indexterm" id="id402"/>
</p><p>If some kind soul has sorted out the problem on their machine, then it is most likely that they will submit a<span class="strong"><strong> patch</strong></span> file to the forum so that it can be used by everyone else in order to fix their code. At this point it is important to realize several things:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If you don't want to have any problems, ensure you only download well-tested and stable software for use on your site. Often CVS versions of a module still contain bugs or errors, and so it may be better to wait until a module is<span class="emphasis"><em> released and tested for your specific version of Drupal</em></span>.</li><li class="listitem" style="list-style-type: disc">Patch files are not specific to Drupal. They are simply files that explain a list of lines of code that should be added or removed in such a way that it is possible for a<span class="strong"><strong> patch utility</strong></span> to implement those changes without the need for human intervention.<a class="indexterm" id="id403"/></li><li class="listitem" style="list-style-type: disc">Patch utilities are not native to Windows machines—they come with Unix-based operating systems such as Linux.<a class="indexterm" id="id404"/></li></ul></div><p>Linux users will need to take some time to learn how to make use of the patch utility if they find they need to implement it. Windows users need to go a step further and download a patch utility first. Luckily there is a download of common Unix utilities available at<a class="ulink" href="http://unxutils.sourceforge.net/"> http://unxutils.sourceforge.net/</a>. This contains the patch utility among other things, and you will need to extract the content to a folder—the<code class="literal"> patch.exe</code> file will be within the<code class="literal"> usr\local\wbin</code> folder in whichever directory you extracted the files to.</p><p>The<code class="literal"> patch.exe</code> file can now be used just like any other command-line utility. We have already used the<code class="literal"> mysql</code> command utility several times, so you have some experience with this. The general syntax when using patch is as follows:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>C:\ patch [options] [originalfile [patchfile]]</strong></span>
</pre></div><p>In this case the<code class="literal"> originalfile</code> is the file to which the changes should be applied, and<code class="literal"> patchfile</code> is clearly the patch file that contains the changes to be implemented. There are a host of options that you can look through, so check out the man page for the patch before working with it. You can find one at<a class="ulink" href="http://www.hmug.org/man/1/patch.php"> http://www.hmug.org/man/1/patch.php</a>. A typical command might look something like this (of course, you need to ensure that you enter the correct file paths to your files if you are not working in one directory):</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>C:\patch buggy_code.php buggy_code.patch</strong></span>
</pre></div><p>Now there is an important path-related issue that needs to be resolved here. If you would like to use<code class="literal"> patch</code> from anywhere on the command line, you need to add its file path to your<span class="strong"><strong> Path</strong></span> system variable—otherwise, you would have to navigate to the<code class="literal"> usr\local\wbin</code> folder on the command line before using<code class="literal"> patch</code> each time (you could alternatively add<code class="literal"> patch.exe</code> to a folder already in your<span class="strong"><strong> Path</strong></span>, but it is probably better to keep everything separate).</p><p>To do this:<a class="indexterm" id="id405"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open up the<span class="strong"><strong> Control Panel</strong></span> and click on<span class="strong"><strong> System</strong></span>.</li><li class="listitem">Click on the<span class="strong"><strong> Advanced</strong></span> tab and click on<span class="strong"><strong> Environment Variables</strong></span></li><li class="listitem">Add the path to the<code class="literal"> patch.exe</code> file into the<span class="strong"><strong> Path</strong></span> environment variable in the<span class="strong"><strong> System variables</strong></span> section as shown here:<div class="mediaobject"><img alt="Patching" src="graphics/1800_10_08.jpg"/></div></li><li class="listitem">Once you are done, click<span class="strong"><strong> OK</strong></span>.</li></ol></div><p>Note that each path set in the<span class="strong"><strong> Path</strong></span> environment variable is separated by a semi-colon. You must ensure that you do not change anything other than adding the single path; otherwise you may well break other important applications.<a class="indexterm" id="id406"/>
</p><p>With that done, you now have access to the patch utility from anywhere on the command line. The important question now becomes whether or not to use a patch file.<span class="emphasis"><em> How do you know whether you need a patch?</em></span> The answer to this really lies in searching Drupal for an answer to any given problem you might have—often there are patches submitted on the module's download page, so make sure you search through this as well as look through the forums for more info.</p><p>Finally, just because a patch has been made available does not necessarily mean that it will fix the problem. Often, you will find that patches themselves create other problems. For example, viewing the issues page for the Flexinode module shows the following:<a class="indexterm" id="id407"/>
</p><div class="mediaobject"><img alt="Patching" src="graphics/1800_10_09.jpg"/></div><p>At the time of writing, there were several patches available for several different things. Depending on what you needed done, you would:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Find the relevant patch file.</li><li class="listitem">Download it to your machine.</li><li class="listitem">Use the patch utility to implement the patch.</li><li class="listitem">Attempt to use the updated code.</li></ol></div><p>Make sure that it is in fact a patch file you are downloading and not an entire file that is intended as a replacement. Patch files will more often that not end with a<code class="literal"> .patch</code> extension. As mentioned, the best way to avoid problems is to only use code that has been proven to be reliable, failing which, it is more than likely you will need to practice implementing patches—enjoy!</p></div>
<div class="section" title="Website Activities"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec05"/>Website Activities</h1></div></div></div><p>Once you have developed your site and have it up and running on the live servers, you will find that your ISP probably offers a fair amount of toys for you to play around with. Some of these can be very useful for the budding website administrator.<span class="emphasis"><em> But what could we possibly need, now that the entire site has been built?</em></span>
</p><p>There are plenty of different tasks that still lie ahead of you. For example, are you sure that malicious people out there can't hotlink to your site and reduce your bandwidth?<span class="emphasis"><em> What is hotlinking? What is bandwidth?</em></span> These questions constitute only a very small part of the types of concerns that must take focus once development is completed. I have to admit, that while the subject of the book was to<span class="emphasis"><em> build a site</em></span>, that task is only one side of the coin!</p><p>In the case of the demo site, the following administration panel is provided by the hosting service provider:<a class="indexterm" id="id408"/>
</p><div class="mediaobject"><img alt="Website Activities" src="graphics/1800_10_10.jpg"/></div><p>Obviously, there are a lot of toys to play with here and it is recommended that you spend some time finding out what is available for you to use and how to use it. Knowing what you have available is very important because it means you are better able to plan<span class="emphasis"><em> how you work</em></span>. For example, the demo site's hosts offer an automated<span class="strong"><strong> Search Engine submit</strong></span> facility that allows the new website to be submitted for indexing to<span class="emphasis"><em> all the major search engines—much</em></span> better than simply waiting around for the site to begin appearing on them.</p><p>Another important thing to note here is that most hosting services will offer a full array of statistics for your website. Things like where people have come from, how many accessed the site, which pages are being accessed, and so on. Drupal comes with modules that do pretty much the same thing, so check to see whether the site's native statistics are sufficient or whether you need to consider installing a new module—something like the<span class="strong"><strong> GraphStat, Tracker, Watchdog</strong></span>, or<span class="strong"><strong> Recorder</strong></span> modules may be more what you have in mind.<a class="indexterm" id="id409"/>
</p><p>Since it is possible you have an entirely different set of options available on your hosted site, we won't discuss this any further here, but there are still a couple of other matters that warrant attention. Let's begin with one of the most commonly requested:<span class="strong"><strong> Search Engine Optimization</strong></span>, or<span class="strong"><strong> SEO</strong></span>.</p><div class="section" title="Search Engine Optimization"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec06"/>Search Engine Optimization</h2></div></div></div><p>One of the most common goals for a website is to appear high up on the big search engine rankings. As you should know, having a good ranking increases the chances of potential users finding your site among the mass of other sites.<span class="emphasis"><em> So what is it that you can do to make your site rank as highly as possible without actually having to pay anyone to do it for you?</em></span>
</p><p>There is no straight answer to this, unfortunately, and many people will give you just as many different answers. However, there is a core set of tasks you can take up that are known to help—they might vary in importance, but it is probably worth performing all of them. The following table highlights the most important optimizations or tasks, which you should consider performing (where possible):</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Optimization</p>
</th><th style="text-align: left" valign="bottom">
<p>Explanation</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>Write web-enhanced copy</p>
</td><td style="text-align: left" valign="top">
<p>IMPORTANT: Think about how your target users would find your site.<span class="emphasis"><em> What type of words would they use to find a site like yours?</em></span> Once you have come up with a list of key words and phrases, ensure that the writing on your site makes use of these phrases whenever possible.</p>
<p>If you are using Google AdWords, then you can check the popularity of various search terms yourself—simply put them forward as potential target keywords and check on their stats, which Google provides before they are added.</p>
<p>For example, if you had a site that deals with mobile gadgets, and you wanted to make the phrase<span class="strong"><strong> cellular phone</strong></span> a term that you rank highly on, then instead of writing something like:</p>
<p>
<span class="strong"><strong>This device can be used to call other people</strong></span>, you should write:</p>
<p>
<span class="strong"><strong>This G1 super cellular phone, can call any other cellular phone from wherever you are</strong></span>.</p>
<p>Admittedly, you cannot control the content of other people's comments and pages, but this would still apply to any and all standard pages you write—such as the<span class="emphasis"><em> introduction</em></span> page,<span class="emphasis"><em> about us</em></span>, or<span class="emphasis"><em> FAQ</em></span>, or even your own personal blog.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Use meaningful file names</p>
</td><td style="text-align: left" valign="top">
<p>While this is not as important as the first point, it certainly will help to have everything named meaningfully, because search engines do look at file names. Instead of naming a page<code class="literal"> 19</code>, you should name it something like<code class="literal"> awesome_webpage.html</code>. Don't go overboard on this because it is not too important.</p>
<p>Look through the modules available with help for renaming files if this appeals to you—something like<span class="strong"><strong> Node (key)words</strong></span> should do the trick.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Use meaningful anchor text</p>
</td><td style="text-align: left" valign="top">
<p>IMPORTANT: Search engines, in particular Google, place a large amount of emphasis on the anchor text used in links. As a result, make sure all your links have meaningful text associated with them. For example, you would rewrite the following sentence:</p>
<p>
<code class="literal">Donate to the Wildlife community &lt;a href ="&lt;yourlink&gt;"&gt;here&lt;/a&gt;</code>.</p>
<p>to:</p>
<p>
<code class="literal">Donate to the &lt;a href ="&lt;yourlink&gt;"&gt;Wildlife community&lt;/a&gt; here</code>.</p>
<p>The reason for this is that the word<span class="strong"><strong> here</strong></span> is not particularly meaningful to a search engine, even though humans can easily make the connection. For the sake of your rankings, simply move the link to the key phrase<span class="strong"><strong> Wildlife community</strong></span> to place more emphasis on it for the search engine.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Write meaningful metatags</p>
</td><td style="text-align: left" valign="top">
<p>As many people will tell you, metatags have become less and less important as time goes by. However, they are still useful, and you should at least go to the effort of filling them out properly. The two metatags that you should consider making use of are the<code class="literal"> keyword</code> and<code class="literal"> description</code> tags. For example, the following shows a possible tag:</p>
<p>
<code class="literal">&lt;meta name="keywords" content="CWC wildlife conservation biosphere"&gt;</code>
</p>
<p>Metatags have been the subject of some abuse, and you should view the W3C consortium's guidelines for their usage:<code class="literal"> http://www.w3.org</code>.</p>
<p>In order to make these changes, you would have to work with your theme—most likely the<code class="literal"> page.tpl</code> file, or whatever is its equivalent!</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Manage your links</p>
</td><td style="text-align: left" valign="top">
<p>IMPORTANT: A high level of importance is placed on the perceived popularity of a website. Search engines can judge the popularity of a website by looking at how many links there are to the site, and how popular the sites that link to it themselves are. For this reason, you should ensure that you link to and link from only sites that you feel are suitable partners.</p>
<p>Effectively, you should search for as many relevant link pages as possible, or actually speak to the relevant sites to determine whether you can provide mutual links. The more links you have from popular sites, the better your ranking will be. You can also try to get one-way links to your site—these are also rated highly by search engines.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Write meaningful<code class="literal"> alt</code> tags for images</p>
</td><td style="text-align: left" valign="top">
<p>Search engines don't see pictures like humans do, so there is nothing you can do about images…<span class="emphasis"><em> or is there?</em></span> Instead of naming your images<code class="literal"> 02_03.jpg</code>, you might consider giving them names like<code class="literal"> cruel_hunter.jpg</code>. Don't stop there either. Instead of adding an image like this:</p>
<p>
<code class="literal">&lt;img src="cruel_hunter.jpg"&gt;</code>
</p>
<p>write it like this:</p>
<p>
<code class="literal">&lt;img src="cruel_hunter.jpg" alt="Hunter making his kill "&gt;</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Submit your site to search engines and online directories</p>
</td><td style="text-align: left" valign="top">
<p>Make sure your site is listed wherever possible. Most hosting packages provide an automated SE-submission facility, which will automatically forward your site to search engines for indexing. Otherwise, look for other SE web page submission tools, or search out your own lists and directories to become part of.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Read up on lists, forums, and online tutorials</p>
</td><td style="text-align: left" valign="top">
<p>There is a lot of helpful information out there. Make sure you do your own research and come up with an SEO policy that is right for you.</p>
</td></tr></tbody></table></div><p>You will find that if you are prepared to put in the time to develop your links and constantly upgrade your site, you will eventually recoup the benefits that accrue over time. However, don't expect everything to happen overnight—gaining popularity can be a tedious process!</p></div><div class="section" title="Maintaining Users"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec07"/>Maintaining Users</h2></div></div></div><p>It is quite likely that while some people register with the full intention of making regular use of your site, they will move on and their account remains hanging around without actually doing anything. It might be prudent to add the<span class="strong"><strong> User Maintenance</strong></span> module early on to keep track of how and whether your users are active, so that you can remove those who don't meet certain criteria.<a class="indexterm" id="id410"/>
</p><p>Go ahead and download the module off the site. It requires a bit of work to get ready:<a class="indexterm" id="id411"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Extract the files to your<code class="literal"> modules</code> folder.</li><li class="listitem">Run the<code class="literal"> .sql</code> script against the database (remember to have a backup available) with the following command:<div class="informalexample"><pre class="programlisting">C:\ mysql udrupal p drupal &lt;
C:\apache2triad\htdocs\drupal\modules\user_maintenance\user_maintenance.sql
</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: none">Ensure that you replace the highlighted file path with the one that reflects your setup if need be.</li></ul></div></li><li class="listitem">Enable the module in the<span class="strong"><strong> modules</strong></span> section under<span class="strong"><strong> administer</strong></span>.</li></ol></div><p>To use the module, head on over to the<span class="strong"><strong> settings</strong></span> section under<span class="strong"><strong> administer</strong></span> once the module is enabled. In the drop-down list in the menu you will notice that there is now a new<span class="strong"><strong> user_maintenance</strong></span> menu item available. Click on that to bring up the following page:</p><div class="mediaobject"><img alt="Maintaining Users" src="graphics/1800_10_11.jpg"/></div><p>As you can see, it is now quite easy to select how long you are prepared to keep an active account on your site despite the fact that the user has not logged on after registering. The reason it is wise to get this contribution up and running as soon as possible is that it cannot work retrospectively. In other words, if you run into this problem after three years of collecting wasted accounts, this contribution cannot tell which accounts it should delete; it only works for those accounts that were created while it is enabled.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec06"/>Summary</h1></div></div></div><p>This chapter has rounded off the picture painted by the previous chapters by taking a look at some of the most important website-related chores that you will have to undertake. Knowing how to make backups at the click of a button, or being able to tell who is using your site for what purposes and when, gives you the power to maintain and manage your site efficiently and with a minimum of fuss.</p><p>With the end of this chapter, we come to the end of the book. For those of you who now need to upload your new site your live domain, the appendix contains further instructions on deployment.</p><p>Congratulations on finishing the book, and I wish you all the best in your future endeavors on the Web. Please remember to take the time to give back to the Drupal community so that it can continue to flourish and help others.</p></div></body></html>
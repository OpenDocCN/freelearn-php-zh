<html><head></head><body><div class="chapter" title="Chapter&#xA0;10.&#xA0;Localize the App"><div class="titlepage"><div><div><h1 class="title"><a id="ch10"/>Chapter 10. Localize the App</h1></div></div></div><p>This chapter explains how to write a multilingual app. Localization, also known as Internationalization (I18N), takes care that a software application can be adapted and rendered in different languages without changes in the source code. This is particularly important in a web application where users speak different languages.</p><p>Yii provides powerful tools to handle this task, choosing from the file or database approach (according to the application's complexity). We will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Setting the default language</li><li class="listitem" style="list-style-type: disc">File-based translations<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Example – using file-based translation for the entire website</li></ul></div></li><li class="listitem" style="list-style-type: disc">Placeholders formatting</li><li class="listitem" style="list-style-type: disc">DB-based translations<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Example – translating the room's description using DB</li></ul></div></li></ul></div><div class="section" title="Setting the default language"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec69"/>Setting the default language</h1></div></div></div><p>A Yii application <a id="id440" class="indexterm"/>uses two kinds of languages: source language and target language.</p><p>Source language specifies the language employed to write the source code; the default setting is <code class="literal">en-US</code>, and it is advisable not to change this value since English is the most used and known language in software development. On the other hand, there is a target language used to display content to end users, and we are going to work specifically on this aspect.</p><p>This language can be set in the configuration file using the <code class="literal">language</code> property:</p><div class="informalexample"><pre class="programlisting">return [
    // set target language to be Italian
    'language' =&gt; 'it-IT',
   
      ....
      ....
];</pre></div><p>Alternatively, you can use the following code:</p><div class="informalexample"><pre class="programlisting">// change target language to Italian
\Yii::$app-&gt;language = 'it-IT';</pre></div><p>Now, let's see<a id="id441" class="indexterm"/> how to handle app localization in practice.</p></div></div>
<div class="section" title="File-based translations"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec70"/>File-based translations</h1></div></div></div><p>This is the most simple way to translate<a id="id442" class="indexterm"/> text messages from one language to another. Basically, there are one or more files for each language containing keywords with text representations; we will put these keywords in the source code where the framework will replace them with text.</p><p>The pairs of keyword-text translations are grouped by categories representing the filenames where they are stored. These pairs are array keys-values, where key indicates keywords, and value indicates text translations.</p><p>By default, the path folder containing translations for a specific language is in <code class="literal">@app/messages/&lt;language&gt;/&lt;category&gt;.php</code>. Therefore, if we are writing translations for the <code class="literal">app</code> category and the <code class="literal">en-US</code> language, for example, the complete path for the translation file will be in <code class="literal">@app/messages/en-US/app.php</code>.</p><p>Going to the source code, translations are activated using the <code class="literal">Yii::t()</code> static method that accepts four parameters, but only the first two are required; the first one is the category, and the second one is the message to translate.</p><p>Now, we want to make an example where we will write a classic <code class="literal">Hello World!</code> in two languages: English and Italian. However, it will be just as easy to translate it in any other language.</p><p>Working on the previous basic templated project, write a new controller named <code class="literal">FileTranslatorController</code> in <code class="literal">basic/controllers/FileTranslatorController.php</code> with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;?php

namespace app\controllers;

use Yii;
use yii\web\Controller;

class FileTranslatorController extends Controller
{
    public function actionIndex()
    {
        \Yii::$app-&gt;language = 'en-US';
        $englishText = \Yii::t('app', 'Hello World!');
        
        \Yii::$app-&gt;language = 'it-IT';
        $italianText = \Yii::t('app', 'Hello World!');
        
        return $this-&gt;render('index', ['englishText' =&gt; $englishText, 'italianText' =&gt; $italianText]);
    }
}</pre></div><p>The first two <a id="id443" class="indexterm"/>source code rows in <code class="literal">actionIndex()</code> will set the app language to <code class="literal">en-US</code>, and then they will store the content of <code class="literal">Hello World!</code> key of the <code class="literal">basic/messages/en-US/app.php</code> file in the <code class="literal">$englishText</code> variable.</p><p>In the same way, the last two source code rows in <code class="literal">actionIndex()</code> will set the app language to <code class="literal">it-IT</code>, and then they will store the content of <code class="literal">Hello World!</code> key of the <code class="literal">basic/messages/it-IT/app.php</code> file in the <code class="literal">$italianText</code> variable.</p><p>The view content in <code class="literal">basic/views/file-translator/index.php</code> is simply as follows:</p><div class="informalexample"><pre class="programlisting">&lt;b&gt;Display Hello World! in two language: English and Italian&lt;/b&gt;

&lt;br /&gt;&lt;br /&gt;

In English:
&lt;?= $englishText ?&gt;

&lt;br /&gt;&lt;br /&gt;
In Italian:
&lt;?= $italianText ?&gt;</pre></div><p>Now, we need to define file languages for English and Italian translations.</p><p>If the <code class="literal">messages</code> folder does not exist in <code class="literal">basic/messages</code>, we will just create it; then, create two new folders named <code class="literal">en-US</code> and <code class="literal">it-IT</code>. In each folder, add a new file named <code class="literal">app.php</code>.</p><p>For the file with the English translations in <code class="literal">basic/messages/en-US/app.php</code>, let's write:</p><div class="informalexample"><pre class="programlisting">&lt;?php

return [
    'Hello World!' =&gt; 'Hello world!',
];

?&gt;</pre></div><p>While for Italian translations in <code class="literal">basic/messages/it-IT/app.php</code>, let's write:</p><div class="informalexample"><pre class="programlisting">&lt;?php

return [
    'Hello World!' =&gt; 'Ciao Mondo!',
];

?&gt;</pre></div><p>You can browse<a id="id444" class="indexterm"/> to <code class="literal">http://hostname/basic/file-translator/index</code> to view the output.</p><div class="section" title="Example – using file-based translation for the entire website"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec46"/>Example – using file-based translation for the entire website</h2></div></div></div><p>Applying translations to the<a id="id445" class="indexterm"/> entire website is tedious, and, above all, there is a high possibility that you will miss some translations. Yii provides a powerful tool to automatically produce the message's PHP files for all the languages we want.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note66"/>Note</h3><p>This powerful tool is a console command <a id="id446" class="indexterm"/>named <code class="literal">message</code>; therefore, we require a console access.</p></div></div><p>This command requires two steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Creating a configuration file where we will indicate the <code class="literal">languages</code> property, or which languages we want to support in the project and the <code class="literal">messagePath</code> property, or rather, where to store translated messages.</li><li class="listitem">Launching the <code class="literal">message</code> command.</li></ol></div><p>For step 1, go to the console, in the project's root folder, where the <code class="literal">yii</code> file is located.</p><p>If we are working on a basic template, we will launch the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ./yii message/config config/i18n.php</strong></span>
</pre></div><p>The first parameter, <code class="literal">message/config</code>, is the action <code class="literal">config</code> invoked on the controller <code class="literal">message</code>, and the second parameter is the file path where we want to save the configuration (in this case, <code class="literal">config/i18n.php</code>, but we can write anything).</p><p>If we are working on an advanced template, we will launch the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>./yii message/config common/config/i18n.php</strong></span>
</pre></div><p>The only difference is that, in the last command, we specified that the configuration file for message command translations is in <code class="literal">common/config</code> instead of the <code class="literal">config</code> folder.</p><p>Now, if we open <code class="literal">config/i18n.php</code>, we should see the default configuration file for the <code class="literal">message</code> command<a id="id447" class="indexterm"/> that should look like this:</p><div class="informalexample"><pre class="programlisting">&lt;?php

return [
    // string, required, root directory of all source files
    'sourcePath' =&gt; __DIR__ . DIRECTORY_SEPARATOR . '..',
    // array, required, list of language codes that the extracted messages
    // should be translated to. For example, ['zh-CN', 'de'].
    'languages' =&gt; ['de'],
    // string, the name of the function for translating messages.
    // Defaults to 'Yii::t'. This is used as a mark to find the messages to be
    // translated. You may use a string for single function name or an array for
    // multiple function names.
    'translator' =&gt; 'Yii::t',
    // boolean, whether to sort messages by keys when merging new messages
    // with the existing ones. Defaults to false, which means the new (untranslated)
    // messages will be separated from the old (translated) ones.
    'sort' =&gt; false,
    // boolean, whether to remove messages that no longer appear in the source code.
    // Defaults to false, which means each of these messages will be enclosed with a pair of '@@' marks.
    'removeUnused' =&gt; false,
    // array, list of patterns that specify which files/directories should NOT be processed.
    // If empty or not set, all files/directories will be processed.
    // A path matches a pattern if it contains the pattern string at its end. For example,
    // '/a/b' will match all files and directories ending with '/a/b';
    // the '*.svn' will match all files and directories whose name ends with '.svn'.
    // and the '.svn' will match all files and directories named exactly '.svn'.
    // Note, the '/' characters in a pattern matches both '/' and '\'.
    // See helpers/FileHelper::findFiles() description for more details on pattern matching rules.
    'only' =&gt; ['*.php'],
    // array, list of patterns that specify which files (not directories) should be processed.
    // If empty or not set, all files will be processed.
    // Please refer to "except" for details about the patterns.
    // If a file/directory matches both a pattern in "only" and "except", it will NOT be processed.
    'except' =&gt; [
        '.svn',
        '.git',
        '.gitignore',
        '.gitkeep',
        '.hgignore',
        '.hgkeep',
        '/messages',
    ],

    // 'php' output format is for saving messages to php files.
    'format' =&gt; 'php',
    // Root directory containing message translations.
    'messagePath' =&gt; __DIR__,
    // boolean, whether the message file should be overwritten with the merged messages
    'overwrite' =&gt; true,


    /*
    // 'db' output format is for saving messages to database.
    'format' =&gt; 'db',
    // Connection component to use. Optional.
    'db' =&gt; 'db',
    // Custom source message table. Optional.
    // 'sourceMessageTable' =&gt; '{{%source_message}}',
    // Custom name for translation message table. Optional.
    // 'messageTable' =&gt; '{{%message}}',
    */

    /*
    // 'po' output format is for saving messages to gettext po files.
    'format' =&gt; 'po',
    // Root directory containing message translations.
    'messagePath' =&gt; __DIR__ . DIRECTORY_SEPARATOR . 'messages',
    // Name of the file that will be used for translations.
    'catalog' =&gt; 'messages',
    // boolean, whether the message file should be overwritten with the merged messages
    'overwrite' =&gt; true,
    */
];</pre></div><p>The configuration is very clear to read, so we will only explain its main properties: <code class="literal">languages</code>, <code class="literal">messagePath</code>, and <code class="literal">except</code>.</p><p>The <code class="literal">languages</code> property defines <a id="id448" class="indexterm"/>which languages are supported in the web project. For example, we could write:</p><div class="informalexample"><pre class="programlisting">'languages' =&gt; ['en', 'it', 'fr'],</pre></div><p>The preceding command supports and autogenerates messages for the English, Italian, and French languages.</p><p>The <code class="literal">messagePath</code> property defines where autogenerated messages should be saved. It is advisable to point to the <code class="literal">messages</code> folder (that must be created if it does not exist); in this way, we can write the following in the basic template:</p><div class="informalexample"><pre class="programlisting">'messagePath' =&gt;  __DIR__ . DIRECTORY_SEPARATOR . '..' . DIRECTORY_SEPARATOR . 'messages',</pre></div><p>Here, <code class="literal">__DIR__</code> refers to the <code class="literal">config</code> file folder, while in the basic template, it is the <code class="literal">basic/config</code> folder.</p><p>Once we have launched the <code class="literal">message</code> command, it will look for all folders and subfolders containing <code class="literal">.php</code> files, as indicated in the <code class="literal">only</code> property (only <code class="literal">.php</code> files will be processed).</p><p>Therefore, in the project's root folder, there are some folders, such as <code class="literal">vendor</code>, not relevant for our purpose.</p><p>So, we will add the <code class="literal">/vendor</code> value to the <code class="literal">except</code> property, in order to indicate that the <code class="literal">message</code> command will not look inside this folder, in this way:</p><div class="informalexample"><pre class="programlisting">    'except' =&gt; [
        '.svn',
        '.git',
        '.gitignore',
        '.gitkeep',
        '.hgignore',
        '.hgkeep',
        '/messages',
        '/vendor'
    ],</pre></div><p>For step 2, we will now try to launch the command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ./yii message config/i18n.php</strong></span>
</pre></div><p>It will find the <code class="literal">Yii::t</code> marker, defined in the <code class="literal">translator</code> property, in all the files in the folders and subfolders specified in the <code class="literal">sourcePath</code> property, considering the <code class="literal">except</code> property to exclude files and folders where we do not want to look.</p><p>The translated messages will be created (if they do not exist) in the <code class="literal">messagePath</code> folder, in our case, in the <code class="literal">messages</code> folder starting from the project's root folder.</p><p>If there are no <code class="literal">Yii::t</code> markers in all the searched files, the relative language's subfolder will be empty.</p><p>For example, open <code class="literal">SiteController</code> in <code class="literal">basic/controller/SiteController.php</code> and change the<a id="id449" class="indexterm"/> <code class="literal">actionIndex</code> content as follows:</p><div class="informalexample"><pre class="programlisting">    public function actionIndex()
    {
        $message = \Yii::t('app', 'this message must be translated!');
        
        return $this-&gt;render('index');
    }</pre></div><p>Now, relaunch the <code class="literal">message</code> command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ./yii message config/i18n.php</strong></span>
</pre></div><p>Then, check the <code class="literal">basic/messages/en</code> folder. We will find an <code class="literal">app.php</code> file that contains the <code class="literal">this message must be translated</code> key to which we must fill the value to specify the translation.</p></div></div>
<div class="section" title="Placeholders formatting"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec71"/>Placeholders formatting</h1></div></div></div><p>The <code class="literal">Yii:t</code> method is not <a id="id450" class="indexterm"/>only limited to replace strings with their translation in other languages, but it handles the specific formatting of source strings to support many kinds of generalization.</p><p>Firstly, <code class="literal">Yii:t()</code> supports placeholders in the following two formats:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">String in the <code class="literal">{nameOfPlaceholder}</code> format</li><li class="listitem" style="list-style-type: disc">Integer in the <code class="literal">{0}</code> format, and this type of placeholder is zero-based</li></ul></div><p>Value arrays to replace the placeholder are passed as the third parameter to the <code class="literal">Yii:t()</code> method.</p><p>For example, we want to display a page with only <code class="literal">Hello World, I'm ...</code> by appending the custom name to the text.</p><p>Create <code class="literal">basic/controllers/FileTranslatorController.php</code>:</p><div class="informalexample"><pre class="programlisting">    public function actionHelloWorldWithName($name='')
    {
        $text = \Yii::t('app', 'Hello World! I\'m {name}', ['name' =&gt; $name]);
        
        return $this-&gt;render('helloWorldWithName', ['text' =&gt; $text]);        
    }</pre></div><p>Now, create the view in <code class="literal">basic/views/file-translator/helloWorldWithName.php</code> simply with the following command:</p><div class="informalexample"><pre class="programlisting">&lt;?= $text ?&gt;</pre></div><p>It will display the <code class="literal">$text</code> value passed from the controller.</p><p>Test it by pointing<a id="id451" class="indexterm"/> the browser to <code class="literal">http://hostname/basic/web/file-translator/hello-world-with-name</code>, also passing the <code class="literal">?name=</code> parameter, otherwise there will be no name at the end of the text.</p><p>Translations can be prepared using the <code class="literal">message</code> command that we have just seen:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ./yii message config/i18n.php</strong></span>
</pre></div><p>This will automatically create a new marker <code class="literal">Hello World! I\'m {name}</code> in the <code class="literal">basic/messages</code> subfolders.</p><p>The placeholders can be specialized with two other attributes: <code class="literal">ParameterType</code> and <code class="literal">ParameterStyle</code>, adding a comma after <code class="literal">PlaceholderName</code>. So, the full form to specify a placeholder will be as follows:</p><div class="informalexample"><pre class="programlisting">{PlaceholderName, ParameterType, ParameterStyle}</pre></div><p>Here, <code class="literal">ParameterType</code> can be:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">number</code> : The ParameterStyle can be an integer, currency, percent, or custom pattern (for example, 000)</li><li class="listitem" style="list-style-type: disc"><code class="literal">date</code>: The ParameterStyle can be short, medium, long, full, or custom pattern (for example, dd/mm/yyyy)</li><li class="listitem" style="list-style-type: disc"><code class="literal">time</code>: The ParameterStyle can be short, medium, long, full or custom pattern (for example, hh:mm)</li><li class="listitem" style="list-style-type: disc"><code class="literal">spellout</code>: There is no ParameterStyle</li><li class="listitem" style="list-style-type: disc"><code class="literal">ordinal</code>: There is no ParameterStyle</li><li class="listitem" style="list-style-type: disc"><code class="literal">duration</code>: There is no ParameterStyle</li></ul></div><p>The most used message formatting is probably <code class="literal">plural</code>, and that allows us to specify different key strings based on the number passed as a parameter.</p><p>Consider the following code as an example:</p><div class="informalexample"><pre class="programlisting">// if $n = 0, it shows "There are no books!"
// if $n = 1, it shows "There is one book!"
// if $n = 4, it shows "There are 4 books!"

echo \Yii::t('app', 'There {n, plural, =0{are no books} =1{is one book} other{are # books}}!', ['n' =&gt; $n]);</pre></div><p>Here, <code class="literal">=0</code> stands<a id="id452" class="indexterm"/> for the message to be displayed when <code class="literal">$n</code> is <code class="literal">0</code>, <code class="literal">=1</code> stands for the message to be displayed when <code class="literal">$n</code> is <code class="literal">1</code>, and <code class="literal">other</code> stands for the message to be displayed when <code class="literal">$n</code> is other than <code class="literal">0</code> and <code class="literal">1</code>.</p></div>
<div class="section" title="DB-based translations"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec72"/>DB-based translations</h1></div></div></div><p>Yii also supports database as a <a id="id453" class="indexterm"/>storage option for message translations.</p><p>It has to be explicitly configured in the <code class="literal">config/web.php</code> file if we are working in the basic template, or in <code class="literal">common/config/main.php</code>, if we are working in the advanced template.</p><p>Next, we need to add two more database tables to manage message sources and message translations.</p><p>Start by creating database tables, as suggested in<a id="id454" class="indexterm"/> Yii's official documentation at <a class="ulink" href="http://www.yiiframework.com/doc-2.0/yii-i18n-dbmessagesource.html">http://www.yiiframework.com/doc-2.0/yii-i18n-dbmessagesource.html</a>:</p><div class="informalexample"><pre class="programlisting">CREATE TABLE source_message (
    id INTEGER PRIMARY KEY AUTO_INCREMENT,
    category VARCHAR(32),
    message TEXT
);

CREATE TABLE message (
    id INTEGER,
    language VARCHAR(16),
    translation TEXT,
    PRIMARY KEY (id, language),
    CONSTRAINT fk_message_source_message FOREIGN KEY (id)
        REFERENCES source_message (id) ON DELETE CASCADE ON UPDATE RESTRICT
);</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note67"/>Note</h3><p>Table names can be customized in the configuration file.</p></div></div><p>Table <code class="literal">source_message</code> will store all messages written with the source language; table <code class="literal">message</code> will store all translations; both tables are joined together by the <code class="literal">id</code> field.</p><p>In the next example, let's insert one record for each table:</p><div class="informalexample"><pre class="programlisting">INSERT INTO `source_message` (`id`, `category`, `message`) VALUES
(1, 'app', 'Hello World from Database!');

INSERT INTO `message` (`id`, `language`, `translation`) VALUES
(1, 'it', 'Ciao Mondo dal Database!');</pre></div><p>Now, it is time to apply some<a id="id455" class="indexterm"/> changes to the configuration. We need to insert the <code class="literal">i18n</code> property in the <code class="literal">components</code> section of the configuration in <code class="literal">config/web.php</code> (based on the basic template):</p><div class="informalexample"><pre class="programlisting">'components' =&gt; [
    // ...
    'i18n' =&gt; [
        'translations' =&gt; [
            'app' =&gt; [
                    'class' =&gt; 'yii\i18n\DbMessageSource',
                    //'messageTable' =&gt; 'message,
                    //'sourceMessageTable' =&gt; 'source_message,
    
            ],
        ],
    ],
],</pre></div><p>This component, i18n, uses <code class="literal">yii\i18n\PhpMessageSource</code> as a class by default, and has employed itself for file-based translation.</p><p>Now, we want to display the message in Italian. Create a new action in <code class="literal">basic/controllers/FileTranslatorController.php</code> named <code class="literal">actionHelloWorldFromDatabase()</code>, with the following content:</p><div class="informalexample"><pre class="programlisting">     public function actionHelloWorldFromDatabase()
    {
        \Yii::$app-&gt;language = 'it';
        $text = \Yii::t('app', 'Hello World from Database!');
        
        return $this-&gt;render('helloWorldFromDatabase', ['text' =&gt; $text]);        
    }</pre></div><p>The view in <code class="literal">basic/views/file-translator/helloWorldFromDatabase</code> will show the <code class="literal">$text</code> content:</p><div class="informalexample"><pre class="programlisting">&lt;?= $text ?&gt;</pre></div><p>Test it by pointing the browser to <code class="literal">http://hostname/basic/web/file-translator/hello-world-from-database</code>. If all is correct, we should see <code class="literal">Ciao Mondo dal Database!</code>, which is the Italian version of <code class="literal">Hello World from Database!</code>.</p><div class="section" title="Example – translating room descriptions using DB"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec47"/>Example – translating room descriptions using DB</h2></div></div></div><p>This example will show you how<a id="id456" class="indexterm"/> to translate the room's description <a id="id457" class="indexterm"/>using the database as the storage option. We will create models for <code class="literal">message</code> and <code class="literal">source_message</code> database tables, since we are going to use ActiveRecord to manage records in all the tables that control translations.</p><p>Firstly, we are going to create models for <code class="literal">message</code> and <code class="literal">source_message</code> database tables using Gii. In the basic template, point the browser to <code class="literal">http://hostname/basic/web/gii</code>, and then go to the model generator. Gii will create <code class="literal">Message</code> and <code class="literal">SourceMessage</code> models in the <code class="literal">basic/models</code> folder.</p><p>Next, we want to create a form that contains descriptions both in the original language and in all other translations.</p><p>For this purpose, we will create a view in <code class="literal">basic/views/rooms/indexWithTranslatedDescriptions.php</code>, as follows:</p><div class="informalexample"><pre class="programlisting">&lt;?php
use yii\helpers\Url;
use yii\widgets\ActiveForm;
?&gt;

&lt;div class="row"&gt;
    &lt;div class="col-md-4"&gt;
        &lt;legend&gt;Rooms with translated descriptions&lt;/legend&gt;
        
        &lt;?php $form = ActiveForm::begin([]); ?&gt;
        &lt;table class="table"&gt;
            &lt;tr&gt;
                &lt;th&gt;#&lt;/th&gt;
                &lt;th&gt;Floor&lt;/th&gt;
                &lt;th&gt;Room number&lt;/th&gt;
                &lt;th&gt;Description - English&lt;/th&gt;
                &lt;th&gt;Description - Italian&lt;/th&gt;
                &lt;th&gt;Description - French&lt;/th&gt;
            &lt;/tr&gt;
            &lt;?php for($k=0;$k&lt;count($rooms);$k++) : ?&gt;
                &lt;?php $room = $rooms[$k]; ?&gt;
                &lt;input type="hidden" name="Room[&lt;?= $k ?&gt;][id]" value="&lt;?= $room-&gt;id ?&gt;" /&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;?php echo $k+1 ?&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;?php echo $room-&gt;floor ?&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;?php echo $room-&gt;room_number ?&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;input type="text" name="Room[&lt;?= $k ?&gt;][description][en]" value="&lt;?= $room-&gt;description ?&gt;" /&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;input type="text" name="Room[&lt;?= $k ?&gt;][description][it]" value="&lt;?= Yii::$app-&gt;i18n-&gt;translate('app', $room-&gt;description, [], 'it') ?&gt;" /&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;input type="text" name="Room[&lt;?= $k ?&gt;][description][fr]" value="&lt;?= Yii::$app-&gt;i18n-&gt;translate('app', $room-&gt;description, [], 'fr') ?&gt;" /&gt;&lt;/td&gt;
                &lt;/tr&gt;
            &lt;?php endfor; ?&gt;
        &lt;/table&gt;
        &lt;br /&gt;
        &lt;input type="submit" class="btn btn-primary" value="Submit descriptions" /&gt;
        &lt;?php ActiveForm::end(); ?&gt;
    &lt;/div&gt;
&lt;/div&gt;</pre></div><p>We will check for <a id="id458" class="indexterm"/>other language translations using<a id="id459" class="indexterm"/> the <code class="literal">Yii::$app-&gt;i18n-&gt;translate</code> method that accepts:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Category</li><li class="listitem" style="list-style-type: disc">Message to be translated</li><li class="listitem" style="list-style-type: disc">Parameters of messages</li><li class="listitem" style="list-style-type: disc">Language</li></ul></div><p>It is now time to add <code class="literal">actionIndexWithTranslatedDescriptions()</code> in <code class="literal">basic/controllers/RoomsController.php</code>:</p><div class="informalexample"><pre class="programlisting">    public function actionIndexWithTranslatedDescriptions()
    {
        if(isset($_POST['Room']))
        {
            $roomsInput = $_POST['Room'];
            foreach($roomsInput as $item)
            {
                $sourceMessage = \app\models\SourceMessage::findOne(['message' =&gt; $item['description']]);
                
                // If null, I need to create source message
                if($sourceMessage == null)
                {
                    $sourceMessage = new \app\models\SourceMessage();
                }
                $sourceMessage-&gt;category = 'app';
                $sourceMessage-&gt;message = $item['description']['en'];
                $sourceMessage-&gt;save();
                
                $otherLanguages = ['it', 'fr'];
                
                foreach($otherLanguages as $otherLang)
                {
                    $message = \app\models\Message::findOne(['id' =&gt; $sourceMessage-&gt;id, 'language' =&gt; $otherLang]);
                    if($message == null)
                    {
                        $message = new \app\models\Message();
                    }
                    $message-&gt;id = $sourceMessage-&gt;id;
                    $message-&gt;language = $otherLang;
                    $message-&gt;translation = $item['description'][$otherLang];
                    $message-&gt;save();
                }
                
                // Room to update
                $roomToUpdate = \app\models\Room::findOne($item['id']);
                $roomToUpdate-&gt;description = $item['description']['en'];
                $roomToUpdate-&gt;save();
            }
        }

        $rooms = Room::find()
        -&gt;all();
        
        return $this-&gt;render('indexWithTranslatedDescriptions', ['rooms' =&gt; $rooms]);
    }</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note68"/>Note</h3><p>If we have trouble accessing the URL, check the <code class="literal">access</code> property returned by the <code class="literal">behaviors()</code> method of this controller to ensure that this action is allowed.</p></div></div><p>On top of this<a id="id460" class="indexterm"/> code, we will check whether the <code class="literal">$_POST</code> array<a id="id461" class="indexterm"/> is filled; in this case, we will get the <code class="literal">$sourceMessage</code> object from descriptions passed from the view. Next, we can create or update the message model for whatever language we want. In the end, we will also save the room object, eventually with its description field changed.</p><p>With this solution, anytime we want to change a description, a new record will be created since the text has been changed.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec73"/>Summary</h1></div></div></div><p>In this chapter, we have seen how to configure multiple languages in our app. We have found out that there are two storage options to handle internationalization: file and database. File is suggested for small projects and database for bigger ones.</p><p>We have discovered how to grab placeholders from the entire website through the 'message' command from the console and how to create placeholders that contain formatting information.</p><p>Finally, we have configured the database as a storage target for translations, and we have created a complete example to handle room description in different languages.</p><p>In the next chapter, we will learn how to create RESTful web services using the new integrated management of Yii 2.</p></div></body></html>
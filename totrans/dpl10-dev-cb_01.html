<html><head></head><body>
<div id="_idContainer007">
<h1 class="chapter-number" id="_idParaDest-21"><a id="_idTextAnchor020"/><span class="koboSpan" id="kobo.1.1">1</span></h1>
<h1 id="_idParaDest-22"><a id="_idTextAnchor021"/><span class="koboSpan" id="kobo.2.1">Up and Running with Drupal</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In this chapter, we will walk through how to create a new Drupal site and the system requirements for running Drupal. </span><span class="koboSpan" id="kobo.3.2">We’ll also walk through running the Drupal site locally using modern local development tools based </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">on Docker.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">Then, we’ll cover adding and managing module and theme extensions with the site running, as well as managing your Drupal code base in Git version control and finally deploying that Drupal site. </span><span class="koboSpan" id="kobo.5.2">By the end of this chapter, you will know how to create a Drupal site, run it locally on your machine, and add modules and themes to that Drupal site. </span><span class="koboSpan" id="kobo.5.3">You will also understand how to manage the Drupal code base in version control and deploy the Drupal site. </span><span class="koboSpan" id="kobo.5.4">This chapter will lay the foundations for working with the rest of the chapters in this book, and experimenting on your own </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">with Drupal.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">In this chapter, we are going to cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.9.1">Creating a new Drupal code base for a </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">new site</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">Running a Drupal </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">site locally</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Using Drush to </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">manage Drupal</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Adding and managing modules and themes </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">with Composer</span></span></li>
<li><span class="koboSpan" id="kobo.17.1">Using version control with your Drupal </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">code base</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">Successfully deploying your </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">Drupal site</span></span></li>
</ul>
<h1 id="_idParaDest-23"><a id="_idTextAnchor022"/><span class="koboSpan" id="kobo.21.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.22.1">This chapter will help you start working with Drupal locally on </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">your computer.</span></span></p>
<p><span class="koboSpan" id="kobo.24.1">You will require </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.26.1">PHP 8.1 </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">or higher</span></span></li>
<li><span class="koboSpan" id="kobo.28.1">Docker and DDEV installed on </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">your machine</span></span></li>
<li><span class="koboSpan" id="kobo.30.1">Composer, the PHP package </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">management tool</span></span></li>
<li><span class="koboSpan" id="kobo.32.1">Docker, for running </span><span class="No-Break"><span class="koboSpan" id="kobo.33.1">local environments</span></span></li>
<li><span class="koboSpan" id="kobo.34.1">An editor, such as Visual Studio Code </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">or PhpStorm</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.36.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.37.1">Go to the Composer documentation to learn how to install Composer globally on </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">your system.</span></span></p>
<p class="callout"><span class="No-Break"><span class="koboSpan" id="kobo.39.1">Linux/Unix/macOS: </span></span><a href="https://getcomposer.org/doc/00-intro.md#installation-linux-unix-osx "><span class="No-Break"><span class="koboSpan" id="kobo.40.1">https://getcomposer.org/doc/00-intro.md#installation-linux-unix-osx</span></span></a></p>
<p class="callout"><span class="No-Break"><span class="koboSpan" id="kobo.41.1">Windows: </span></span><a href="https://getcomposer.org/doc/00-intro.md#installation-windows "><span class="No-Break"><span class="koboSpan" id="kobo.42.1">https://getcomposer.org/doc/00-intro.md#installation-windows</span></span></a></p>
<h1 id="_idParaDest-24"><a id="_idTextAnchor023"/><span class="koboSpan" id="kobo.43.1">Creating a Drupal site</span></h1>
<p><span class="koboSpan" id="kobo.44.1">Create a </span><a id="_idIndexMarker000"/><span class="koboSpan" id="kobo.45.1">new Drupal site using the </span><strong class="bold"><span class="koboSpan" id="kobo.46.1">Composer</span></strong><span class="koboSpan" id="kobo.47.1"> project template and run the </span><strong class="bold"><span class="koboSpan" id="kobo.48.1">Quick Start</span></strong><span class="koboSpan" id="kobo.49.1"> command to create a preview site. </span><span class="koboSpan" id="kobo.49.2">The instructions provided in this section are based on the recommended installation instructions </span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">at </span></span><a href="https://www.drupal.org/download"><span class="No-Break"><span class="koboSpan" id="kobo.51.1">https://www.drupal.org/download</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.52.1">.</span></span></p>
<h2 id="_idParaDest-25"><a id="_idTextAnchor024"/><span class="koboSpan" id="kobo.53.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.54.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.55.1">Quick Start</span></strong><span class="koboSpan" id="kobo.56.1"> command uses SQLite as the database for Drupal. </span><span class="koboSpan" id="kobo.56.2">With most operating system PHP installations, this is readily available and installed. </span><span class="koboSpan" id="kobo.56.3">If SQLite is not available, the installation script will error. </span><span class="koboSpan" id="kobo.56.4">If this happens, that is okay! </span><span class="koboSpan" id="kobo.56.5">In </span><em class="italic"><span class="koboSpan" id="kobo.57.1">Running your Drupal site locally</span></em><span class="koboSpan" id="kobo.58.1">, we will run Drupal using a local development environment with </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">a database.</span></span></p>
<p><span class="koboSpan" id="kobo.60.1">Drupal also requires several PHP extensions. </span><span class="koboSpan" id="kobo.60.2">These are typically available with most PHP distributions. </span><span class="koboSpan" id="kobo.60.3">The up-to-date list of required PHP extensions can be found </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">online: </span></span><a href="https://www.drupal.org/docs/system-requirements/php-requirements#extensions"><span class="No-Break"><span class="koboSpan" id="kobo.62.1">https://www.drupal.org/docs/system-requirements/php-requirements#extensions</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.63.1">.</span></span></p>
<h2 id="_idParaDest-26"><a id="_idTextAnchor025"/><span class="koboSpan" id="kobo.64.1">How to do it...</span></h2>
<ol>
<li><span class="koboSpan" id="kobo.65.1">Open a terminal and navigate where you would like to create your new </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">Drupal site.</span></span></li>
<li><span class="koboSpan" id="kobo.67.1">Use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.68.1">create-project</span></strong><span class="koboSpan" id="kobo.69.1"> command to create a new Drupal site in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.70.1">mysite</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.71.1"> directory:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.72.1">composer create-project drupal/recommended-project mysite</span></strong></pre></li>
</ol>
<p class="callout-heading"><span class="koboSpan" id="kobo.73.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.74.1">If your PHP installation is missing any required extensions for Drupal, this command will fail. </span><span class="koboSpan" id="kobo.74.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.75.1">Composer</span></strong><span class="koboSpan" id="kobo.76.1"> command output will explain what extensions </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">are missing.</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.78.1">Move into </span><a id="_idIndexMarker001"/><span class="koboSpan" id="kobo.79.1">the newly created </span><strong class="source-inline"><span class="koboSpan" id="kobo.80.1">mysite</span></strong><span class="koboSpan" id="kobo.81.1"> directory, which contains the Drupal site’s </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">code base:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.83.1">cd mysite</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.84.1">Run the </span><strong class="bold"><span class="koboSpan" id="kobo.85.1">Quick Start</span></strong><span class="koboSpan" id="kobo.86.1"> command to install a sample Drupal site using the </span><strong class="bold"><span class="koboSpan" id="kobo.87.1">Umami </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.88.1">Maganize</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.89.1"> demo:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.90.1">php web/core/scripts/drupal quick-start demo_umami</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.91.1">Once the installation script has finished, your browser will open your Drupal site. </span><span class="koboSpan" id="kobo.91.2">If your browser does not open, a login link will be printed in </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">the terminal:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer005">
<span class="koboSpan" id="kobo.93.1"><img alt="Figure 1.1 – Output from running the Quick Start command" src="image/Figure_1.1_B18548.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.94.1">Figure 1.1 – Output from running the Quick Start command</span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.95.1">Press </span><em class="italic"><span class="koboSpan" id="kobo.96.1">Ctrl</span></em><span class="koboSpan" id="kobo.97.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.98.1">C</span></em><span class="koboSpan" id="kobo.99.1"> to exit the </span><strong class="bold"><span class="koboSpan" id="kobo.100.1">Quick Start</span></strong><span class="koboSpan" id="kobo.101.1"> server at </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">any time.</span></span></li>
<li><span class="koboSpan" id="kobo.103.1">Next, open </span><strong class="source-inline"><span class="koboSpan" id="kobo.104.1">web/sites/default/settings.php</span></strong><span class="koboSpan" id="kobo.105.1"> in your editor. </span><span class="koboSpan" id="kobo.105.2">We will modify </span><a id="_idIndexMarker002"/><span class="koboSpan" id="kobo.106.1">this file to modify the configuration synchronization directory and add local </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">setting overrides.</span></span></li>
<li><span class="koboSpan" id="kobo.108.1">Set the configuration synchronization directory (where Drupal’s site configuration can be exported) to </span><strong class="source-inline"><span class="koboSpan" id="kobo.109.1">../config</span></strong><span class="koboSpan" id="kobo.110.1">. </span><span class="koboSpan" id="kobo.110.2">The path is relative to the </span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">web directory.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.112.1">The installer from the </span><strong class="bold"><span class="koboSpan" id="kobo.113.1">Quick Start</span></strong><span class="koboSpan" id="kobo.114.1"> command will have generated a default value. </span><span class="koboSpan" id="kobo.114.2">At the bottom of your file, find a line similar to </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">the following:</span></span></p>
<pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.116.1">$settings['config_sync_directory'] =</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.117.1">  'sites/default/files/config_....';</span></strong></pre>
<p><span class="koboSpan" id="kobo.118.1">Replace it with the </span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">following line</span><a id="_idTextAnchor026"/><span class="koboSpan" id="kobo.120.1">:</span></span></p>
<pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.121.1">$settings['config_sync_directory'] = '../config'</span></strong><span class="koboSpan" id="kobo.122.1">;</span></pre>
<p><span class="koboSpan" id="kobo.123.1">This ensures your exported Drupal configuration is not within the </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">web</span></strong><span class="koboSpan" id="kobo.125.1"> document </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">root folder.</span></span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.127.1">At the </span><a id="_idIndexMarker003"/><span class="koboSpan" id="kobo.128.1">bottom of your file, add the following snippet of code to allow the creation of a </span><strong class="source-inline"><span class="koboSpan" id="kobo.129.1">settings.local.php</span></strong><span class="koboSpan" id="kobo.130.1"> file to override the settings in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.131.1">settings.php</span></strong><span class="koboSpan" id="kobo.132.1"> file in </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">different environments:</span></span><pre class="console"><span class="koboSpan" id="kobo.134.1">
/**</span></pre><pre class="console"><span class="koboSpan" id="kobo.135.1">
 * Include local environment overrides.</span></pre><pre class="console"><span class="koboSpan" id="kobo.136.1">
 */</span></pre><pre class="console"><span class="koboSpan" id="kobo.137.1">
if (file_exists($app_root . </span><span class="koboSpan" id="kobo.137.2">'/' . </span><span class="koboSpan" id="kobo.137.3">$site_path .</span></pre><pre class="console"><span class="koboSpan" id="kobo.138.1">
  '/settings.local.php')) {</span></pre><pre class="console"><span class="koboSpan" id="kobo.139.1">
   include $app_root . </span><span class="koboSpan" id="kobo.139.2">'/' . </span><span class="koboSpan" id="kobo.139.3">$site_path .</span></pre><pre class="console"><span class="koboSpan" id="kobo.140.1">
     '/settings.local.php';</span></pre><pre class="console"><span class="koboSpan" id="kobo.141.1">
}</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.142.1">This checks whether there is also a </span><strong class="source-inline"><span class="koboSpan" id="kobo.143.1">settings.local.php</span></strong><span class="koboSpan" id="kobo.144.1"> file alongside your </span><strong class="source-inline"><span class="koboSpan" id="kobo.145.1">settings.php</span></strong><span class="koboSpan" id="kobo.146.1"> file and includes it if it exists. </span><span class="koboSpan" id="kobo.146.2">By using local settings files, you can add sensible defaults to your Drupal settings file but have per-environment configurations and database </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">connection settings.</span></span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.148.1">With that, you have set up a Drupal code base and a sample development site that we will use throughout this chapter and the rest of </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">this book.</span></span></li>
</ol>
<h2 id="_idParaDest-27"><a id="_idTextAnchor027"/><span class="koboSpan" id="kobo.150.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.151.1">Composer allows </span><a id="_idIndexMarker004"/><span class="koboSpan" id="kobo.152.1">developers to create new projects from existing packages. </span><span class="koboSpan" id="kobo.152.2">The Drupal community provides the </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">drupal/recommended-project</span></strong><span class="koboSpan" id="kobo.154.1"> package as scaffolding for a Drupal site. </span><span class="koboSpan" id="kobo.154.2">When running </span><strong class="source-inline"><span class="koboSpan" id="kobo.155.1">create-project</span></strong><span class="koboSpan" id="kobo.156.1">, it copies the </span><strong class="source-inline"><span class="koboSpan" id="kobo.157.1">drupal/recommended-project</span></strong><span class="koboSpan" id="kobo.158.1"> package and installs our dependencies for us, making our copy of the package to use on </span><span class="No-Break"><span class="koboSpan" id="kobo.159.1">our own.</span></span></p>
<p><span class="koboSpan" id="kobo.160.1">Drupal has a configuration management system that allows exporting and importing configuration. </span><span class="koboSpan" id="kobo.160.2">This allows you to make configuration changes locally and push them up into production, without having to make changes on your live site. </span><span class="koboSpan" id="kobo.160.3">That is what </span><strong class="source-inline"><span class="koboSpan" id="kobo.161.1">config_sync_directory</span></strong><span class="koboSpan" id="kobo.162.1"> is for; it will be covered in more detail in the </span><em class="italic"><span class="koboSpan" id="kobo.163.1">Managing your Drupal code with version control</span></em><span class="koboSpan" id="kobo.164.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.165.1">Successfully deploying your Drupal </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.166.1">site</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.167.1"> recipes.</span></span></p>
<p><span class="koboSpan" id="kobo.168.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.169.1">Quick Start</span></strong><span class="koboSpan" id="kobo.170.1"> command was added in </span><strong class="bold"><span class="koboSpan" id="kobo.171.1">Drupal 8.6</span></strong><span class="koboSpan" id="kobo.172.1"> to create a development environment </span><a id="_idIndexMarker005"/><span class="koboSpan" id="kobo.173.1">for Drupal for new developers quickly. </span><span class="koboSpan" id="kobo.173.2">It installs Drupal programmatically, starts PHP’s built-in web server, and uses SQLite for </span><span class="No-Break"><span class="koboSpan" id="kobo.174.1">database access.</span></span></p>
<p><span class="koboSpan" id="kobo.175.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.176.1">Quick Start</span></strong><span class="koboSpan" id="kobo.177.1"> command is also re-entrant. </span><span class="koboSpan" id="kobo.177.2">If you rerun the command, it will use the existing SQLite database file. </span><span class="koboSpan" id="kobo.177.3">This allows you to run a development environment with one command quickly. </span><span class="koboSpan" id="kobo.177.4">We will cover running a full-fledged environment in the </span><em class="italic"><span class="koboSpan" id="kobo.178.1">Running your Drupal site </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.179.1">locally</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.180.1"> recipe.</span></span></p>
<h2 id="_idParaDest-28"><a id="_idTextAnchor028"/><span class="koboSpan" id="kobo.181.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.182.1">While </span><strong class="source-inline"><span class="koboSpan" id="kobo.183.1">drupal/recommended-project</span></strong><span class="koboSpan" id="kobo.184.1"> is the primary way to create a new Drupal site, there are other options. </span><span class="koboSpan" id="kobo.184.2">Other project templates include a community alternative and various distribution templates, and various agencies that work with Drupal have provided their own (internally </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">and publicly.)</span></span></p>
<h3><span class="koboSpan" id="kobo.186.1">Community Composer project template</span></h3>
<p><span class="koboSpan" id="kobo.187.1">Before </span><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">drupal/recommended project</span></strong><span class="koboSpan" id="kobo.189.1">, Drupal did not have a standard Composer project </span><a id="_idIndexMarker006"/><span class="koboSpan" id="kobo.190.1">template. </span><span class="koboSpan" id="kobo.190.2">The community drove this initiative forward and still maintains a more opinionated Drupal project template. </span><span class="koboSpan" id="kobo.190.3">The project can be found </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">at </span></span><a href="https://github.com/drupal-composer/drupal-project"><span class="No-Break"><span class="koboSpan" id="kobo.192.1">https://github.com/drupal-composer/drupal-project</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.193.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.194.1">The project adds the </span><span class="No-Break"><span class="koboSpan" id="kobo.195.1">following enhancements:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.196.1">Support for environment files and </span><span class="No-Break"><span class="koboSpan" id="kobo.197.1">environment variables</span></span></li>
<li><span class="koboSpan" id="kobo.198.1">Patching support </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">for dependencies</span></span></li>
<li><span class="koboSpan" id="kobo.200.1">Drush (while a de facto tool, it is not provided by the recommended </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">project template)</span></span></li>
</ul>
<h3><span class="koboSpan" id="kobo.202.1">Drupal distribution templates</span></h3>
<p><span class="koboSpan" id="kobo.203.1">Drupal </span><a id="_idIndexMarker007"/><span class="koboSpan" id="kobo.204.1">has a concept of installation profiles, often referred to as distributions. </span><span class="koboSpan" id="kobo.204.2">They are referred to as distributions because they provide an opinionated build of Drupal. </span><span class="koboSpan" id="kobo.204.3">There are several distribution projects </span><span class="No-Break"><span class="koboSpan" id="kobo.205.1">templates available:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.206.1">Open Social</span></strong><span class="koboSpan" id="kobo.207.1"> is a community engagement software built on top of </span><span class="No-Break"><span class="koboSpan" id="kobo.208.1">Drupal: </span></span><a href="https://github.com/goalgorilla/social_template/ "><span class="No-Break"><span class="koboSpan" id="kobo.209.1">https://github.com/goalgorilla/social_template/</span></span></a></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.210.1">Commerce Kickstart</span></strong><span class="koboSpan" id="kobo.211.1">, a preconfigured eCommerce store built on top of Drupal with </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">Commerce: </span></span><a href="https://github.com/centarro/commerce-kickstart-project "><span class="No-Break"><span class="koboSpan" id="kobo.213.1">https://github.com/centarro/commerce-kickstart-project</span></span></a></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.214.1">Contenta CMS</span></strong><span class="koboSpan" id="kobo.215.1">, an API-first decoupled CMS built on top of </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">Drupal: </span></span><a href="https://github.com/contentacms/contenta_jsonapi_project "><span class="No-Break"><span class="koboSpan" id="kobo.217.1">https://github.com/contentacms/contenta_jsonapi_project</span></span></a></li>
</ul>
<h2 id="_idParaDest-29"><a id="_idTextAnchor029"/><span class="koboSpan" id="kobo.218.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.219.1">Composer </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">documentation: </span></span><a href="https://getcomposer.org/doc/ "><span class="No-Break"><span class="koboSpan" id="kobo.221.1">https://getcomposer.org/doc/</span></span></a></li>
</ul>
<h1 id="_idParaDest-30"><a id="_idTextAnchor030"/><span class="koboSpan" id="kobo.222.1">Running your Drupal site locally</span></h1>
<p><span class="koboSpan" id="kobo.223.1">To work with Drupal, you need to have a local development environment. </span><span class="koboSpan" id="kobo.223.2">The local development </span><a id="_idIndexMarker008"/><span class="koboSpan" id="kobo.224.1">environment should be able to help you mimic your production environments, such as having access to specific PHP versions, database versions, Redis, and </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">other services.</span></span></p>
<p><span class="koboSpan" id="kobo.226.1">To achieve this, we will be using </span><strong class="bold"><span class="koboSpan" id="kobo.227.1">Docker</span></strong><span class="koboSpan" id="kobo.228.1">. </span><span class="koboSpan" id="kobo.228.2">We will not be interacting directly with Docker but through a tool called </span><strong class="bold"><span class="koboSpan" id="kobo.229.1">DDEV</span></strong><span class="koboSpan" id="kobo.230.1">. </span><span class="koboSpan" id="kobo.230.2">DDEV is </span><a id="_idIndexMarker009"/><span class="koboSpan" id="kobo.231.1">an abstraction on top of Docker that provides sensible defaults for running a Drupal site locally yet the flexibility to extend and add </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">additional services.</span></span></p>
<p><span class="koboSpan" id="kobo.233.1">DDEV is similar to </span><strong class="bold"><span class="koboSpan" id="kobo.234.1">Laravel’s Sail</span></strong><span class="koboSpan" id="kobo.235.1"> but supports </span><a id="_idIndexMarker010"/><span class="koboSpan" id="kobo.236.1">various PHP projects that originated from the </span><span class="No-Break"><span class="koboSpan" id="kobo.237.1">Drupal community.</span></span></p>
<h2 id="_idParaDest-31"><a id="_idTextAnchor031"/><span class="koboSpan" id="kobo.238.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.239.1">You will </span><a id="_idIndexMarker011"/><span class="koboSpan" id="kobo.240.1">need to </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">install Docker:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.242.1">macOS and Windows require the use of Docker Desktop since containers do not run natively on either operating </span><span class="No-Break"><span class="koboSpan" id="kobo.243.1">system: </span></span><a href="https://www.docker.com/products/docker-desktop "><span class="No-Break"><span class="koboSpan" id="kobo.244.1">https://www.docker.com/products/docker-desktop</span></span></a></li>
<li><span class="koboSpan" id="kobo.245.1">Linux runs Docker natively; it is best to see DDEV’s curated installation </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">steps: </span></span><a href="https://ddev.readthedocs.io/en/stable/users/docker_installation/#linux-installation-docker-and-docker-compose "><span class="No-Break"><span class="koboSpan" id="kobo.247.1">https://ddev.readthedocs.io/en/stable/users/docker_installation/#linux-installation-docker-and-docker-compose</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.248.1">Next, you </span><a id="_idIndexMarker012"/><span class="koboSpan" id="kobo.249.1">can </span><span class="No-Break"><span class="koboSpan" id="kobo.250.1">install DDEV:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.251.1">macOS and Linux</span></strong><span class="koboSpan" id="kobo.252.1">: Installation is done through the Homebrew package </span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">manager: </span></span><a href="https://ddev.readthedocs.io/en/stable/#homebrew-macoslinux "><span class="No-Break"><span class="koboSpan" id="kobo.254.1">https://ddev.readthedocs.io/en/stable/#homebrew-macoslinux</span></span></a></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.255.1">Windows</span></strong><span class="koboSpan" id="kobo.256.1">: Windows requires WSL2 and has detailed </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">instructions: </span></span><a href="https://ddev.readthedocs.io/en/stable/#installation-or-upgrade-windows-wsl2 "><span class="No-Break"><span class="koboSpan" id="kobo.258.1">https://ddev.readthedocs.io/en/stable/#installation-or-upgrade-windows-wsl2</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.259.1">The DDEV installation guide covers how to install Docker and itself for each operating system in </span><span class="No-Break"><span class="koboSpan" id="kobo.260.1">depth: </span></span><a href="https://ddev.readthedocs.io/en/stable/#installation"><span class="No-Break"><span class="koboSpan" id="kobo.261.1">https://ddev.readthedocs.io/en/stable/#installation</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.262.1">.</span></span></p>
<h2 id="_idParaDest-32"><a id="_idTextAnchor032"/><span class="koboSpan" id="kobo.263.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.264.1">Make </span><a id="_idIndexMarker013"/><span class="koboSpan" id="kobo.265.1">sure Docker </span><span class="No-Break"><span class="koboSpan" id="kobo.266.1">is running.</span></span></li>
<li><span class="koboSpan" id="kobo.267.1">Open a terminal and navigate to your Drupal </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">code base.</span></span></li>
<li><span class="koboSpan" id="kobo.269.1">Run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">config</span></strong><span class="koboSpan" id="kobo.271.1"> command to begin </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">the setup:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.273.1">ddev config</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.274.1">The first prompt is to choose a project name. </span><span class="koboSpan" id="kobo.274.2">Use the default name, inferred from the current directory name, or provide a custom one. </span><span class="koboSpan" id="kobo.274.3">Press </span><em class="italic"><span class="koboSpan" id="kobo.275.1">Enter</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.276.1">to continue.</span></span></li>
<li><span class="koboSpan" id="kobo.277.1">Select the document root for the Drupal site. </span><span class="koboSpan" id="kobo.277.2">DDEV’s default value is automatically detected. </span><span class="koboSpan" id="kobo.277.3">Press </span><em class="italic"><span class="koboSpan" id="kobo.278.1">Enter</span></em><span class="koboSpan" id="kobo.279.1"> to use the default value </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">web</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.283.1">The next prompt is for the project type. </span><span class="koboSpan" id="kobo.283.2">DDEV provides platform detection and defaults to </span><strong class="source-inline"><span class="koboSpan" id="kobo.284.1">drupal10</span></strong><span class="koboSpan" id="kobo.285.1">. </span><span class="koboSpan" id="kobo.285.2">Press </span><em class="italic"><span class="koboSpan" id="kobo.286.1">Enter</span></em><span class="koboSpan" id="kobo.287.1"> to </span><span class="No-Break"><span class="koboSpan" id="kobo.288.1">select it.</span></span></li>
<li><span class="koboSpan" id="kobo.289.1">The DDEV setup is now complete! </span><span class="koboSpan" id="kobo.289.2">We can start the local environment by using the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.290.1">Start</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.291.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.292.1">ddev start</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.293.1">Access </span><a id="_idIndexMarker014"/><span class="koboSpan" id="kobo.294.1">the Drupal site with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.295.1">launch</span></strong><span class="koboSpan" id="kobo.296.1"> command, which will bring us to the interactive </span><span class="No-Break"><span class="koboSpan" id="kobo.297.1">site installer:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.298.1">ddev launch</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.299.1">Finish installing Drupal by pressing </span><strong class="bold"><span class="koboSpan" id="kobo.300.1">Save and continue</span></strong><span class="koboSpan" id="kobo.301.1"> on the first </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">two forms.</span></span></li>
<li><span class="koboSpan" id="kobo.303.1">Once the installation has finished, fill out the site’s configuration form and </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">press </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.305.1">Save</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.307.1">Your Drupal site is </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">now running!</span></span></li>
</ol>
<h2 id="_idParaDest-33"><a id="_idTextAnchor033"/><span class="koboSpan" id="kobo.309.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.310.1">DDEV allows you to build a customizable local development environment without having to </span><a id="_idIndexMarker015"/><span class="koboSpan" id="kobo.311.1">be a Docker pro but still allows you to leverage Docker specifics. </span><span class="koboSpan" id="kobo.311.2">DDEV is a layer above the Docker Compose tool and is used to run multi-container Docker applications. </span><span class="koboSpan" id="kobo.311.3">It generates the Compose file and runs </span><strong class="source-inline"><span class="koboSpan" id="kobo.312.1">docker-compose</span></strong><span class="koboSpan" id="kobo.313.1"> commands for you. </span><span class="koboSpan" id="kobo.313.2">This makes it perfect for sharing with teams, as it takes away any intricacies </span><span class="No-Break"><span class="koboSpan" id="kobo.314.1">of Docker.</span></span></p>
<p><span class="koboSpan" id="kobo.315.1">The configuration for your DDEV site is located in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.316.1">config.yaml</span></strong><span class="koboSpan" id="kobo.317.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">.ddev</span></strong><span class="koboSpan" id="kobo.319.1"> directory of your Drupal directory. </span><span class="koboSpan" id="kobo.319.2">The PHP version, database type, version, and more can be customized in this </span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">configuration file.</span></span></p>
<p><span class="koboSpan" id="kobo.321.1">When running Composer or other commands, you will need to SSH into the web application container. </span><span class="koboSpan" id="kobo.321.2">This can be achieved with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">ssh</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.323.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.324.1">
ddev ssh</span></pre>
<p><span class="koboSpan" id="kobo.325.1">By SSHing into the web application, you can run commands directly in your </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">local environment.</span></span></p>
<h2 id="_idParaDest-34"><a id="_idTextAnchor034"/><span class="koboSpan" id="kobo.327.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.328.1">Multiple options can be changed with DDEV and other tools that are similar </span><span class="No-Break"><span class="koboSpan" id="kobo.329.1">to DDEV.</span></span></p>
<h3><span class="koboSpan" id="kobo.330.1">Changing the site’s PHP version</span></h3>
<p><span class="koboSpan" id="kobo.331.1">To modify </span><a id="_idIndexMarker016"/><span class="koboSpan" id="kobo.332.1">the PHP version used on your project, edit </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">.ddev/config.yaml</span></strong><span class="koboSpan" id="kobo.334.1"> and change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">php_version</span></strong><span class="koboSpan" id="kobo.336.1"> property. </span><span class="koboSpan" id="kobo.336.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.337.1">Drupal 10</span></strong><span class="koboSpan" id="kobo.338.1"> project type defaults to </span><strong class="bold"><span class="koboSpan" id="kobo.339.1">PHP 8.1</span></strong><span class="koboSpan" id="kobo.340.1">, which is the minimum required PHP version for Drupal. </span><span class="koboSpan" id="kobo.340.2">But you may choose to use newer PHP versions as they are released and supported </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">by Drupal.</span></span></p>
<h3><span class="koboSpan" id="kobo.342.1">Changing the database version or type</span></h3>
<p><span class="koboSpan" id="kobo.343.1">DDEV </span><a id="_idIndexMarker017"/><span class="koboSpan" id="kobo.344.1">supports MySQL and MariaDB databases, but it does not support Postgres (although it is supported by Drupal). </span><span class="koboSpan" id="kobo.344.2">By </span><a id="_idIndexMarker018"/><span class="koboSpan" id="kobo.345.1">default, DDEV uses </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.346.1">MariaDB 10.3</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.348.1">To change your MariaDB version, edit </span><strong class="source-inline"><span class="koboSpan" id="kobo.349.1">.ddev/config.yaml</span></strong><span class="koboSpan" id="kobo.350.1"> and change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">mariadb_version</span></strong><span class="koboSpan" id="kobo.352.1"> property to your </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">desired version</span></span></li>
<li><span class="koboSpan" id="kobo.354.1">To use MySQL instead of MariaDB, edit </span><strong class="source-inline"><span class="koboSpan" id="kobo.355.1">.ddev/config.yaml</span></strong><span class="koboSpan" id="kobo.356.1"> and replace the </span><strong class="source-inline"><span class="koboSpan" id="kobo.357.1">mariadb_version</span></strong><span class="koboSpan" id="kobo.358.1"> property with </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.359.1">mysql_version: "8.0"</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.360.1">You cannot change database types or downgrade database versions once there is data in the database. </span><span class="koboSpan" id="kobo.360.2">You must first delete the project’s database using </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.361.1">ddev delete</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.363.1">Check the online documentation to learn what versions of each database type are </span><span class="No-Break"><span class="koboSpan" id="kobo.364.1">supported: </span></span><a href="https://ddev.readthedocs.io/en/stable/users/extend/database_types/"><span class="No-Break"><span class="koboSpan" id="kobo.365.1">https://ddev.readthedocs.io/en/stable/users/extend/database_types/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.366.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.367.1">Adding custom services</span></h3>
<p><span class="koboSpan" id="kobo.368.1">DDEV allows </span><a id="_idIndexMarker019"/><span class="koboSpan" id="kobo.369.1">you to add custom services by writing Docker Compose files in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.370.1">.ddev</span></strong><span class="koboSpan" id="kobo.371.1"> directory. </span><span class="koboSpan" id="kobo.371.2">DDEV will aggregate all Docker Compose files in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.372.1">.ddev</span></strong><span class="koboSpan" id="kobo.373.1"> directory that follow the naming convention of </span><strong class="source-inline"><span class="koboSpan" id="kobo.374.1">docker-compose.*.yml</span></strong><span class="koboSpan" id="kobo.375.1">, where </span><strong class="source-inline"><span class="koboSpan" id="kobo.376.1">*</span></strong><span class="koboSpan" id="kobo.377.1"> is a </span><span class="No-Break"><span class="koboSpan" id="kobo.378.1">unique word.</span></span></p>
<p><span class="koboSpan" id="kobo.379.1">For example, to add Redis, we would create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">docker-compose.redis.yaml</span></strong><span class="koboSpan" id="kobo.381.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">.ddev</span></strong><span class="koboSpan" id="kobo.383.1"> directory. </span><span class="koboSpan" id="kobo.383.2">It would contain the following Docker Compose manifest, which defines the Redis service and links it to the web </span><span class="No-Break"><span class="koboSpan" id="kobo.384.1">application service:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.385.1">
version: "3.6"
services:
  redis:
    container_name: ddev-${DDEV_SITENAME}-redis
    image: redis:6
    ports:
      - 6379
    labels:
      com.ddev.site-name: ${DDEV_SITENAME}
      com.ddev.approot: $DDEV_APPROOT
  web:
    links:
      - redis:redis</span></pre>
<p><span class="koboSpan" id="kobo.386.1">The documentation </span><a id="_idIndexMarker020"/><span class="koboSpan" id="kobo.387.1">for additional services can be </span><a id="_idIndexMarker021"/><span class="koboSpan" id="kobo.388.1">found </span><span class="No-Break"><span class="koboSpan" id="kobo.389.1">at </span></span><a href="https://ddev.readthedocs.io/en/stable/users/extend/additional-services/"><span class="No-Break"><span class="koboSpan" id="kobo.390.1">https://ddev.readthedocs.io/en/stable/users/extend/additional-services/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.391.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.392.1">Running Composer with DDEV</span></h3>
<p><span class="koboSpan" id="kobo.393.1">DDEV allows </span><a id="_idIndexMarker022"/><span class="koboSpan" id="kobo.394.1">you to run Composer inside of the web application container. </span><span class="koboSpan" id="kobo.394.2">This is beneficial if you have a different version of PHP on your host machine or have missing extensions required by the project that exists in the web </span><span class="No-Break"><span class="koboSpan" id="kobo.395.1">application container.</span></span></p>
<p><span class="koboSpan" id="kobo.396.1">To run Composer commands, use </span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">ddev composer</span></strong><span class="koboSpan" id="kobo.398.1">. </span><span class="koboSpan" id="kobo.398.2">For example, the following would add a new module to a </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">Drupal site:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.400.1">
ddev composer require drupal/token</span></pre>
<p><span class="koboSpan" id="kobo.401.1">You can provide any Composer commands </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">and arguments.</span></span></p>
<h2 id="_idParaDest-35"><a id="_idTextAnchor035"/><span class="koboSpan" id="kobo.403.1">See also</span></h2>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.404.1">Awesome DDEV</span></strong><span class="koboSpan" id="kobo.405.1">: A collection </span><a id="_idIndexMarker023"/><span class="koboSpan" id="kobo.406.1">of blogs, tutorials, tips, and tricks for </span><span class="No-Break"><span class="koboSpan" id="kobo.407.1">DDEV: </span></span><a href="https://github.com/drud/awesome-ddev "><span class="No-Break"><span class="koboSpan" id="kobo.408.1">https://github.com/drud/awesome-ddev</span></span></a></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.409.1">DDEV Config</span></strong><span class="koboSpan" id="kobo.410.1">: A collection of contributed recipes and snippets for customizing DDEV </span><span class="No-Break"><span class="koboSpan" id="kobo.411.1">sites: </span></span><a href="https://github.com/drud/ddev-contrib "><span class="No-Break"><span class="koboSpan" id="kobo.412.1">https://github.com/drud/ddev-contrib</span></span></a></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.413.1">Official local development </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.414.1">guide</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">: </span></span><a href="https://www.drupal.org/docs/official_docs/en/_local_development_guide.html "><span class="No-Break"><span class="koboSpan" id="kobo.416.1">https://www.drupal.org/docs/official_docs/en/_local_development_guide.html</span></span></a></li>
</ul>
<h1 id="_idParaDest-36"><a id="_idTextAnchor036"/><span class="koboSpan" id="kobo.417.1">Using the Drush command-line tool</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.418.1">Drush</span></strong><span class="koboSpan" id="kobo.419.1"> is a command-line </span><a id="_idIndexMarker024"/><span class="koboSpan" id="kobo.420.1">tool that interacts with Drupal to perform actions such as installing Drupal or performing various maintenance tasks. </span><span class="koboSpan" id="kobo.420.2">In this recipe, we will add Drush to our Drupal site and use it to install the </span><span class="No-Break"><span class="koboSpan" id="kobo.421.1">Drupal site.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.422.1">Warning</span></p>
<p class="callout"><span class="koboSpan" id="kobo.423.1">This example uses commands that will cause data loss if you have an existing </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">installed site.</span></span></p>
<h2 id="_idParaDest-37"><a id="_idTextAnchor037"/><span class="koboSpan" id="kobo.425.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.426.1">When using DDEV, you must SSH into the web application container using </span><strong class="source-inline"><span class="koboSpan" id="kobo.427.1">ddev ssh</span></strong><span class="koboSpan" id="kobo.428.1"> to interact </span><span class="No-Break"><span class="koboSpan" id="kobo.429.1">with Drush.</span></span></p>
<h2 id="_idParaDest-38"><a id="_idTextAnchor038"/><span class="koboSpan" id="kobo.430.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.431.1">Open a terminal and navigate to your Drupal </span><span class="No-Break"><span class="koboSpan" id="kobo.432.1">code base.</span></span></li>
<li><span class="koboSpan" id="kobo.433.1">Add </span><strong class="bold"><span class="koboSpan" id="kobo.434.1">Drush</span></strong><span class="koboSpan" id="kobo.435.1"> via </span><strong class="bold"><span class="koboSpan" id="kobo.436.1">Composer</span></strong><span class="koboSpan" id="kobo.437.1"> using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">require</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.439.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.440.1">composer require drush/drush</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.441.1">Execute the </span><strong class="source-inline"><span class="koboSpan" id="kobo.442.1">site:install</span></strong><span class="koboSpan" id="kobo.443.1"> command to </span><span class="No-Break"><span class="koboSpan" id="kobo.444.1">install Drupal:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.445.1">php vendor/bin/drush site:install --account-pass=admin</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.446.1">Once the installation has finished, use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.447.1">user:login</span></strong><span class="koboSpan" id="kobo.448.1"> command to generate a one-time login link to access the Drupal site. </span><span class="koboSpan" id="kobo.448.2">Your browser should automatically open if you do not click the </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">returned link:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.450.1">php vendor/bin/drush user:login</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.451.1">Install the </span><strong class="bold"><span class="koboSpan" id="kobo.452.1">Layout Builder</span></strong><span class="koboSpan" id="kobo.453.1"> module using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.454.1">pm:enable</span></strong><span class="koboSpan" id="kobo.455.1"> command. </span><span class="koboSpan" id="kobo.455.2">Press </span><em class="italic"><span class="koboSpan" id="kobo.456.1">Enter</span></em><span class="koboSpan" id="kobo.457.1"> to confirm this to install </span><strong class="bold"><span class="koboSpan" id="kobo.458.1">Layout Builder</span></strong><span class="koboSpan" id="kobo.459.1"> and </span><span class="No-Break"><span class="koboSpan" id="kobo.460.1">its dependencies:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.461.1">php vendor/bin/drush pm:enable layout_builder</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.462.1">Rebuild Drupal’s caches using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.463.1">cache:rebuild</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.464.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.465.1">php vendor/bin/drush cache:rebuild</span></strong></pre></li>
</ol>
<h2 id="_idParaDest-39"><a id="_idTextAnchor039"/><span class="koboSpan" id="kobo.466.1">How it works…</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.467.1">Drush</span></strong><span class="koboSpan" id="kobo.468.1"> has been </span><a id="_idIndexMarker025"/><span class="koboSpan" id="kobo.469.1">part of the Drupal community since </span><strong class="bold"><span class="koboSpan" id="kobo.470.1">Drupal 4.7</span></strong><span class="koboSpan" id="kobo.471.1"> and has become a must-have tool for every Drupal developer. </span><span class="koboSpan" id="kobo.471.2">The project can bootstrap Drupal on the command line and perform interactions with </span><span class="No-Break"><span class="koboSpan" id="kobo.472.1">a site.</span></span></p>
<p><span class="koboSpan" id="kobo.473.1">Drush has a plethora of commands, which can be found by running the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.474.1">list</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.475.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.476.1">
php vendor/bin/drush list</span></pre>
<p><span class="koboSpan" id="kobo.477.1">Modules can provide their own Drush commands as well. </span><span class="koboSpan" id="kobo.477.2">As you add modules to your Drupal sites, new commands may be available. </span><span class="koboSpan" id="kobo.477.3">In the </span><em class="italic"><span class="koboSpan" id="kobo.478.1">Extending Drupal with custom code</span></em><span class="koboSpan" id="kobo.479.1"> recipe, we will cover creating your own </span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">Drush command.</span></span></p>
<h2 id="_idParaDest-40"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.481.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.482.1">There is a plethora of Drush commands and ways that Drush can make working with your Drupal site </span><span class="No-Break"><span class="koboSpan" id="kobo.483.1">much easier.</span></span></p>
<h3><span class="koboSpan" id="kobo.484.1">Running Drush with DDEV</span></h3>
<p><span class="koboSpan" id="kobo.485.1">DDEV provides a way to run Drush without using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.486.1">ssh</span></strong><span class="koboSpan" id="kobo.487.1"> command to SSH into the web application </span><a id="_idIndexMarker026"/><span class="koboSpan" id="kobo.488.1">container, just like it does for Composer. </span><span class="koboSpan" id="kobo.488.2">To run Drush commands with DDEV, use </span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">ddev drush</span></strong><span class="koboSpan" id="kobo.490.1">. </span><span class="koboSpan" id="kobo.490.2">For example, the following command would generate a link to log into your </span><span class="No-Break"><span class="koboSpan" id="kobo.491.1">Drupal site:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.492.1">
ddev drush user:login</span></pre>
<p><span class="koboSpan" id="kobo.493.1">You can provide any Drush command </span><span class="No-Break"><span class="koboSpan" id="kobo.494.1">and arguments.</span></span></p>
<h3><span class="koboSpan" id="kobo.495.1">Checking whether there are pending security updates</span></h3>
<p><span class="koboSpan" id="kobo.496.1">It is important to keep your installed modules and themes up to date, especially if there are security </span><a id="_idIndexMarker027"/><span class="koboSpan" id="kobo.497.1">releases. </span><span class="koboSpan" id="kobo.497.2">Drush provides the </span><strong class="source-inline"><span class="koboSpan" id="kobo.498.1">pm:security</span></strong><span class="koboSpan" id="kobo.499.1"> command, which checks for any pending security releases for installed modules </span><span class="No-Break"><span class="koboSpan" id="kobo.500.1">or themes:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.501.1">
php vendor/bin/drush pm:security</span></pre>
<h3><span class="koboSpan" id="kobo.502.1">Exporting or importing a SQL file to your Drupal database</span></h3>
<p><span class="koboSpan" id="kobo.503.1">Drush has </span><a id="_idIndexMarker028"/><span class="koboSpan" id="kobo.504.1">a variety </span><a id="_idIndexMarker029"/><span class="koboSpan" id="kobo.505.1">of SQL commands for interacting with your </span><span class="No-Break"><span class="koboSpan" id="kobo.506.1">database directly.</span></span></p>
<p><span class="koboSpan" id="kobo.507.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">sql:dump</span></strong><span class="koboSpan" id="kobo.509.1"> command allows you to create a database dump that can be imported into another database. </span><span class="koboSpan" id="kobo.509.2">By default, the SQL statements are printed unless the </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">--result-file</span></strong><span class="koboSpan" id="kobo.511.1"> option is passed. </span><span class="koboSpan" id="kobo.511.2">The file path is relative to Drupal’s document root (the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">web</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.513.1"> directory):</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.514.1">
php vendor/bin/drush sql:dump --result-file=../db-dump.sql</span></pre>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.515.1">sql:cli</span></strong><span class="koboSpan" id="kobo.516.1"> allows you to execute SQL statements, including importing a SQL dump file. </span><span class="koboSpan" id="kobo.516.2">For example, you can use this command to import a SQL dump from your production Drupal database into your local </span><span class="No-Break"><span class="koboSpan" id="kobo.517.1">development environment:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.518.1">
php vendor/bin/drush sql:cli &lt; db-dump.sql</span></pre>
<h2 id="_idParaDest-41"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.519.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.520.1">Drush home </span><a id="_idIndexMarker030"/><span class="No-Break"><span class="koboSpan" id="kobo.521.1">page: </span></span><a href="https://www.drush.org/latest/ "><span class="No-Break"><span class="koboSpan" id="kobo.522.1">https://www.drush.org/latest/</span></span></a></li>
</ul>
<h1 id="_idParaDest-42"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.523.1">Adding and managing module and theme extensions</span></h1>
<p><span class="koboSpan" id="kobo.524.1">Drupal is </span><a id="_idIndexMarker031"/><span class="koboSpan" id="kobo.525.1">extremely versatile due to its composable design </span><a id="_idIndexMarker032"/><span class="koboSpan" id="kobo.526.1">and its large ecosystem of contributed modules </span><a id="_idIndexMarker033"/><span class="koboSpan" id="kobo.527.1">and themes. </span><span class="koboSpan" id="kobo.527.2">Composer is used for installing and upgrading </span><a id="_idIndexMarker034"/><span class="koboSpan" id="kobo.528.1">extensions on your Drupal site using its </span><strong class="source-inline"><span class="koboSpan" id="kobo.529.1">require</span></strong><span class="koboSpan" id="kobo.530.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">update</span></strong><span class="koboSpan" id="kobo.532.1"> commands. </span><span class="koboSpan" id="kobo.532.2">In </span><a id="_idIndexMarker035"/><span class="koboSpan" id="kobo.533.1">this recipe, we will add the popular </span><strong class="bold"><span class="koboSpan" id="kobo.534.1">Pathauto</span></strong><span class="koboSpan" id="kobo.535.1"> module (</span><a href="https://www.drupal.org/project/pathauto"><span class="koboSpan" id="kobo.536.1">https://www.drupal.org/project/pathauto</span></a><span class="koboSpan" id="kobo.537.1">) and </span><a id="_idIndexMarker036"/><span class="koboSpan" id="kobo.538.1">the </span><strong class="bold"><span class="koboSpan" id="kobo.539.1">Barrio</span></strong><span class="koboSpan" id="kobo.540.1"> theme (</span><a href="https://www.drupal.org/project/bootstrap_barrio"><span class="koboSpan" id="kobo.541.1">https://www.drupal.org/project/bootstrap_barrio</span></a><span class="koboSpan" id="kobo.542.1">), a Bootstrap </span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">5 theme.</span></span></p>
<h2 id="_idParaDest-43"><a id="_idTextAnchor043"/><span class="koboSpan" id="kobo.544.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.545.1">Open a terminal and navigate to your Drupal </span><span class="No-Break"><span class="koboSpan" id="kobo.546.1">code base.</span></span></li>
<li><span class="koboSpan" id="kobo.547.1">First, we will add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.548.1">Pathauto</span></strong><span class="koboSpan" id="kobo.549.1"> module using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.550.1">require</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.551.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.552.1">composer require drupal/pathauto</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.553.1">Composer will output some data as it begins resolving the </span><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">Pathauto</span></strong><span class="koboSpan" id="kobo.555.1"> package. </span><span class="koboSpan" id="kobo.555.2">You will notice that the module dependencies for </span><strong class="source-inline"><span class="koboSpan" id="kobo.556.1">Pathauto</span></strong><span class="koboSpan" id="kobo.557.1"> were also downloaded: </span><strong class="source-inline"><span class="koboSpan" id="kobo.558.1">Token</span></strong><span class="koboSpan" id="kobo.559.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">Chaos Tools</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.562.1">The modules will be installed into the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.563.1">web/modules/contrib</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.564.1"> directory.</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.565.1">Next, we will add the </span><span class="No-Break"><span class="koboSpan" id="kobo.566.1">Barrio theme:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.567.1">composer require drupal/bootstrap_barrio</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.568.1">This will download the Barrio theme and place it into the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.569.1">web/themes/contrib</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.570.1"> directory.</span></span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.571.1">Now, we will install the </span><strong class="source-inline"><span class="koboSpan" id="kobo.572.1">Pathauto</span></strong><span class="koboSpan" id="kobo.573.1"> module using the Drush </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.574.1">pm:enable</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.575.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.576.1">php vendor/bin/drush pm:enable pathauto</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.577.1">This Drush command will prompt us to install </span><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">Pathauto</span></strong><span class="koboSpan" id="kobo.579.1"> with the required module dependencies (</span><strong class="source-inline"><span class="koboSpan" id="kobo.580.1">Chaos Tools</span></strong><span class="koboSpan" id="kobo.581.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.582.1">Token</span></strong><span class="koboSpan" id="kobo.583.1">) as well, with a default option of </span><strong class="source-inline"><span class="koboSpan" id="kobo.584.1">yes</span></strong><span class="koboSpan" id="kobo.585.1">. </span><span class="koboSpan" id="kobo.585.2">Hit </span><em class="italic"><span class="koboSpan" id="kobo.586.1">Enter</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.587.1">to continue.</span></span></p>
<p><span class="koboSpan" id="kobo.588.1">The command will return </span><span class="No-Break"><span class="koboSpan" id="kobo.589.1">the following:</span></span></p>
<pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.590.1">[success] Successfully enabled: pathauto, ctools,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.591.1">  token</span></strong></pre>
<ol>
<li value="5"><span class="koboSpan" id="kobo.592.1">Next, we </span><a id="_idIndexMarker037"/><span class="koboSpan" id="kobo.593.1">will enable the Barrio theme using the Drush </span><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">theme:enable</span></strong><span class="koboSpan" id="kobo.595.1"> command </span><a id="_idIndexMarker038"/><span class="koboSpan" id="kobo.596.1">and set it as the </span><a id="_idIndexMarker039"/><span class="koboSpan" id="kobo.597.1">default theme using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.598.1">config:set</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.599.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.600.1">php vendor/bin/drush theme:enable bootstrap_barrio</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.601.1">This only </span><a id="_idIndexMarker040"/><span class="koboSpan" id="kobo.602.1">enables the theme; it does not make it the default theme used by your Drupal site. </span><span class="koboSpan" id="kobo.602.2">To make it the default theme, we need to modify the site’s configuration with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.603.1">config:set</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.604.1"> command:</span></span></p>
<pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.605.1">php vendor/bin/drush config:set system.theme default</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.606.1">  bootstrap_barrio</span></strong></pre>
<p><span class="koboSpan" id="kobo.607.1">This modifies the </span><strong class="source-inline"><span class="koboSpan" id="kobo.608.1">system.theme</span></strong><span class="koboSpan" id="kobo.609.1"> config so that it uses Barrio as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.610.1">default</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.611.1">theme setting.</span></span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.612.1">Let’s assume there was a new release of </span><strong class="source-inline"><span class="koboSpan" id="kobo.613.1">Pathauto</span></strong><span class="koboSpan" id="kobo.614.1"> that we needed to update. </span><span class="koboSpan" id="kobo.614.2">We can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.615.1">update</span></strong><span class="koboSpan" id="kobo.616.1"> command to update </span><span class="No-Break"><span class="koboSpan" id="kobo.617.1">our package:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.618.1">composer update drupal/pathauto</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.619.1">This will update the </span><strong class="source-inline"><span class="koboSpan" id="kobo.620.1">Pathauto</span></strong><span class="koboSpan" id="kobo.621.1"> module to the next version. </span><span class="koboSpan" id="kobo.621.2">However, it will not update its dependencies – that is, </span><strong class="source-inline"><span class="koboSpan" id="kobo.622.1">Chaos Tools</span></strong><span class="koboSpan" id="kobo.623.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.624.1">Token</span></strong><span class="koboSpan" id="kobo.625.1">. </span><span class="koboSpan" id="kobo.625.2">Using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.626.1">--with-dependencies</span></strong><span class="koboSpan" id="kobo.627.1"> option ensures direct dependencies for </span><strong class="source-inline"><span class="koboSpan" id="kobo.628.1">Pathauto</span></strong><span class="koboSpan" id="kobo.629.1"> are </span><span class="No-Break"><span class="koboSpan" id="kobo.630.1">also updated.</span></span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.631.1">Finally, we will cover removing modules that we have added to the Drupal site. </span><span class="koboSpan" id="kobo.631.2">First, we must </span><em class="italic"><span class="koboSpan" id="kobo.632.1">uninstall</span></em><span class="koboSpan" id="kobo.633.1"> the module from Drupal before we remove it from the </span><span class="No-Break"><span class="koboSpan" id="kobo.634.1">code base:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.635.1">php vendor/bin/drush pm:uninstall pathauto ctools</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.636.1">  token</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.637.1">Notice how </span><strong class="source-inline"><span class="koboSpan" id="kobo.638.1">Chaos Tools</span></strong><span class="koboSpan" id="kobo.639.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">Token</span></strong><span class="koboSpan" id="kobo.641.1"> are added as arguments? </span><span class="koboSpan" id="kobo.641.2">These modules were added to our code base and installed as dependencies for </span><strong class="source-inline"><span class="koboSpan" id="kobo.642.1">Pathauto</span></strong><span class="koboSpan" id="kobo.643.1">. </span><span class="koboSpan" id="kobo.643.2">We need to uninstall these modules as well before </span><span class="No-Break"><span class="koboSpan" id="kobo.644.1">removing </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.645.1">Pathauto</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.646.1">.</span></span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.647.1">Next, we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.648.1">remove</span></strong><span class="koboSpan" id="kobo.649.1"> command to remove </span><strong class="source-inline"><span class="koboSpan" id="kobo.650.1">Pathauto</span></strong><span class="koboSpan" id="kobo.651.1"> from the </span><span class="No-Break"><span class="koboSpan" id="kobo.652.1">code base:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.653.1">composer remove drupal/pathauto</span></strong></pre></li>
</ol>
<h2 id="_idParaDest-44"><a id="_idTextAnchor044"/><span class="koboSpan" id="kobo.654.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.655.1">By default, Composer </span><a id="_idIndexMarker041"/><span class="koboSpan" id="kobo.656.1">can only add packages available on </span><strong class="bold"><span class="koboSpan" id="kobo.657.1">Packagist</span></strong><span class="koboSpan" id="kobo.658.1"> (</span><a href="https://packagist.org/"><span class="koboSpan" id="kobo.659.1">https://packagist.org/</span></a><span class="koboSpan" id="kobo.660.1">). </span><span class="koboSpan" id="kobo.660.2">The Drupal.org website provides a </span><strong class="bold"><span class="koboSpan" id="kobo.661.1">Composer</span></strong><span class="koboSpan" id="kobo.662.1"> endpoint </span><a id="_idIndexMarker042"/><span class="koboSpan" id="kobo.663.1">that exposes all Drupal projects as Composer </span><a id="_idIndexMarker043"/><span class="koboSpan" id="kobo.664.1">packages under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.665.1">drupal/</span></strong><span class="koboSpan" id="kobo.666.1"> namespace. </span><span class="koboSpan" id="kobo.666.2">The Drupal </span><a id="_idIndexMarker044"/><span class="koboSpan" id="kobo.667.1">project template adds the Composer template’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.668.1">composer.json</span></strong><span class="koboSpan" id="kobo.669.1"> so that </span><a id="_idIndexMarker045"/><span class="koboSpan" id="kobo.670.1">these packages </span><span class="No-Break"><span class="koboSpan" id="kobo.671.1">become available:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.672.1">
    "repositories": [
        {
            "type": "composer",
            "url": "https://packages.drupal.org/8"
        }
    ],</span></pre>
<p><span class="koboSpan" id="kobo.673.1">Drupal follows a pattern of having projects downloaded from </span><strong class="source-inline"><span class="koboSpan" id="kobo.674.1">Drupal.org</span></strong><span class="koboSpan" id="kobo.675.1"> go into a </span><strong class="source-inline"><span class="koboSpan" id="kobo.676.1">contrib</span></strong><span class="koboSpan" id="kobo.677.1"> directory and </span><strong class="source-inline"><span class="koboSpan" id="kobo.678.1">custom</span></strong><span class="koboSpan" id="kobo.679.1"> code go into a </span><span class="No-Break"><span class="koboSpan" id="kobo.680.1">custom directory.</span></span></p>
<p><span class="koboSpan" id="kobo.681.1">Once modules and themes have been added to a Drupal code base, they still need to be installed. </span><span class="koboSpan" id="kobo.681.2">Having the code present does not make them immediately activated. </span><span class="koboSpan" id="kobo.681.3">This also means that removing modules from your code base must be a two-part process. </span><span class="koboSpan" id="kobo.681.4">Drupal will throw errors if you remove a module’s code before it </span><span class="No-Break"><span class="koboSpan" id="kobo.682.1">is uninstalled.</span></span></p>
<h2 id="_idParaDest-45"><a id="_idTextAnchor045"/><span class="koboSpan" id="kobo.683.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.684.1">Drupal is a project that was created before Composer and only recently became </span><strong class="bold"><span class="koboSpan" id="kobo.685.1">Composer</span></strong><span class="koboSpan" id="kobo.686.1"> compatible halfway through the Drupal 8 life cycle. </span><span class="koboSpan" id="kobo.686.2">There are some additional items </span><span class="No-Break"><span class="koboSpan" id="kobo.687.1">to cover.</span></span></p>
<h3><span class="koboSpan" id="kobo.688.1">Composer Library Installer and Drupal extensions</span></h3>
<p><span class="koboSpan" id="kobo.689.1">Composer will install packages to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.690.1">vendor</span></strong><span class="koboSpan" id="kobo.691.1"> directory by default. </span><span class="koboSpan" id="kobo.691.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.692.1">Composer Library Installer</span></strong><span class="koboSpan" id="kobo.693.1"> is a </span><a id="_idIndexMarker046"/><span class="koboSpan" id="kobo.694.1">package that frameworks can use to </span><a id="_idIndexMarker047"/><span class="koboSpan" id="kobo.695.1">modify the installation paths of specific </span><span class="No-Break"><span class="koboSpan" id="kobo.696.1">package types.</span></span></p>
<p><span class="koboSpan" id="kobo.697.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.698.1">composer/installers</span></strong><span class="koboSpan" id="kobo.699.1"> package is added as part of Drupal’s project template and supports the </span><a id="_idIndexMarker048"/><span class="koboSpan" id="kobo.700.1">following package types and </span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">their destinations:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.702.1">drupal-core</span></strong><span class="koboSpan" id="kobo.703.1">: The package type used for Drupal’s core code base. </span><span class="koboSpan" id="kobo.703.2">It is installed in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.704.1">web/core</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.705.1"> directory.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.706.1">drupal-module</span></strong><span class="koboSpan" id="kobo.707.1">: The package type used for modules. </span><span class="koboSpan" id="kobo.707.2">It is installed in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.708.1">web/modules/contrib</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.709.1"> directory.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.710.1">drupal-theme</span></strong><span class="koboSpan" id="kobo.711.1">: The package type used for themes. </span><span class="koboSpan" id="kobo.711.2">It is installed in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.712.1">web/themes /</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.713.1">contrib</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.714.1"> directory.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.715.1">drupal-profile</span></strong><span class="koboSpan" id="kobo.716.1">: The package type used for profiles. </span><span class="koboSpan" id="kobo.716.2">It is installed in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.717.1">web/modules/profiles</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.718.1"> directory.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">drupal-library</span></strong><span class="koboSpan" id="kobo.720.1">: A special package type used to help download frontend libraries to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.721.1">web/libraries</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.722.1"> directory.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.723.1">These mappings can be found in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.724.1">composer.json</span></strong><span class="koboSpan" id="kobo.725.1"> file for your </span><span class="No-Break"><span class="koboSpan" id="kobo.726.1">Drupal project.</span></span></p>
<h3><span class="koboSpan" id="kobo.727.1">Updating Drupal core</span></h3>
<p><span class="koboSpan" id="kobo.728.1">Updating the </span><a id="_idIndexMarker049"/><span class="koboSpan" id="kobo.729.1">core Drupal code base is a bit more involved than updating the </span><strong class="source-inline"><span class="koboSpan" id="kobo.730.1">drupal/core-recommended</span></strong><span class="koboSpan" id="kobo.731.1"> package. </span><span class="koboSpan" id="kobo.731.2">As stated, Drupal has recently added support for true Composer build support. </span><span class="koboSpan" id="kobo.731.3">There is also the </span><strong class="source-inline"><span class="koboSpan" id="kobo.732.1">drupal/core-composer-scaffold</span></strong><span class="koboSpan" id="kobo.733.1"> package, which copies over the </span><span class="No-Break"><span class="koboSpan" id="kobo.734.1">required files.</span></span></p>
<p><span class="koboSpan" id="kobo.735.1">Composer allows us to use wildcards to update dependencies. </span><span class="koboSpan" id="kobo.735.2">The easiest way to upgrade </span><a id="_idIndexMarker050"/><span class="koboSpan" id="kobo.736.1">Drupal core is by using a wildcard and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.737.1">-</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.738.1">with-dependencies</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.739.1"> option:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.740.1">
composer update 'drupal/core-*' –with-dependencies</span></pre>
<p><span class="koboSpan" id="kobo.741.1">The apostrophes are used to escape the </span><strong class="source-inline"><span class="koboSpan" id="kobo.742.1">*</span></strong><span class="koboSpan" id="kobo.743.1"> character. </span><span class="koboSpan" id="kobo.743.2">This command will update </span><strong class="source-inline"><span class="koboSpan" id="kobo.744.1">drupal/core-recommended</span></strong><span class="koboSpan" id="kobo.745.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.746.1">drupal/core-composer-scaffold</span></strong><span class="koboSpan" id="kobo.747.1"> at the same time, as well as all of Drupal core’s </span><span class="No-Break"><span class="koboSpan" id="kobo.748.1">dependency packages.</span></span></p>
<h2 id="_idParaDest-46"><a id="_idTextAnchor046"/><span class="koboSpan" id="kobo.749.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.750.1">The official documentation for using Composer to download and update </span><span class="No-Break"><span class="koboSpan" id="kobo.751.1">files: </span></span><a href="https://www.drupal.org/docs/user_guide/en/install-composer.html "><span class="No-Break"><span class="koboSpan" id="kobo.752.1">https://www.drupal.org/docs/user_guide/en/install-composer.html</span></span></a></li>
<li><span class="koboSpan" id="kobo.753.1">The official documentation for downloading and installing a theme from </span><span class="No-Break"><span class="koboSpan" id="kobo.754.1">Drupal.org: </span></span><a href="https://www.drupal.org/docs/user_guide/en/extend-theme-install.html "><span class="No-Break"><span class="koboSpan" id="kobo.755.1">https://www.drupal.org/docs/user_guide/en/extend-theme-install.html</span></span></a></li>
</ul>
<h1 id="_idParaDest-47"><a id="_idTextAnchor047"/><span class="koboSpan" id="kobo.756.1">Managing your Drupal code with version control</span></h1>
<p><span class="koboSpan" id="kobo.757.1">Now that </span><a id="_idIndexMarker051"/><span class="koboSpan" id="kobo.758.1">we have a Drupal code base, it is time to put that code into version control with Git. </span><span class="koboSpan" id="kobo.758.2">We will also export our Drupal site’s configuration to YAML files that allow us to track the site configuration in </span><span class="No-Break"><span class="koboSpan" id="kobo.759.1">version control.</span></span></p>
<p><span class="koboSpan" id="kobo.760.1">Tracking your code in version control makes it easier to collaborate with other developers, track changes, and integrate with continuous integration and deployment tools. </span><span class="koboSpan" id="kobo.760.2">It is highly recommended, even if you are the only developer working on </span><span class="No-Break"><span class="koboSpan" id="kobo.761.1">the project.</span></span></p>
<h2 id="_idParaDest-48"><a id="_idTextAnchor048"/><span class="koboSpan" id="kobo.762.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.763.1">This recipe requires that you have Git on your machine. </span><span class="koboSpan" id="kobo.763.2">If you do not already have Git, see the </span><span class="No-Break"><span class="koboSpan" id="kobo.764.1">following resources:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.765.1">Git official downloads </span><span class="No-Break"><span class="koboSpan" id="kobo.766.1">page: </span></span><a href="https://git-scm.com/downloads"><span class="No-Break"><span class="koboSpan" id="kobo.767.1">https://git-scm.com/downloads</span></span></a></li>
<li><span class="koboSpan" id="kobo.768.1">GitHub’s </span><em class="italic"><span class="koboSpan" id="kobo.769.1">Install Git</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.770.1">guide: </span></span><a href="https://github.com/git-guides/install-git "><span class="No-Break"><span class="koboSpan" id="kobo.771.1">https://github.com/git-guides/install-git</span></span></a></li>
</ul>
<h2 id="_idParaDest-49"><a id="_idTextAnchor049"/><span class="koboSpan" id="kobo.772.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.773.1">Open a terminal and navigate to your Drupal </span><span class="No-Break"><span class="koboSpan" id="kobo.774.1">code base.</span></span></li>
<li><span class="koboSpan" id="kobo.775.1">Initialize a new Git repository with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.776.1">init</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.777.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.778.1">git init</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.779.1">You will see a message about an initialized empty repository, similar to </span><span class="No-Break"><span class="koboSpan" id="kobo.780.1">the following:</span></span></p>
<pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.781.1">Initialized empty Git repository in /Users/</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.782.1">  mglaman/Sites/mysite/.git/</span></strong></pre>
<ol>
<li value="3"><span class="koboSpan" id="kobo.783.1">Before we </span><a id="_idIndexMarker052"/><span class="koboSpan" id="kobo.784.1">add files to Git to be tracked in version control, we must create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.785.1">.gitignore</span></strong><span class="koboSpan" id="kobo.786.1"> file to specify files we do not want to be tracked. </span><span class="koboSpan" id="kobo.786.2">Create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.787.1">.gitignore</span></strong><span class="koboSpan" id="kobo.788.1"> file in your project’s </span><span class="No-Break"><span class="koboSpan" id="kobo.789.1">root directory.</span></span></li>
<li><span class="koboSpan" id="kobo.790.1">We want to ignore directories that contain code that is managed by Composer, user-managed files (such as uploads), and sensitive directories. </span><span class="koboSpan" id="kobo.790.2">Add the following to your </span><strong class="source-inline"><span class="koboSpan" id="kobo.791.1">.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.792.1">gitignore</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.793.1"> file:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.794.1"># Ignore directories generated by Composer</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.795.1">/drush/contrib/</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.796.1">/vendor/</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.797.1">/web/core/</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.798.1">/web/modules/contrib/</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.799.1">/web/themes/contrib/</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.800.1">/web/profiles/contrib/</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.801.1">/web/libraries/</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.802.1"># Ignore local settings overrides.</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.803.1">/web/sites/*/settings.local.php</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.804.1"># Ignore Drupal's file directory</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.805.1">/web/sites/*/files/</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.806.1">This excludes all the directories where Composer may install dependencies, local override settings, and the file uploads directory. </span><span class="koboSpan" id="kobo.806.2">We do not exclude </span><strong class="source-inline"><span class="koboSpan" id="kobo.807.1">web/sites/default/settings.php</span></strong><span class="koboSpan" id="kobo.808.1"> but ensure we exclude </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.809.1">settings.local.php</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.810.1"> files.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.811.1">Now, we can </span><a id="_idIndexMarker053"/><span class="koboSpan" id="kobo.812.1">add our files to be tracked by Git using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.813.1">add</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.814.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.815.1">git add .</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.816.1">We use a period (</span><strong class="source-inline"><span class="koboSpan" id="kobo.817.1">.</span></strong><span class="koboSpan" id="kobo.818.1">) for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.819.1">add</span></strong><span class="koboSpan" id="kobo.820.1"> command’s argument to add all files within the </span><span class="No-Break"><span class="koboSpan" id="kobo.821.1">current directory.</span></span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.822.1">Verify that the files were added to be tracked by Git by using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.823.1">status</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.824.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.825.1">git status</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.826.1">You should see multiple lines of files colored green. </span><span class="koboSpan" id="kobo.826.2">Green means the files are staged to </span><span class="No-Break"><span class="koboSpan" id="kobo.827.1">be tracked:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer006">
<span class="koboSpan" id="kobo.828.1"><img alt="Figure 1.2 – Output from the status command, with green files representing items tracked in Git" src="image/Figure_1.2_B18548.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.829.1">Figure 1.2 – Output from the status command, with green files representing items tracked in Git</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.830.1">Now, it is time </span><a id="_idIndexMarker054"/><span class="koboSpan" id="kobo.831.1">to commit the changes using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.832.1">commit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.833.1"> command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.834.1">git commit -m "Initial commit"</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.835.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.836.1">commit</span></strong><span class="koboSpan" id="kobo.837.1"> command records changes to the repository. </span><span class="koboSpan" id="kobo.837.2">Commits require a commit message. </span><span class="koboSpan" id="kobo.837.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.838.1">-m</span></strong><span class="koboSpan" id="kobo.839.1"> flag allows you to provide </span><span class="No-Break"><span class="koboSpan" id="kobo.840.1">a message.</span></span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.841.1">With our code now tracked in Git, we want to export Drupal’s configuration and track that as well. </span><span class="koboSpan" id="kobo.841.2">We can do this with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.842.1">config:export</span></strong><span class="koboSpan" id="kobo.843.1"> command </span><span class="No-Break"><span class="koboSpan" id="kobo.844.1">from Drush:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.845.1">php vendor/bin/drush config:export</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.846.1">For the first import, all configurations will be exported. </span><span class="koboSpan" id="kobo.846.2">Afterward, you will be prompted to export the configuration as it will overwrite the </span><span class="No-Break"><span class="koboSpan" id="kobo.847.1">existing files.</span></span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.848.1">Add the exported configuration files </span><span class="No-Break"><span class="koboSpan" id="kobo.849.1">to Git:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.850.1">git add config</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.851.1">You may use </span><strong class="source-inline"><span class="koboSpan" id="kobo.852.1">git status</span></strong><span class="koboSpan" id="kobo.853.1"> to verify that the files were staged </span><span class="No-Break"><span class="koboSpan" id="kobo.854.1">for commit.</span></span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.855.1">Commit the </span><span class="No-Break"><span class="koboSpan" id="kobo.856.1">configuration files:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.857.1">git commit -m "Add configuration files"</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.858.1">Your Drupal site is now managed in Git and can be pushed to a GitHub or </span><span class="No-Break"><span class="koboSpan" id="kobo.859.1">GitLab repository!</span></span></li>
</ol>
<h2 id="_idParaDest-50"><a id="_idTextAnchor050"/><span class="koboSpan" id="kobo.860.1">How it works…</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.861.1">Git</span></strong><span class="koboSpan" id="kobo.862.1"> is a free </span><a id="_idIndexMarker055"/><span class="koboSpan" id="kobo.863.1">and open-source version control system. </span><span class="koboSpan" id="kobo.863.2">In this recipe, we created a new Git repository for the files that make up our Drupal site. </span><span class="koboSpan" id="kobo.863.3">When files are added to a Git repository, they are tracked to monitor changes to the files. </span><span class="koboSpan" id="kobo.863.4">Changes are then committed and create a new revision in the version control history. </span><span class="koboSpan" id="kobo.863.5">The Git repository can then be added to GitHub, GitLab, or other services to host the </span><span class="No-Break"><span class="koboSpan" id="kobo.864.1">project code.</span></span></p>
<p><span class="koboSpan" id="kobo.865.1">Version control </span><a id="_idIndexMarker056"/><span class="koboSpan" id="kobo.866.1">is beneficial as it makes it easy to work with other developers without creating conflicting code changes. </span><span class="koboSpan" id="kobo.866.2">It also makes the code transportable. </span><span class="koboSpan" id="kobo.866.3">The Drupal site code does not live just on your machine, but also on the remote repository (GitHub, GitLab, or </span><span class="No-Break"><span class="koboSpan" id="kobo.867.1">another service).</span></span></p>
<p><span class="koboSpan" id="kobo.868.1">Nearly all </span><strong class="bold"><span class="koboSpan" id="kobo.869.1">Platf</span><a id="_idTextAnchor051"/><span class="koboSpan" id="kobo.870.1">orm-as-a-Service</span></strong><span class="koboSpan" id="kobo.871.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.872.1">PaaS</span></strong><span class="koboSpan" id="kobo.873.1">) hosting </span><a id="_idIndexMarker057"/><span class="koboSpan" id="kobo.874.1">providers that provide continuous integration and deployment for Drupal sites require code to exist in a </span><span class="No-Break"><span class="koboSpan" id="kobo.875.1">Git repository.</span></span></p>
<h2 id="_idParaDest-51"><a id="_idTextAnchor052"/><span class="koboSpan" id="kobo.876.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.877.1">Git </span><span class="No-Break"><span class="koboSpan" id="kobo.878.1">docs: </span></span><a href="https://git-scm.com/docs "><span class="No-Break"><span class="koboSpan" id="kobo.879.1">https://git-scm.com/docs</span></span></a></li>
<li><span class="koboSpan" id="kobo.880.1">Drupal.org documentation for </span><span class="No-Break"><span class="koboSpan" id="kobo.881.1">Git: </span></span><a href="https://www.drupal.org/docs/develop/git "><span class="No-Break"><span class="koboSpan" id="kobo.882.1">https://www.drupal.org/docs/develop/git</span></span></a></li>
</ul>
<h1 id="_idParaDest-52"><a id="_idTextAnchor053"/><span class="koboSpan" id="kobo.883.1">Successfully deploying your Drupal site</span></h1>
<p><span class="koboSpan" id="kobo.884.1">So far, we have created a Drupal code base, set up a local development environment, and put our </span><a id="_idIndexMarker058"/><span class="koboSpan" id="kobo.885.1">code base into version control. </span><span class="koboSpan" id="kobo.885.2">Now, it is time to cover deploying your Drupal site to </span><span class="No-Break"><span class="koboSpan" id="kobo.886.1">a server.</span></span></p>
<p><span class="koboSpan" id="kobo.887.1">Deploying your Drupal site involves more than just copying over the code files as you may need to run schema updates and configuration imports. </span><span class="koboSpan" id="kobo.887.2">In this recipe, we will use </span><strong class="bold"><span class="koboSpan" id="kobo.888.1">rsync</span></strong><span class="koboSpan" id="kobo.889.1">, an efficient </span><a id="_idIndexMarker059"/><span class="koboSpan" id="kobo.890.1">file transfer tool, to copy our Drupal site code base to a server and use Drush to create a successful </span><span class="No-Break"><span class="koboSpan" id="kobo.891.1">Drupal deployment.</span></span></p>
<h2 id="_idParaDest-53"><a id="_idTextAnchor054"/><span class="koboSpan" id="kobo.892.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.893.1">This recipe requires access to a virtual machine over </span><strong class="bold"><span class="koboSpan" id="kobo.894.1">SSH</span></strong><span class="koboSpan" id="kobo.895.1"> that has a </span><strong class="bold"><span class="koboSpan" id="kobo.896.1">Linux, Apache, MySQL, and PHP</span></strong><span class="koboSpan" id="kobo.897.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.898.1">LAMP</span></strong><span class="koboSpan" id="kobo.899.1">) stack </span><a id="_idIndexMarker060"/><span class="koboSpan" id="kobo.900.1">installed. </span><span class="koboSpan" id="kobo.900.2">Many </span><a id="_idIndexMarker061"/><span class="koboSpan" id="kobo.901.1">cloud providers, such as </span><strong class="bold"><span class="koboSpan" id="kobo.902.1">Digital Ocean</span></strong><span class="koboSpan" id="kobo.903.1"> and AWS </span><strong class="bold"><span class="koboSpan" id="kobo.904.1">Lightsail</span></strong><span class="koboSpan" id="kobo.905.1">, have </span><a id="_idIndexMarker062"/><span class="koboSpan" id="kobo.906.1">one-click installations for LAMP stack </span><span class="No-Break"><span class="koboSpan" id="kobo.907.1">virtual machines:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.908.1">A virtual machine with 1 GB of memory and one CPU will suffice, usually the lowest virtual </span><span class="No-Break"><span class="koboSpan" id="kobo.909.1">machine tier.</span></span></li>
<li><span class="koboSpan" id="kobo.910.1">You must be able to access the virtual machine using SSH key-based authentication or </span><span class="No-Break"><span class="koboSpan" id="kobo.911.1">password authentication.</span></span></li>
<li><span class="koboSpan" id="kobo.912.1">This recipe uses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.913.1">root</span></strong><span class="koboSpan" id="kobo.914.1"> user, which is not the best security practice. </span><span class="koboSpan" id="kobo.914.2">Server security practices and management are outside the scope of </span><span class="No-Break"><span class="koboSpan" id="kobo.915.1">this book.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.916.1">This recipe uses an IP address of </span><strong class="source-inline"><span class="koboSpan" id="kobo.917.1">167.71.255.26</span></strong><span class="koboSpan" id="kobo.918.1"> for accessing the server. </span><span class="koboSpan" id="kobo.918.2">Replace </span><strong class="source-inline"><span class="koboSpan" id="kobo.919.1">167.71.255.26</span></strong><span class="koboSpan" id="kobo.920.1"> with the IP address for </span><span class="No-Break"><span class="koboSpan" id="kobo.921.1">your server.</span></span></p>
<p><span class="koboSpan" id="kobo.922.1">At the time of writing, the MySQL PHP library does not support the new </span><strong class="source-inline"><span class="koboSpan" id="kobo.923.1">caching_sha2_authentication</span></strong><span class="koboSpan" id="kobo.924.1"> authentication implemented by MySQL. </span><span class="koboSpan" id="kobo.924.2">You will need a user that has access to the database with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.925.1">mysql_native_password</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.926.1">authentication method.</span></span></p>
<p><span class="koboSpan" id="kobo.927.1">Here is a summary of the SQL commands for creating a </span><strong class="source-inline"><span class="koboSpan" id="kobo.928.1">drupaldb</span></strong><span class="koboSpan" id="kobo.929.1"> database that is accessible to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.930.1">dbuser</span></strong><span class="koboSpan" id="kobo.931.1"> user with a password </span><span class="No-Break"><span class="koboSpan" id="kobo.932.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.933.1">dbpass</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.934.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.935.1">
CREATE DATABASE drupal
CREATE USER 'dbuser'@'%' IDENTIFIED WITH
  mysql_native_password BY 'dbpass';
GRANT ALL ON drupal.* TO 'dbuser'@'%';</span></pre>
<h2 id="_idParaDest-54"><a id="_idTextAnchor055"/><span class="koboSpan" id="kobo.936.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.937.1">Open a </span><a id="_idIndexMarker063"/><span class="koboSpan" id="kobo.938.1">terminal and navigate to your Drupal </span><span class="No-Break"><span class="koboSpan" id="kobo.939.1">code base.</span></span></li>
<li><span class="koboSpan" id="kobo.940.1">Create an ignore file for </span><strong class="source-inline"><span class="koboSpan" id="kobo.941.1">rsync</span></strong><span class="koboSpan" id="kobo.942.1"> to exclude directories named </span><strong class="source-inline"><span class="koboSpan" id="kobo.943.1">.rsyncignore</span></strong><span class="koboSpan" id="kobo.944.1"> with the </span><span class="No-Break"><span class="koboSpan" id="kobo.945.1">following code:</span></span><pre class="console"><span class="koboSpan" id="kobo.946.1">
.git/</span></pre><pre class="console"><span class="koboSpan" id="kobo.947.1">
.ddev/</span></pre><pre class="console"><span class="koboSpan" id="kobo.948.1">
.vscode/</span></pre><pre class="console"><span class="koboSpan" id="kobo.949.1">
.idea/</span></pre><pre class="console"><span class="koboSpan" id="kobo.950.1">
web/sites/*/files/</span></pre><pre class="console"><span class="koboSpan" id="kobo.951.1">
web/sites/*/settings.local.php</span></pre><pre class="console"><span class="koboSpan" id="kobo.952.1">
web/sites/*/settings.ddev.php</span></pre><pre class="console"><span class="koboSpan" id="kobo.953.1">
*.sql</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.954.1">This will be used to reduce the number of files transferred to the production server, including developer tool configuration, local development files, and any </span><span class="No-Break"><span class="koboSpan" id="kobo.955.1">SQL dumps.</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.956.1">Now, we will deploy our Drupal code base to the remote server </span><span class="No-Break"><span class="koboSpan" id="kobo.957.1">using </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.958.1">rsync</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.959.1">:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.960.1">rsync -rzcEl . </span><span class="koboSpan" id="kobo.960.2">root@167.71.255.26:/var/www/html --</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.961.1">  exclude-from=".rsyncignore" --delete</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.962.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.963.1">rzCE</span></strong><span class="koboSpan" id="kobo.964.1"> flags control how files are copied to the remote server. </span><strong class="source-inline"><span class="koboSpan" id="kobo.965.1">r</span></strong><span class="koboSpan" id="kobo.966.1"> is for recursive copying, </span><strong class="source-inline"><span class="koboSpan" id="kobo.967.1">z</span></strong><span class="koboSpan" id="kobo.968.1"> compresses files during transfer, </span><strong class="source-inline"><span class="koboSpan" id="kobo.969.1">C</span></strong><span class="koboSpan" id="kobo.970.1"> uses a checksum to see if files have been modified and should be copied, </span><strong class="source-inline"><span class="koboSpan" id="kobo.971.1">E</span></strong><span class="koboSpan" id="kobo.972.1"> preserves the executability of files, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.973.1">l</span></strong><span class="koboSpan" id="kobo.974.1"> preserves links. </span><span class="koboSpan" id="kobo.974.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.975.1">E</span></strong><span class="koboSpan" id="kobo.976.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.977.1">l</span></strong><span class="koboSpan" id="kobo.978.1"> flags are important for Composer’s </span><span class="No-Break"><span class="koboSpan" id="kobo.979.1">vendor/bin executables.</span></span></p>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.980.1">.</span></strong><span class="koboSpan" id="kobo.981.1"> represents our current working directory as the source, where </span><strong class="source-inline"><span class="koboSpan" id="kobo.982.1">root@167.71.255.26:/var/www/html</span></strong><span class="koboSpan" id="kobo.983.1"> is our destination. </span><span class="koboSpan" id="kobo.983.2">Replace </span><strong class="source-inline"><span class="koboSpan" id="kobo.984.1">root@167.71.255.26</span></strong><span class="koboSpan" id="kobo.985.1"> with your virtual machine’s user and </span><span class="No-Break"><span class="koboSpan" id="kobo.986.1">IP address.</span></span></p>
<p><span class="koboSpan" id="kobo.987.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.988.1">exclude-from</span></strong><span class="koboSpan" id="kobo.989.1"> option uses our </span><strong class="source-inline"><span class="koboSpan" id="kobo.990.1">.rsyncignore</span></strong><span class="koboSpan" id="kobo.991.1"> file to skip files from being uploaded, while </span><strong class="source-inline"><span class="koboSpan" id="kobo.992.1">delete</span></strong><span class="koboSpan" id="kobo.993.1"> removes old files from the destination that are no </span><span class="No-Break"><span class="koboSpan" id="kobo.994.1">longer valid.</span></span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.995.1">We also </span><a id="_idIndexMarker064"/><span class="koboSpan" id="kobo.996.1">need to create a database SQL dump for a one-time import using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.997.1">sql:dump</span></strong><span class="koboSpan" id="kobo.998.1"> command </span><span class="No-Break"><span class="koboSpan" id="kobo.999.1">from Drush:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1000.1">php vendor/bin/drush sql:dump --result-file=../db-</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1001.1">  </span></strong><strong class="bold"><span class="koboSpan" id="kobo.1002.1">dump.sql</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1003.1">We can also </span><a id="_idIndexMarker065"/><span class="koboSpan" id="kobo.1004.1">copy it over to the server for import later on using, </span><strong class="bold"><span class="koboSpan" id="kobo.1005.1">secure file copy</span></strong><span class="koboSpan" id="kobo.1006.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.1007.1">SFC</span></strong><span class="koboSpan" id="kobo.1008.1">). </span><span class="koboSpan" id="kobo.1008.2">We will upload it to the home directory of the user, not the </span><span class="No-Break"><span class="koboSpan" id="kobo.1009.1">Drupal directory:</span></span></p>
<pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1010.1">scp db-dump.sql root@167.71.255.26:db-dump.sql</span></strong></pre>
<ol>
<li value="5"><span class="koboSpan" id="kobo.1011.1">To finish setting up, SSH into your </span><span class="No-Break"><span class="koboSpan" id="kobo.1012.1">virtual machine:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1013.1">ssh root@167.71.255.26</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.1014.1">After copying the files, we also need to make sure writeable directories are accessible to the web server, such as writing CSS and JS aggregated files and compiled </span><strong class="bold"><span class="koboSpan" id="kobo.1015.1">Twig</span></strong><span class="koboSpan" id="kobo.1016.1"> templates. </span><span class="koboSpan" id="kobo.1016.2">This is a one-time operation when setting up the Drupal site after the first </span><span class="No-Break"><span class="koboSpan" id="kobo.1017.1">file transfer:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1018.1">mkdir -p /var/www/html/web/sites/default/files/</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1019.1">chown -R www-data:www-data /var/www/html</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1020.1">  /web/sites/default/files/</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1021.1">This ensures the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1022.1">web/sites/default/files</span></strong><span class="koboSpan" id="kobo.1023.1"> directory is owned by the web server user so that it can </span><span class="No-Break"><span class="koboSpan" id="kobo.1024.1">write files.</span></span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.1025.1">Next, we need to update the document root used by Apache, which defaults to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1026.1">/var/www/html</span></strong><span class="koboSpan" id="kobo.1027.1">. </span><span class="koboSpan" id="kobo.1027.2">The new document root is </span><strong class="source-inline"><span class="koboSpan" id="kobo.1028.1">/var/www/html/web</span></strong><span class="koboSpan" id="kobo.1029.1">. </span><span class="koboSpan" id="kobo.1029.2">We will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1030.1">sed</span></strong><span class="koboSpan" id="kobo.1031.1"> command to replace the value </span><span class="No-Break"><span class="koboSpan" id="kobo.1032.1">for us:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1033.1">sed -i "s,/var/www/html,/var/www/html/web,g"</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1034.1">  /etc/apache2/sites-enabled/000-default.conf</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1035.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1036.1">sed</span></strong><span class="koboSpan" id="kobo.1037.1"> command stands for stream editor and makes finding and replacing text in files </span><span class="No-Break"><span class="koboSpan" id="kobo.1038.1">very easy.</span></span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.1039.1">We need </span><a id="_idIndexMarker066"/><span class="koboSpan" id="kobo.1040.1">to make Apache aware of our configuration changes. </span><span class="koboSpan" id="kobo.1040.2">Use the </span><span class="No-Break"><span class="koboSpan" id="kobo.1041.1">following command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1042.1">systemctl reload apache2</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1043.1">This will reload the Apache service’s configuration and make it aware of the new </span><span class="No-Break"><span class="koboSpan" id="kobo.1044.1">document root.</span></span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.1045.1">Before we set up our site, we will need to create our </span><strong class="source-inline"><span class="koboSpan" id="kobo.1046.1">settings.local.php</span></strong><span class="koboSpan" id="kobo.1047.1"> file on the server so that Drupal knows how to connect to the database. </span><span class="koboSpan" id="kobo.1047.2">We will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1048.1">nano</span></strong><span class="koboSpan" id="kobo.1049.1"> command-line editor to create and edit </span><span class="No-Break"><span class="koboSpan" id="kobo.1050.1">the file:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1051.1">nano /var/www/html/web/sites/default</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1052.1">  /settings.local.php</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.1053.1">Add the following code to your </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1054.1">settings.local.php</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1055.1"> file:</span></span><pre class="console"><span class="koboSpan" id="kobo.1056.1">
&lt;?php</span></pre><pre class="console"><span class="koboSpan" id="kobo.1057.1">
$databases['default']['default'] = [</span></pre><pre class="console"><span class="koboSpan" id="kobo.1058.1">
  'driver' =&gt; 'mysql',</span></pre><pre class="console"><span class="koboSpan" id="kobo.1059.1">
  'database' =&gt; 'drupal',</span></pre><pre class="console"><span class="koboSpan" id="kobo.1060.1">
  'username' =&gt; 'dbuser',</span></pre><pre class="console"><span class="koboSpan" id="kobo.1061.1">
  'password' =&gt; 'dbpass',</span></pre><pre class="console"><span class="koboSpan" id="kobo.1062.1">
  'host' =&gt; 'localhost',</span></pre><pre class="console"><span class="koboSpan" id="kobo.1063.1">
  'port' =&gt; 3306,</span></pre><pre class="console"><span class="koboSpan" id="kobo.1064.1">
];</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1065.1">Be sure to change the database credentials so that they match the ones created with your server. </span><span class="koboSpan" id="kobo.1065.2">Drupal will also try to create the database for you if it does </span><span class="No-Break"><span class="koboSpan" id="kobo.1066.1">not exist.</span></span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.1067.1">Save the </span><a id="_idIndexMarker067"/><span class="koboSpan" id="kobo.1068.1">file by using </span><em class="italic"><span class="koboSpan" id="kobo.1069.1">CTRL</span></em><span class="koboSpan" id="kobo.1070.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.1071.1">X</span></em><span class="koboSpan" id="kobo.1072.1">, then </span><em class="italic"><span class="koboSpan" id="kobo.1073.1">Y</span></em><span class="koboSpan" id="kobo.1074.1">, and finally </span><span class="No-Break"><span class="koboSpan" id="kobo.1075.1">clicking </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1076.1">Enter</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1077.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.1078.1">Verify the database connection settings </span><span class="No-Break"><span class="koboSpan" id="kobo.1079.1">using Drush:</span></span></p>
<pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1080.1">cd /var/www/html</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1081.1">php vendor/bin/drush status</span></strong></pre>
<p><span class="koboSpan" id="kobo.1082.1">The database credentials should match what you added </span><span class="No-Break"><span class="koboSpan" id="kobo.1083.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1084.1">settings.local.php</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1085.1">.</span></span></p>
<ol>
<li value="12"><span class="koboSpan" id="kobo.1086.1">Next, we need to populate our database. </span><span class="koboSpan" id="kobo.1086.2">We will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1087.1">sql:cli</span></strong><span class="koboSpan" id="kobo.1088.1"> command to import our initial database from the local </span><span class="No-Break"><span class="koboSpan" id="kobo.1089.1">development environment:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1090.1">php vendor/bin/drush sql:cli &lt; ~/db-dump.sql</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.1091.1">Then, we can go through the deployment steps with Drush by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1092.1">deploy</span></strong><span class="koboSpan" id="kobo.1093.1"> command to run any schema updates and </span><span class="No-Break"><span class="koboSpan" id="kobo.1094.1">configuration imports:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.1095.1">php vendor/bin/drush deploy</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.1096.1">You may now access your Drupal site and </span><span class="No-Break"><span class="koboSpan" id="kobo.1097.1">view it!</span></span></li>
</ol>
<h2 id="_idParaDest-55"><a id="_idTextAnchor056"/><span class="koboSpan" id="kobo.1098.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.1099.1">This recipe involved various components: a virtual server to host our code and serve our Drupal site, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1100.1">rsync</span></strong><span class="koboSpan" id="kobo.1101.1"> tool for transferring files, and Drush to perform the required </span><span class="No-Break"><span class="koboSpan" id="kobo.1102.1">deployment steps.</span></span></p>
<p><span class="koboSpan" id="kobo.1103.1">A benefit of using rsync over FTP or even scp, another command-line-based file transfer tool, is that rsync works incrementally. </span><span class="koboSpan" id="kobo.1103.2">If a file has not been modified, rsync will not transfer that file. </span><span class="koboSpan" id="kobo.1103.3">It will also ensure that deleted files are also deleted on the remote server, something other file transfer tools do </span><span class="No-Break"><span class="koboSpan" id="kobo.1104.1">not do.</span></span></p>
<p><span class="koboSpan" id="kobo.1105.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1106.1">deploy</span></strong><span class="koboSpan" id="kobo.1107.1"> command from Drush ensures that your Drupal site’s database and configuration </span><a id="_idIndexMarker068"/><span class="koboSpan" id="kobo.1108.1">are up to date. </span><span class="koboSpan" id="kobo.1108.2">It is a command that operates various processes in a best-practice fashion. </span><span class="koboSpan" id="kobo.1108.3">The command runs all of Drupal’s update hooks to ensure they are executed (schema updates and state changes provided by modules), and that configuration is synchronized from the exported configuration files. </span><span class="koboSpan" id="kobo.1108.4">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1109.1">deploy</span></strong><span class="koboSpan" id="kobo.1110.1"> command should always be run, just as you would run migrations for a Symfony or </span><span class="No-Break"><span class="koboSpan" id="kobo.1111.1">Laravel application.</span></span></p>
<h2 id="_idParaDest-56"><a id="_idTextAnchor057"/><span class="koboSpan" id="kobo.1112.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.1113.1">Next, we will cover more about hosting and deploying your </span><span class="No-Break"><span class="koboSpan" id="kobo.1114.1">Drupal sites.</span></span></p>
<h3><span class="koboSpan" id="kobo.1115.1">Platform-as-a-service hosting provider</span></h3>
<p><span class="koboSpan" id="kobo.1116.1">You </span><a id="_idIndexMarker069"/><span class="koboSpan" id="kobo.1117.1">can avoid this process completely by leveraging one of the PaaS hosting providers for Drupal (</span><span class="No-Break"><span class="koboSpan" id="kobo.1118.1">listed alphabetically):</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.1119.1">Acquia </span><span class="No-Break"><span class="koboSpan" id="kobo.1120.1">Cloud: </span></span><a href="https://www.acquia.com/products/drupal-cloud/cloud-platform/drupal-hosting "><span class="No-Break"><span class="koboSpan" id="kobo.1121.1">https://www.acquia.com/products/drupal-cloud/cloud-platform/drupal-hosting</span></span></a></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.1122.1">Pantheon: </span></span><a href="https://pantheon.io/product/drupal-hosting "><span class="No-Break"><span class="koboSpan" id="kobo.1123.1">https://pantheon.io/product/drupal-hosting</span></span></a></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.1124.1">Platform.sh: </span></span><a href="https://platform.sh/marketplace/drupal/ "><span class="No-Break"><span class="koboSpan" id="kobo.1125.1">https://platform.sh/marketplace/drupal/</span></span></a></li>
</ul>
<h3><span class="koboSpan" id="kobo.1126.1">Automating deployments</span></h3>
<p><span class="koboSpan" id="kobo.1127.1">Using </span><a id="_idIndexMarker070"/><span class="koboSpan" id="kobo.1128.1">continuous integration, this deployment process can be automated in GitHub Actions, GitLab CI, or other continuous integration providers with your repository on commit. </span><span class="koboSpan" id="kobo.1128.2">You will need to configure an additional set of private keys that are added to your continuous integration tool so that the service can SSH into </span><span class="No-Break"><span class="koboSpan" id="kobo.1129.1">your server.</span></span></p>
<h2 id="_idParaDest-57"><a id="_idTextAnchor058"/><span class="koboSpan" id="kobo.1130.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.1131.1">Hosting partners on </span><span class="No-Break"><span class="koboSpan" id="kobo.1132.1">Drupal.org: </span></span><a href="https://www.drupal.org/hosting "><span class="No-Break"><span class="koboSpan" id="kobo.1133.1">https://www.drupal.org/hosting</span></span></a></li>
<li><span class="koboSpan" id="kobo.1134.1">Documentation for the Drush </span><strong class="source-inline"><span class="koboSpan" id="kobo.1135.1">deploy</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1136.1">command: </span></span><a href="https://www.drush.org/latest/deploycommand/"><span class="No-Break"><span class="koboSpan" id="kobo.1137.1">https://www.drush.org/latest/deploycommand/</span></span></a></li>
</ul>
</div>
</body></html>
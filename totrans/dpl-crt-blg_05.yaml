- en: Chapter 5. Users, Roles, and Permissions
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第五章 用户、角色和权限
- en: It's time to look at an entirely different aspect of running a Drupal website.
    Up until now we have focused on adding and organizing the site's basic functionality.
    We have not yet given any thought to how this functionality is to be accessed,
    or by whom. As the site grows, you will most likely feel the need to delegate
    certain responsibilities to various people. Alternatively, you might organize
    a team of people to work on specific aspects of the site. Whatever your needs,
    at some stage you will have to make decisions about who can do what, and the good
    people at Drupal have made sure that it is possible to do precisely this.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 是时候看看运营Drupal网站的一个完全不同的方面了。到目前为止，我们一直专注于添加和组织网站的基本功能。我们还没有考虑过这些功能是如何被访问的，或者由谁访问。随着网站的发展，你很可能会觉得需要将某些责任委托给不同的人。或者，你可能组织一个团队来处理网站的特定方面。无论你的需求是什么，在某个阶段，你将不得不做出关于谁可以做什么的决定，而Drupal的好人们已经确保了这一点是可能的。
- en: In the same vein as the previous chapter, having Drupal simplify the implementation
    of your access control policies does not mean that the task is a trivial one.
    There is still much thought that needs to go on behind the scenes in order to
    create a sophisticated, and above all, effective policy for controlling access
    to the site. Because of this, we will spend a bit of time exploring the ramifications
    of the various choices available, instead of simply listing them. Taking a holistic
    approach to your access control policy will ensure you don't end up with any nasty
    surprises down the line.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 与上一章类似，Drupal简化了你的访问控制策略的实施，并不意味着这项任务微不足道。在幕后仍然需要很多思考，以便创建一个复杂且最重要的是有效的策略来控制对网站的访问。因此，我们将花一些时间探讨各种选择的后果，而不仅仅是列出它们。以整体的方法来考虑你的访问控制策略将确保你不会在将来遇到任何令人不快的惊喜。
- en: 'Since we have now been working with Drupal for a little while we will start
    spreading our wings a bit and use some slightly more advanced methods provided
    by contributed modules. Specifically, this chapter will look at the following
    topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已经在Drupal上工作了一段时间，我们将开始尝试一些由贡献模块提供的更高级的方法。具体来说，本章将探讨以下主题：
- en: Planning an access policy
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 规划访问策略
- en: Roles
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 角色
- en: Permissions—including the use of the *Taxonomy Access Control* module
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 权限——包括使用*分类访问控制*模块
- en: Users
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户
- en: Access rules
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问规则
- en: Before we continue, it is worth pointing out that at the moment you are more
    than likely using the administrative user (user number 1) for all the site's development
    needs. That is absolutely fine, but once you have finished making any major changes
    to the site, you should begin using a normal administrative user that has only
    the permissions required to complete your day-to-day tasks. The next section will
    highlight the general philosophy behind user access, which should make the reason
    for this clear.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们继续之前，值得指出的是，目前你很可能正在使用管理用户（用户编号1）来满足所有网站的开发需求。这是完全可以接受的，但一旦你对网站进行了任何重大更改，你应该开始使用只有完成日常任务所需权限的正常管理用户。下一节将强调用户访问背后的总体理念，这将使这一做法的原因变得清晰。
- en: Planning an Access Policy
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 规划访问策略
- en: When you think about how your site should work, you need to focus in on what
    will be required of yourself, other community members, or even anonymous users.
    In other words, *will there be a team of moderators working to ensure that the
    content of the site conforms to the dictates of good taste and avoids material
    that is tantamount to hate speech and so on? Will there be subject experts who
    are allowed to create and maintain their own content? How much will anonymous
    visitors be allowed to become involved, or will they be forced to merely window
    shop without being able to contribute?*
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 当你思考你的网站应该如何运作时，你需要专注于自己、其他社区成员或甚至匿名用户需要做什么。换句话说，*是否会有一个团队的中介人员来确保网站内容符合良好的品味，避免仇恨言论等材料？是否会有允许创建和维护自己内容的主题专家？匿名访客将被允许参与多少，或者他们是否只能被动浏览而无法贡献？*
- en: Some of you might feel that you want the use of the site to grow organically
    with the community, and so you want to be extremely flexible in your approach.
    However, you can take it as given that your site and access policies are already
    flexible, given how easy it is to make changes in Drupal. This means that no one
    is exempt from building a proper access control plan to begin with. If you need
    to change it as time goes by, so be it, but at least there will be a coherent
    set of roles from the start.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 一些用户可能觉得希望网站的使用能够随着社区的自然增长而发展，因此希望自己的方法非常灵活。然而，鉴于在Drupal中更改设置非常容易，你可以认为你的网站和访问政策已经足够灵活。这意味着没有人可以免除制定一个适当的访问控制计划。如果你随着时间的推移需要更改它，那就这么做吧，但至少从开始就会有一套连贯的角色。
- en: 'So where do we begin? The first and foremost rule of security that can be applied
    directly to our situation is to:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，我们从哪里开始呢？可以直接应用于我们情况的第一个也是最重要的安全规则是：
- en: Note
  id: totrans-14
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Grant a user permissions sufficient for completing the intended task, and no
    more!
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 授予用户完成预期任务所需的权限，不要更多！
- en: Our entire approach is going to be governed by this rule. With a bit of thought
    you should be able to see why this is so important. Obviously, the last thing
    anyone wants is for an anonymous user to be able to modify the personal blog of
    a respected industry expert. This means that each type of user should have carefully
    controlled permissions that effectively block their ability to act outside the
    scope of their role.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的所有方法都将受此规则支配。稍加思考，你应该能够理解为什么这一点如此重要。显然，任何人都不会希望匿名用户能够修改一位受人尊敬的行业专家的个人博客。这意味着每种类型的用户都应该拥有经过仔细控制的权限，以有效地阻止他们超出其角色范围的行为。
- en: 'One upshot of this is that you will find it better to create a larger number
    of specific roles rather than create a generic role or two, and allow everyone
    to use those catch-all permissions. Drupal gives us fine-grained control over
    what users can accomplish, and you should make good use of this facility. It may
    help to think of your access control using the following figure (this does not
    necessarily represent the actual roles on your site—it''s just an example):'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 这样做的结果是，你会发现创建更多具体的角色比创建一个或两个通用角色，然后让每个人都使用这些万能权限要好。Drupal让我们能够精细控制用户可以完成的事情，你应该充分利用这一功能。思考以下图示（这并不一定代表你网站上实际的角色——它只是一个例子）可能会有所帮助：
- en: '![Planning an Access Policy](img/1800_05_01.jpg)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![规划访问策略](img/1800_05_01.jpg)'
- en: The shaded region represents the total number of permissions available for the
    site. Contained within this set are the various roles that exist either by default,
    like the **Anonymous users** role, or those you create in order to cater for the
    different types of users the site will require—in this case, the **Blog Writer
    users** and **Forum Moderator users** roles. Each role can then contain any number
    of users.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 阴影区域代表网站可用的总权限数量。这个集合中包含了默认存在的各种角色，比如**匿名用户**角色，或者你创建的以适应网站所需的不同类型用户的角色——在这个例子中，是**博客作者用户**和**论坛管理员用户**角色。每个角色可以包含任意数量的用户。
- en: From the previous diagram you can see that the **Anonymous users** have the
    smallest set of permissions because they have the smallest area of the total diagram.
    This set of permissions is totally encapsulated by the **Forum Moderator users**
    and **Blog Writer users**—meaning that forum moderators and blog writers can do
    everything an anonymous user does, and a whole lot more.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 从之前的图中可以看出，**匿名用户**拥有最小的权限集合，因为他们拥有整个图中最小的区域。这个权限集合完全被**论坛管理员用户**和**博客作者用户**所包含——这意味着论坛管理员和博客作者可以做任何匿名用户能做的事情，还能做更多。
- en: Of course, the blog writers have a slightly different remit. While they share
    some common permissions with the forum administrators, they also have a few of
    their own. Your permissions as the primary or administrative user encompass the
    entire set, because there should be nothing that you cannot control.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，博客作者有一项不同的职责。虽然他们与论坛管理员共享一些共同权限，但他们也有一些自己的权限。作为主要或管理用户，你的权限涵盖了整个集合，因为你不应该有任何无法控制的事情。
- en: 'It is up to you to decide on which roles are best for the site, but before
    you attempt this it is important to ask: *What are roles and how are they used
    in the first place?* To answer this, let''s take a look at the practical side
    of things in more detail.'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 由您决定哪些角色最适合网站，但在尝试之前，重要的是要问自己：**什么是角色？它们最初是如何被使用的？**为了回答这个问题，让我们更详细地看看实际操作的方面。
- en: Roles
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 角色
- en: It may seem a bit odd that we are not beginning our practical look at access
    control with a discussion on users. After all, it is all about what users *can*
    and *cannot* do! The problem with immediately talking about users is that the
    focus of a single user is too narrow, and we can learn far more about controlling
    access by taking a more broad view using roles. Once we have learned everything
    there is to know about roles, actually working with users becomes a trivial matter.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我们没有从用户讨论开始我们的实际访问控制探讨，这看起来可能有些奇怪。毕竟，这全部关乎用户可以做什么和不能做什么！立即讨论用户的问题在于，单个用户的焦点过于狭窄，通过更广泛地使用角色来控制访问，我们可以学到更多。一旦我们了解了关于角色的一切，实际处理用户就变得微不足道了。
- en: 'A user role, in Drupal, is akin to a character in a play. In a play, an actor
    must always be true to their character—in other words, there is a defined way
    to behave and the character never deviates (no matter which actor portrays the
    character), otherwise the illusion is broken. In the same way, Drupal allows defined
    roles that determine the behavior of a user. Creating a role in Drupal is very
    easy! Simply click the **access control** link under **administer** and select
    the **roles** tab to bring up the following simple interface:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在Drupal中，用户角色类似于戏剧中的角色。在戏剧中，演员必须始终忠于自己的角色——换句话说，有明确的行为方式，角色永远不会偏离（无论哪个演员扮演该角色），否则就会打破幻觉。同样，Drupal允许定义角色，这些角色决定了用户的行为。在Drupal中创建角色非常简单！只需点击**管理**下的**访问控制**链接，然后选择**角色**标签，即可打开以下简单的界面：
- en: '![Roles](img/1800_05_02.jpg)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![角色](img/1800_05_02.jpg)'
- en: As you can see, we have two roles already defined by default—the **anonymous
    user** and the **authenticated user**. It is not possible to change these, and
    so the **Operations** column is permanently set to **locked**. To begin with,
    the anonymous user (this is any user who is browsing the site without logging
    in) has very few permissions set, and you would more than likely want to keep
    it this way despite the fact that it is possible to give them any and all permissions.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，我们默认已经定义了两个角色——**匿名用户**和**认证用户**。这些角色无法更改，因此**操作**列永久设置为**锁定**。一开始，匿名用户（这是指那些未登录就浏览网站的用户）的权限设置非常少，尽管可以赋予他们任何权限，但您很可能希望保持这种状态。
- en: Similarly, the authenticated user, by default, has only a few more permissions
    than the anonymous user, and it is also sensible to keep these to a minimum. We
    will see in a little while how to go about deciding who should have which permissions.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，默认情况下，认证用户比匿名用户只有少数更多的权限，也有道理将这些权限保持在最低限度。我们很快就会看到如何决定谁应该拥有哪些权限。
- en: In order to add a new role, simply type in a name for the role and click **Add
    role**, and you're done! *But what name do you want to add?* That's the question!
    If you are unsure about what name to use, then it is most likely you haven't clearly
    defined what purpose you want that role to serve. To see how this is done, let's
    assume that the *Contechst Wildlife Community* requires a forum moderator who
    will be a normal user in every way except for the ability to work directly on
    **Conservation** forums (to take some of the burden of responsibility off the
    administrator's hands) to create new topics and to edit the content if necessary.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 要添加新角色，只需输入角色的名称，然后点击**添加角色**，任务就完成了！**但您想添加什么名称呢？**这是一个问题！如果您不确定使用什么名称，那么很可能您还没有清楚地定义该角色想要服务的目的。为了了解如何做到这一点，让我们假设*Contechst
    Wildlife Community*需要一个论坛管理员，这个管理员在所有方面都将是普通用户，除了能够直接在**保护**论坛上工作（从管理员手中分担一些责任）以创建新主题和必要时编辑内容。
- en: So, to get the ball rolling, we type in **Forum Moderator user** and click **Add
    role**—actually, you might even want to be more specific and use something like
    **Conservation Forum Moderator user** in this case, but you get the general idea.
    That's it! We have added the role successfully. Now, when you are presented with
    the **roles** page you should be able to view the new role, with the option to
    edit it shown on the right-hand side of the page. You can click **edit** in order
    to change the name of the role or delete it completely.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，为了开始操作，我们输入**论坛管理员用户**并点击**添加角色**——实际上，你可能甚至想要更具体一些，在这个例子中使用**保存论坛管理员用户**，但基本概念是一样的。就这样！我们已经成功添加了角色。现在，当你看到**角色**页面时，你应该能够查看新角色，页面的右侧显示了编辑选项。你可以点击**编辑**来更改角色的名称或完全删除它。
- en: Our work is just beginning, because now we need to grant or deny the various
    permissions that the **Forum Moderator user** role will need in order to successfully
    fulfill its purpose. New roles are not given any permissions at all to begin with—this
    makes sense if you think about it, because the last thing we want is to create
    a role only to find that it has the same permissions as the administrative user.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的工作才刚刚开始，因为现在我们需要授予或拒绝**论坛管理员用户**角色所需的各项权限，以便成功履行其职责。一开始，新角色根本没有任何权限——如果你这么想的话，这是有道理的，因为我们最不希望的是创建一个角色，结果发现它和行政用户的权限相同。
- en: The chances are you will need to add several roles depending on the needs of
    the site. For the moment, let's move on and take a look at how we flesh out this
    new role by setting permissions.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 根据网站的需求，你可能需要添加几个角色。现在，让我们继续前进，看看我们如何通过设置权限来具体化这个新角色。
- en: Permissions
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 权限
- en: 'In order to work with permissions, click the **permissions** tab on the **access
    control** page and you should be presented with a screen much like this (notice
    the new **Forum Moderator user** role on the right-hand side of the page):'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 为了处理权限，点击**访问控制**页面上的**权限**选项卡，你应该会看到一个类似于这样的屏幕（注意页面右侧的新**论坛管理员用户**角色）：
- en: '![Permissions](img/1800_05_03.jpg)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![权限](img/1800_05_03.jpg)'
- en: As you can see, this page lists all of the available permissions down the left-hand
    column and allows you to enable or disable that permission by checking or un-checking
    boxes in the relevant column. It is easy enough to see that one simply goes down
    the list selecting those permissions required to be given for each role. What
    is not so easy is actually determining what should and shouldn't be enabled in
    the first place.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，这个页面列出了所有可用的权限在左侧列，并允许你通过在相关列中勾选或取消勾选复选框来启用或禁用该权限。很容易看出，一个人只需沿着列表选择每个角色所需的权限即可。实际上并不容易确定最初应该启用或禁用哪些权限。
- en: 'Notice too that the permissions given in the list on the left-hand side pertain
    to specific modules. This means that if we change the site''s setup by adding
    or removing modules, then we will also have to change the permissions on this
    page. What this means is that:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，左侧列表中给出的权限与特定模块相关。这意味着，如果我们通过添加或删除模块来更改网站的设置，那么我们也必须更改此页面上的权限。这意味着：
- en: Note
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Most times a module is added, you will need to ensure that the permissions are
    set as you require them for that module, because by default no permissions are
    granted.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数时候，当你添加一个模块时，你需要确保权限设置符合该模块的需求，因为默认情况下不会授予任何权限。
- en: '*What else can we learn from the permissions page shown in the previous screenshot?
    Well, what does each permission precisely mean?* There are quite a few verbs that
    allow for completely different actions. The following lists the more common, generic
    ones although you might find one or two others crop up every now and then to cater
    for a specific module:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '*我们从上一张截图所示的权限页面还能学到什么？嗯，每个权限究竟意味着什么？* 有很多动词允许执行完全不同的操作。以下列出了一些更常见、更通用的动词，尽管你可能会偶尔发现一两个其他动词来适应特定的模块：'
- en: '**administer:** gives the user the ability to affect the function of a module.
    For example, granting administer rights to the locale module means that the user
    can add or remove languages, manage strings, and even export `.po` files. This
    permission should only ever be given to trusted users, and never to anonymous
    users.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**管理**：赋予用户影响模块功能的能力。例如，授予本地模块的管理权限意味着用户可以添加或删除语言，管理字符串，甚至导出`.po`文件。这个权限应该只授予可信赖的用户，绝不应该授予匿名用户。'
- en: '**access:** gives the user the ability to make use of a module without being
    able to affect it in any way. For example, granting access rights to the comment
    module allows a user to view comments without being able to delete, edit, or reply
    to them.'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**访问**：赋予用户使用一个模块的能力，而不会以任何方式影响它。例如，授予评论模块的访问权限允许用户查看评论，而无法删除、编辑或回复它们。'
- en: '**create:** gives the user the ability to create content of some sort. For
    example granting rights to create stories allows users to do so, but does not
    also give them the ability to edit those stories.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**创建**：赋予用户创建某种内容的能力。例如，授予创建故事的权限允许用户这样做，但并不也赋予他们编辑这些故事的能力。'
- en: '**edit own:** gives the user the ability to work with the content *they have
    created*. For example, granting **edit own** rights to the *story* module means
    that the user can modify their own stories at will.'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**编辑自己的内容**：赋予用户使用他们自己创建的内容的能力。例如，授予**编辑自己的内容**权限给**故事**模块意味着用户可以随意修改自己的故事。'
- en: There are also other module-specific permissions available, and it is recommended
    that you play around and understand any new permission(s) you set—most are pretty
    self explanatory.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 还有其他特定模块的权限可用，建议你尝试并理解你设置的任何新权限（大多数都很直观）。
- en: Now, as the permissions given to the default roles are pretty sparse, you will
    probably want to take a look at what those users can do at the same time as you
    work on any new roles. More than likely, you will want to allow anonymous users
    to access much of the site's content, without allowing them to modify it in any
    way. I'll leave those choices up to you. But how do we go about setting up the
    required permissions for the **Forum Moderator user?**
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，由于默认角色赋予的权限相当稀疏，你可能会想在你工作于任何新角色时同时查看那些用户能做什么。很可能，你希望允许匿名用户访问网站的大部分内容，但不允许他们以任何方式修改它。我将这些选择留给你。但我们是怎样设置**论坛管理员用户**所需的权限呢？
- en: 'If we look down the list of permissions shown on the **Permission** page, we
    see the following forum-related options (at the moment, the **Forum Moderator
    user** permissions are those in the outermost column):'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们查看**权限**页面上显示的权限列表，我们会看到以下与论坛相关的选项（目前，**论坛管理员用户**的权限在最外一列）：
- en: '![Permissions](img/1800_05_04.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![权限](img/1800_05_04.jpg)'
- en: Enabling these three options and then testing out what new powers are made available
    should quickly demonstrate that this is not quite what we want.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 启用这三个选项并测试一下新获得的能力应该会很快证明这并不是我们想要的。
- en: If you are wondering how to actually test this out, you will need to register
    a new user and assign them to the **Forum Moderator user** role. The following
    section on *Users* explains how to create new users and administer them properly,
    so if you are unsure as to how to do this, jump ahead quickly and check that out
    so that you have a new user to work with.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在想如何实际测试这一点，你需要注册一个新用户并将他们分配到**论坛管理员用户**角色。以下关于**用户**的部分解释了如何创建新用户并正确管理他们，所以如果你不确定如何操作，快速跳到前面查看，以便你有一个可以工作的新用户。
- en: 'The following point might make your life a bit easier:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 以下这一点可能会让你的生活变得容易一些：
- en: Tip
  id: totrans-52
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: Use two browsers to test out your site! The demo site's development machine
    has IE and Firefox. Keep one browser for the administrator and the other for anonymous
    or other users in order to test out changes. This will save you from having to
    log in and out whenever testing new permissions.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 使用两个浏览器来测试你的网站！演示站点的开发机器有IE和Firefox。保留一个浏览器供管理员使用，另一个用于匿名用户或其他用户以测试更改。这将帮助你避免在测试新权限时需要频繁登录和登出。
- en: Assuming you are happy to test out the new permissions one way or another, you
    will find that the forum moderator can access and work with *all of the forums*,
    and we want to confine this particular user to only the **Conservation-related**
    topics. We need something more specific—perhaps *in one of the other modules?*
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你愿意以某种方式测试新的权限，你会发现论坛管理员可以访问并处理**所有论坛**，而我们希望将这个特定的用户限制在**与保护相关的**主题中。我们需要更具体的东西——也许是在**其他模块之一**？
- en: Looking over the remaining permissions we can see that there is an **administer
    nodes** option— let's try that. Disable the **administer forums** option and enable
    the **administer nodes** option for the anonymous user before saving and logging
    out. You should now find that the **Forum Administrator user** can edit *any posts*
    to the forum quite easily by selecting the **content** link in the main menu.
    *So, what's the problem?* Well, for a start this user can now also configure all
    the different types of content on the site, as well as edit any type of content
    including other people's blogs. This situation is worse than the first one!
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 查看剩余的权限，我们可以看到有一个 **管理节点** 选项——让我们试试。在保存并登出之前，禁用 **管理论坛** 选项并启用 **管理节点** 选项供匿名用户使用。你现在应该会发现
    **论坛管理员用户** 可以轻松地通过在主菜单中选择 **内容** 链接来编辑论坛上的 *任何帖子*。*那么问题是什么？* 好吧，首先，这个用户现在也可以配置网站上所有不同类型的内容，以及编辑任何类型的内容，包括其他人的博客。这种情况比第一个问题还要糟糕！
- en: Oh dear, despite the fact that we have quite a bit of control over who does
    what at the moment, there is already an indication that there are some things
    that are not easily done without help from elsewhere. In order to complete this
    task we will need to make use of the *Taxonomy Access Control* module that we
    downloaded and installed in the previous chapter, because the solution to the
    current problem lies in forcing Drupal to define users who can access and manipulate
    content based on its category.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 哎呀，尽管我们现在对谁做什么有相当大的控制权，但已经有迹象表明，有些事情没有其他地方的协助是难以完成的。为了完成这个任务，我们需要利用我们在上一章下载并安装的
    *分类访问控制* 模块，因为当前问题的解决方案在于迫使 Drupal 定义可以基于其类别访问和操作内容的用户。
- en: Setting Permissions with Taxonomy Access Control
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用分类访问控制设置权限
- en: 'Assuming you have this module enabled, head on over to the **access control**
    section under the **administer** link (you will need to be logged in as the administrator
    again). You should notice that there is a new tab on this page entitled **category
    permissions**. This page should contain a list of the available roles and the
    ability to edit their category permissions. Straight off the bat, however, it
    probably won''t work because you need to enable the module first. If this is the
    case, the following link should be shown:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你已经启用了这个模块，前往 **管理** 链接下的 **访问控制** 部分（你需要再次以管理员身份登录）。你应该会注意到这个页面上有一个新的标签页，标题为
    **分类权限**。这个页面应该包含一个可用角色的列表以及编辑它们分类权限的能力。然而，一开始可能不会工作，因为你需要首先启用该模块。如果是这种情况，以下链接应该会显示：
- en: '![Setting Permissions with Taxonomy Access Control](img/1800_05_05.jpg)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![使用分类访问控制设置权限](img/1800_05_05.jpg)'
- en: 'They''re the boss! Head on over to the **taxonomy_access** page under **settings**
    and enable the module. Now when you view the **category permissions** page in
    **access control**, you will see a list of the available roles, ready for you
    to work with. Click the **Forum Moderator user** in this list to see the permissions
    for any and all types of categorized content (incidentally, don''t worry if you
    are unsure about content taxonomy and categories as yet—all this will be discussed
    in the following few chapters), like this:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 他们是老板！前往 **设置** 下的 **taxonomy_access** 页面并启用该模块。现在当你查看 **访问控制** 下的 **分类权限**
    页面时，你会看到一个可供你工作的角色列表。点击列表中的 **论坛版主用户** 来查看任何和所有类型分类内容的权限（顺便说一句，如果你对内容分类和类别还不确定，不要担心——所有这些内容将在接下来的几章中讨论），如下所示：
- en: '![Setting Permissions with Taxonomy Access Control](img/1800_05_06.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![使用分类访问控制设置权限](img/1800_05_06.jpg)'
- en: There is a lot to think about here! Now there is a taxonomy access help page
    at **taxonomy_access** under **help** in the **administer** section, which you
    should read along with this. Let's take a quick look at all of these options in
    action as well.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有很多东西要考虑！现在在 **管理** 下的 **帮助** 中有一个分类访问帮助页面在 **taxonomy_access** 下，你应该与这个页面一起阅读。让我们快速查看所有这些选项的实际操作。
- en: The first three column-options available are **View, Update**, and **Delete**.
    These are fairly self explanatory and allow the user to view, work with, or remove
    content respectively. The next option, **Create**, allows users to fix the specified
    term to a post. **List** causes the specified term to be displayed on a posting's
    page, in a category list or even in the breadcrumb navigation. Ensure that you
    have **List** enabled if you want that term to actually appear in, on, or around
    your pages—leaving it disabled could have some unexpected results.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 可用的前三个列选项是**查看、更新**和**删除**。这些选项相当直观，允许用户分别查看、处理或删除内容。下一个选项**创建**允许用户将指定的术语固定到帖子中。**列表**会导致指定的术语在帖子的页面、类别列表中甚至面包屑导航中显示。如果您希望该术语实际上出现在您的页面、页面上或其周围，请确保已启用**列表**——如果禁用，可能会产生一些意外的结果。
- en: 'The first three options have three settings to choose from:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 前三个选项有三个设置可供选择：
- en: '**Allow** (A): Grants the user the associated permission for any given category'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**允许**（A）：为任何给定类别授予用户相关权限'
- en: '**Ignore** (I): Effectively denies the user the associated permission but can
    be overridden by using other **Allow** commands'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**忽略**（I）：实际上拒绝用户的相关权限，但可以使用其他**允许**命令来覆盖'
- en: '**Deny** (D): Denies the user the associated permission for any given category'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**拒绝**（D）：拒绝用户对任何给定类别的相关权限'
- en: 'The second bullet in this list brings us to an important point concerning precedence:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 列表中的第二个要点引出了一个关于优先级的重要问题：
- en: Note
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The **Deny** directive takes precedence over **Allow!**
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '**拒绝**指令优先于**允许**！'
- en: '*Why is this important?* Think about what would happen if at some stage a posting
    is linked to several categories (this scenario is possible, and we will come across
    it later in the book). If permissions are set up such that a user has the **Allow**
    directive set for a term in one *vocabulary* (vocabulary, and other taxonomy-related
    terms are all discussed in detail in [Chapter 7](ch07.html "Chapter 7. Advanced
    Content") on *Advanced Content)*, but **Deny** set for that term in the other,
    then the **Deny** directive takes precedence. This is why **Ignore** is so important
    because it allows you to effectively deny a permission for a term in one category
    without affecting others.'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '*为什么这很重要？* 想想如果在某个阶段，一个帖子被链接到几个类别（这种情况是可能的，我们将在本书后面的章节中遇到这种情况）。如果权限设置得如此，即用户在一个*词汇表*中的术语上设置了**允许**指令（词汇表和其他与分类法相关的术语都在[第7章](ch07.html
    "第7章。高级内容")的*高级内容*中详细讨论），但在另一个中设置了**拒绝**，那么**拒绝**指令将具有优先权。这就是为什么**忽略**如此重要的原因，因为它允许您有效地在一个类别中拒绝一个术语的权限，而不会影响其他类别。'
- en: Note
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Use **Deny** only if you are sure that a given role will *never* need access
    to that term.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 只有在您确定某个角色将**永远**不需要访问该术语时，才使用**拒绝**。
- en: The drop-down lists shown at the top of each vocabulary allow you to make generalized
    statements that influence the entire column. For example, you might want to allow
    a user to view all the terms in a vocabulary rather than have to change each and
    every setting manually. If this is the case, simply select **Allow all** from
    the drop-down list and away you go. Below the drop-down list is the **Default**
    option, which causes any new terms in that column to be automatically endowed
    with the permission you set here—if you are not sure what you want here, stick
    to **Ignore.**
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 每个词汇表顶部显示的下拉列表允许您做出影响整个列的通用声明。例如，您可能希望允许用户查看词汇表中的所有术语，而不是必须手动更改每个设置。如果是这种情况，只需从下拉列表中选择**允许所有**即可继续操作。下拉列表下方是**默认**选项，它会导致该列中任何新的术语自动获得在此处设置的权限——如果您不确定在这里想要什么，请坚持使用**忽略**。
- en: 'Now, if you attempted to access the forums using your **Forum Moderator** user
    with the default permissions set, you will more than likely be disappointed:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如果您尝试使用默认权限设置的**论坛管理员**用户访问论坛，您很可能会感到失望：
- en: '![Setting Permissions with Taxonomy Access Control](img/1800_05_07.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![使用分类法访问控制设置权限](img/1800_05_07.jpg)'
- en: 'This is really to be expected (despite the fact that we know that the forums
    do exist) because by default the forum moderator has only **Ignore** directives
    set. Set your page to look like the following, and ensure that your **Forum Moderator**
    user has permission to **create forum topics** and **edit own forum topics** (set
    on the **permissions** tab of the **access control** page):'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这实际上是可以预料的（尽管我们知道论坛确实存在），因为默认情况下论坛管理员只有**忽略**指令设置。将您的页面设置为以下样式，并确保您的**论坛管理员**用户有权**创建论坛主题**和**编辑自己的论坛主题**（在**访问控制**页面的**权限**选项卡上设置）：
- en: '![Setting Permissions with Taxonomy Access Control](img/1800_05_08.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![使用分类访问控制设置权限](img/1800_05_08.jpg)'
- en: Clicking **Save category permissions** captures these settings, and you can
    now try out the new permissions. Specifically, we need to check whether this user
    can perform the expected operations. *What are the expected operations?* Given
    the settings, we want the user to be able to access only the **Commercial Fishing**
    forum within the **Conservation** container. The user should be able to post to
    this forum as well as edit any posts within this forum (even if they are not the
    user's own posts).
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**保存分类权限**将捕获这些设置，现在您可以尝试使用新的权限。具体来说，我们需要检查此用户是否可以执行预期的操作。*预期的操作是什么？*根据设置，我们希望用户只能访问**商业捕鱼**论坛，该论坛位于**保护**容器内。用户应该能够在此论坛上发帖，以及编辑此论坛内的任何帖子（即使不是用户自己的帖子）。
- en: 'Looking at the **Forums** page from the perspective of the forum moderator,
    we get the following:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 从论坛管理员的视角来看**论坛**页面，我们得到以下结果：
- en: '![Setting Permissions with Taxonomy Access Control](img/1800_05_09.jpg)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![使用分类访问控制设置权限](img/1800_05_09.jpg)'
- en: 'This is perfect! The user can only access the one forum as expected, but the
    real test lies in whether we can edit someone else''s posts. In this case, I used
    my administrator user to post a note to this forum, and accessing it via the **Forum
    Administrator user** brings up the following page:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 这太完美了！用户只能按预期访问一个论坛，但真正的测试在于我们是否可以编辑他人的帖子。在这种情况下，我使用我的管理员用户在此论坛上发布了一条笔记，通过**论坛管理员用户**访问它时，会出现以下页面：
- en: '![Setting Permissions with Taxonomy Access Control](img/1800_05_10.jpg)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![使用分类访问控制设置权限](img/1800_05_10.jpg)'
- en: From this you can see that the **List** directive that was enabled is working
    correctly because the taxonomy term **Commercial Fishing** is displayed. Obviously,
    the **View** and **Update** directives are working fine because we can see the
    post and can edit it. If you would like to confirm that the **Delete** directive
    is working, simply click on **edit** and check that the option to **Delete** the
    post is available at the bottom of the page.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里您可以看到，已启用的**列表**指令正在正常工作，因为显示出了分类术语**商业捕鱼**。显然，**查看**和**更新**指令工作得很好，因为我们可以看到帖子并且可以编辑它。如果您想确认**删除**指令是否工作，只需点击**编辑**并检查页面底部是否有**删除**帖子的选项。
- en: This is great news! Having tested the simplest case of granting permissions
    on a single forum, you now have to go back and set all the permission that will
    be needed. In doing so, it is likely that you will come across a few other interesting
    points. I will cover a couple of them here in detail—ultimately, you need to practice
    working with taxonomies and permissions to be able to achieve exactly what you
    want. I suggest waiting until we have covered taxonomies in more detail before
    diving in, though.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个好消息！在测试了在单个论坛上授予权限的最简单情况后，您现在需要返回并设置所有需要的权限。在这个过程中，您可能会遇到一些其他有趣的问题。我将在下面详细说明其中的一些——最终，您需要练习使用分类和权限，以便能够实现您想要的确切效果。尽管如此，我建议在更详细地介绍分类之前再进行操作。
- en: 'Go back to the **category permissions** page for the **Forum Moderator** user,
    disable all of the **Create** directives, and save your settings. Now try post
    a new forum topic using the **Forum administrator** user. You should be presented
    with a page like this:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 返回**论坛管理员**用户的**分类权限**页面，禁用所有**创建**指令，并保存您的设置。现在尝试使用**论坛管理员**用户发布一个新的论坛主题。您应该会看到一个像这样的页面：
- en: '![Setting Permissions with Taxonomy Access Control](img/1800_05_11.jpg)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![使用分类访问控制设置权限](img/1800_05_11.jpg)'
- en: '*What''s the problem?* **Submit** this message and then go back to the forums
    to view it. *Do you see the issue?* We have disabled **Create**, so we are not
    given the option of specifying which term this post should be associated with.
    So, because we can only view the **Conservation** container and the **Commercial
    Fishing** forum, the new content is not available to us.*"But we would ultimately
    allow the forum moderator to "View" all of the forum topics anyway"*, you might
    counter. This is true, and doing so would certainly make the post accessible,
    but it wouldn''t help the forum moderator to actually post to the forum he or
    she is in charge of.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '*问题是什么？* **提交**这条消息，然后回到论坛查看。*你看到问题了吗？* 我们已经禁用了**创建**，因此我们没有指定这条帖子应关联哪个术语的选项。因此，因为我们只能查看**保护**容器和**商业捕鱼**论坛，所以新的内容对我们不可用。*“但我们会最终允许论坛管理员“查看”所有论坛主题”，你可能会反驳。这是真的，这样做确实会使帖子可访问，但这不会帮助论坛管理员实际上发布到他或她负责的论坛中。'
- en: 'This has hopefully demonstrated that choosing your settings is quite a subtle
    task. Re-enabling the **Create** directive and attempting the post again brings
    up the following extra option, which then does the trick:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 这可能已经展示了选择你的设置是一项相当微妙的工作。重新启用**创建**指令并再次尝试发帖会带来以下额外选项，然后就能解决问题：
- en: '![Setting Permissions with Taxonomy Access Control](img/1800_05_12.jpg)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![使用分类访问控制设置权限](img/1800_05_12.jpg)'
- en: Now when this content is submitted, it is correctly displayed in the **Commercial
    Fishing** forum. We will leave taxonomy permissions there because we have yet
    to discuss taxonomy in any detail, and you will be able to practice more effectively
    once we have discussed the ins and outs of taxonomies. Some of you may be wondering,
    for example, how to post this note to *all* the forums within the forum administrator's
    remit instead of *one at a time—tasks* like this will be dealt with in [Chapter
    7](ch07.html "Chapter 7. Advanced Content").
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 现在这个内容提交后，它会在**商业捕鱼**论坛中正确显示。我们将保留分类权限在那里，因为我们还没有详细讨论分类，一旦我们讨论了分类的来龙去脉，你将能够更有效地练习。例如，有些人可能会想知道如何将这条笔记发布到论坛管理员职责范围内的**所有**论坛，而不是一次只发布一个——像这样的任务将在[第7章](ch07.html
    "第7章。高级内容")中处理。
- en: 'Once you are happy that you can control the **Forum Moderator user**, let''s
    try something slightly different. Click the **permissions** tab of the **access
    control** page under **administer** and ensure that your **anonymous user** has
    all the available **forum module** permissions selected. Save these changes and
    log out of Drupal. Now, you have already seen what these permissions do; the anonymous
    user, most likely, will be able to administer all the forums. Sure enough, the
    main menu shows us the link to go to the forums as well as a link to administer
    forums. Click on the bottom link, which leads to the administration page for the
    forums. You should notice something fairly odd, like this:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你确定可以控制**论坛管理员用户**，让我们尝试一些稍微不同的事情。点击**管理**下的**访问控制**页面中的**权限**标签页，并确保你的**匿名用户**已经选择了所有可用的**论坛模块**权限。保存这些更改并从Drupal注销。现在，你已经看到了这些权限的作用；匿名用户很可能会能够管理所有论坛。确实如此，主菜单显示了前往论坛以及管理论坛的链接。点击底部的链接，它会带你到论坛的管理页面。你应该会注意到一些相当奇怪的事情，就像这样：
- en: '![Setting Permissions with Taxonomy Access Control](img/1800_05_13.jpg)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![使用分类访问控制设置权限](img/1800_05_13.jpg)'
- en: Hmm, that's strange because we know there are forums there. Let's try the other
    **forum** link in the main menu. This time, following that link simply brings
    up a blank page. That's very odd, we have full administrative permissions on the
    forums, yet Drupal is acting like they don't exist. *Can you figure out why?*
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 嗯，这很奇怪，因为我们知道那里有论坛。让我们尝试主菜单中的另一个**论坛**链接。这次，跟随那个链接仅仅会弹出一个空白页面。这非常奇怪，我们在论坛上拥有完整的管理权限，但Drupal表现得好像它们不存在一样。*你能想出为什么吗？*
- en: As the administrator, remove the **forum module** permissions for the **anonymous
    user** in the **access control** section and save the settings. Now, click on
    the **category permissions** tab and then select the **edit** link for the **anonymous
    user**. You will be presented with the same untouched settings page that we initially
    saw for the **Forum Moderator user**. The answer should now be apparent. As the
    anonymous user has no permissions set here, we were effectively giving Drupal
    conflicting instructions by saying that this user is a forum administrator who
    is not allowed to access anything related to the taxonomy terms within the forums.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 作为管理员，在**访问控制**部分移除**匿名用户**的**论坛模块**权限并保存设置。现在，点击**分类权限**标签页，然后选择**匿名用户**的**编辑**链接。您将看到与最初为**论坛管理员用户**看到的相同的未更改的设置页面。现在答案应该很明显。由于匿名用户在这里没有设置任何权限，我们实际上通过说这个用户是论坛管理员，但不允许访问论坛中与分类术语相关的任何内容，向Drupal提供了相互冲突的指令。
- en: In our case, we would like anonymous users to be able to view all the content
    in the forums (although, if there were any topics you wanted to hide you could
    simply leave them unchecked) so we choose **Select all** from the **List** drop-down
    and **Allow all** in the **View** column drop-down and save the settings. Take
    a look at the results as the anonymous user. You should find that it is possible
    to view all the forums as expected, but you are required to login in order to
    post anything.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的情况下，我们希望匿名用户能够查看论坛中的所有内容（尽管，如果您想隐藏任何主题，只需简单地取消选中即可），所以我们从**列表**下拉菜单中选择**全选**，并在**查看**列下拉菜单中选择**允许所有**并保存设置。以匿名用户身份查看结果。您应该会发现可以像预期的那样查看所有论坛，但您需要登录才能发布任何内容。
- en: 'This has exemplified the need to thoroughly test your site regularly so that
    unforeseen changes don''t have disastrous effects. You may have asked yourself
    at some stage during the discussion on permissions: *Can one user belong to several
    roles?* The follow-up question to this is of course *What permissions does a user
    who belongs to more than one role receive?* In order to answer these very important
    questions, let us take a look at the next topic in our discussion.'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 这说明了定期彻底测试您网站的需要，以便未预见的变化不会产生灾难性的影响。在讨论权限的某个阶段，您可能已经问过自己：*一个用户可以属于多个角色吗？* 当然，这个问题紧随其后的就是*属于多个角色的用户会收到哪些权限？*
    为了回答这些非常重要的问题，让我们来看看我们讨论的下一个主题。
- en: Users
  id: totrans-98
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用户
- en: A single user account can be given as many or as few permissions as you like
    via the use of roles. Drupal users are not really anything unless they already
    have a role that defines the manner in which they can operate within the Drupal
    framework. Hence, we discussed roles first.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过使用角色来为单个用户账户分配您想要的任何数量或数量的权限。Drupal用户除非他们已经有一个定义了他们在Drupal框架内操作方式的角色的权限，否则实际上什么都不是。因此，我们首先讨论了角色。
- en: Users can be created in two ways. The most common way is by registering on the
    site—if you haven't already, go ahead and register a new user on your site by
    clicking the **Create new account** link on the homepage just to test things out
    for yourself. Remember to supply a valid email address otherwise you won't be
    able to sign in properly. This will create an authenticated user, with any and
    all permissions that have been assigned to the **authenticated user** role.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 用户可以通过两种方式创建。最常见的方式是在网站上注册——如果您还没有，请点击主页上的**创建新账户**链接，注册您网站上的新用户，以便自己测试一下。请记住提供有效的电子邮件地址，否则您将无法正确登录。这将创建一个经过身份验证的用户，具有分配给**经过身份验证的用户**角色的所有权限。
- en: The second way is to use your administrative user to create a new user. In order
    to do this, log on as the administrative user and click on **users** under **administer**.
    Select the **add user** tab and follow the instructions on that page—you will
    need to supply Drupal with usernames, email addresses, and passwords. Once you
    have a couple of users to play around with, it's time to begin working with them.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 第二种方式是使用您的管理用户创建新用户。为了做到这一点，以管理用户身份登录，然后点击**管理**下的**用户**。选择**添加用户**标签页并遵循该页面的说明——您需要向Drupal提供用户名、电子邮件地址和密码。一旦您有几个用户可以玩，就是时候开始与他们一起工作了。
- en: Administering Users
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 管理用户
- en: As the site's administrator, you are given complete access to the other users'
    account information. By clicking on the **edit** link shown to the right of each
    user account (under the **Operations** column heading) in the **users** page under
    **administer**, you can make any changes you require to a given user.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 作为网站管理员，你被赋予了完全访问其他用户账户信息的能力。通过点击在**administer**下的**users**页面中每个用户账户右侧显示的**编辑**链接（位于**操作**列标题下），你可以对特定用户进行任何所需的更改。
- en: 'Now, we have already looked over this page briefly when we initially set up
    our administrative user in [Chapter 2](ch02.html "Chapter 2. Setting Up the Development
    Environment"), but it is worth looking over it in slightly more depth now as it
    has an important setting that was not there the first time round. If you scroll
    down the page a bit, you will notice that you now have the option to stipulate
    which roles this user belongs to. At present the demo site''s **Roles** section
    looks like this:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，当我们最初在[第2章](ch02.html "第2章。设置开发环境")中设置管理用户时，我们已经简要地浏览过这个页面，但现在值得更深入地查看，因为它有一个第一次设置时没有的重要设置。如果你将页面向下滚动一点，你会注意到你现在可以选择指定该用户属于哪些角色。目前演示网站的**角色**部分看起来如下：
- en: '![Administering Users](img/1800_05_14.jpg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![管理用户](img/1800_05_14.jpg)'
- en: 'Reading the lines below the checkboxes in this screenshot, you can see that
    whenever you add a user to another role, the user obtains the combined permissions
    of these roles. So, that answers the questions we had in the earlier section on
    *Permissions. But what''s all the fuss about?* By knowing this, you should go
    about delegating roles in the following fashion:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在此截图中的复选框下方阅读这些行，你可以看到，每次你将用户添加到另一个角色时，该用户将获得这些角色的合并权限。因此，这就回答了我们在早期关于*权限*部分提出的问题。但是，这一切的喧嚣究竟是为了什么？通过了解这一点，你应该按照以下方式来委派角色：
- en: Define the most basic user of the site by setting the **anonymous user** permissions.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过设置**匿名用户**权限来定义网站最基本的使用者。
- en: Set permissions for a basic **authenticated user—most** likely for people who
    have registered on your site.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为基本**认证用户**设置权限——很可能是那些已经在您的网站上注册的人。
- en: Create special roles by only adding the specific additional permissions that
    are required by that role, and no more. Don't re-assign permissions that the authenticated
    user already has.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过仅添加该角色所需的具体额外权限来创建特殊角色，不要重新分配认证用户已经拥有的权限。
- en: Create new users by combining whatever roles are required for their duties or
    needs.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过组合他们职责或需求所需的任何角色来创建新用户。
- en: 'If you follow the steps above, you will be sure to always give the correct
    permissions to each role. This is because you are building up a user''s permissions
    from the most basic to the most complex without having to assign every single
    permission each time. It should be obvious that a forum moderator would have all
    the permissions of an anonymous and authenticated user plus a few more. So, if
    you look back to the first diagram in the chapter you can see that, in this case,
    we would:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你遵循上述步骤，你将确保始终为每个角色分配正确的权限。这是因为你正在从最基本到最复杂逐步构建用户的权限，而不必每次都分配每个单独的权限。很明显，论坛管理员将拥有匿名用户和认证用户的全部权限，再加上一些额外的权限。所以，如果你回顾章节中的第一个图表，你可以看到在这种情况下，我们会：
- en: Define the **anonymous user** and **authenticated user** role permissions—an
    authenticated user should have all the permissions of an anonymous user, plus
    whatever else is needed by your basic site user.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义**匿名用户**和**认证用户**的角色权限——认证用户应该拥有匿名用户的全部权限，以及你的基本网站用户所需的其他权限。
- en: Create new roles with only the additional permissions needed for both the **Forum
    Moderator user** and **Blog Writer user** other than those given to the authenticated
    user
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建仅包含**论坛管理员用户**和**博客作者用户**所需额外权限的新角色，除了已授予认证用户的权限之外。
- en: Assign blog writers to the **Blog Writer user** role (they are automatically
    given the permissions granted to an authenticated user), and do the same for forum
    moderators and their role.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将博客作者分配到**博客作者用户**角色（他们自动获得授予认证用户的权限），并为论坛管理员及其角色做同样的事情。
- en: Other than using that strategy for assigning roles to users, the information
    in this section is pretty easy to intuit; so let's move on.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 除了使用该策略为用户分配角色之外，本节中的信息相当容易直观理解；因此，让我们继续前进。
- en: Configuring Users
  id: totrans-116
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置用户
- en: 'This section really discusses how the site treats users rather than discussing
    what users can and cannot do. However, you will find that some of the information
    in this section is important for the look and feel of the site. Click on **settings**
    under the **administer** link and then click **users**. You will be provided with
    set of options beginning with user registration settings as follows:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 这一节实际上讨论的是网站如何对待用户，而不是讨论用户可以做什么和不可以做什么。然而，你会发现这一节中的一些信息对于网站的外观和感觉非常重要。点击**管理**链接下的**设置**，然后点击**用户**。你将看到一个选项集，从用户注册设置开始，如下所示：
- en: '![Configuring Users](img/1800_05_15.jpg)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![配置用户](img/1800_05_15.jpg)'
- en: You might want to consider which of the first three options to select quite
    carefully depending on how you envisage the site functioning. For example, you
    might wish to allow everyone to read and post comments to the forums, or do whatever,
    without needing to register first. If this is the case, then it is likely that
    the only people who would need to register are going to be performing some sort
    of administrative duties, in which case you would probably want to select the
    first option, or at least the third option.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 根据你对网站功能的设想，你可能需要非常仔细地考虑选择前三个选项中的哪一个。例如，你可能希望允许每个人都能够阅读和发表论坛上的评论，或者做任何事情，而不需要先注册。如果是这样的话，那么可能只需要注册的人是那些将要执行某种管理职责的人，在这种情况下，你可能想要选择第一个选项，或者至少第三个选项。
- en: For the demo site's sake, the second option is fine as we would like to make
    it easy for as many people as possible to become involved in the community without
    allowing absolutely everyone to post content and potentially cause problems. A
    helpful message is also added to explain the registration process to potential
    users.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 为了演示网站，第二个选项是可行的，因为我们希望尽可能让更多的人能够参与到社区中来，同时又不允许每个人都发布内容，从而可能引起问题。还增加了一条有用的信息，以解释注册流程给潜在用户。
- en: The next section on this page deals with the process of user email customization.
    There is an interesting facet to this however, in that Drupal makes certain variables
    available for use within the static text that is entered. Let's take a look at
    how to modify a line or so in order to get the feel for how this works.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 页面上的下一节讨论了用户电子邮件定制的流程。然而，这里有一个有趣的方面，那就是Drupal提供了一些变量，可以在输入的静态文本中使用。让我们看看如何修改一行或几行，以便了解这是如何工作的。
- en: 'By way of example, we will change the **Subject of welcome e-mail** text from:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，我们将修改**欢迎电子邮件的主题**文本，从：
- en: '**Account details for %username at %site** to a slightly sprightlier:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '**%username 在 %site 的账户详情**，使其更加活泼：'
- en: '**Congratulations %username, you have registered with the %site on %date!**'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '**恭喜 %username，您已在 %date 在 %site 注册！**'
- en: 'Nothing too complicated here! The keywords preceded by the **%** sign are simply
    placeholders for other values, which are inserted into your email according to
    how they are set at that particular time. This gives you the ability to personalize
    your correspondence. In this case, the subject of the welcome email for a user
    registered as **David** is now displayed as follows:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 这里没有太多复杂的事情！以**%**符号开头的关键词只是其他值的占位符，这些值将根据特定时间如何设置而插入到你的电子邮件中。这让你能够个性化你的通信。在这种情况下，注册为**David**的用户欢迎电子邮件的主题现在显示如下：
- en: '![Configuring Users](img/1800_05_16.jpg)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![配置用户](img/1800_05_16.jpg)'
- en: As you can see, the **%username, %site**, and **%date** placeholders have been
    correctly changed to reflect the contents of the variables for that particular
    setup. There are settings available for several standard emails such as **password
    recovery** and **welcome (awaiting admin approval)**. The defaults are of course
    fairly sensible and easy to change should you need to. Remember the placeholders
    that are available for each piece of text are mentioned below the text area so
    play around with them until you are comfortable with their usage.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，**%username, %site**和**%date**占位符已正确更改，以反映该特定设置的变量内容。有几个标准电子邮件的设置可供选择，如**密码恢复**和**欢迎（等待管理员批准）**。当然，默认值是相当合理且易于更改的。记住，每个文本片段下面都提到了可用的占位符，所以请尝试使用它们，直到你对它们的用法感到舒适。
- en: The final section deals with **Pictures**. Now, if you wish to enable **Picture
    support** for users, then select **Enabled** from the list, provide a default
    picture if you want one, and click **Save configuration** (the other settings
    are fairly self explanatory and sensible, and you can come back at any stage to
    change them if they are not suitable for you).
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一个部分是关于**图片**的。现在，如果您希望为用户启用**图片支持**，则从列表中选择**启用**，如果您想要一个默认图片，请提供，然后点击**保存配置**（其他设置相当直观和合理，您可以在任何阶段返回更改它们，如果它们不适合您）。
- en: 'Drupal will set up a `pictures` folder to hold all of the pictures within the
    `files` folder in your Drupal installation. Once everything is done, users will
    have a new section added to the **edit** tab of their **my account** page, like
    so:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal将在您的Drupal安装中的`files`文件夹内创建一个`pictures`文件夹来存放所有图片。一旦完成所有操作，用户将在他们的**编辑**标签页的**我的账户**页面中添加一个新的部分，如下所示：
- en: '![Configuring Users](img/1800_05_17.jpg)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![配置用户](img/1800_05_17.jpg)'
- en: When the picture has been successfully uploaded, it will appear on the **my
    account** page, and with the user's blog and forum posts on the site.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 当图片成功上传后，它将出现在**我的账户**页面，以及用户在该网站的博客和论坛帖子中。
- en: 'If the image does not appear and you end up seeing a link, something like this:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 如果图片没有显示，你看到的是一个链接，类似于以下内容：
- en: '![Configuring Users](img/1800_05_18.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![配置用户](img/1800_05_18.jpg)'
- en: 'then you will need to ensure that you set the correct **upload module** permissions
    on the **access control** page, as follows:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，您需要确保在**访问控制**页面正确设置**上传模块**的权限，如下所示：
- en: '![Configuring Users](img/1800_05_19.jpg)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![配置用户](img/1800_05_19.jpg)'
- en: Remember that since the **Forum Administrator** user automatically receives
    all the permissions of the **authenticated** user, it is not necessary to enable
    the **view uploaded files** permission for the **Forum Administrator** as this
    would be redundant and would make the purpose of your user less clear.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，由于**论坛管理员**用户自动接收所有**认证用户**的权限，因此没有必要为**论坛管理员**启用**查看上传文件**的权限，因为这将是多余的，并且会使你的用户目的变得不明确。
- en: Allowing users to incorporate pictures into a site is a good way for people
    to be able to personalize their contributions, and also gives everyone something
    visual to associate posts with. This is a great way to foster a community, as
    it helps give different users an identity of sorts.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 允许用户将图片整合到网站中是让人们能够个性化他们贡献的好方法，同时也为每个人提供了与帖子关联的视觉元素。这是培养社区的一个好方法，因为它有助于给不同的用户提供某种身份。
- en: 'Editing the picture is easy! Simply modify it in the **Picture** section of
    the user''s edit page as shown here:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑图片很简单！只需在用户编辑页面的**图片**部分进行修改，如下所示：
- en: '![Configuring Users](img/1800_05_20.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![配置用户](img/1800_05_20.jpg)'
- en: That is pretty much the end of the line for configuring users. There are still
    a few more things we need to discuss with regards to security before we can move
    on though.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 这基本上就是配置用户的结束。在我们继续之前，还有一些关于安全性的问题需要讨论。
- en: Access Rules
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 访问规则
- en: So far it should seem like Drupal has things more or less covered when it comes
    to ensuring that it is possible to control who does what on the site. This is
    certainly the case, but there are a few more situations that we have not yet discussed,
    and may well end up affecting the site at some stage. For example, *what happens
    if you find that there is a company that repeatedly spams your forums with advertisements
    and marketing information?* Or, *what happens if you want only people from a certain
    company to access your site?*
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，Drupal在确保能够控制网站上谁做什么方面似乎已经做得差不多了。这确实是事实，但还有一些我们尚未讨论的情况，可能会在某个阶段影响网站。例如，*如果你发现有一家公司反复在你的论坛上发布广告和营销信息会发生什么？*
    或者，*如果你想只允许特定公司的人访问你的网站会发生什么？*
- en: Problems of this nature can really be a thorn in your side. Access problems
    can even end up driving community members away—unless you have the ability to
    set access rules.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 这种性质的问题确实可能成为你心中的刺。访问问题甚至可能导致社区成员流失——除非你有设置访问规则的能力。
- en: 'There are some techniques that can be used to set access rules via the **access
    rules** tab on the **access control** page under the **administer** main menu
    item. To implement any access rules you will need to select the **add rule** option,
    which brings up the following page:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些技术可以通过在**管理**主菜单项下的**访问控制**页面中的**访问规则**标签页来设置访问规则。要实施任何访问规则，您需要选择**添加规则**选项，这将打开以下页面：
- en: '![Access Rules](img/1800_05_21.jpg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![访问规则](img/1800_05_21.jpg)'
- en: From this you can see that I am in the process of making a rule that denies
    access based on an email address. Before we continue on this line, it is important
    to note that there are both **Allow** and **Deny** options available, and these
    will act based on a supplied **Username, E-mail**, or **Host** address given in
    the **Rule type** section. The final option, **Mask**, allows you to specify the
    actual name of the user or host to which the rule will apply.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里你可以看出，我正在创建一个基于电子邮件地址拒绝访问的规则。在我们继续这条线之前，重要的是要注意，这里既有**允许**和**拒绝**选项可供选择，并且这些选项将根据在**规则类型**部分提供的**用户名、电子邮件**或**主机**地址执行。最后一个选项**掩码**允许你指定规则将应用的实际用户名或主机名。
- en: In the above case, the email address`bad_user@contechst.com` will have a **deny**
    rule created after **Add rule** has been clicked.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述情况下，点击**添加规则**后，电子邮件地址`bad_user@contechst.com`将创建一个**拒绝**规则。
- en: Go ahead and create a rule like this one, and once you are done you will see
    that the rule now appears under the **list** tab. Now that there is a deny rule
    in place, how do we go about using it? The answer is that it is already being
    used. If someone tries to register with the email address supplied in the rule,
    they will be denied access. As it stands, this is probably not very helpful, because
    it is unlikely you will know ahead of time what specific email addresses to block.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 继续创建这样的规则，完成后你将看到该规则现在出现在**列表**标签下。现在已经有了一个拒绝规则，我们如何使用它呢？答案是它已经被使用了。如果有人试图使用规则中提供的电子邮件地址注册，他们将无法访问。目前来看，这可能不是很有帮助，因为你可能无法提前知道要阻止哪些具体的电子邮件地址。
- en: 'In order to cater for the times when you aren''t entirely sure of the specific
    address, there are two wildcard characters provided that can serve as generic
    strings or characters. Let''s say that you wanted to ban someone who runs a small
    spamming business. Simply blocking their current email address is not really sufficient,
    because they can simply create another address and use that one to register with
    Drupal. If you know that the addresses come from one location, such as:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 为了应对你不确定具体地址的情况，提供了两个通配符字符，可以作为通用字符串或字符使用。假设你想禁止一个运营小型垃圾邮件业务的人。仅仅阻止他们当前的电子邮件地址并不足够，因为他们可以简单地创建另一个地址并使用它来在Drupal上注册。如果你知道这些地址来自一个位置，例如：
- en: '[PRE0]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You could use the `%` character to match whatever characters are present before
    the `@` sign, effectively stopping anyone from that email server from registering,
    like so:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用`%`字符来匹配`@`符号之前出现的任何字符，从而阻止该电子邮件服务器上的任何人注册，如下所示：
- en: '[PRE1]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'If you have a Hotmail account, or something similar, try blocking any address
    that ends in `@hotmail.com` and then attempt to register an account on the site.
    You should find that Drupal presents you with the following message:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你有一个Hotmail账户或类似的东西，尝试阻止任何以`@hotmail.com`结尾的地址，然后尝试在该网站上注册账户。你应该会发现Drupal会显示以下信息：
- en: '![Access Rules](img/1800_05_22.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![访问规则](img/1800_05_22.jpg)'
- en: A new problem rears its ugly head when it so happens that you don't want to
    allow Hotmail addresses on the site with the exception of a close personal friend
    who is traveling around the world and can only access a Hotmail address. In this
    case, you need to set an **Allow** rule as well. If it so happens that the email
    address of the person is `good_friend@hotmail.com`, then you could set the allow
    rule by selecting the appropriate options to cater for this on the **add rule**
    page.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 当你不想在网站上允许使用Hotmail地址，除非是那位正在世界各地旅行的亲密朋友，他只能使用Hotmail地址时，就会出现一个新的问题。在这种情况下，你也需要设置一个**允许**规则。如果这个人的电子邮件地址是`good_friend@hotmail.com`，那么你可以在**添加规则**页面选择适当的选项来设置允许规则。
- en: 'Your rules would then look something like this:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 你的规则可能看起来像这样：
- en: '![Access Rules](img/1800_05_23.jpg)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![访问规则](img/1800_05_23.jpg)'
- en: What this does is ban all Hotmail addresses on the site. However, because *an
    allow rule takes precedence over a deny rule*, the one and only Hotmail address
    specified in the single **allow** rule shown in the screenshot will work fine.
    Now when your good friend attempts to register, everything will go swimmingly
    well.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 这实际上是在网站上禁止所有Hotmail地址。然而，由于**允许规则优先于拒绝规则**，截图中所显示的单个**允许**规则中指定的唯一Hotmail地址将正常工作。现在，当你的好朋友尝试注册时，一切都会顺利进行。
- en: After some time, you might find that the set of rules that are in place can
    become slightly confusing, or alternatively, it is simply not feasible to continue
    attempting to register new names all the time to ensure that they work according
    to plan. In this case, use the **check rules** tab on the right-hand side of the
    **access rules** page. This allows names of users, email addresses, and hosts
    to be entered in order to check whether they have access or not. Simply compare
    these results with your expectations to determine if everything is working as
    planned.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 经过一段时间，你可能会发现现有的规则集可能会变得有些令人困惑，或者，简单地来说，持续不断地尝试注册新名称以确保它们按计划工作变得不可行。在这种情况下，请使用**访问规则**页面右侧的**检查规则**标签。这允许输入用户名、电子邮件地址和主机，以检查它们是否有访问权限。只需将这些结果与你的预期进行比较，以确定一切是否按计划进行。
- en: One final thing to bear in mind is that if you deny access using the host criteria,
    then this will be enforced throughout the site and not just on the registration
    pages. For the case of the spammer, you would probably want to deny access to
    the site in general; so you would select the **host** option with something like
    this for the **Mask:**
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 最后需要注意的一点是，如果你使用主机标准拒绝访问，那么这一限制将会在整个网站上实施，而不仅仅是注册页面。对于垃圾邮件发送者的情况，你可能希望一般性地拒绝其访问网站；因此，你会在**掩码**选项中选择类似以下的内容：**主机**
- en: '[PRE2]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'This would then match to any host with `irritating_spammer` in it. For example:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 这样就会匹配包含`irritating_spammer`的任何主机。例如：
- en: '[PRE3]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: and so on. Remember to check that all the rules you add have the desired affect
    on the site's access policy. It would be a shame to make a rule that prevented
    potentially valuable community members from accessing content, causing them to
    go elsewhere.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 等等。请记住检查你添加的所有规则是否对网站的访问策略产生了预期的效果。如果制定了一条规则，阻止了可能对社区有价值的成员访问内容，导致他们去其他地方，那将是一件遗憾的事情。
- en: I would be remiss if I didn't mention, before finishing off, that there are
    a number of other **user access/authentication-related** modules available on
    the Drupal website. It is probably worthwhile to check these out at `http://drupal.org/project/Modules/category/74`
    in case there is something you find that is particularly suited to your needs.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在结束之前，如果不提及其他一些与**用户访问/身份验证相关**的模块，我会感到疏忽。Drupal网站上有很多这样的模块。在`http://drupal.org/project/Modules/category/74`上查看这些模块可能是有价值的，以防你发现某些特别适合你需求的模块。
- en: Of special interest are the *node privacy byrole* and *Path Access* modules,
    which provide an alternative method of controlling access to content. Having seen
    how the *Taxonomy Access* module worked, you should feel confident enough to work
    with any of these contributions assuming you are not able to achieve precisely
    what you want already.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 特别值得注意的是**按角色节点隐私**和**路径访问**模块，它们提供了控制内容访问的另一种方法。在看到**分类访问**模块的工作方式后，你应该有足够的信心去处理这些贡献，前提是你不能完全实现你想要的功能。
- en: Summary
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 概述
- en: This chapter has given you a good grounding in the basics of controlling access
    to your site's content. You have seen that Drupal comes with a large number of
    facilities and options to ensure proper maintenance of the site by retaining overall
    control with the administrative user, as well as delegate important jobs to trusted
    users via the use of roles.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 本章为你提供了关于控制网站内容访问的基础知识。你看到Drupal提供了一系列设施和选项，以确保通过管理员用户保持整体控制，以及通过使用角色将重要任务委托给可信赖的用户，来确保网站的适当维护。
- en: We looked at how to go about planning an access policy. This is not only an
    important requirement, in terms of making sure the site runs smoothly, but also
    helps to solidify how the site will eventually work by forcing you to consider
    many eventualities. Following this, a tour of the fundamental aspects of access
    control in Drupal saw us discussing roles, permissions, and users, and learning
    how to plan and implement an access policy based on the requirements of the site.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 我们探讨了如何规划访问策略。这不仅是一个重要的要求，确保网站顺利运行，而且通过迫使你考虑许多可能情况，有助于巩固网站最终的工作方式。在此之后，我们对Drupal中访问控制的基本方面进行了探讨，讨论了角色、权限和用户，并学习了如何根据网站的要求规划和实施访问策略。
- en: A discourse on how to use the contributed module that controls access based
    on taxonomy showed us how to implement even further fine-grained control over
    the content's access permissions. However, you probably also found out that creating
    a well-designed and coherent access policy takes a bit of time. Planning, and
    above all, testing, will help ensure that everything works as intended.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 关于如何使用基于分类法的访问控制模块的讨论，展示了如何实现对内容访问权限的更细致的控制。然而，你可能也发现，创建一个设计良好且连贯的访问策略需要一些时间。规划，更重要的是，测试，将有助于确保一切按预期工作。
- en: Access rules were then introduced as a further way of controlling who gets into
    the site, with a discussion on how to use the wildcard characters effectively.
    With that, we are done with access control although you are strongly urged to
    spend some time playing around with the various options until you are comfortable
    with being able to make changes and knowing their effects.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 随后，引入了访问规则作为进一步控制谁可以进入网站的方法，并讨论了如何有效地使用通配符字符。至此，我们完成了访问控制，尽管强烈建议你花些时间尝试各种选项，直到你对能够进行更改并了解其效果感到舒适为止。
- en: The next two chapters take an in-depth look at content—the beating heart of
    Drupal!
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来的两章将深入探讨内容——Drupal的核心所在！

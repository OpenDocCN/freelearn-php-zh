<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;3.&#xA0;Understanding PHP Basics" id="LTSU1-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03" class="calibre1"/>Chapter 3. Understanding PHP Basics</h1></div></div></div><p class="calibre8">Learning a new language is not easy. You need to understand not only the syntax of the language, but also its grammatical rules, that is, when and why to use each element of the language. Luckily for you, some languages come from the same root. For example, Spanish and French are Romance languages, as they both evolved from spoken Latin; that means that these two languages share a lot of rules, and if you already know French, learning Spanish becomes much easier.</p><p class="calibre8">Programming languages are quite the same. If you already know another programming language, it will be very easy for you to go through this chapter. If this is your first time though, you will need to understand all those grammatical rules from scratch, and so, it might take some more time. But fear not! We are here to help you in this endeavor.</p><p class="calibre8">In this chapter, you will learn about the following:</p><div class="book"><ul class="itemizedlist"><li class="listitem">PHP files</li><li class="listitem">Variables, strings, arrays, and operators in PHP</li><li class="listitem">PHP in web applications</li><li class="listitem">Control structures in PHP</li><li class="listitem">Functions in PHP</li><li class="listitem">The PHP filesystem</li></ul></div></div>

<div class="book" title="Chapter&#xA0;3.&#xA0;Understanding PHP Basics" id="LTSU1-edcc22b134104d5db0bf3aa086c86851">
<div class="book" title="PHP files"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch03lvl1sec17" class="calibre1"/>PHP files</h1></div></div></div><p class="calibre8">From <a id="id90" class="calibre1"/>now on, we will work on your <code class="email">index.php</code> file, so you can just start the web server, and go to <code class="email">http://localhost:8080</code> to see the results.</p><p class="calibre8">You might have already noticed that in order to write PHP code, you have to start the file with <code class="email">&lt;?php</code>. There are other options, and you can also finish the file with <code class="email">?&gt;</code>, but none of them are needed. What is important to know is that you can mix PHP code with other content, like HTML, CSS, or JavaScript, in your PHP file as soon as you enclose the PHP bits with the <code class="email">&lt;?php ?&gt;</code> tags.</p><div class="informalexample"><pre class="programlisting">&lt;?php
  echo 'hello world';
<span class="strong"><strong class="calibre2">?&gt;</strong></span>
<span class="strong"><strong class="calibre2">bye world</strong></span>
</pre></div><p class="calibre8">If you <a id="id91" class="calibre1"/>check the result of the preceding code snippet in your browser, you will see that it prints both messages, <span class="strong"><strong class="calibre2">hello world</strong></span> and <span class="strong"><strong class="calibre2">bye world</strong></span>. The reason why this happens is simple: you already know that the PHP code there prints the <span class="strong"><strong class="calibre2">hello world</strong></span> message. What happens next is that anything outside the PHP tags will be interpreted as is. If there is an HTML code for instance, it would not be printed as is, but will be interpreted by the browser.</p><p class="calibre8">You will learn in <a class="calibre1" title="Chapter 6. Adapting to MVC" href="part0056_split_000.html#1LCVG1-edcc22b134104d5db0bf3aa086c86851">Chapter 6</a>, <span class="strong"><em class="calibre12">Adapting to MVC</em></span>, why it is usually a bad idea to mix PHP and HTML. For now, assuming that it is bad, let's try to avoid it. For that, you can include one file from another <a id="id92" class="calibre1"/>PHP file using any one of these four functions:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">include</code>: This will <a id="id93" class="calibre1"/>try to find and include the specified file each time it is invoked. If the file is not found, PHP will throw a warning, but will continue with the execution.</li><li class="listitem"><code class="email">require</code>: This <a id="id94" class="calibre1"/>will do the same as <code class="email">include</code>, but PHP will throw an error instead of a warning if the file is not found.</li><li class="listitem"><code class="email">include_once</code>: This<a id="id95" class="calibre1"/> function will do what <code class="email">include</code> does, but it will include the file only the first time that it is invoked. Subsequent calls will be ignored.</li><li class="listitem"><code class="email">require_once</code>: This <a id="id96" class="calibre1"/>works the same as <code class="email">require</code>, but it will include the file only the first time that it is invoked. Subsequent calls will be ignored.</li></ul></div><p class="calibre8">Each function has its own usage, so it is not right to say that one is better than the other. Just think carefully what your scenario is, and then decide. For example, let's try to include our <code class="email">index.html</code> file from our <code class="email">index.php</code> file such that we do not mix PHP with HTML, but have the best of both worlds:</p><div class="informalexample"><pre class="programlisting">&lt;?php
echo 'hello world';
<span class="strong"><strong class="calibre2">require 'index.html';</strong></span>
</pre></div><p class="calibre8">We chose <code class="email">require</code> as we know the file is there—and if it is not, we are not interested in continuing the execution. Moreover, as it is some HTML code, we might want to include it multiple times, so we did not choose the <code class="email">require_once</code> option. You can try to require a file that does not exist, and see what the browser says.</p><p class="calibre8">PHP does not consider empty lines; you can add as many as you want to make your code easier to read, and it will not have any repercussion on your application. Another element that helps in writing understandable code, and which is ignored by PHP, is comments. Let's see both in action:</p><div class="informalexample"><pre class="programlisting">&lt;?php

<span class="strong"><strong class="calibre2">/*</strong></span>
<span class="strong"><strong class="calibre2"> * This is the first file loaded by the web server.</strong></span>
<span class="strong"><strong class="calibre2"> * It prints some messages and html from other files.</strong></span>
<span class="strong"><strong class="calibre2"> */</strong></span>

<span class="strong"><strong class="calibre2">// let's print a message from php</strong></span>
echo 'hello world';

// and then include the rest of html
require 'index.html';</pre></div><p class="calibre8">The code does the same<a id="id97" class="calibre1"/> job as the previous one, but now everyone will easily understand what we are trying to do. We can see two types of comments: single-line comments and multiple-line comments. The first type consists of a single line starting with <code class="email">//</code>, and the second type encloses multiple lines within <code class="email">/*</code> and <code class="email">*/</code>. We start each commented line with an asterisk, but that is completely optional.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Variables" id="MSDG1-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec18" class="calibre1"/>Variables</h1></div></div></div><p class="calibre8">Variables<a id="id98" class="calibre1"/> keep a value for future reference. This value can change if we want it to; that is why they are called variables. Let's take a look at them in an example. Save this code in your <code class="email">index.php</code> file:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$a = 1;
$b = 2;
$c = $a + $b;
echo $c; // 3</pre></div><p class="calibre8">In this preceding piece of code, we have three variables: <code class="email">$a</code> has value <code class="email">1</code>, <code class="email">$b</code> has <code class="email">2</code>, and <code class="email">$c</code> contains the sum of <code class="email">$a</code> and <code class="email">$b</code>, hence, <code class="email">$c</code> equals 3. Your browser should print the value of the variable <code class="email">$c</code>, which is 3.</p><p class="calibre8">Assigning a value to a variable means to give it a value, and it is done with the equals sign as shown in the previous example. If you did not assign a value to a variable, we will get a notice from PHP when it checks its contents. A notice is just a message telling us that something is not exactly right, but it is a minor problem and you can continue with the execution. The value of an unassigned variable will be null, that is, nothing.</p><p class="calibre8">PHP variables start with the <code class="email">$</code> sign followed by the variable name. A valid variable name starts with a letter or an underscore followed by any combination of letters, numbers, and/or underscores. It is case sensitive. Let's see some examples:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$_some_value = 'abc'; // valid
$1number = 12.3; // not valid!
$some$signs% = '&amp;^%'; // not valid!
$go_2_home = "ok"; // valid
$go_2_Home = 'no'; // this is a different variable
$isThisCamelCase = true; // camel case</pre></div><p class="calibre8">Remember that <a id="id99" class="calibre1"/>everything after <code class="email">//</code> is a comment, and is thus ignored by PHP.</p><p class="calibre8">In this piece of code, we can see that variable names like <code class="email">$_some_value</code> and <code class="email">$go_2_home</code> are valid. <code class="email">$1number</code> and <code class="email">$some$signs%</code> are not valid as they start with a number, or they contain invalid symbols. As names are case sensitive, <code class="email">$go_2_home</code> and <code class="email">$go_2_Home</code> are two different variables. Finally, we show the CamelCase convention, which is the preferred option among most developers.</p></div>

<div class="book" title="Variables" id="MSDG1-edcc22b134104d5db0bf3aa086c86851">
<div class="book" title="Data types"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec27" class="calibre1"/>Data types</h2></div></div></div><p class="calibre8">We can assign<a id="id100" class="calibre1"/> more than just numbers to variables. PHP has eight primitive types, but for now, we will focus on its four scalar types:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">Booleans</strong></span>: These<a id="id101" class="calibre1"/> take just true or false values</li><li class="listitem"><span class="strong"><strong class="calibre2">Integers</strong></span>: These are<a id="id102" class="calibre1"/> numeric values without a decimal point, for example, 2 or 5</li><li class="listitem"><span class="strong"><strong class="calibre2">Floating point numbers or floats</strong></span>: These<a id="id103" class="calibre1"/> are numbers with a decimal point, for example, 2.3</li><li class="listitem"><span class="strong"><strong class="calibre2">Strings</strong></span>: These are <a id="id104" class="calibre1"/>concatenations of characters which are surrounded by either single or double quotes, like 'this' or "that"</li></ul></div><p class="calibre8">Even though PHP defines these types, it allows the user to assign different types of data to the same variable. Check the following code to see how it works:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$number = 123;
var_dump($number);
$number = 'abc';
var_dump($number);</pre></div><p class="calibre8">If you check the result on your browser, you will see the following:</p><div class="informalexample"><pre class="programlisting">int(123) string(3) "abc"</pre></div><p class="calibre8">The code first<a id="id105" class="calibre1"/> assigns the value <code class="email">123</code> to the variable <code class="email">$number</code>. As <code class="email">123</code> is an integer, the type of the variable will be integer <code class="email">int</code>. That is what we see when printing the content of the variable with <code class="email">var_dump</code>. After that, we assign another value to the same variable, this time a string. When printing the new content, we see that the type of the variable changed from integer to string, yet PHP did not complain at any time. This is called <a id="id106" class="calibre1"/>
<span class="strong"><strong class="calibre2">type juggling</strong></span>.</p><p class="calibre8">Let's check another piece of code:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$a = "1";
$b = 2;
var_dump($a + $b); // 3
var_dump($a . $b); // 12</pre></div><p class="calibre8">You already know that the <code class="email">+</code> operator returns the sum of two numeric values. You will see later that the <code class="email">.</code> operator concatenates two strings. Thus, the preceding code assigns a string and an integer to two variables, and then tries to add and concatenate them.</p><p class="calibre8">When trying to add them, PHP knows that it needs two numeric values, and so it tries to adapt the string to an integer. In this case, it is easy as the string represents a valid number. That is the reason why we see the first result as an integer 3 (<span class="strong"><em class="calibre12">1 + 2</em></span>).</p><p class="calibre8">In the last line, we are performing a string concatenation. We have an integer in <code class="email">$b</code>, so PHP will first try to convert it to a string—which is "2"—and then concatenate it with the other string, "1". The result is the string "12".</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note04" class="calibre1"/>Note</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">Type juggling</strong></span>
</p><p class="calibre8">PHP tries to convert the<a id="id107" class="calibre1"/> data type of a variable only when there is a context where the type of variable needed is different. But PHP does not change the value and type of the variable itself. Instead, it will take the value and try to transform it, leaving the variable intact.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Operators"><div class="book" id="NQU22-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec19" class="calibre1"/>Operators</h1></div></div></div><p class="calibre8">Using <a id="id108" class="calibre1"/>variables is nice, but if we cannot make them interact with each other, there is nothing much we can do. <span class="strong"><strong class="calibre2">Operators</strong></span> are elements that take some expressions—operands—and perform actions on them to get a result. The most common examples of operators are arithmetic operators, which you already saw previously.</p><p class="calibre8">An <span class="strong"><strong class="calibre2">expression</strong></span>
<a id="id109" class="calibre1"/> is almost anything that has a value. Variables, numbers, or text are examples of expressions, but you will see that they can get way more complicated. Operators expect expressions of a specific type, for example, arithmetic operators expect either integers or floats. But as you already know, PHP takes care of transforming the types of the expressions given whenever possible.</p><p class="calibre8">Let's take a look at the most important groups of operators.</p></div>

<div class="book" title="Operators">
<div class="book" title="Arithmetic operators"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec28" class="calibre1"/>Arithmetic operators</h2></div></div></div><p class="calibre8">Arithmetic <a id="id110" class="calibre1"/>operators <a id="id111" class="calibre1"/>are very intuitive, as you already know. Addition, subtraction, multiplication, and division (<code class="email">+</code>, <code class="email">-</code>, <code class="email">*</code>, and <code class="email">/</code>) do as their names say. Modulus (<code class="email">%</code>) gives the remainder of the division of two operands. Exponentiation (<code class="email">**</code>) raises the first operand to the power of the second. Finally, negation (<code class="email">-</code>) negates the operand. This last one is the only arithmetic operator that takes just one operand.</p><p class="calibre8">Let's see some examples:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$a = 10;
$b = 3;
var_dump($a + $b); // 13
var_dump($a - $b); // 7
var_dump($a * $b); // 30
var_dump($a / $b); // 3.333333...
var_dump($a % $b); // 1
var_dump($a ** $b); // 1000
var_dump(-$a); // -10</pre></div><p class="calibre8">As you can see, they are quite easy to understand!</p></div></div>

<div class="book" title="Operators">
<div class="book" title="Assignment operators"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec29" class="calibre1"/>Assignment operators</h2></div></div></div><p class="calibre8">You <a id="id112" class="calibre1"/>already know this one too, as we have been using it in our examples. The assignment <a id="id113" class="calibre1"/>operator assigns the result of an expression to a variable. Now you know that an expression can be as simple as a number, or, for example, the result of a series of arithmetic operations. The following example assigns the result of an expression to a variable:</p><div class="informalexample"><pre class="programlisting">&lt;?php
<span class="strong"><strong class="calibre2">$a = 3 + 4 + 5 - 2;</strong></span>
var_dump($a); // 10</pre></div><p class="calibre8">There are a series of assignment operators that work as shortcuts. You can build them combining an arithmetic operator and the assignment operator. Let's see some examples:</p><div class="informalexample"><pre class="programlisting">$a = 13;
<span class="strong"><strong class="calibre2">$a += 14; // same as $a = $a + 14;</strong></span>
var_dump($a);
<span class="strong"><strong class="calibre2">$a -= 2; // same as $a = $a - 2;</strong></span>
var_dump($a);
<span class="strong"><strong class="calibre2">$a *= 4; // same as $a = $a * 4;</strong></span>
var_dump($a);</pre></div></div></div>

<div class="book" title="Operators">
<div class="book" title="Comparison operators"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec30" class="calibre1"/>Comparison operators</h2></div></div></div><p class="calibre8">Comparison <a id="id114" class="calibre1"/>operators <a id="id115" class="calibre1"/>are one of the most used groups of operators. They take two operands and compare them, returning the result of the comparison usually as a Boolean, that is, <code class="email">true</code> or <code class="email">false</code>.</p><p class="calibre8">There are four comparisons that are very intuitive: <code class="email">&lt;</code> (less than), <code class="email">&lt;=</code> (less or equal to), <code class="email">&gt;</code> (greater than), and <code class="email">&gt;=</code> (greater than or equal to). There is also the special operator <code class="email">&lt;=&gt;</code> (spaceship) that compares both the operands and returns an integer instead of a Boolean. When comparing <span class="strong"><em class="calibre12">a</em></span> with <span class="strong"><em class="calibre12">b</em></span>, the result will be less than 0 if <span class="strong"><em class="calibre12">a</em></span> is less than <span class="strong"><em class="calibre12">b</em></span>, 0 if <span class="strong"><em class="calibre12">a</em></span> equals <span class="strong"><em class="calibre12">b</em></span>, and greater than 0 if <span class="strong"><em class="calibre12">a</em></span> is greater than <span class="strong"><em class="calibre12">b</em></span>. Let's see some examples:</p><div class="informalexample"><pre class="programlisting">&lt;?php
var_dump(2 &lt; 3); // true
var_dump(3 &lt; 3); // false
var_dump(3 &lt;= 3); // true
var_dump(4 &lt;= 3); // false
var_dump(2 &gt; 3); // false
var_dump(3 &gt;= 3); // true
var_dump(3 &gt; 3); // false
var_dump(1 &lt;=&gt; 2); // int less than 0
var_dump(1 &lt;=&gt; 1); // 0
var_dump(3 &lt;=&gt; 2); // int greater than 0</pre></div><p class="calibre8">There are comparison operators to evaluate if two expressions are equal or not, but you need to be careful with type juggling. The <code class="email">==</code> (equals) operator evaluates two expressions <span class="strong"><em class="calibre12">after</em></span> type juggling, that is, it will try to transform both expressions to the same type, and then compare them. Instead, the <code class="email">===</code> (identical) operator evaluates two expressions <span class="strong"><em class="calibre12">without</em></span> type juggling, so even if they look the same, if they are not of the same type, the comparison will return <code class="email">false</code>. The same applies to <code class="email">!=</code> or <code class="email">&lt;&gt;</code> (not equal to) and <code class="email">!==</code> (not identical):</p><div class="informalexample"><pre class="programlisting">&lt;?php
$a = 3;
$b = '3';
$c = 5;
var_dump($a == $b); // true
var_dump($a === $b); // false
var_dump($a != $b); // false
var_dump($a !== $b); // true
var_dump($a == $c); // false
var_dump($a &lt;&gt; $c); // true</pre></div><p class="calibre8">You can see that <a id="id116" class="calibre1"/>when asking if a string and an integer that represent the<a id="id117" class="calibre1"/> same number are equal, it replies affirmatively; PHP first transforms both to the same type. On the other hand, when asked if they are identical, it replies they are not as they are of different types.</p></div></div>

<div class="book" title="Operators">
<div class="book" title="Logical operators"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec31" class="calibre1"/>Logical operators</h2></div></div></div><p class="calibre8">Logical operators <a id="id118" class="calibre1"/>apply a logic operation—also known as a binary operation—to its <a id="id119" class="calibre1"/>operands, returning a Boolean response. The most used ones are <code class="email">!</code> (not), <code class="email">&amp;&amp;</code> (and), and <code class="email">||</code> (or). <code class="email">&amp;&amp;</code> will return <code class="email">true</code> only if both operands evaluate to <code class="email">true</code>. <code class="email">||</code> will return <code class="email">true</code> if any or both of the operands are <code class="email">true</code>. <code class="email">!</code> will return the negated value of the operand, that is, <code class="email">true</code> if the operand is <code class="email">false</code> or <code class="email">false</code> if the operand is <code class="email">true</code>. Let's see some examples:</p><div class="informalexample"><pre class="programlisting">&lt;?php
var_dump(true &amp;&amp; true); // true
var_dump(true &amp;&amp; false); // false
var_dump(true || false); // true
var_dump(false || false); // false
var_dump(!false); // true</pre></div></div></div>

<div class="book" title="Operators">
<div class="book" title="Incrementing and decrementing operators"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch03lvl2sec32" class="calibre1"/>Incrementing and decrementing operators</h2></div></div></div><p class="calibre8">Incrementing/decrementing operators<a id="id120" class="calibre1"/> are also shortcuts like <code class="email">+=</code> or <code class="email">-=</code>, and they only <a id="id121" class="calibre1"/>work on variables. There are four of them, and <a id="id122" class="calibre1"/>they need special attention. We've already <a id="id123" class="calibre1"/>seen the first two:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">++</code>: This operator on the left of the variable will increase the variable by 1, and then return the result. On the right, it will return the content of the variable, and after that increase it by 1.</li><li class="listitem"><code class="email">--</code>: This operator works the same as <code class="email">++</code> but decreases the value by 1 instead of increasing by 1.</li></ul></div><p class="calibre8">Let's see an example:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$a = 3;
<span class="strong"><strong class="calibre2">$b = $a++; // $b is 3, $a is 4</strong></span>
var_dump($a, $b);
<span class="strong"><strong class="calibre2">$b = ++$a; // $a and $b are 5</strong></span>
var_dump($a, $b);</pre></div><p class="calibre8">In the preceding code, on the first assignment to <code class="email">$b</code>, we use <code class="email">$a++</code>. The operator on the right will return first the value of <code class="email">$a</code>, which is <code class="email">3</code>, assign it to <code class="email">$b</code>, and only then increase <code class="email">$a</code> by 1. In the second assignment, the operator on the left first increases <code class="email">$a</code> by 1, changes the value of <code class="email">$a</code> to <code class="email">5</code>, and then assigns that value to <code class="email">$b</code>.</p></div></div>

<div class="book" title="Operators">
<div class="book" title="Operator precedence"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_6"><a id="ch03lvl2sec33" class="calibre1"/>Operator precedence</h2></div></div></div><p class="calibre8">You can add multiple operators to<a id="id124" class="calibre1"/> an expression to make it as long as it needs to be, but you need to be careful as some operators have higher precedence than others, and thus, the order of execution might not be the one you expect. The following table shows the order of precedence of the operators that we've studied until now:</p><div class="informalexample"><table border="1" class="calibre15"><colgroup class="calibre16"><col class="calibre17"/><col class="calibre17"/></colgroup><thead class="calibre18"><tr class="calibre19"><th valign="bottom" class="calibre20">
<p class="calibre21">Operator</p>
</th><th valign="bottom" class="calibre20">
<p class="calibre21">Type</p>
</th></tr></thead><tbody class="calibre22"><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">**</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Arithmetic</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">++</code>, <code class="literal">--</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Increasing/decreasing</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">!</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Logical</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">*</code>, <code class="literal">/</code>, <code class="literal">%</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Arithmetic</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">+</code>, <code class="literal">-</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Arithmetic</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">&lt;</code>, <code class="literal">&lt;=</code>, <code class="literal">&gt;</code>, <code class="literal">&gt;=</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Comparison</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">==</code>, <code class="literal">!=</code>, <code class="literal">===</code>, <code class="literal">!==</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Comparison</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">&amp;&amp;</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Logical</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">||</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Logical</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">=</code>, <code class="literal">+=</code>, <code class="literal">-=</code>, <code class="literal">*=</code>, <code class="literal">/=</code>, <code class="literal">%=</code>, <code class="literal">**=</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Assignment</p>
</td></tr></tbody></table></div><p class="calibre8">The preceding table shows us that the expression <span class="strong"><em class="calibre12">3+2*3</em></span> will first evaluate the product <span class="strong"><em class="calibre12">2*3</em></span> and then the sum, so the result is 9 rather than 15. If you want to perform operations in a specific order, different from the natural order of precedence, you can force it by enclosing the operation within parentheses. Hence, <span class="strong"><em class="calibre12">(3+2)*3</em></span> will first perform the sum and then the product, giving the result 15 this time.</p><p class="calibre8">Let's see some examples to clarify this quite tricky subject:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$a = 1;
$b = 3;
$c = true;
$d = false;
<span class="strong"><strong class="calibre2">$e = $a + $b &gt; 5 || $c; // true</strong></span>
var_dump($e);
<span class="strong"><strong class="calibre2">$f = $e == true &amp;&amp; !$d; // true</strong></span>
var_dump($f);
<span class="strong"><strong class="calibre2">$g = ($a + $b) * 2 + 3 * 4; // 20</strong></span>
var_dump($g);</pre></div><p class="calibre8">This preceding example could be endless, and still not be able to cover all the scenarios you can imagine, so let's keep it simple. In the first highlighted line, we have a combination of arithmetic, <a id="id125" class="calibre1"/>comparison, and logical operators, plus the assignment operator. As there are no parentheses, the order is the one detailed in the previous table. The operator with the highest preference is the sum, so we perform it first: <code class="email">$a</code> + <code class="email">$b</code> equals 4. The next one is the comparison operator, so <span class="strong"><em class="calibre12">4 &gt; 5</em></span>, which is <code class="email">false</code>. Finally, the logical operator, <code class="email">false</code> || <code class="email">$c</code> (<code class="email">$c</code> is <code class="email">true</code>) results in <code class="email">true</code>.</p><p class="calibre8">The second example might need a bit more explanation. The first operator we see in the table is the negation, so we resolve it. <code class="email">!$d</code> is <code class="email">!false</code>, so it is <code class="email">true</code>. The expression is now, <code class="email">$e</code> == <code class="email">true</code> &amp;&amp; <code class="email">true</code>. First we need to solve the comparison <code class="email">$e</code> == <code class="email">true.</code> Knowing that <code class="email">$e</code> is <code class="email">true</code>, the comparison results in <code class="email">true</code>. The final operation then is the logical end, and it results in <code class="email">true</code>.</p><p class="calibre8">Try to work out the last example by yourself to get some practice. Do not be afraid if you think we are not covering operators enough. During the next few sections, we will see a lot of examples.</p></div></div>
<div class="book" title="Working with strings" id="OPEK1-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec20" class="calibre1"/>Working with strings</h1></div></div></div><p class="calibre8">Working <a id="id126" class="calibre1"/>with strings in real life is really easy. Actions like <span class="strong"><em class="calibre12">Check if this string contains this</em></span> or <span class="strong"><em class="calibre12">Tell me how many times this character appears</em></span> are very easy to perform. But when programming, strings are concatenations of characters that you cannot see at once when searching for something. Instead, you have to look one by one and keep track of what the content is. In this scenario, those really easy actions are not that easy any more.</p><p class="calibre8">Luckily for you, PHP brings a whole set of predefined functions that help you in interacting with strings. You can find the entire list of functions<a id="id127" class="calibre1"/> at <a class="calibre1" href="http://php.net/manual/en/ref.strings.php">http://php.net/manual/en/ref.strings.php</a>, but we will only cover the ones that are used the most. Let's look at some examples:</p><div class="informalexample"><pre class="programlisting">&lt;?php

$text = '   How can a clam cram in a clean cream can? ';

echo strlen($text); // 45
$text = trim($text);
echo $text; // How can a clam cram in a clean cream can?
echo strtoupper($text); // HOW CAN A CLAM CRAM IN A CLEAN CREAM CAN?
echo strtolower($text); // how can a clam cram in a clean cream can?
$text = str_replace('can', 'could', $text);
echo $text; // How could a clam cram in a clean cream could?
echo substr($text, 2, 6); // w coul
var_dump(strpos($text, 'can')); // false
var_dump(strpos($text, 'could')); // 4</pre></div><p class="calibre8">In the preceding long<a id="id128" class="calibre1"/> piece of code, we are playing with a string with different functions:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">strlen</code>: This<a id="id129" class="calibre1"/> function returns the number of characters that the string contains.</li><li class="listitem"><code class="email">trim</code>: This <a id="id130" class="calibre1"/>function returns the string, removing all the blank spaces to the left and to the right.</li><li class="listitem"><code class="email">strtoupper</code> and <code class="email">strtolower</code>: These functions return the string with all the characters in upper or <a id="id131" class="calibre1"/>lower <a id="id132" class="calibre1"/>case respectively.</li><li class="listitem"><code class="email">str_replace</code>: This <a id="id133" class="calibre1"/>function replaces all occurrences of a given string by the replacement string.</li><li class="listitem"><code class="email">substr</code>: This <a id="id134" class="calibre1"/>function extracts the string contained between the positions specified by parameters, with the first character being at position 0.</li><li class="listitem"><code class="email">strpos</code>: This <a id="id135" class="calibre1"/>function shows the position of the first occurrence of the given string. It returns <code class="email">false</code> if the string cannot be found.</li></ul></div><p class="calibre8">Additionally, there is an operator for strings (<code class="email">.</code>) which concatenates two strings (or two variables transformed to a string when possible). Using it is really simple: in the following example, the last statement will concatenate all the strings and variables forming the sentence, <span class="strong"><em class="calibre12">I am Hiro Nakamura!</em></span>.</p><div class="informalexample"><pre class="programlisting">&lt;?php
$firstname = 'Hiro';
$surname = 'Nakamura';
<span class="strong"><strong class="calibre2">echo 'I am ' . $firstname . ' ' . $surname . '!';</strong></span>
</pre></div><p class="calibre8">Another thing to note about strings is the way they are represented. So far, we have been enclosing the strings within single quotes, but you can also enclose them within double quotes. The difference is that within single quotes, a string is exactly as it is represented, but within double quotes, some rules are applied before showing the final result. There are two elements that double quotes treat differently than single quotes: escape characters and variable expansions.</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">Escape characters</strong></span>: These are <a id="id136" class="calibre1"/>special characters than cannot be represented easily. Examples of escape characters are new lines or tabs. To represent them, we use escape sequences, which are the concatenation of a backslash (<code class="email">\</code>) followed by some other character. For example, <code class="email">\n</code> represents a new line, and <code class="email">\t</code> represents a tabulation.</li><li class="listitem"><span class="strong"><strong class="calibre2">Variable expanding</strong></span>: This <a id="id137" class="calibre1"/>allows you to include variable references inside the string, and PHP replaces them by their current value. You have to include the <code class="email">$</code> sign too.</li></ul></div><p class="calibre8">Have a look at the following example:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$firstname = 'Hiro';
$surname = 'Nakamura';
<span class="strong"><strong class="calibre2">echo "My name is $firstname $surname.\nI am a master of time and space. \"Yatta!\"";</strong></span>
</pre></div><p class="calibre8">The preceding piece of code will print the following in the browser:</p><div class="informalexample"><pre class="programlisting">My name is Hiro Nakamura.
I am a master of time and space. "Yatta!"</pre></div><p class="calibre8">Here, <code class="email">\n</code> inserted a new line. <code class="email">\"</code> added the double quotes (you need to escape them too, as PHP would understand that you want to end your string), and the variables <code class="email">$firstname</code> and <code class="email">$surname</code> were replaced by their values.</p></div>

<div id="page" style="height:0pt"/><div class="book" title="Arrays"><div class="book" id="PNV62-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec21" class="calibre1"/>Arrays</h1></div></div></div><p class="calibre8">If you have <a id="id138" class="calibre1"/>some experience with other programming languages or data structures in general, you might be aware of two data structures that are very common and useful: <span class="strong"><strong class="calibre2">lists</strong></span> <a id="id139" class="calibre1"/>and <a id="id140" class="calibre1"/>
<span class="strong"><strong class="calibre2">maps</strong></span>. A list is an ordered set of elements, whereas a map is a set of elements identified by keys. Let's see an example:</p><div class="informalexample"><pre class="programlisting">List: ["Harry", "Ron", "Hermione"]

Map: {
  "name": "James Potter",
  "status": "dead"
}</pre></div><p class="calibre8">The first element is a list of names that contains three values: <code class="email">Harry</code>, <code class="email">Ron</code>, and <code class="email">Hermione</code>. The second one is a map, and it defines two values: <code class="email">James Potter</code> and <code class="email">dead</code>. Each of these two values is identified with a key: <code class="email">name</code> and <code class="email">status</code> respectively.</p><p class="calibre8">In PHP, we do not have lists and maps; we have arrays. An array is a data structure that implements both, a list and a map.</p></div>

<div class="book" title="Arrays">
<div class="book" title="Initializing arrays"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec34" class="calibre1"/>Initializing arrays</h2></div></div></div><p class="calibre8">You have different options for initializing<a id="id141" class="calibre1"/> an array. You can initialize an empty array, or you can initialize an array with data. There are different ways of writing the same data with arrays too. Let's see some examples:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$empty1 = [];
$empty2 = array();
$names1 = ['Harry', 'Ron', 'Hermione'];
$names2 = array('Harry', 'Ron', 'Hermione');
$status1 = [
    'name' =&gt; 'James Potter',
    'status' =&gt; 'dead'
];
$status2 = array(
    'name' =&gt; 'James Potter',
    'status' =&gt; 'dead'
);</pre></div><p class="calibre8">In the preceding example, we define the list and map from the previous section. <code class="email">$names1</code> and <code class="email">$names2</code> are exactly the same array, just using a different notation. The same happens with <code class="email">$status1</code> and <code class="email">$status2</code>. Finally, <code class="email">$empty1</code> and <code class="email">$empty2</code> are two ways of creating an empty array.</p><p class="calibre8">Later you will see that lists are handled like maps. Internally, the array <code class="email">$names1</code> is a map, and its keys are ordered numbers. In this case, another initialization for <code class="email">$names1</code> that leads to the same array could be as follows:</p><div class="informalexample"><pre class="programlisting">$names1 = [
    0 =&gt; 'Harry',
    1 =&gt; 'Ron',
    2 =&gt; 'Hermione'
];</pre></div><p class="calibre8">Keys of an array can be any alphanumeric value, like strings or numbers. Values of an array can be anything: strings, numbers, Booleans, other arrays, and so on. You could have something like the following:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$books = [
    '1984' =&gt; [
        'author' =&gt; 'George Orwell',
        'finished' =&gt; true,
        'rate' =&gt; 9.5
    ],
    'Romeo and Juliet' =&gt; [
        'author' =&gt; 'William Shakespeare',
        'finished' =&gt; false
    ]
];</pre></div><p class="calibre8">This array is a list that contains two <a id="id142" class="calibre1"/>arrays—maps. Each map contains different values like strings, doubles, and Booleans.</p></div></div>

<div class="book" title="Arrays">
<div class="book" title="Populating arrays"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec35" class="calibre1"/>Populating arrays</h2></div></div></div><p class="calibre8">Arrays are not immutable, that is, they<a id="id143" class="calibre1"/> can change after being initialized. You can change the content of an array either by treating it as a map or as a list. Treating it as a map means that you specify the key that you want to override, whereas treating it as a list means appending another element to the end of the array:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$names = ['Harry', 'Ron', 'Hermione'];
$status = [
    'name' =&gt; 'James Potter',
    'status' =&gt; 'dead'
];
<span class="strong"><strong class="calibre2">$names[] = 'Neville';</strong></span>
<span class="strong"><strong class="calibre2">$status['age'] = 32;</strong></span>
print_r($names, $status);</pre></div><p class="calibre8">In the preceding example, the first highlighted line appends the name <code class="email">Neville</code> to the list of names, hence the list will look like <span class="strong"><em class="calibre12">['Harry', 'Ron', 'Hermione', 'Neville']</em></span>. The second change actually adds a new key-value to the array. You can check the result from your browser by using the function <code class="email">print_r</code>. It does something similar to <code class="email">var_dump</code>, just without the type and size of each value.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note05" class="calibre1"/>Note</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">print_r and var_dump in a browser</strong></span>
</p><p class="calibre8">When printing the content of an array, it is useful to see one key-value per line, but if you check your browser, you will see that it displays the whole array in one line. That happens because what the browser tries to display is HTML, and it ignores new lines or whitespaces. To check the content of the array as PHP wants you to see it, check the source code of the page—you will see the option by right-clicking on the page.</p></div><p class="calibre8">If you need to remove an element from the array, instead of adding or updating one, you can use the <code class="email">unset</code> function:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$status = [
    'name' =&gt; 'James Potter',
    'status' =&gt; 'dead'
];
<span class="strong"><strong class="calibre2">unset($status['status']);</strong></span>
print_r ($status);</pre></div><p class="calibre8">The new <code class="email">$status</code> array <a id="id144" class="calibre1"/>contains the key name only.</p></div></div>

<div class="book" title="Arrays">
<div class="book" title="Accessing arrays"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec36" class="calibre1"/>Accessing arrays</h2></div></div></div><p class="calibre8">Accessing<a id="id145" class="calibre1"/> an array is as easy as specifying the key as when you were updating it. For that, you need to understand how lists work. You already know that lists are treated internally as a map with numeric keys in order. The first key is always 0; so, an array with <span class="strong"><em class="calibre12">n</em></span> elements will have keys from 0 to <span class="strong"><em class="calibre12">n-1</em></span>.</p><p class="calibre8">You can add any key to a given array, even if it previously consisted of numeric entries. The problem arises when adding numeric keys, and later, you try to append an element to the array. What do you think will happen?</p><div class="informalexample"><pre class="programlisting">&lt;?php
$names = ['Harry', 'Ron', 'Hermione'];
$names['badguy'] = 'Voldemort';
$names[8] = 'Snape';
<span class="strong"><strong class="calibre2">$names[] = 'McGonagall';</strong></span>
print_r($names);</pre></div><p class="calibre8">The result of that last piece of code is as follows:</p><div class="informalexample"><pre class="programlisting">Array
(
    [0] =&gt; Harry
    [1] =&gt; Ron
    [2] =&gt; Hermione
    [badguy] =&gt; Voldemort
    [8] =&gt; Snape
    [9] =&gt; McGonagall
)</pre></div><p class="calibre8">When trying to append a value, PHP inserts it after the last numeric key, in this case <code class="email">8</code>.</p><p class="calibre8">You might've already figured it out by yourself, but you can always print any part of the array by specifying its key:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$names = ['Harry', 'Ron', 'Hermione'];
<span class="strong"><strong class="calibre2">print_r($names[1]); // prints 'Ron'</strong></span>
</pre></div><p class="calibre8">Finally, trying to access a key that does not exist in an array will return you a null and throw a notice, as PHP identifies that you are doing something wrong in your code.</p><div class="informalexample"><pre class="programlisting">&lt;?php
$names = ['Harry', 'Ron', 'Hermione'];
<span class="strong"><strong class="calibre2">var_dump($names[4]); // null and a PHP notice</strong></span>
</pre></div></div></div>

<div class="book" title="Arrays">
<div class="book" title="The empty and isset functions"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec37" class="calibre1"/>The empty and isset functions</h2></div></div></div><p class="calibre8">There are two useful <a id="id146" class="calibre1"/>functions for enquiring about the content of an array. If you want to know if an array contains any element at all, you can ask if it is empty with the <code class="email">empty</code> function. That function actually <a id="id147" class="calibre1"/>works with strings too, an empty string being a string <a id="id148" class="calibre1"/>with no characters (' '). The <code class="email">isset</code> function<a id="id149" class="calibre1"/> takes an array position, and returns <code class="email">true</code> or <code class="email">false</code> depending on whether that position exists or not:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$string = '';
$array = [];
$names = ['Harry', 'Ron', 'Hermione'];
var_dump(empty($string)); // true
var_dump(empty($array)); // true
var_dump(empty($names)); // false
var_dump(isset($names[2])); // true
var_dump(isset($names[3])); // false</pre></div><p class="calibre8">In the preceding example, we can see that an array with no elements or a string with no characters will return <code class="email">true</code> when asked if it is empty, and <code class="email">false</code> otherwise. When we use <code class="email">isset($names[2])</code> to check if the position 2 of the array exists, we get <code class="email">true</code>, as there is a value for that key: <code class="email">Hermione</code>. Finally, <code class="email">isset($names[3])</code> evaluates to <code class="email">false</code> as the key 3 does not exist in that array.</p></div></div>

<div class="book" title="Arrays">
<div class="book" title="Searching for elements in an array"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch03lvl2sec38" class="calibre1"/>Searching for elements in an array</h2></div></div></div><p class="calibre8">Probably, one of the <a id="id150" class="calibre1"/>most used functions with arrays is <code class="email">in_array</code>. This <a id="id151" class="calibre1"/>function takes two values, the value that you want to search for and the array. The function returns <code class="email">true</code> if the value is in the array and <code class="email">false</code> otherwise. This is very useful, because a lot of times what you want to know from a list or a map is if it contains an element, rather than knowing that it does or its location.</p><p class="calibre8">Even more useful sometimes is <code class="email">array_search</code>. This function works in the same way except that instead of returning a Boolean, it returns the key where the value is found, or <code class="email">false</code> otherwise. Let's see both functions:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$names = ['Harry', 'Ron', 'Hermione'];
<span class="strong"><strong class="calibre2">$containsHermione = in_array('Hermione', $names);</strong></span>
var_dump($containsHermione); // true
<span class="strong"><strong class="calibre2">$containsSnape = in_array('Snape', $names);</strong></span>
var_dump($containsSnape); // false
<span class="strong"><strong class="calibre2">$wheresRon = array_search('Ron', $names);</strong></span>
var_dump($wheresRon); // 1
<span class="strong"><strong class="calibre2">$wheresVoldemort = array_search('Voldemort', $names);</strong></span>
var_dump($wheresVoldemort); // false</pre></div></div></div>

<div class="book" title="Arrays">
<div class="book" title="Ordering arrays"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_6"><a id="ch03lvl2sec39" class="calibre1"/>Ordering arrays</h2></div></div></div><p class="calibre8">An array <a id="id152" class="calibre1"/>can be sorted in different ways, so there are a lot of chances that the order that you need is different from the current one. By default, the array is sorted by the order in which the elements were added to it, but you can sort an array by its key or by its value, both ascending and descending. Furthermore, when sorting an array by its values, you can choose to preserve their keys or to generate new ones as a list.</p><p class="calibre8">There is a complete list of these functions<a id="id153" class="calibre1"/> on the official documentation website at <a class="calibre1" href="http://php.net/manual/en/array.sorting.php">http://php.net/manual/en/array.sorting.php</a>, but here we will display the most important ones:</p><div class="informalexample"><table border="1" class="calibre15"><colgroup class="calibre16"><col class="calibre17"/><col class="calibre17"/><col class="calibre17"/><col class="calibre17"/></colgroup><thead class="calibre18"><tr class="calibre19"><th valign="bottom" class="calibre20">
<p class="calibre21">Name</p>
</th><th valign="bottom" class="calibre20">
<p class="calibre21">Sorts by</p>
</th><th valign="bottom" class="calibre20">
<p class="calibre21">Maintains key association</p>
</th><th valign="bottom" class="calibre20">
<p class="calibre21">Order of sort</p>
</th></tr></thead><tbody class="calibre22"><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">sort</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Value</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">No</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Low to high</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">rsort</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Value</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">No</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">High to low</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">asort</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Value</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Yes</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Low to high</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">arsort</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Value</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Yes</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">High to low</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">ksort</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Key</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Yes</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Low to high</p>
</td></tr><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">
<code class="literal">krsort</code>
</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Key</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">Yes</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">High to low</p>
</td></tr></tbody></table></div><p class="calibre8">These functions always take one argument, the array, and they do not return anything. Instead, they directly sort the array we pass to them. Let's see some of them:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$properties = [
    'firstname' =&gt; 'Tom',
    'surname' =&gt; 'Riddle',
    'house' =&gt; 'Slytherin'
];
$properties1 = $properties2 = $properties3 = $properties;
<span class="strong"><strong class="calibre2">sort($properties1);</strong></span>
var_dump($properties1);
<span class="strong"><strong class="calibre2">asort($properties3);</strong></span>
var_dump($properties3);
<span class="strong"><strong class="calibre2">ksort($properties2);</strong></span>
var_dump($properties2);</pre></div><p class="calibre8">Okay, there is a lot<a id="id154" class="calibre1"/> going on in the last example. First of all, we initialize an array with some key values and assign it to <code class="email">$properties</code>. Then we create three variables that are copies of the original array—the syntax should be intuitive. Why do we do that? Because if we sort the original array, we will not have the original content any more. This is not what we want in this specific example, as we want to see how the different sort functions affect the same array. Finally, we perform three different sorts, and print each of the results. The browser should show you something like the following:</p><div class="informalexample"><pre class="programlisting">array(3) {
  [0]=&gt;
  string(6) "Riddle"
  [1]=&gt;
  string(9) "Slytherin"
  [2]=&gt;
  string(3) "Tom"
}
array(3) {
  ["surname"]=&gt;
  string(6) "Riddle"
  ["house"]=&gt;
  string(9) "Slytherin"
  ["firstname"]=&gt;
  string(3) "Tom"
}
array(3) {
  ["firstname"]=&gt;
  string(3) "Tom"
  ["house"]=&gt;
  string(9) "Slytherin"
  ["surname"]=&gt;
  string(6) "Riddle"
}</pre></div><p class="calibre8">The first function, <code class="email">sort</code>, orders the values alphabetically. Also, if you check the keys, now they are numeric as in a list, instead of the original keys. Instead, <code class="email">asort</code> orders the values in the same way, but keeps the association of key-values. Finally, <code class="email">ksort</code> orders the elements by their keys, alphabetically.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="tip06" class="calibre1"/>Tip</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">How to remember so many function names</strong></span>
</p><p class="calibre8">PHP has a lot of function helpers that will save you from writing customized functions by yourself, for example, it provides you with up to 13 different sorting functions. And you can always rely on the official documentation. But, of course, you would like to write code without going back and forth from the docs. So, here are some tips to remember what each sorting function does:</p><div class="book"><ul class="itemizedlist"><li class="listitem">An <code class="email">a</code> in the name means <span class="strong"><strong class="calibre2">associative</strong></span>, and thus, will preserve the key-value association.</li><li class="listitem">An <code class="email">r</code> in the name means <span class="strong"><strong class="calibre2">reverse</strong></span>, so the order will be from high to low.</li><li class="listitem">A <code class="email">k</code> means <span class="strong"><strong class="calibre2">key</strong></span>, so the sorting will be based on the keys instead of the values.</li></ul></div></div></div></div>

<div class="book" title="Arrays">
<div class="book" title="Other array functions"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_7"><a id="ch03lvl2sec40" class="calibre1"/>Other array functions</h2></div></div></div><p class="calibre8">There are around 80 <a id="id155" class="calibre1"/>different functions related to arrays. As you can imagine, you will never even hear about some of them, as they have very specific purposes. The complete list can be<a id="id156" class="calibre1"/> found at <a class="calibre1" href="http://php.net/manual/en/book.array.php">http://php.net/manual/en/book.array.php</a>.</p><p class="calibre8">We can get a list of the keys of the array with <code class="email">array_keys</code>, and a list of its values with <code class="email">array_values</code>:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$properties = [
    'firstname' =&gt; 'Tom',
    'surname' =&gt; 'Riddle',
    'house' =&gt; 'Slytherin'
];
<span class="strong"><strong class="calibre2">$keys = array_keys($properties);</strong></span>
var_dump($keys);
<span class="strong"><strong class="calibre2">$values = array_values($properties);</strong></span>
var_dump($values);</pre></div><p class="calibre8">We can get the number of elements in an array with the <code class="email">count</code> function:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$names = ['Harry', 'Ron', 'Hermione'];
<span class="strong"><strong class="calibre2">$size = count($names);</strong></span>
var_dump($size); // 3</pre></div><p class="calibre8">And we can merge two or more arrays into one with <code class="email">array_merge</code>:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$good = ['Harry', 'Ron', 'Hermione'];
$bad = ['Dudley', 'Vernon', 'Petunia'];
<span class="strong"><strong class="calibre2">$all = array_merge($good, $bad);</strong></span>
var_dump($all);</pre></div><p class="calibre8">The last example will print the following array:</p><div class="informalexample"><pre class="programlisting">array(6) {
  [0]=&gt;
  string(5) "Harry"
  [1]=&gt;
  string(3) "Ron"
  [2]=&gt;
  string(8) "Hermione"
  [3]=&gt;
  string(6) "Dudley"
  [4]=&gt;
  string(6) "Vernon"
  [5]=&gt;
  string(7) "Petunia"
}</pre></div><p class="calibre8">As you can see, the<a id="id157" class="calibre1"/> keys of the second array are now different, as originally, both the arrays had the same numeric keys, and an array cannot have two values for the same key.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="PHP in web applications"><div class="book" id="QMFO2-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec22" class="calibre1"/>PHP in web applications</h1></div></div></div><p class="calibre8">Even though the main purpose of<a id="id158" class="calibre1"/> this chapter is to show you the basics of PHP, doing it in a reference-manual kind of a way is not interesting enough, and if we were to copy-paste what the official documentation says, you might as well go there and read it by yourself. Keeping in mind the main purpose of this book and your main goal is to write web applications with PHP, let us show you how to apply everything you are learning as soon as possible, before you get too bored.</p><p class="calibre8">In order to do that, we will now start on a journey towards building an online bookstore. At the very beginning, you might not see the usefulness of it, but that is just because we've still not shown all that PHP can do.</p></div>

<div class="book" title="PHP in web applications">
<div class="book" title="Getting information from the user"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec41" class="calibre1"/>Getting information from the user</h2></div></div></div><p class="calibre8">Let's start by building a home<a id="id159" class="calibre1"/> page. In this page, we are going to figure out if the user is looking for a book or just walking by. How do we find that out? The easiest way right now is to inspect the URL that the user used to access our application, and extract some information from there.</p><p class="calibre8">Save this content as your <code class="email">index.php</code>:</p><div class="informalexample"><pre class="programlisting">&lt;?php
<span class="strong"><strong class="calibre2">$looking = isset($_GET['title']) || isset($_GET['author']);</strong></span>
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Bookstore&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
<span class="strong"><strong class="calibre2">    &lt;p&gt;You lookin'? &lt;?php echo (int) $looking; ?&gt;&lt;/p&gt;</strong></span>
    &lt;p&gt;The book you are looking for is&lt;/p&gt;
    &lt;ul&gt;
        &lt;li&gt;&lt;b&gt;Title&lt;/b&gt;: &lt;?php echo $_GET['title']; ?&gt;&lt;/li&gt;
        &lt;li&gt;&lt;b&gt;Author&lt;/b&gt;: &lt;?php echo $_GET['author']; ?&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><p class="calibre8">Now access the <a id="id160" class="calibre1"/>link, <code class="email">http://localhost:8000/?author=HarperLee&amp;title=To Kill a Mockingbird</code>. You will see that the page prints some of the information that you passed on to the URL.</p><p class="calibre8">For each request, PHP stores all the parameters that come from the query string in an array called <code class="email">$_GET</code>. Each key of the array is the name of the parameter, and its associated value is the value of the parameter. So <code class="email">$_GET</code> contains two entries: <code class="email">$_GET['author']</code> contains <code class="email">Harper Lee</code> and <code class="email">$_GET['title']</code> has the value <code class="email">To Kill a Mockingbird</code>.</p><p class="calibre8">In the first highlighted line, we assign a Boolean value to the variable <code class="email">$looking</code>. If either <code class="email">$_GET['title']</code> or <code class="email">$_GET['author']</code> exists, that variable will be <code class="email">true</code>, otherwise <code class="email">false</code>. Just after that, we close the PHP tag and then we print some HTML, but as you can see, we are actually mixing the HTML with some PHP code.</p><p class="calibre8">Another interesting line here is the second highlighted one. Before printing the content of <code class="email">$looking</code>, we cast the value. <span class="strong"><strong class="calibre2">Casting</strong></span>
<a id="id161" class="calibre1"/> means forcing PHP to transform a type of value to another one. Casting a Boolean to an integer means that the resultant value will be <code class="email">1</code> if the Boolean is <code class="email">true</code> or <code class="email">0</code> if the Boolean is <code class="email">false</code>. As <code class="email">$looking</code> is <code class="email">true</code> since <code class="email">$_GET</code> contains valid keys, the page shows a "1".</p><p class="calibre8">If we try to access the same page without sending any information, as in <code class="email">http://localhost:8000</code>, the browser will say <span class="strong"><strong class="calibre2">Are you looking for a book? 0</strong></span>. Depending on the settings of your PHP configuration, you will see two notice messages complaining that you are trying to access keys of the array that do not exist.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note06" class="calibre1"/>Note</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">Casting versus type juggling</strong></span>
</p><p class="calibre8">We already<a id="id162" class="calibre1"/> know that when PHP needs a specific type of<a id="id163" class="calibre1"/> variable, it will try to transform it, which is called type juggling. But PHP is quite flexible, so sometimes, you have to be the one specifying the type that you need. When printing something with <code class="email">echo</code>, PHP tries to transform everything it gets into strings. Since the string version of the Boolean <code class="email">false</code> is an empty string, that would not be useful <a id="id164" class="calibre1"/>for our application. Casting the Boolean to <a id="id165" class="calibre1"/>an integer first assures that we will see a value, even if it is just a 0.</p></div></div></div>

<div class="book" title="PHP in web applications">
<div class="book" title="HTML forms"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec42" class="calibre1"/>HTML forms</h2></div></div></div><p class="calibre8">HTML forms <a id="id166" class="calibre1"/>are one of the most popular ways of collecting information from the user. They <a id="id167" class="calibre1"/>consist of a series of fields—called <code class="email">input</code> in the HTML world—and a final <code class="email">submit</code> button. In HTML, the <code class="email">form</code> tag contains two attributes: <code class="email">action</code> points where the form will be submitted, and <code class="email">method</code>, which specifies the HTTP method that the form will use (GET or POST). Let's see how it works. Save the following content as <code class="email">login.html</code> and go to <code class="email">http://localhost:8000/login.html</code>.</p><div class="informalexample"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Bookstore - Login&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;p&gt;Enter your details to login:&lt;/p&gt;
<span class="strong"><strong class="calibre2">    &lt;form action="authenticate.php" method="post"&gt;</strong></span>
        &lt;label&gt;Username&lt;/label&gt;
<span class="strong"><strong class="calibre2">       &lt;input type="text" name="username" /&gt;</strong></span>
        &lt;label&gt;Password&lt;/label&gt;
<span class="strong"><strong class="calibre2">       &lt;input type="password" name="password" /&gt;</strong></span>
<span class="strong"><strong class="calibre2">        &lt;input type="submit" value="Login"/&gt;</strong></span>
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><p class="calibre8">The form defined in the preceding code contains two fields, one for the username and one for the password. You can see that they are identified by the attribute name. If you try to submit this form, the browser will show you a <span class="strong"><strong class="calibre2">Page Not Found</strong></span> message, as it is trying to access <code class="email">http://localhost:8000/authenticate.php</code> and the web server cannot find it. Let's create it then:</p><div class="informalexample"><pre class="programlisting">&lt;?php
<span class="strong"><strong class="calibre2">$submitted = !empty($_POST);</strong></span>
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Bookstore&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;p&gt;Form submitted? &lt;?php echo (int) $submitted; ?&gt;&lt;/p&gt;
    &lt;p&gt;Your login info is&lt;/p&gt;
    &lt;ul&gt;
        &lt;li&gt;&lt;b&gt;username&lt;/b&gt;: &lt;?php echo $_POST['username']; ?&gt;&lt;/li&gt;
        &lt;li&gt;&lt;b&gt;password&lt;/b&gt;: &lt;?php echo $_POST['password']; ?&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><p class="calibre8">As with <code class="email">$_GET</code>, <code class="email">$_POST</code> is an<a id="id168" class="calibre1"/> array that contains the parameters received by<a id="id169" class="calibre1"/> POST. In this preceding piece of code, we first ask if that array is not empty—note the <code class="email">!</code> operator. Afterwards, we just display the information received, just as in <code class="email">index.php</code>. Notice that the keys of the <code class="email">$_POST</code> array are the values for the argument name of each input field.</p></div></div>

<div class="book" title="PHP in web applications">
<div class="book" title="Persisting data with cookies"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec43" class="calibre1"/>Persisting data with cookies</h2></div></div></div><p class="calibre8">When we want the browser to<a id="id170" class="calibre1"/> remember some data like whether you are logged in or not on your web application, your basic info, and<a id="id171" class="calibre1"/> so on, we use <span class="strong"><strong class="calibre2">cookies</strong></span>. Cookies are stored on the <a id="id172" class="calibre1"/>client side and are sent to the server when making a request as headers. As PHP is oriented towards web applications, it allows you to manage cookies in a very easy way.</p><p class="calibre8">There are few things you need to know about cookies and PHP. You can write cookies with the <code class="email">setcookie</code> function that accepts several arguments:</p><div class="book"><ul class="itemizedlist"><li class="listitem">A valid name for the cookie as a string.</li><li class="listitem">The value of the cookie—only strings or values that can be casted to a string. This parameter is optional, and if not set, PHP will actually remove the cookie.</li><li class="listitem">Expiration time as a timestamp. If not set, the cookie will be removed once the browser is closed.</li></ul></div><div class="informalexample" title="Note"><h3 class="title2"><a id="note07" class="calibre1"/>Note</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">Timestamps</strong></span>
</p><p class="calibre8">Computers use<a id="id173" class="calibre1"/> different ways for describing dates and times, and a very common one, especially on Unix systems, is the use of timestamps. They represent the number of seconds passed since January 1, 1970. For example, the timestamp that represents October 4, 2015 at 6:30 p.m. would be 1,443,954,637, which is the number of seconds since that date.</p><p class="calibre8">You can get the current timestamp with PHP using the <code class="email">time</code> function.</p></div><p class="calibre8">There are other arguments related to security, but they are out of the scope of this section. Also note that you can only set cookies if there is no previous output from your application, that is, before HTML, <code class="email">echo</code> calls, and any other similar functions that send some output.</p><p class="calibre8">To read the cookies that the client sends to us, we just need to access the array, <code class="email">$_COOKIE</code>. It works as the other two arrays, so the keys of the array will be the name of the cookies and the value of the array will be their values.</p><p class="calibre8">A very common usage for <a id="id174" class="calibre1"/>cookies is authenticating the user. There are several <a id="id175" class="calibre1"/>different ways of doing so, depending on the level of security you need for your application. Let's try to implement one very simple—albeit insecure one (do not use it for live web applications). Leaving the HTML intact, update the PHP part of your <code class="email">authenticate.php</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;?php
<span class="strong"><strong class="calibre2">setcookie('username', $_POST['username']);</strong></span>
$submitted = !empty($_POST);
?&gt;</pre></div><p class="calibre8">Do the same with the <code class="email">body</code> tag in your <code class="email">index.php</code>:</p><div class="informalexample"><pre class="programlisting">&lt;body&gt;
<span class="strong"><strong class="calibre2">    &lt;p&gt;You are &lt;?php echo $_COOKIE['username']; ?&gt;&lt;/p&gt;</strong></span>
    &lt;p&gt;Are you looking for a book? &lt;?php echo (int) $lookingForBook; ?&gt;&lt;/p&gt;
    &lt;p&gt;The book you are looking for is&lt;/p&gt;
    &lt;ul&gt;
        &lt;li&gt;&lt;b&gt;Title&lt;/b&gt;: &lt;?php echo $_GET['title']; ?&gt;&lt;/li&gt;
        &lt;li&gt;&lt;b&gt;Author&lt;/b&gt;: &lt;?php echo $_GET['author']; ?&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/body&gt;</pre></div><p class="calibre8">If you access <code class="email">http://localhost:8000/login.html</code> again, try to log in, open a new tab (in the same browser), and go to the home page at <code class="email">http://localhost:8000</code>, you will see how the browser still remembers your username.</p></div></div>

<div class="book" title="PHP in web applications">
<div class="book" title="Other superglobals"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec44" class="calibre1"/>Other superglobals</h2></div></div></div><p class="calibre8">
<code class="email">$_GET</code>, <code class="email">$_POST</code>, and <code class="email">$_COOKIE</code> are special variables called <a id="id176" class="calibre1"/>
<span class="strong"><strong class="calibre2">superglobals</strong></span>. There are other superglobals too, like <code class="email">$_SERVER</code> or <code class="email">$_ENV</code>, which will give you extra information. The first one shows you information about headers, paths accessed, and other information related to the request. The second one contains the environment variables of the machine where your application is running. You can see the full list of these arrays and their elements at <a class="calibre1" href="http://php.net/manual/es/language.variables.superglobals.php">http://php.net/manual/es/language.variables.superglobals.php</a>.</p><p class="calibre8">In general, using <a id="id177" class="calibre1"/>superglobals is useful, since it allows you to get information from the user, the browser, the request, and so on. This is of immeasurable value when writing web applications that need to interact with the user. But with great power comes great responsibility, and you should be very careful when using these arrays. Most of those values come from the users themselves, which could lead to security issues.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Control structures"><div class="book" id="RL0A2-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec23" class="calibre1"/>Control structures</h1></div></div></div><p class="calibre8">So far, our<a id="id178" class="calibre1"/> files have been executed line by line. Due to that, we have been getting notices on some scenarios, such as when the array does not contain what we are looking for. Would it not be nice if we could choose which lines to execute? Control structures to the rescue!</p><p class="calibre8">A <span class="strong"><strong class="calibre2">control structure</strong></span> is like a traffic diversion sign. It directs the execution flow depending on some predefined conditions. There are different control structures, but we can categorize them in <span class="strong"><strong class="calibre2">conditionals</strong></span>
<a id="id179" class="calibre1"/> and <a id="id180" class="calibre1"/>
<span class="strong"><strong class="calibre2">loops</strong></span>. A conditional allows us to choose whether to execute a statement or not. A loop executes a statement as many times as you need. Let's take a look at each one of them.</p></div>

<div class="book" title="Control structures">
<div class="book" title="Conditionals"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec45" class="calibre1"/>Conditionals</h2></div></div></div><p class="calibre8">A conditional<a id="id181" class="calibre1"/> evaluates a <a id="id182" class="calibre1"/>Boolean expression, that is, something that returns a value. If the expression is <code class="email">true</code>, it will execute everything inside its block of code. A block of code is a group of statements enclosed by <code class="email">{}</code>. Let's see how it works:</p><div class="informalexample"><pre class="programlisting">&lt;?php
echo "Before the conditional.";
<span class="strong"><strong class="calibre2">if (4 &gt; 3) {</strong></span>
<span class="strong"><strong class="calibre2">    echo "Inside the conditional.";</strong></span>
<span class="strong"><strong class="calibre2">}</strong></span>
<span class="strong"><strong class="calibre2">if (3 &gt; 4) {</strong></span>
<span class="strong"><strong class="calibre2">    echo "This will not be printed.";</strong></span>
<span class="strong"><strong class="calibre2">}</strong></span>
echo "After the conditional.";</pre></div><p class="calibre8">In the preceding piece of code, we use two conditionals. A conditional is defined by the keyword <code class="email">if</code> followed by a Boolean expression in parentheses and by a block of code. If the expression is <code class="email">true</code>, it will execute the block, otherwise it will skip it.</p><p class="calibre8">You can increase the power of conditionals by adding the keyword <code class="email">else</code>. This tells PHP to execute some block of code if the previous conditions were not satisfied. Let's see an example:</p><div class="informalexample"><pre class="programlisting">if (2 &gt; 3) {
    echo "Inside the conditional.";
<span class="strong"><strong class="calibre2">} else {</strong></span>
<span class="strong"><strong class="calibre2">    echo "Inside the else.";</strong></span>
}</pre></div><p class="calibre8">The preceding example will execute the code inside the <code class="email">else</code> as the condition of the <code class="email">if</code> was not satisfied.</p><p class="calibre8">Finally, you can<a id="id183" class="calibre1"/> also add an <code class="email">elseif</code> keyword followed by another <a id="id184" class="calibre1"/>condition and a block of code to continue asking PHP for more conditions. You can add as many <code class="email">elseif</code> as you need after an <code class="email">if</code>. If you add an <code class="email">else</code>, it has to be the last one of the chain of conditions. Also keep in mind that as soon as PHP finds a condition that resolves to <code class="email">true</code>, it will stop evaluating the rest of conditions.</p><div class="informalexample"><pre class="programlisting">&lt;?php
if (4 &gt; 5) {
    echo "Not printed";
} elseif (4 &gt; 4) {
    echo "Not printed";
<span class="strong"><strong class="calibre2">} elseif (4 == 4) {</strong></span>
<span class="strong"><strong class="calibre2">    echo "Printed.";</strong></span>
} elseif (4 &gt; 2) {
    echo "Not evaluated.";
} else {
    echo "Not evaluated.";
}
if (4 == 4) {
    echo "Printed";
}</pre></div><p class="calibre8">In the last example, the first condition that evaluates to <code class="email">true</code> is the highlighted one. After that, PHP does not evaluate any more conditions until a new <code class="email">if</code> starts.</p><p class="calibre8">With this knowledge, let's try to clean up our application a bit, executing statements only when needed. Copy this code to your <code class="email">index.php</code> file:</p><div class="informalexample"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Bookstore&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;p&gt;
<span class="strong"><strong class="calibre2">&lt;?php</strong></span>
<span class="strong"><strong class="calibre2">if (isset($_COOKIE[username'])) {</strong></span>
<span class="strong"><strong class="calibre2">    echo "You are " . $_COOKIE['username'];</strong></span>
<span class="strong"><strong class="calibre2">} else {</strong></span>
<span class="strong"><strong class="calibre2">    echo "You are not authenticated.";</strong></span>
<span class="strong"><strong class="calibre2">}</strong></span>
<span class="strong"><strong class="calibre2">?&gt;</strong></span>
    &lt;/p&gt;
<span class="strong"><strong class="calibre2">&lt;?php</strong></span>
<span class="strong"><strong class="calibre2">if (isset($_GET['title']) &amp;&amp; isset($_GET['author'])) {</strong></span>
<span class="strong"><strong class="calibre2">?&gt;</strong></span>
<span class="strong"><strong class="calibre2">    &lt;p&gt;The book you are looking for is&lt;/p&gt;</strong></span>
<span class="strong"><strong class="calibre2">    &lt;ul&gt;</strong></span>
<span class="strong"><strong class="calibre2">        &lt;li&gt;&lt;b&gt;Title&lt;/b&gt;: &lt;?php echo $_GET['title']; ?&gt;&lt;/li&gt;</strong></span>
<span class="strong"><strong class="calibre2">        &lt;li&gt;&lt;b&gt;Author&lt;/b&gt;: &lt;?php echo $_GET['author']; ?&gt;&lt;/li&gt;</strong></span>
<span class="strong"><strong class="calibre2">    &lt;/ul&gt;</strong></span>
<span class="strong"><strong class="calibre2">&lt;?php</strong></span>
<span class="strong"><strong class="calibre2">} else {</strong></span>
<span class="strong"><strong class="calibre2">?&gt;</strong></span>
<span class="strong"><strong class="calibre2">    &lt;p&gt;You are not looking for a book?&lt;/p&gt;</strong></span>
<span class="strong"><strong class="calibre2">&lt;?php</strong></span>
<span class="strong"><strong class="calibre2">}</strong></span>
<span class="strong"><strong class="calibre2">?&gt;</strong></span>
&lt;/body&gt;
&lt;/html&gt;</pre></div><p class="calibre8">In this new code, we <a id="id185" class="calibre1"/>have mixed conditionals and HTML code in two different <a id="id186" class="calibre1"/>ways. The first one opens a PHP tag, and adds an <code class="email">if…else</code> clause that will print whether we are authenticated or not with an <code class="email">echo</code>. No HTML is merged within the conditionals, which makes it clear.</p><p class="calibre8">The second option—the second highlighted block—shows an uglier solution, but sometimes necessary. When you have to print a lot of HTML code, <code class="email">echo</code> is not that handy, and it is better to close the PHP tag, print all HTML you need, and then open the tag again. You can do that even inside the code block of an <code class="email">if</code> clause as you can see in the code.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note08" class="calibre1"/>Note</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">Mixing PHP and HTML</strong></span>
</p><p class="calibre8">If you feel <a id="id187" class="calibre1"/>that the last file we edited looks rather ugly, you are right. Mixing PHP and HTML is confusing, and you should avoid it. In <a class="calibre1" title="Chapter 6. Adapting to MVC" href="part0056_split_000.html#1LCVG1-edcc22b134104d5db0bf3aa086c86851">Chapter 6</a>, <span class="strong"><em class="calibre12">Adapting to MVC</em></span>, we will see how to do things properly.</p></div><p class="calibre8">Let's edit our <code class="email">authenticate.php</code> file too, as it is trying to access the <code class="email">$_POST</code> entries that might not be there. The new content of the file would be as follows:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$submitted = isset($_POST['username']) &amp;&amp; isset($_POST['password']);
if ($submitted) {
    setcookie('username', $_POST['username']);
}
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Bookstore&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
<span class="strong"><strong class="calibre2">&lt;?php if ($submitted): ?&gt;</strong></span>
    &lt;p&gt;Your login info is&lt;/p&gt;
    &lt;ul&gt;
        &lt;li&gt;&lt;b&gt;username&lt;/b&gt;: &lt;?php echo $_POST['username']; ?&gt;&lt;/li&gt;
        &lt;li&gt;&lt;b&gt;password&lt;/b&gt;: &lt;?php echo $_POST['password']; ?&gt;&lt;/li&gt;
    &lt;/ul&gt;
<span class="strong"><strong class="calibre2">&lt;?php else: ?&gt;</strong></span>
    &lt;p&gt;You did not submit anything.&lt;/p&gt;
<span class="strong"><strong class="calibre2">&lt;?php endif; ?&gt;</strong></span>
&lt;/body&gt;
&lt;/html&gt;</pre></div><p class="calibre8">This code also<a id="id188" class="calibre1"/> contains conditionals, which we already know. We are setting a <a id="id189" class="calibre1"/>variable to know if we submitted a login or not, and set the cookies if so. But the highlighted lines show you a new way of including conditionals with HTML. This makes the code more readable when working with HTML code, avoiding the use of <code class="email">{}</code>, and instead using <code class="email">:</code> and <code class="email">endif</code>. Both syntaxes are correct, and you should use the one that you consider more readable in each case.</p></div></div>

<div class="book" title="Control structures">
<div class="book" title="Switch…case"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec46" class="calibre1"/>Switch…case</h2></div></div></div><p class="calibre8">Another control structure <a id="id190" class="calibre1"/>similar to <code class="email">if…else</code> is <code class="email">switch…case</code>. This structure <a id="id191" class="calibre1"/>evaluates only one expression, and executes the block depending on its value. Let's see an example:</p><div class="informalexample"><pre class="programlisting">&lt;?php
switch ($title) {
    case 'Harry Potter':
        echo "Nice story, a bit too long.";
        break;
    case 'Lord of the Rings':
        echo "A classic!";
        break;
    default:
        echo "Dunno that one.";
        break;
}</pre></div><p class="calibre8">The <code class="email">switch</code> clause takes an expression, in this case a variable, and then defines a series of cases. When the case matches the current value of the expression, PHP executes the code inside it. As soon as PHP finds a <code class="email">break</code> statement, it exits the <code class="email">switch…case</code>. In case none of the cases are suitable for the expression, PHP executes the default, if there is one, but that is optional.</p><p class="calibre8">You also need to know that breaks are mandatory if you want to exit the <code class="email">switch…case</code>. If you do not specify any, PHP will keep on executing statements, even if it encounters a new case. Let's see a similar example, but without the breaks:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$title = 'Twilight';
switch ($title) {
    case 'Harry Potter':
        echo "Nice story, a bit too long.";
    case 'Twilight':
        echo 'Uh...';
    case 'Lord of the Rings':
        echo "A classic!";
    default:
        echo "Dunno that one.";
}</pre></div><p class="calibre8">If you test this code in your browser, you will see that it prints <span class="strong"><strong class="calibre2">Uh...A classic! Dunno that one</strong></span>. PHP found that the second case is valid, so it executes its content. But as there are no breaks, it keeps on executing until the end. This might be the desired behavior sometimes but not usually, so be careful when using it!</p></div></div>

<div class="book" title="Control structures">
<div class="book" title="Loops"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec47" class="calibre1"/>Loops</h2></div></div></div><p class="calibre8">
<span class="strong"><strong class="calibre2">Loops</strong></span> are <a id="id192" class="calibre1"/>control structures that allow you to execute certain statements several times, as many<a id="id193" class="calibre1"/> times as you need. You might use them in several different scenarios, but the most common one is when interacting with arrays. For example, imagine you have an array with elements, but you do not know what is in it. You want to print all its elements, so you loop through all of them.</p><p class="calibre8">There are four types of loops. Each of them has its own use cases, but in general, you can transform one type of loop into another. Let's look at them closely.</p><div class="book" title="While"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch03lvl3sec06" class="calibre1"/>While</h3></div></div></div><p class="calibre8">The <code class="email">while</code> loop<a id="id194" class="calibre1"/> is the simplest of the loops. It executes a block of code until the expression to<a id="id195" class="calibre1"/> evaluate returns <code class="email">false</code>. Let's see one example:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$i = 1;
while ($i &lt; 4) {
    echo $i . " ";
    $i++;
}</pre></div><p class="calibre8">In the preceding example, we define a variable with value <code class="email">1</code>. Then we have a <code class="email">while</code> clause in which the expression to evaluate is <code class="email">$i &lt; 4</code>. This loop executes the content of the block of code until that expression is <code class="email">false</code>. As you can see, inside the loop we are incrementing the value of <code class="email">$i</code> by 1 each time, so the loop ends after 4 iterations. Check the output of that script and you will see "0 1 2 3". The last value printed is 3, so at that time the value of <code class="email">$i</code> was 3. After that, we increased its value to 4, so when the <code class="email">while</code> clause evaluates if <code class="email">$i &lt; 4</code>, the result is <code class="email">false</code>.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note09" class="calibre1"/>Note</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">Whiles and infinite loops</strong></span>
</p><p class="calibre8">One of the most<a id="id196" class="calibre1"/> common problems with the <code class="email">while</code> loops is creating an infinite loop. If you do not add any code inside the <code class="email">while</code> loop that updates any of the variables considered in the <code class="email">while</code> expression such that it can be <code class="email">false</code> at some point, PHP will never exit the loop!</p></div></div><div class="book" title="Do…while"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch03lvl3sec07" class="calibre1"/>Do…while</h3></div></div></div><p class="calibre8">The <code class="email">do…while</code> loop <a id="id197" class="calibre1"/>is very similar to <code class="email">while</code> in the sense that it evaluates an<a id="id198" class="calibre1"/> expression each time, and will execute the block of code until that expression is <code class="email">false</code>. The only difference is that when this expression is evaluated, the <code class="email">while</code> clause evaluates the expression before executing the code, so sometimes, we might not even enter the loop if the expression evaluates to <code class="email">false</code> the very first time. On the other hand, <code class="email">do…while</code> evaluates the expression after it executes its block of code, so even if the expression is <code class="email">false</code> from the very beginning, the loop will be executed at least once.</p><div class="informalexample"><pre class="programlisting">&lt;?php
echo "with while: ";
$i = 1;
while ($i &lt; 0) {
    echo $i . " ";
    $i++;
}
echo "with do-while: ";
$i = 1;
<span class="strong"><strong class="calibre2">do {</strong></span>
<span class="strong"><strong class="calibre2">    echo $i . " ";</strong></span>
<span class="strong"><strong class="calibre2">    $i++;</strong></span>
<span class="strong"><strong class="calibre2">} while ($i &lt; 0);</strong></span>
</pre></div><p class="calibre8">The preceding <a id="id199" class="calibre1"/>piece of code defines two loops with the same expression and block <a id="id200" class="calibre1"/>of code, but if you execute them, you will see that only the code inside the <code class="email">do…while</code> is executed. In both cases, the expression is <code class="email">false</code> since the beginning, so <code class="email">while</code> does not even enter the loop, whereas the <code class="email">do…while</code> enters the loop once.</p></div><div class="book" title="For"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch03lvl3sec08" class="calibre1"/>For</h3></div></div></div><p class="calibre8">The <code class="email">for</code> loop<a id="id201" class="calibre1"/> is the most complex of the four loops. It defines an initialization expression, an <a id="id202" class="calibre1"/>exit condition, and the end of an iteration expression. When PHP first encounters the loop, it executes what is defined as the initialization expression. Then, it evaluates the exit condition and if it resolves to <code class="email">true</code>, it enters the loop. After executing everything inside the loop, it executes the end of the iteration expression. Once done, it evaluates the end condition again, going through the loop code and the end of the iteration expression, until it evaluates to <code class="email">false</code>. As always, an example will clarify it:</p><div class="informalexample"><pre class="programlisting">&lt;?php
for ($i = 1; $i &lt; 10; $i++) {
    echo $i . " ";
}</pre></div><p class="calibre8">The initialization expression is <code class="email">$i = 1</code>, and is executed only the first time. The exit condition is <code class="email">$i &lt; 10</code>, and it is evaluated at the beginning of each iteration. The end of the iteration expression is <code class="email">$i++</code>, which is executed at the end of each iteration. This example prints the numbers from 1 to 9. Another more common usage of the <code class="email">for</code> loop is with arrays:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$names = ['Harry', 'Ron', 'Hermione'];
for ($i = 0; $i &lt; count($names); $i++) {
    echo $names[$i] . " ";
}</pre></div><p class="calibre8">In this example, we have <a id="id203" class="calibre1"/>an array of names. Since it is defined as a list, its keys will be 0, 1, and 2. The loop initializes the variable <code class="email">$i</code> to 0, and it iterates until the value of <code class="email">$i</code> is not<a id="id204" class="calibre1"/> less than the number of elements in the array, that is, 3. In the first iteration, <code class="email">$i</code> is 0, in the second, it is 1, and in the third one it is equal to 2. When <code class="email">$i</code> is 3, it will not enter the loop, as the exit condition evaluates to <code class="email">false</code>.</p><p class="calibre8">On each iteration, we print the content of the position <code class="email">$i</code> of the array, hence the result of this code will be all three names in the array.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="tip07" class="calibre1"/>Tip</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">Be careful with exit conditions</strong></span>
</p><p class="calibre8">It is very common to set an <a id="id205" class="calibre1"/>exit condition that is not exactly what we need, especially with arrays. Remember that arrays start with 0 if they are a list, so an array of three elements will have entries of 0, 1, and 2. Defining the exit condition as <code class="email">$i &lt;= count($array)</code> will cause an error in your code, as when <code class="email">$i</code> is 3, it also satisfies the exit condition and will try to access the key 3, which does not exist.</p></div></div><div class="book" title="Foreach"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch03lvl3sec09" class="calibre1"/>Foreach</h3></div></div></div><p class="calibre8">The last, but not least, type of <a id="id206" class="calibre1"/>loop is <code class="email">foreach</code>. This loop is exclusive for arrays, and it <a id="id207" class="calibre1"/>allows you to iterate an array entirely, even if you do not know its keys. There are two options for the syntax, as you can see in the following examples:</p><div class="informalexample"><pre class="programlisting">&lt;?php
$names = ['Harry', 'Ron', 'Hermione'];
foreach ($names as $name) {
    echo $name . " ";
}
foreach ($names as $key =&gt; $name) {
    echo $key . " -&gt; " . $name . " ";
}</pre></div><p class="calibre8">The <code class="email">foreach</code> loop accepts an array—in this case <code class="email">$names</code>—and it specifies a variable which will contain the value of the entry of the array. You can see that we do not need to specify any end condition, as PHP will know when the array has been iterated. Optionally, you can specify a variable that contains the key of each iteration, as in the second loop.</p><p class="calibre8">The <code class="email">foreach</code> loops are also useful with maps, where the keys are not necessarily numeric. The order in which PHP iterates the array will be the same order that you used to insert the contents in the array.</p><p class="calibre8">Let's use some loops <a id="id208" class="calibre1"/>in our application. We want to show the available books in our <a id="id209" class="calibre1"/>home page. We have the list of books in an array, so we will have to iterate all of them with a <code class="email">foreach</code> loop, printing some information from each one. Append the following code to the <code class="email">body</code> tag in <code class="email">index.php</code>:</p><div class="informalexample"><pre class="programlisting">&lt;?php endif;
    $books = [
        [
            'title' =&gt; 'To Kill A Mockingbird',
            'author' =&gt; 'Harper Lee',
            'available' =&gt; true,
            'pages' =&gt; 336,
            'isbn' =&gt; 9780061120084
        ],
        [
            'title' =&gt; '1984',
            'author' =&gt; 'George Orwell',
            'available' =&gt; true,
            'pages' =&gt; 267,
            'isbn' =&gt; 9780547249643
        ],
        [
            'title' =&gt; 'One Hundred Years Of Solitude',
            'author' =&gt; 'Gabriel Garcia Marquez',
            'available' =&gt; false,
            'pages' =&gt; 457,
            'isbn' =&gt; 9785267006323
        ],
    ];
?&gt;
&lt;ul&gt;
<span class="strong"><strong class="calibre2">&lt;?php foreach ($books as $book): ?&gt;</strong></span>
<span class="strong"><strong class="calibre2">        &lt;li&gt;</strong></span>
<span class="strong"><strong class="calibre2">            &lt;i&gt;&lt;?php echo $book['title']; ?&gt;&lt;/i&gt;</strong></span>
<span class="strong"><strong class="calibre2">            - &lt;?php echo $book['author']; ?&gt;</strong></span>
<span class="strong"><strong class="calibre2">&lt;?php if (!$book['available']): ?&gt;</strong></span>
<span class="strong"><strong class="calibre2">          &lt;b&gt;Not available&lt;/b&gt;</strong></span>
<span class="strong"><strong class="calibre2">&lt;?php endif; ?&gt;</strong></span>
<span class="strong"><strong class="calibre2">        &lt;/li&gt;</strong></span>
<span class="strong"><strong class="calibre2">&lt;?php endforeach; ?&gt;</strong></span>
    &lt;/ul&gt;</pre></div><p class="calibre8">The highlighted code shows a <code class="email">foreach</code> loop using the <code class="email">:</code> notation as well, which is better when mixing it with HTML. It iterates all of the <code class="email">$books</code> array, and for each book, it prints some information<a id="id210" class="calibre1"/> as an HTML list. Notice also that we have a conditional inside a<a id="id211" class="calibre1"/> loop, which is perfectly fine. Of course, this conditional will be executed for each entry in the array, so you should keep the block of code of your loops as simple as possible.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Functions"><div class="book" id="SJGS2-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec24" class="calibre1"/>Functions</h1></div></div></div><p class="calibre8">A function is a<a id="id212" class="calibre1"/> reusable block of code that, given an input, performs some actions and, optionally, returns some result. You already know several predefined functions like <code class="email">empty</code>, <code class="email">in_array</code>, or <code class="email">var_dump</code>. Those functions come with PHP so you do not have to reinvent the wheel, but you can create your own very easily. You can define functions when you identify portions of your application that have to be executed several times, or just to encapsulate some functionality.</p></div>

<div class="book" title="Functions">
<div class="book" title="Function declaration"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec48" class="calibre1"/>Function declaration</h2></div></div></div><p class="calibre8">Declaring a <a id="id213" class="calibre1"/>function means writing it down so it can be used later. A function has a name, takes some arguments, and has a block of code. Optionally, it can define what kind of value is to be returned. The name of the function has to follow the same rules as variable names, that is, it has to start with a letter or an underscore, and can contain any letters, numbers, or underscore. It cannot be a reserved word.</p><p class="calibre8">Let's see a simple example:</p><div class="informalexample"><pre class="programlisting">function addNumbers($a, $b) {
    $sum = $a + $b;
    return $sum;
}
<span class="strong"><strong class="calibre2">$result = addNumbers(2, 3);</strong></span>
</pre></div><p class="calibre8">The preceding function's name is <code class="email">addNumbers</code>, and it takes two arguments: <code class="email">$a</code> and <code class="email">$b</code>. The block of code defines a new variable <code class="email">$sum</code>, which is the sum of both arguments, and then returns its content with <code class="email">return</code>. In order to use this function, you just need to call it by its name while sending all the required arguments, as shown in the highlighted line.</p><p class="calibre8">PHP does not support<a id="id214" class="calibre1"/> <span class="strong"><strong class="calibre2">overloaded functions</strong></span>. Overloading refers to the ability of declaring two or more functions with the same name but different arguments. As you can see, you can declare the arguments without knowing what their types are, so PHP would not be able to decide which function to use.</p><p class="calibre8">Another important thing to note is the <a id="id215" class="calibre1"/>
<span class="strong"><strong class="calibre2">variable scope</strong></span>. We are declaring a variable <code class="email">$sum</code> inside the block of code, so once the function ends, the variable will not be accessible any more. That means that the scope of variables declared inside the function is just the function itself. Furthermore, if you had a variable <code class="email">$sum</code> declared outside the function, it would not be affected at all since the function cannot access that variable unless we send it as an argument.</p></div></div>

<div class="book" title="Functions">
<div class="book" title="Function arguments"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec49" class="calibre1"/>Function arguments</h2></div></div></div><p class="calibre8">A function gets <a id="id216" class="calibre1"/>information from outside via arguments. You can define any number of arguments—including 0 (none). These arguments need at least a name so they can be used inside the function; there cannot be two arguments with the same name. When invoking the function, you need to send the arguments in the same order as declared.</p><p class="calibre8">A function may contain <a id="id217" class="calibre1"/>
<span class="strong"><strong class="calibre2">optional arguments</strong></span>, that is, you are not forced to provide a value for those arguments. When declaring the function, you need to provide a default value for those arguments. So, in case the user does not provide a value, the function will use the default one.</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">function addNumbers($a, $b, $printResult = false) {</strong></span>
    $sum = $a + $b;
    if ($printResult) {
        echo 'The result is ' . $sum;
    }
    return $sum;
}

$sum1 = addNumbers(1, 2);
$sum1 = addNumbers(3, 4, false);
$sum1 = addNumbers(5, 6, true); // it will print the result</pre></div><p class="calibre8">This new function in the last example takes two mandatory arguments and an optional one. The default value of the optional argument is <code class="email">false</code>, and it is then used normally inside the function. The function will print the result of the sum if the user provides <code class="email">true</code> as the third argument, which happens only the third time that the function is invoked. For the first two, <code class="email">$printResult</code> is set to <code class="email">false</code>.</p><p class="calibre8">The arguments that the function receives are just copies of the values that the user provided. That means that if you modify these arguments inside the function, it will not affect the original values. This feature is known as sending arguments by value. Let's see an example:</p><div class="informalexample"><pre class="programlisting">function modify($a) {
    $a = 3;
}

$a = 2;
modify($a);
var_dump($a); // prints 2</pre></div><p class="calibre8">We are declaring a <a id="id218" class="calibre1"/>variable <code class="email">$a</code> with value <code class="email">2</code>, and then calling the <code class="email">modify</code> method sending that <code class="email">$a</code>. The <code class="email">modify</code> method modifies the argument <code class="email">$a</code>, setting its value to <code class="email">3</code>, but this does not affect the original value of <code class="email">$a</code>, which remains <code class="email">2</code> as you can see from <code class="email">var_dump</code>.</p><p class="calibre8">If what you want is to actually change the value of the original variable used in the invocation, you need to pass the argument by reference. To do that, you add an ampersand (<code class="email">&amp;</code>) before the argument when declaring the function:</p><div class="informalexample"><pre class="programlisting">function modify(&amp;$a) {
    $a = 3;
}</pre></div><p class="calibre8">Now, on invoking the function <code class="email">modify</code>, <code class="email">$a</code> will always be <code class="email">3</code>.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note10" class="calibre1"/>Note</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">Arguments by value versus by reference</strong></span>
</p><p class="calibre8">PHP allows <a id="id219" class="calibre1"/>you to do it, and in fact, some native functions of PHP use arguments by reference. Remember the array sorting functions? They did not return the sorted array, but sorted the array provided instead. But using arguments by reference is a way of confusing developers. Usually, when someone uses a function, they expect a result, and they do not want the arguments provided by them to be modified. So try to avoid it; people will be grateful!</p></div></div></div>

<div class="book" title="Functions">
<div class="book" title="The return statement"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec50" class="calibre1"/>The return statement</h2></div></div></div><p class="calibre8">You can have as many <code class="email">return</code> statements <a id="id220" class="calibre1"/>as you want inside your function, but PHP will exit the function as soon as it finds one. That means that if you have two consecutive <code class="email">return</code> statements, the second one will never be executed. Still, having multiple <code class="email">return</code> statements can be useful if they are inside conditionals. Add this function inside your <code class="email">functions.php</code> file:</p><div class="informalexample"><pre class="programlisting">function loginMessage() {
    if (isset($_COOKIE['username'])) {
        return "You are " . $_COOKIE['username'];
    } else {
        return "You are not authenticated.";
    }
}</pre></div><p class="calibre8">And let's use the last example in your <code class="email">index.php</code> file by replacing the highlighted content (note that to save some trees, I replaced most of the code that was not changed at all with <code class="email">//…</code>):</p><div class="informalexample"><pre class="programlisting">//...
&lt;body&gt;
<span class="strong"><strong class="calibre2">    &lt;p&gt;&lt;?php echo loginMessage(); ?&gt;&lt;/p&gt;</strong></span>
&lt;?php if (isset($_GET['title']) &amp;&amp; isset($_GET['author'])): ?&gt;
//...</pre></div><p class="calibre8">Additionally, you can omit<a id="id221" class="calibre1"/> the <code class="email">return</code> statement if you do not want the function to return anything. In this case, the function will end once it reaches the end of the block of code.</p></div></div>

<div class="book" title="Functions">
<div class="book" title="Type hinting and return types"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec51" class="calibre1"/>Type hinting and return types</h2></div></div></div><p class="calibre8">With the release of PHP 7, the<a id="id222" class="calibre1"/> language allows the developer to be more specific about what functions <a id="id223" class="calibre1"/>are getting and returning. You can—always optionally—specify the type of argument that the function needs (<span class="strong"><strong class="calibre2">type hinting</strong></span>), and the type of result the function will return (<span class="strong"><strong class="calibre2">return type</strong></span>). Let's first see an example:</p><div class="informalexample"><pre class="programlisting">&lt;?php

<span class="strong"><strong class="calibre2">declare(strict_types=1);</strong></span>

<span class="strong"><strong class="calibre2">function addNumbers(int $a, int $b, bool $printSum): int {</strong></span>
    $sum = $a + $b;
    if ($printSum) {
        echo 'The sum is ' . $sum;
    }
    return $sum;
}

addNumbers(1, 2, true);
addNumbers(1, '2', true); // it fails when strict_types is 1
addNumbers(1, 'something', true); // it always fails</pre></div><p class="calibre8">This preceding function states that the arguments need to be integer, integer, and Boolean, and that the result will be an integer. Now, you know that PHP has type juggling, so it can usually transform a value of one type to its equivalent value of another type, for example, the string "2" can be used as integer 2. To stop PHP from using type juggling with the arguments and results of functions, you can declare the directive <code class="email">strict_types</code> as shown in the first highlighted line. This directive has to be declared at the top of each file where you want to enforce this behavior.</p><p class="calibre8">The three invocations work as follows:</p><div class="book"><ul class="itemizedlist"><li class="listitem">The first invocation sends two integers and a Boolean, which is what the function expects, so regardless of the value of <code class="email">strict_types</code>, it will always work.</li><li class="listitem">The second <a id="id224" class="calibre1"/>invocation sends an integer, a string, and a Boolean. The string <a id="id225" class="calibre1"/>has a valid integer value, so if PHP was allowed to use type juggling, the invocation would resolve just normally. But in this example, it will fail because of the declaration at the top of the file.</li><li class="listitem">The third invocation will always fail as the string "something" cannot be transformed into a valid integer.</li></ul></div><p class="calibre8">Let's try to use a function within our project. In our <code class="email">index.php</code>, we have a <code class="email">foreach</code> loop that iterates the books and prints them. The code inside the loop is kind of hard to understand as it is a mix of HTML with PHP, and there is a conditional too. Let's try to abstract the logic inside the loop into a function. First, create the new <code class="email">functions.php</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;?php
function printableTitle(array $book): string {
    $result = '&lt;i&gt;' . $book['title'] . '&lt;/i&gt; - ' . $book['author'];
    if (!$book['available']) {
        $result .= ' &lt;b&gt;Not available&lt;/b&gt;';
    }
    return $result;
}</pre></div><p class="calibre8">This file will contain our functions. The first one, <code class="email">printableTitle</code>, takes an array representing a book, and builds a string with a nice representation of the book in HTML. The code is the same as before, just encapsulated in a function.</p><p class="calibre8">Now <code class="email">index.php</code> will have to include the <code class="email">functions.php</code> file, and then use the function inside the loop. Let's see how:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">&lt;?php require_once 'functions.php' ?&gt;</strong></span>
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

//...

?&gt;
    &lt;ul&gt;
&lt;?php foreach ($books as $book): ?&gt;
<span class="strong"><strong class="calibre2">    &lt;li&gt;&lt;?php echo printableTitle($book); ?&gt; &lt;/li&gt;</strong></span>
&lt;?php endforeach; ?&gt;
    &lt;/ul&gt;

//...</pre></div><p class="calibre8">Well, now our loop looks way cleaner, right? Also, if we need to print the title of the book somewhere<a id="id226" class="calibre1"/> else, we <a id="id227" class="calibre1"/>can reuse the function instead of duplicating code!</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="The filesystem"><div class="book" id="TI1E2-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec25" class="calibre1"/>The filesystem</h1></div></div></div><p class="calibre8">As you might have already<a id="id228" class="calibre1"/> noticed, PHP comes with a lot of native functions that help you to manage arrays and strings in an easier way as compared to other languages. The filesystem is another of those areas where PHP tried to make it as easy as possible. The list of functions extends to over 80 different ones, so we will cover here just the ones that you are more likely to use.</p></div>

<div class="book" title="The filesystem">
<div class="book" title="Reading files"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec52" class="calibre1"/>Reading files</h2></div></div></div><p class="calibre8">In our code, we define a<a id="id229" class="calibre1"/> list of books. So far, we have only three books, but you can guess that if we want to make this application useful, the list will grow way more. Storing the information inside your code is not practical at all, so we have to start thinking about externalizing it.</p><p class="calibre8">If we think in terms of separating the code from the data, there is no need to keep using PHP arrays to define the books. Using a less language-restrictive system will allow people who do not know PHP to edit the content of the file. There are many solutions for this, like CSV or XML files, but nowadays, one of the most used systems to represent data in web applications is JSON. PHP allows you to convert arrays to JSON and vice versa using just a couple of functions: <code class="email">json_encode</code> and <code class="email">json_decode</code>. Easy, right?</p><p class="calibre8">Save the following into <code class="email">books.json</code>:</p><div class="informalexample"><pre class="programlisting">[
    {
        "title": "To Kill A Mockingbird",
        "author": "Harper Lee",
        "available": true,
        "pages": 336,
        "isbn": 9780061120084
    },
    {
        "title": "1984",
        "author": "George Orwell",
        "available": true,
        "pages": 267,
        "isbn": 9780547249643
    },
    {
        "title": "One Hundred Years Of Solitude",
        "author": "Gabriel Garcia Marquez",
        "available": false,
        "pages": 457,
        "isbn": 9785267006323
    }
]</pre></div><p class="calibre8">The preceding code snippet is a JSON representation of our array in PHP. Now, let's read this information with the function <code class="email">file_get_contents</code>, and transform it to a PHP array with <code class="email">json_decode</code>. Replace the array with these two lines:</p><div class="informalexample"><pre class="programlisting">$booksJson = file_get_contents('books.json');
$books = json_decode($booksJson, true);</pre></div><p class="calibre8">With just one function, we <a id="id230" class="calibre1"/>are able to store all the content from the JSON file in a variable as a string. With the function, we transform this JSON string into an array. The second argument in <code class="email">json_decode</code> tells PHP to transform it to an array, otherwise it would use objects, which we have not covered as yet.</p><p class="calibre8">When referencing files within PHP functions, you need to know whether to use absolute or relative paths. When using relative paths, PHP will try to find the file inside the same directory where the PHP script is. If not found, PHP will try to find it in other directories defined in the <code class="email">include_path</code> directive, but that is something you would like to avoid. Instead, you could use absolute paths, which is a way to make sure the reference will not be misunderstood. Let's see two examples:</p><div class="informalexample"><pre class="programlisting">$booksJson = file_get_contents('/home/user/bookstore/books.json');
$booksJson = file_get_contents(__DIR__, '/books.json');</pre></div><p class="calibre8">The constant<code class="email"> __DIR__</code> contains the directory name of the current PHP file, and if we prefix it to the name of our file, we will have an absolute path. In fact, even though you might think that writing down the whole path by yourself is better, using <code class="email">__DIR__</code> allows you to move your application anywhere else without needing to change anything in the code, as its content will always match the directory of the script, whereas the hardcoded path from the first example will not be valid anymore.</p></div></div>

<div class="book" title="The filesystem">
<div class="book" title="Writing files"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec53" class="calibre1"/>Writing files</h2></div></div></div><p class="calibre8">Let's add some <a id="id231" class="calibre1"/>functionality to our application. Imagine that we want to allow the user to take the book that he or she is looking for, but only if it is available. If you remember, we identify the book by the query string. That is not very practical, so let's help the user by adding links to the list of books, so when you click on a link, the query string will contain that book's information.</p><div class="informalexample"><pre class="programlisting">&lt;?php require_once 'functions.php' ?&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Bookstore&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;p&gt;&lt;?php echo loginMessage(); ?&gt;&lt;/p&gt;
<span class="strong"><strong class="calibre2">&lt;?php</strong></span>
<span class="strong"><strong class="calibre2">$booksJson = file_get_contents('books.json');</strong></span>
<span class="strong"><strong class="calibre2">$books = json_decode($booksJson, true);</strong></span>
<span class="strong"><strong class="calibre2">if (isset($_GET['title'])) {</strong></span>
<span class="strong"><strong class="calibre2">    echo '&lt;p&gt;Looking for &lt;b&gt;' . $_GET['title'] . '&lt;/b&gt;&lt;/p&gt;';</strong></span>
<span class="strong"><strong class="calibre2">} else {</strong></span>
<span class="strong"><strong class="calibre2">    echo '&lt;p&gt;You are not looking for a book?&lt;/p&gt;';</strong></span>
<span class="strong"><strong class="calibre2">}</strong></span>
<span class="strong"><strong class="calibre2">?&gt;</strong></span>
    &lt;ul&gt;
&lt;?php foreach ($books as $book): ?&gt;
<span class="strong"><strong class="calibre2">    &lt;li&gt;</strong></span>
<span class="strong"><strong class="calibre2">        &lt;a href="?title=&lt;?php echo $book['title']; ?&gt;"&gt;</strong></span>
<span class="strong"><strong class="calibre2">            &lt;?php echo printableTitle($book); ?&gt;</strong></span>
<span class="strong"><strong class="calibre2">        &lt;/a&gt;</strong></span>
<span class="strong"><strong class="calibre2">    &lt;/li&gt;</strong></span>
&lt;?php endforeach; ?&gt;
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><p class="calibre8">If you try the preceding code<a id="id232" class="calibre1"/> in your browser, you will see that the list contains links, and by clicking on them, the page refreshes with the new title as part of the query string. Let's now check if the book is available or not, and if it is, let's update its available field to <code class="email">false</code>. Add the following function in your <code class="email">functions.php</code>:</p><div class="informalexample"><pre class="programlisting">function bookingBook(array &amp;$books, string $title): bool {
    foreach ($books as $key =&gt; $book) {
        if ($book['title'] == $title) {
            if ($book['available']) {
                $books[$key]['available'] = false;
                return true;
            } else {
                return false;
            }
        }
    }
    return false;
}</pre></div><p class="calibre8">We have to pay attention as the code starts getting complex. This function takes an array of books and a title, and returns a Boolean, being <code class="email">true</code> if it could book it or <code class="email">false</code> if not. Moreover, the array of books is passed by reference, which means that all changes to that array will affect the original <a id="id233" class="calibre1"/>array too. Even though we discouraged this previously, in this case, it is a reasonable approach.</p><p class="calibre8">We iterate the whole array of books, asking each time if the title of the current book matches the one we are looking for. Only if that is <code class="email">true</code>, we will check if the book is available or not. If it is, we will update the availability to <code class="email">false</code> and return <code class="email">true</code>, meaning that we booked the book. If the book is not available, we will just return <code class="email">false</code>.</p><p class="calibre8">Finally, note that <code class="email">foreach</code> defines <code class="email">$key</code> and <code class="email">$book</code>. We do so because the <code class="email">$book</code> variable is a copy of the <code class="email">$books</code> array, and if we edit it, the original one will not be affected. Instead, we ask for the key of that book too, so when editing the array, we use <code class="email">$books[$key]</code> instead of <code class="email">$book</code>.</p><p class="calibre8">We can use this function from the <code class="email">index.php</code> file:</p><div class="informalexample"><pre class="programlisting">//...
    echo '&lt;p&gt;Looking for &lt;b&gt;' . $_GET['title'] . '&lt;/b&gt;&lt;/p&gt;';
<span class="strong"><strong class="calibre2">    if (bookingBook($books, $_GET['title'])) {</strong></span>
<span class="strong"><strong class="calibre2">        echo 'Booked!';</strong></span>
<span class="strong"><strong class="calibre2">    } else {</strong></span>
<span class="strong"><strong class="calibre2">        echo 'The book is not available...';</strong></span>
<span class="strong"><strong class="calibre2">    }</strong></span>
} else {
//...</pre></div><p class="calibre8">Try it out in your browser. By clicking on an available book, you will get the <span class="strong"><strong class="calibre2">Booked!</strong></span> message. We are almost done! We are just missing the last part: persist this information back to the filesystem. In order to do that, we have to construct the new JSON content and then to write it back to the <code class="email">books.json</code> file. Of course, let's do that only if the book was available.</p><div class="informalexample"><pre class="programlisting">function updateBooks(array $books) {
    $booksJson = json_encode($books);
    file_put_contents(__DIR__ . '/books.json', $booksJson);
}</pre></div><p class="calibre8">The <code class="email">json_encode</code> function does the opposite of <code class="email">json_decode</code>: it takes an array—or any other variable—and transforms it to JSON. The <code class="email">file_put_contents</code> function is used to write to the file referenced as the first argument, the content sent as the second argument. Would you know how to use this function?</p><div class="informalexample"><pre class="programlisting">//...
if (bookingBook($books, $_GET['title'])) {
    echo 'Booked!';
<span class="strong"><strong class="calibre2">    updateBooks($books);</strong></span>
} else {
    echo 'The book is not available...';
}
//...</pre></div><div class="informalexample" title="Note"><h3 class="title2"><a id="note11" class="calibre1"/>Note</h3><p class="calibre8">
<span class="strong"><strong class="calibre2">Files versus databases</strong></span>
</p><p class="calibre8">Storing information in <a id="id234" class="calibre1"/>JSON files is better than having it in your code, but it is <a id="id235" class="calibre1"/>still not the best option. In <a class="calibre1" title="Chapter 5. Using Databases" href="part0045_split_000.html#1AT9A1-edcc22b134104d5db0bf3aa086c86851">Chapter 5</a>, <span class="strong"><em class="calibre12">Using Databases</em></span>, you will learn how to store data of the application in a database, which is a way better solution.</p></div></div></div>

<div class="book" title="The filesystem">
<div class="book" title="Other filesystem functions"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec54" class="calibre1"/>Other filesystem functions</h2></div></div></div><p class="calibre8">If you want to make <a id="id236" class="calibre1"/>your application more robust, you could check that the <code class="email">books.json</code> file exists, that you have read and write permission, and/or that the previous content was a valid JSON. You can use some PHP functions for that:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">file_exists</code>: This<a id="id237" class="calibre1"/> function takes the path of the file, and returns a Boolean: <code class="email">true</code> when the file exists and <code class="email">false</code> otherwise.</li><li class="listitem"><code class="email">is_writable</code>: This <a id="id238" class="calibre1"/>function works the same as <code class="email">file_exists</code>, but checks whether the file is writable or not.</li></ul></div><p class="calibre8">You can find the <a id="id239" class="calibre1"/>full list of functions at <a class="calibre1" href="http://uk1.php.net/manual/en/book.filesystem.php">http://uk1.php.net/manual/en/book.filesystem.php</a>. You can find functions to move, copy, or remove files, create directories, give permissions and ownership, and so on.</p></div></div>
<div class="book" title="Summary" id="UGI01-edcc22b134104d5db0bf3aa086c86851"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec26" class="calibre1"/>Summary</h1></div></div></div><p class="calibre8">In this chapter, we went through all the basics of procedural PHP while writing simple examples in order to practice them. You now know how to use variables and arrays with control structures and functions, how to get information from HTTP requests, and how to interact with the filesystem among other things.</p><p class="calibre8">In the next chapter, we will study the other and most used paradigm: OOP. That is one step closer to writing clean and well-structured applications.</p></div></body></html>
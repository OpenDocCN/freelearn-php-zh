<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;5.&#xA0;Modules, Widgets, and Helpers"><div class="book" id="11C3M2-ad3e09b384df46aea690d9c8897d5fe7"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05" class="calibre1"/>Chapter 5. Modules, Widgets, and Helpers</h1></div></div></div><p class="calibre9">Like its predecessor, Yii2 provides several useful tools and reusable code blocks to help us quickly develop our applications, known as widgets and helpers. Yii2 also provides us with the ability to build and include mini applications known as modules that can enable us to rapidly add new features to our application while maintaining a clear separation of concerns in our main application and any extended functionality. In this chapter, we'll cover the basics of building and working with modules within our application. We'll also cover several of Yii2's built-in widgets and helpers and learn how we can implement our own custom widgets.</p></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Modules, Widgets, and Helpers">
<div class="book" title="Modules"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch05lvl1sec29" class="calibre1"/>Modules</h1></div></div></div><p class="calibre9">In Yii2, modules<a id="id251" class="calibre1"/> are considered to be mini self-contained software packages containing the complete MVC stack. When paired with an application, modules provide a way to extend applications by adding new features and tools without adding code to our main code base. Consequently, modules are a great way to create and reuse code. When creating applications with Yii2, you'll most likely work with prebuilt models, such as Gii or the Yii2 dev module; however, modules can also be custom applications created specifically to build upon and separate code for a specific purpose. In this section, we'll go over the basic modules in Yii2 as well as cover how to create and implement them within our application.</p></div></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Modules, Widgets, and Helpers">
<div class="book" title="Modules">
<div class="book" title="Module components"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch05lvl2sec50" class="calibre1"/>Module components</h2></div></div></div><p class="calibre9">Compared to <a id="id252" class="calibre1"/>Yii1, modules in Yii2 haven't changed much. At their core, they<a id="id253" class="calibre1"/> still consist of the same structure and share many of the same ideas. In Yii2, modules are stored in the <code class="email">modules</code> directory of our application root and are registered with our application through our web or console configuration files. If we were to break down a basic module, its directory structure and core files would be as follows:</p><div class="note"><pre class="programlisting">app/
    modules/
        mymodule/
            Module.php
            controllers/
                DefaultController.php
            models/
            views/
                layouts/
                default/
                    index.php</pre></div><p class="calibre9">Each module <a id="id254" class="calibre1"/>registered with our application resides within its own dedicated<a id="id255" class="calibre1"/> module folder, which registers itself with its corresponding route with our URL manager by default (in this instance, the <code class="email">mymodule</code> folder will correspond to the <code class="email">/mymodule</code> URI route). Consequently, any controller within the module, unless otherwise registered with our URL manager, will be available as a dedicated controller route within the module itself. For example, the <code class="email">DefaultController.php</code> controller will map to the root route of our module <code class="email">(/mymodule</code>), while any other controller will map to the controller name within the <code class="email">/mymodule</code> URI.</p><p class="calibre9">Additionally, modules provide full support for the basic MVC architecture within Yii2. Each module may have its own set of models, views, controllers, and even components. Like complete applications, modules also have support for their own views and layouts, allowing them to be styled and managed differently than our main application. As part of a Yii2 application, they also have complete access to the models and classes implemented within our main application.</p><div class="book" title="The module class structure"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch05lvl3sec34" class="calibre1"/>The module class structure</h3></div></div></div><p class="calibre9">The<a id="id256" class="calibre1"/> most important part of a module is the module class defined in the <code class="email">Module.php</code> file in the root directory of our module. At its most basic level, a module must simply extend the <code class="email">yii\base\Module</code> class:</p><div class="note"><pre class="programlisting">&lt;?php

namespace app\modules\mymodule;

class Module extends \yii\base\Module {}</pre></div><p class="calibre9">Like everything in Yii2, however, modules can define their custom initialization code and configuration files by overloading the public <code class="email">init()</code> method of our class. At the minimum, when overloading this method, we'll want to ensure that the parent <code class="email">init()</code> method from <code class="email">yii\base\Module</code> is called.</p><div class="note"><pre class="programlisting">public function init()
{
    parent::init();

    // Set custom parameters
    $this-&gt;params['a'] = 'b';

    // Register a custom Yii config for our module
    \Yii::configure($this, require __DIR__ . '/config/config.php');
}</pre></div><p class="calibre9">We can <a id="id257" class="calibre1"/>also define additional custom parameters with our module by adding values to the <code class="email">yii\base\Module::$params</code> array. Additionally, custom configurations can be registered to our module using the <code class="email">Yii::configure()</code> static method. This configuration can be a simple key-value pair, or it can be a complete configuration file, such as those used in our web and console configuration files.</p><div class="note" title="Note"><h3 class="title2"><a id="tip85" class="calibre1"/>Tip</h3><p class="calibre9">The Yii2 <a id="id258" class="calibre1"/>configuration syntax can be explored in detail in the Yii2 guide located at <a class="calibre1" href="http://www.yiiframework.com/doc-2.0/guide-concept-configurations.html">http://www.yiiframework.com/doc-2.0/guide-concept-configurations.html</a>.</p></div></div><div class="book" title="Controllers"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch05lvl3sec35" class="calibre1"/>Controllers</h3></div></div></div><p class="calibre9">Within a<a id="id259" class="calibre1"/> module, controllers are placed within the <code class="email">controllers/</code> directory of the main module, and as per the Yii2 convention, they live within the module's namespace. For example, to create the default controller for our <code class="email">mymodule</code> module, we would add the following to <code class="email">app/modules/mymodule/controllers/DefaultController.php</code>:</p><div class="note"><pre class="programlisting">&lt;?php

namespace app\modules\mymodule\controllers;

class DefaultController extends \yii\web\Controller
{
    public function actionIndex()
    {
        return $this-&gt;render('index');
    }
}</pre></div><p class="calibre9">Like other controllers within our project, the default action within our controller is the index action. Since controllers within our module extend <code class="email">yii\web\controller</code>, we can adjust our default action by setting the <code class="email">yii\web\controller::$defaultAction</code> parameter.</p><p class="calibre9">By default, Yii2 will <a id="id260" class="calibre1"/>route the <code class="email">/mymodule</code> URI route to the <code class="email">DefaultController</code> class. Should we wish to change this, however, we can adjust the <code class="email">$defaultRoute</code> parameter of our <code class="email">Module</code> class. For instance, if we have a controller to handle users called <code class="email">UserController</code>, we can make our default route map to our controller, as follows:</p><div class="note"><pre class="programlisting">&lt;?php

namespace app\modules\mymodule;

class Module extends \yii\base\Module
{
    public $defaultRoute = 'user'; // user maps to UserController
}</pre></div><p class="calibre9">Consequently, navigating to <code class="email">/mymodule</code> within our module will result in our <code class="email">UserController</code> class being executed rather than <code class="email">DefaultController</code>.</p><div class="note" title="Note"><h3 class="title2"><a id="tip86" class="calibre1"/>Tip</h3><p class="calibre9">Remember that unless otherwise specified, controllers will always be available in their named URI. In our example, both <code class="email">/mymodule</code> and <code class="email">/mymodule/user</code> will map to the same controller and perform similar actions. If you do not want the named controller route to be enabled after adjusting the <code class="email">$defaultRoute</code> parameter, adjust your router accordingly.</p></div></div><div class="book" title="Views and layouts"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch05lvl3sec36" class="calibre1"/>Views and layouts</h3></div></div></div><p class="calibre9">Since <a id="id261" class="calibre1"/>controllers within modules extend from <code class="email">yii\web\controller</code>, we can take advantage of view and layout rendering within our module. To get started with rendering our view, we first need to define which layout we want to use. By default, modules will use whatever the parent modules layout file is until it reaches the main layout file, and then it will default to the layout file defined in <code class="email">app/views/layouts</code>.</p><p class="calibre9">If we do not want to use our application's layout file, we can define a custom layout file for our module by setting the <code class="email">yii\base\Module::$layout</code> property, as follows:</p><p class="calibre9">We will then define a layout file called <code class="email">main.php</code> within the <code class="email">app/modules/mymodules/views/layouts</code> folder:</p><div class="note"><pre class="programlisting">&lt;?php use yii\helpers\Html; ?&gt;

&lt;?php $this-&gt;beginPage() ?&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"/&gt;
        &lt;?php echo Html::csrfMetaTags() ?&gt;
        &lt;title&gt;&lt;?php echo Html::encode($this-&gt;title) ?&gt;&lt;/title&gt;
        &lt;?php $this-&gt;head() ?&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;?php $this-&gt;beginBody() ?&gt;
        &lt;?php echo $content ?&gt;
        &lt;?php $this-&gt;endBody() ?&gt;
    &lt;/body&gt;
&lt;/html&gt;
&lt;?php $this-&gt;endPage() ?&gt;</pre></div><div class="note" title="Note"><h3 class="title2"><a id="tip87" class="calibre1"/>Tip</h3><p class="calibre9">The<a id="id262" class="calibre1"/> only component needed in a layout file to render our view files is <code class="email">&lt;?php echo $content ?&gt;</code>. When working with views, however, you may find many things you would expect to work in views will not however unless a full HTML document is defined with the <code class="email">beginPage()</code>, <code class="email">endPage()</code>, <code class="email">beginBody()</code>, <code class="email">endBody()</code>, and <code class="email">head()</code> methods from <code class="email">yii\base\view</code>. For more information on these methods, refer to the<a id="id263" class="calibre1"/> layout section of the Yii2 documentation at <a class="calibre1" href="http://www.yiiframework.com/doc-2.0/guide-structure-views.html#layouts%20and%20the%20yii%5Cbase%5Cview%20class%20at%20http://www.yiiframework.com/doc-2.0/yii-base-view.html">http://www.yiiframework.com/doc-2.0/guide-structure-views.html#layouts and the yii\base\view class at http://www.yiiframework.com/doc-2.0/yii-base-view.html</a>.</p></div><p class="calibre9">After defining our layout, we'll need to define the view file for our <code class="email">DefaultController::actionIndex()</code> method, where we previously declared that we wanted to render the index view. Within modules, views are PHP files with the same name as the requested view within our <code class="email">render()</code> method, and they map to the <code class="email">app/modules/mymodule/views/&lt;controller&gt;</code> path. In our case, this view maps to <code class="email">app/modules/mymodule/views/default/index.php</code>. For now, let's simply add the following to this view file:</p><div class="note"><pre class="programlisting">&lt;?php echo "MyModule: Hello World!"; ?&gt;</pre></div></div><div class="book" title="Registering modules"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch05lvl3sec37" class="calibre1"/>Registering modules</h3></div></div></div><p class="calibre9">Once we<a id="id264" class="calibre1"/> have created our module, we need to register it with our configuration file by defining a <code class="email">modules</code> section within our <code class="email">app/config/web.php</code> file:</p><div class="note"><pre class="programlisting">'modules' =&gt; [
    'mymodule' =&gt; 'app\modules\mymodule\Module'
],</pre></div><p class="calibre9">Alternatively, if we want to pass additional parameters to our module, we can define our configuration as follows:</p><div class="note"><pre class="programlisting">'modules' =&gt; [
    'mymodule' =&gt; [
        'class' =&gt; 'app\modules\mymodule\Module',
        'foo' =&gt; 'bar' // Maps to app\modules\mymodule\Module::$foo, assuming $foo is declared
    ]
]</pre></div><div class="note" title="Note"><h3 class="title2"><a id="tip88" class="calibre1"/>Tip</h3><p class="calibre9">Like many configuration options in Yii2, modules can receive additional arguments using the previously mentioned configuration file. Any key-value pair will populate the public property of the specified class with the value listed in the array.</p></div><div class="book" title="Dynamically registering modules"><div class="book"><div class="book"><div class="book"><h4 class="title3"><a id="ch05lvl4sec08" class="calibre1"/>Dynamically registering modules</h4></div></div></div><p class="calibre9">Often<a id="id265" class="calibre1"/> when working with large projects, several components will be broken down into modules that need to be registered with our application. Moreover, there may be circumstances where only certain modules need to be registered at a given time. One way to automate the process of registering many different modules at once is to create a dynamic configuration script and let our application scan our modules for us.</p><p class="calibre9">To do this, we first need to adjust the modules section of our <code class="email">app/config/web.php</code> file to load a custom configuration for our modules, as follows:</p><div class="note"><pre class="programlisting">'modules' =&gt; require(__DIR__ . '/module.php'),</pre></div><p class="calibre9">Then, we'll define <code class="email">app/config/module.php</code>, as follows:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we'll want to set the directory that we want to scan as well as try to load a precached configuration file, should one exist.<div class="note"><pre class="programlisting">&lt;?php

// Set the scan directory
$directory = __DIR__ . DS . '..' . DS . 'modules';
$cachedConfig = __DIR__.DS.'..'.DS.'runtime'.DS.'modules.config.php';</pre></div></li><li class="listitem" value="2">Then, we'll try to return our cached configuration file, should it exist.<div class="note"><pre class="programlisting">// Attempt to load the cached file if it exists
if (file_exists($cachedConfig))
    return require_once($cachedConfig);</pre></div></li><li class="listitem" value="3">If we<a id="id266" class="calibre1"/> don't have a precached configuration file, we'll then want to iterate all the folders in our <code class="email">app/modules</code> directory and then dynamically build a module configuration array. Additionally, we'll also attempt to load a module specific configuration file located at <code class="email">app/modules/&lt;module&gt;/config/main.php</code>. This will enable us to package the configuration with our module without making changes to our <code class="email">app/config/web.php</code> file:<div class="note"><pre class="programlisting">else
{
    // Otherwise generate one, and return it
    $response = array();

    // Find all the modules currently installed, and preload them
    foreach (new IteratorIterator(new DirectoryIterator($directory)) as $filename)
    {
        // Don't import dot files
        if (!$filename-&gt;isDot() &amp;&amp; strpos($filename-&gt;getFileName(), ".") === false)
        {
            $path = $filename-&gt;getPathname();

            if (file_exists($path.DS.'config'.DS.'main.php'))
            {
                $config = require($path.DS.'config'.DS.'main.php');
                $module = [ 'class' =&gt; 'app\\modules\\' . $filename-&gt;getFilename() . '\Module' ];

                foreach ($config as $k=&gt;$v)
                    $module[$k] = $v;

                $response[$filename-&gt;getFilename()] = $module;
            }
            else
                $response[$filename-&gt;getFilename()] = 'app\\modules\\' . $filename-&gt;getFilename() . '\Module';
        }
    }</pre></div></li><li class="listitem" value="4">Finally, we<a id="id267" class="calibre1"/> generate a cached version of our generated configuration file to eliminate duplicate work on each request. Now, when adding new modules to our application, we simply need to remove the <code class="email">runtime/modules.confg.php</code> file rather than tediously update our web configuration file:<div class="note"><pre class="programlisting">    $encoded = serialize($response);
    file_put_contents($cachedConfig, '&lt;?php return unserialize(\''.$encoded.'\');');

    // return the response
    return $response;
}</pre></div></li></ol><div class="calibre15"/></div><p class="calibre9">Altogether, our dynamic configuration file will look as follows:</p><div class="note"><pre class="programlisting">&lt;?php

// Set the scan directory
$directory = __DIR__ . DS . '..' . DS . 'modules';
$cachedConfig = __DIR__.DS.'..'.DS.'runtime'.DS.'modules.config.php';

// Attempt to load the cached file if it exists
if (file_exists($cachedConfig))
    return require_once($cachedConfig);
else
{
    // Otherwise generate one, and return it
    $response = array();

    // Find all the modules currently installed, and preload them
    foreach (new IteratorIterator(new DirectoryIterator($directory)) as $filename)
   {
        // Don't import dot files
        if (!$filename-&gt;isDot() &amp;&amp; strpos($filename-&gt;getFileName(), ".") === false)
        {
            $path = $filename-&gt;getPathname();

            if (file_exists($path.DS.'config'.DS.'main.php'))
            {
                $config = require($path.DS.'config'.DS.'main.php');
                $module = [ 'class' =&gt; 'app\\modules\\' . $filename-&gt;getFilename() . '\Module' ];

                foreach ($config as $k=&gt;$v)
                    $module[$k] = $v;

                $response[$filename-&gt;getFilename()] = $module;
            }
            else
                $response[$filename-&gt;getFilename()] = 'app\\modules\\' . $filename-&gt;getFilename() . '\Module';
        }
    }

    $encoded = serialize($response);
    file_put_contents($cachedConfig, '&lt;?php return unserialize(\''.$encoded.'\');');

    // return the response
    return $response;
}</pre></div><p class="calibre9">Using a <a id="id268" class="calibre1"/>configuration file and the module registration process, we can drastically reduce our configuration file management overhead and make our application extremely flexible, should we package features into separate modules that may or may not be installed at the same time.</p></div><div class="book" title="Bootstrapping modules"><div class="book"><div class="book"><div class="book"><h4 class="title3"><a id="ch05lvl4sec09" class="calibre1"/>Bootstrapping modules</h4></div></div></div><p class="calibre9">Some modules, such as the <code class="email">debug</code> module, need to be executed on every request when enabled. To ensure that these modules run on every request, we can Bootstrap them by adding them<a id="id269" class="calibre1"/> to the Bootstrap section of our configuration file. If you're familiar with Yii1, the <code class="email">bootstrap</code> option is used in a manner similar to the Yii1 preload configuration option:</p><div class="note"><pre class="programlisting">[
    'bootstrap' =&gt; [
        'debug',
    ],

    'modules' =&gt; [
        'debug' =&gt; 'yii\debug\Module',
    ],
]</pre></div><div class="note" title="Note"><h3 class="title2"><a id="tip89" class="calibre1"/>Tip</h3><p class="calibre9">Due to the way Yii2 lazily loads new objects, you may encounter race conditions between Yii2's autoloading of the class and the actual population of that object. The <code class="email">Bootstrap</code> parameter of our configuration option will ensure that Yii2 will autoload and register the object early on in the execution flow rather than waiting until the class it requires.</p><p class="calibre9">Be careful with adding items to the <code class="email">bootstrap</code> section, however, as forcing Yii2 to register objects before they're needed can introduce performance degradation into your application.</p></div></div></div></div></div></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Modules, Widgets, and Helpers">
<div class="book" title="Modules">
<div class="book" title="Accessing modules"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch05lvl2sec51" class="calibre1"/>Accessing modules</h2></div></div></div><p class="calibre9">When <a id="id270" class="calibre1"/>working with modules, you may need to get the instance of the currently running module to either access the module ID and parameters or components associated to the module. To retrieve the current active instance of a module, you can use the <code class="email">getInstance()</code> method on the module class directly:</p><div class="note"><pre class="programlisting">$module = \app\modules\mymodule\Module::getInstance();</pre></div><p class="calibre9">Alternatively, if you know the name of the module, you can access it through the <code class="email">\Yii</code> instance:</p><div class="note"><pre class="programlisting">$module = \Yii::$app-&gt;getModule('mymodule');</pre></div><p class="calibre9">Moreover, if you are working in a controller, you can access a module from within a running controller using the following method:</p><div class="note"><pre class="programlisting">$module = \Yii::$app-&gt;controller-&gt;mymodule;</pre></div><p class="calibre9">Once you <a id="id271" class="calibre1"/>have an instance of the module, you can access any public properties, parameters, and components associated with that module:</p><div class="note"><pre class="programlisting">echo $module-&gt;foo;
var_dump($module-&gt;params);</pre></div></div></div></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Modules, Widgets, and Helpers">
<div class="book" title="Modules">
<div class="book" title="Managing modules with Composer"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch05lvl2sec52" class="calibre1"/>Managing modules with Composer</h2></div></div></div><p class="calibre9">When <a id="id272" class="calibre1"/>packaging projects, it's often beneficial to <a id="id273" class="calibre1"/>manage and version our modules independent of our main applications. Using Composer and semantic versioning, we can manage our modules such that they are versioned to specific points in time in our application while still enabling developers to work with us. Moreover, we can also configure our main project to automatically install modules for us on deployment, which can drastically reduce the overhead involved in managing modules:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">To get started with managing our modules with Composer, we first need to move our module source code out of our main application and push it to our DCVS repository.</li><li class="listitem" value="2">Next, we need to create a <code class="email">composer.json</code> file within our new module's repository:<div class="note"><pre class="programlisting">{
    "name": "masteringyii/chapter5-mymodule",
    "description": "The mymodule module for Chapter 5 of the book Mastering Yii",
    "license": "MIT",
    "type": "drupal-module",
    "keywords": [
        "mastering yii",
        "book",
        "packt",
        "packt publishing",
        "chapter 5"
    ],
    "authors": [
        {
            "name": "Charles R. Portwood II",
            "homepage": "https://www.nasteringyii.com"
        }
    ],
    "support": {
        "source": "https://github.com/masteringyii/chapter5-mymodule"
    },
    "homepage": "https://www.masteringyii.com"
}</pre></div><div class="note1" title="Note"><h3 class="title2"><a id="tip90" class="calibre1"/>Tip</h3><p class="calibre9">The tool we are using to manage the installation of our modules is called composer-installers. To automatically install modules to our modules directory, we need to explicitly declare the type of our Composer package. The composer-installers project does not support Yii-specific modules currently; however, for our purpose, the <code class="email">drupal-module</code> type does what we need.</p></div></li><li class="listitem" value="3">Next, we'll <a id="id274" class="calibre1"/>need to make some changes to <a id="id275" class="calibre1"/>our main projects' <code class="email">composer.json</code> file. The first change we need to make is the inclusion of the composer-installers dependency. We can do this by adding the following to the require block of our <code class="email">composer.json</code> file:<div class="note"><pre class="programlisting">"composer/installers": "v1.0.21"</pre></div></li><li class="listitem" value="4">The second change we need to make to our main project's <code class="email">composer.json</code> file is reference our modules' DCVS repository. We can do this by creating a repositories block populated with the DCVS information for our module <code class="email">repository</code> and then adding the module to our <code class="email">require</code> block:<div class="note"><pre class="programlisting">"repositories": [
        {
            "type": "vcs",
            "url": "https://github.com/masteringyii/chapter5-mymodule"
        },
    ],
"require": {
    "php": "&gt;=5.4.0",
    "yiisoft/yii2": "*",
    "yiisoft/yii2-bootstrap": "*",
    "yiisoft/yii2-swiftmailer": "*",
    "composer/installers": "v1.0.21",
    "masteringyii/chapter5-mymodule": "dev-master"
  },</pre></div></li><li class="listitem" value="5">Then, we need to add the installation information to the extras section of our <code class="email">composer.json</code> file. This provides the required information to the composer-installers package:<div class="note"><pre class="programlisting">"installer-paths": {
    "modules/mymodule/": [
        "masteringyii/chapter5-mymodule"
    ],
}</pre></div></li><li class="listitem" value="6">Then, we'll want to ensure that our module directory is excluded from our DCVS repository. We can do this adding a .<code class="email">gitignore</code> file to our module directory with the following information:<div class="note"><pre class="programlisting">*</pre></div></li><li class="listitem" value="7">Finally, we <a id="id276" class="calibre1"/>can run Composer to update <a id="id277" class="calibre1"/>and automatically install our module:<div class="note"><pre class="programlisting"><span class="strong"><strong class="calibre2">composer update –o</strong></span>
</pre></div><div class="note1" title="Note"><h3 class="title2"><a id="tip91" class="calibre1"/>Tip</h3><p class="calibre9">Since we have specified that we wanted to use the <code class="email">dev-master</code> branch of our <code class="email">mymodule</code> repository, Composer will clone the project into our application, which will allow us to develop it independent of our main application, as usual. During deployments, however, you should semantically version your module so that the versioned copy of the module is downloaded rather than cloned.</p></div></li></ol><div class="calibre15"/></div><p class="calibre9">Our module has now been installed from Composer.</p></div></div></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Modules, Widgets, and Helpers">
<div class="book" title="Modules">
<div class="book" title="Modules in summary"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch05lvl2sec53" class="calibre1"/>Modules in summary</h2></div></div></div><p class="calibre9">Modules <a id="id278" class="calibre1"/>are best used in large applications where certain features or reusable components need to be created. As we've shown in this section, modules are extremely powerful and can be used to extend our application.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Widgets"><div class="book" id="12AK82-ad3e09b384df46aea690d9c8897d5fe7"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec30" class="calibre1"/>Widgets</h1></div></div></div><p class="calibre9">In Yii2, widgets <a id="id279" class="calibre1"/>are reuseable code blocks that are used in views to add configurable user interface logic to our application in an object-oriented way. Yii2 comes with several different types of reusable widgets, some of which we have already seen in previous chapters. Custom widgets can also be created to create tools that can be reused across multiple projects. In this section, we'll go over the basic types of widgets, how to use them, and <a id="id280" class="calibre1"/>how to implement our own within our applications.</p></div>

<div class="book" title="Widgets">
<div class="book" title="Using widgets"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch05lvl2sec54" class="calibre1"/>Using widgets</h2></div></div></div><p class="calibre9">As a presentation <a id="id281" class="calibre1"/>layer tool, widgets are most commonly used within our view files. In Yii2, widgets can be used in one of two distinct ways. The first way to use widgets is to call the <code class="email">yii\base\Widget::widget()</code> method on a supported widget within a view. This method takes a configuration array as an option and returns a rendered widget as a result. For instance, to display a Twitter Bootstrap 3 style alert on our page, we can use the <code class="email">yii\bootstrap\Alert</code> widget as follows:</p><div class="note"><pre class="programlisting">&lt;?php use yii\bootstrap\Alert; ?&gt;

&lt;?php echo Alert::widget([
    'options' =&gt; [
        'class' =&gt; 'alert-info',
    ],
    'body' =&gt; 'This is a bootstrap alert widget using widget()',
]);</pre></div><p class="calibre9">Alternatively, we can construct an instance of a specific widget using <code class="email">yii\base\widget::begin()</code> and <code class="email">yii\base\widget::end()</code> to construct our widget. Using our previous example, this will look as follows:</p><div class="note"><pre class="programlisting">&lt;?php use yii\bootstrap\Alert; ?&gt;

&lt;?php $widget = Alert::begin([
    'options' =&gt; [
        'class' =&gt; 'alert-warning',
    ],
]);

echo 'This is an bootstrap3 alert widget warning using begin() and end()';

$widget-&gt;end();</pre></div><div class="mediaobject"><img src="../images/00036.jpeg" alt="Using widgets" class="calibre10"/><div class="caption"><p class="calibre26">What both Alert widgets will look like once rendered</p></div></div><p class="calibre11"> </p><div class="note" title="Note"><h3 class="title2"><a id="tip92" class="calibre1"/>Tip</h3><p class="calibre9">As a<a id="id282" class="calibre1"/> view object, widgets are responsible for registering and loading their own assets to ensure that they are presented properly. This is why we can create an instance of <code class="email">yii\bootstrap\Alert</code> and see an alert rendered with all the appropriate styles and functionalities.</p></div></div></div>

<div class="book" title="Widgets">
<div class="book" title="Commonly used built-in widgets"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch05lvl2sec55" class="calibre1"/>Commonly used built-in widgets</h2></div></div></div><p class="calibre9">To<a id="id283" class="calibre1"/> help quickly develop applications, Yii2 comes<a id="id284" class="calibre1"/> with several powerful widgets built in that we can use to jumpstart development.</p><div class="book" title="Bootstrap widgets"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch05lvl3sec38" class="calibre1"/>Bootstrap widgets</h3></div></div></div><p class="calibre9">One <a id="id285" class="calibre1"/>of the main widget types Yii2 provides is specific to Twitter Bootstrap 3 styles and provides a quick and easy way to add a functionality to our application. When working with Bootstrap widgets, Yii2 will inject the necessary HTML, CSS, and JavaScript objects into the DOM for us. However, this can be optimized by including the core Bootstrap assets within our application's asset manager, <code class="email">AppAsset.php</code>, located in your <code class="email">@app/assets</code> directory:</p><div class="note"><pre class="programlisting">public $depends = [
    'yii\web\YiiAsset',
    'yii\bootstrap\BootstrapAsset', // this line
];</pre></div><div class="note" title="Note"><h3 class="title2"><a id="tip93" class="calibre1"/>Tip</h3><p class="calibre9">We'll cover <code class="email">AssetManager</code> in more detail in <a class="calibre1" title="Chapter 6. Asset Management" href="part0039_split_000.html#1565U2-ad3e09b384df46aea690d9c8897d5fe7">Chapter 6</a>, <span class="strong"><em class="calibre13">Asset Management</em></span>.</p></div><p class="calibre9">All Bootstrap-specific<a id="id286" class="calibre1"/> widgets belong to the <code class="email">\yii\bootstrap</code> namespace. These<a id="id287" class="calibre1"/> core widgets are as follows:</p><div class="note"><table border="1" class="calibre16"><colgroup class="calibre17"><col class="calibre18"/><col class="calibre18"/></colgroup><thead class="calibre19"><tr class="calibre20"><th valign="bottom" class="calibre21">
<p class="calibre22">Widget</p>
</th><th valign="bottom" class="calibre21">
<p class="calibre22">Result</p>
</th></tr></thead><tbody class="calibre23"><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">ActiveForm</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A styled ActiveForm instance</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Alert</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A style alert</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Button</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A styled button</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Button Dropdown</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A button drop-down group</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Button Group</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A button group</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Carousel</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">An images or a text carousel</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Collapse</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">An accordion collapse JavaScript widget</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Dropdown</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A drop-down menu</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Model</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A model</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Nav</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A navigation menu</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">NavBar</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A navigation top bar</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Progress</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A styled process bar</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Tabs</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A styled tab</p>
</td></tr></tbody></table></div><div class="note" title="Note"><h3 class="title2"><a id="tip94" class="calibre1"/>Tip</h3><p class="calibre9">More<a id="id288" class="calibre1"/> information on Bootstrap-specific widgets can be found on the Yii guide at <a class="calibre1" href="http://www.yiiframework.com/doc-2.0/guide-widget-bootstrap.html">http://www.yiiframework.com/doc-2.0/guide-widget-bootstrap.html</a>. More <a id="id289" class="calibre1"/>information on Twitter Bootstrap 3 can be found at <a class="calibre1" href="http://getbootstrap.com">http://getbootstrap.com</a>.</p></div></div><div class="book" title="jQuery UI widgets"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch05lvl3sec39" class="calibre1"/>jQuery UI widgets</h3></div></div></div><p class="calibre9">Through<a id="id290" class="calibre1"/> an official Yii2 extension, Yii2 also provides several jQuery-UI-specific widgets. Support for jQuery UI widgets can be added to our application by including the <code class="email">yii2-jui</code> Composer package in our application:</p><div class="note"><pre class="programlisting"><span class="strong"><strong class="calibre2">php composer.phar require --prefer-dist yiisoft/yii2-jui "*"</strong></span>
</pre></div><p class="calibre9">Once installed, the jQuery UI package provides support for the following widgets under the <code class="email">\yii\jui</code> namespace:</p><div class="note"><table border="1" class="calibre16"><colgroup class="calibre17"><col class="calibre18"/><col class="calibre18"/></colgroup><thead class="calibre19"><tr class="calibre20"><th valign="bottom" class="calibre21">
<p class="calibre22">Widget</p>
</th><th valign="bottom" class="calibre21">
<p class="calibre22">Result</p>
</th></tr></thead><tbody class="calibre23"><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Accordion</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">An accordion element</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">AutoComplete</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">An autocomplete element</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">DatePicker</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A date time picker object</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Dialog</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A dialog box</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Draggable</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A draggable element</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Droppable</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A droppable element</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Menu</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A menu</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">ProgressBar</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A styled progress bar</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Resizable</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A resizable element</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Selectable</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A selectable element</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Slider</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A slider</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">SliderInput</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">An input slider</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Sortable</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A sortable element</p>
</td></tr></tbody></table></div><div class="note" title="Note"><h3 class="title2"><a id="tip95" class="calibre1"/>Tip</h3><p class="calibre9">More<a id="id291" class="calibre1"/> information on jQuery-UI-specific widgets can be found in the Yii guide at <a class="calibre1" href="http://www.yiiframework.com/doc-2.0/guide-widget-jui.html">http://www.yiiframework.com/doc-2.0/guide-widget-jui.html</a>. More<a id="id292" class="calibre1"/> information on jQuery UI can be found at <a class="calibre1" href="https://jqueryui.com">https://jqueryui.com</a>.</p></div></div><div class="book" title="Yii-specific widgets"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch05lvl3sec40" class="calibre1"/>Yii-specific widgets</h3></div></div></div><p class="calibre9">Yii2 comes <a id="id293" class="calibre1"/>with support for familiar Yii1 widgets such as ActiveForm and GridView, both of which we explored in previous chapters. All widgets<a id="id294" class="calibre1"/> in Yii2 that are specific to Yii2 are namespaced under <code class="email">\yii\widget</code>.</p><div class="note"><table border="1" class="calibre16"><colgroup class="calibre17"><col class="calibre18"/><col class="calibre18"/></colgroup><thead class="calibre19"><tr class="calibre20"><th valign="bottom" class="calibre21">
<p class="calibre22">Widget</p>
</th><th valign="bottom" class="calibre21">
<p class="calibre22">Result</p>
</th></tr></thead><tbody class="calibre23"><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">ActiveForm</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">An ActiveForm instance used to display Yii2 forms</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">GridView</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A view to display model and data provider data in a grid table view</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">DetailView</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A view to display data for a specific modal</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">ListView</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A list view to display multiple modals on a single page</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">AjaxForm</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A widget to construct an Ajax form </p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">LinkPager</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A widget to display a pagination element for multiple records</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">LinkSorter</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A widget to sort data from a data provider</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Pjax</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">An implementation of jQuery's pjax functionality in Yii2</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Breadcrumb</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A widget to display a breadcrumb trail</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">ContentDecorator</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">The content decorator widget is used to capture all output between the <code class="literal">begin()</code> and <code class="literal">end()</code> methods and pass it to the corresponding view in the <code class="literal">$content</code> variable.</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">FragmentCache</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">Used to cache view fragments</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">InputWidget</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A widget used to display an input field.</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">MaskedInput</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">An input widget used to force users to enter properly formatted data</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Menu</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A widget used to display a Yii menu</p>
</td></tr><tr class="calibre20"><td valign="top" class="calibre24">
<p class="calibre22">Spaceless</p>
</td><td valign="top" class="calibre24">
<p class="calibre22">A widget to remove whitespace characters between HTML tags</p>
</td></tr></tbody></table></div><div class="note" title="Note"><h3 class="title2"><a id="tip96" class="calibre1"/>Tip</h3><p class="calibre9">Several online projects also exist to extend Yii2's widget collection. Before trying to<a id="id295" class="calibre1"/> implement your own widget, try to search Yii2's extensions to see whether someone might have already implemented what you need.</p></div></div></div></div>

<div class="book" title="Widgets">
<div class="book" title="Creating custom widgets"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch05lvl2sec56" class="calibre1"/>Creating custom widgets</h2></div></div></div><p class="calibre9">In some <a id="id296" class="calibre1"/>instances, it may make more sense to create our own widget to handle a specific task. To create a custom widget in Yii2, we need to create a class that extends <code class="email">yii\base\Widget</code> and implements either the <code class="email">init()</code> or <code class="email">run()</code> method. For instance, suppose we want to create a widget that displays a greeting with the user's name depending upon the time of the day. We can create that widget by implementing the following:</p><div class="note"><pre class="programlisting">&lt;?php
namespace app\components;

use yii\base\Widget;
use yii\helpers\Html;

class GreetingWidget extends Widget
{
    public $name = null;

    public $greeting;

    public function init()
    {
        parent::init();

        $hour = date('G');

        if ( $hour &gt;= 5 &amp;&amp; $hour &lt;= 11 )
            $this-&gt;greeting = "Good Morning";
        else if ( $hour &gt;= 12 &amp;&amp; $hour &lt;= 18 )
            $this-&gt;greeting = "Good Afternoon";
        else if ( $hour &gt;= 19 || $hours &lt;= 4 )
            $this-&gt;greeting = "Good Evening";
    }

    public function run()
    {
        if ($this-&gt;name === null)
            return HTML::encode($this-&gt;greeting);
        else
            return HTML::encode($this-&gt;greeting . ', ' . $this-&gt;name);
    }
}</pre></div><p class="calibre9">We can<a id="id297" class="calibre1"/> then implement our widget by adding the following to our view file:</p><div class="note"><pre class="programlisting">&lt;?php
use app\components\GreetingWidget;
echo GreetingWidget::widget([ 'name' =&gt; ' Charles' ); </pre></div><div class="mediaobject"><img src="../images/00037.jpeg" alt="Creating custom widgets" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre9">We can also write our widgets so that they use the <code class="email">begin()</code> and <code class="email">end()</code> format. As an illustration, let's create a widget that outputs whatever is wrapped within a <code class="email">begin()</code> and <code class="email">end()</code> tag in an HTML <code class="email">div</code> element. We can write this class as follows:</p><div class="note"><pre class="programlisting">&lt;?php

namespace app\components;

use yii\base\Widget;
use yii\helpers\Html;

class EchoWidget extends Widget
{
    public function init()
    {
        parent::init();
        ob_start();
    }

    public function run()
    {
        $content = ob_get_clean();
        echo Html::tag('div', $content, ['class' =&gt; 'echo-widget']);
    }
}</pre></div><p class="calibre9">We can<a id="id298" class="calibre1"/> then use our widget as follows in our view:</p><div class="note"><pre class="programlisting">&lt;?php use app\components\EchoWidget; ?&gt;

&lt;?php EchoWidget::begin(); ?&gt;
    &lt;?php echo "Echo this!"; ?&gt;
&lt;?php EchoWidget::end(); ?&gt;</pre></div><p class="calibre9">When using widgets, you may find it necessary to pass information to a view file to handle more complex view logic. In Yii2, widgets have native support for the <code class="email">render()</code> method, allowing us to render view files.</p><div class="note"><pre class="programlisting">public function run()
{
    return $this-&gt;render('greeting');
}</pre></div><p class="calibre9">By default, view files should be stored within the <code class="email">WidgetPath\views</code> folder. In our example, since the <code class="email">GreetingWidget</code> class is namespaced under <code class="email">app\components</code>, our greeting view file will be located at <code class="email">@app\components\views\greeting.php</code>.</p></div></div>

<div class="book" title="Widgets">
<div class="book" title="A summary of widgets"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch05lvl2sec57" class="calibre1"/>A summary of widgets</h2></div></div></div><p class="calibre9">Widgets<a id="id299" class="calibre1"/> are powerful object-oriented reusable code blocks that we can add to our views to quickly and easily add additional functionality to our application. As self-contained objects, widgets follow the MVC pattern and handle dependency management for any and all assets and external scripts required for the widget to function.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Helpers"><div class="book" id="1394Q2-ad3e09b384df46aea690d9c8897d5fe7"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec31" class="calibre1"/>Helpers</h1></div></div></div><p class="calibre9">Yii2 has <a id="id300" class="calibre1"/>several built-in helper classes to streamline common coding tasks, such as HTML, array, and JSON manipulation. These helper functions take the form of static classes (which means that they should be called statically rather than being instantiated) and live underneath the <code class="email">\yii\helpers</code> namespace. In this section, we'll go over several of the more common helpers.</p><div class="note" title="Note"><h3 class="title2"><a id="tip97" class="calibre1"/>Tip</h3><p class="calibre9">Comprehensive documentation for all helpers Yii2 supports can be found on the <a id="id301" class="calibre1"/>Yii2 API documentation page underneath the helpers section at <a class="calibre1" href="http://www.yiiframework.com/doc-2.0/">http://www.yiiframework.com/doc-2.0/</a>.</p></div></div>

<div class="book" title="Helpers">
<div class="book" title="The URL helper"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch05lvl2sec58" class="calibre1"/>The URL helper</h2></div></div></div><p class="calibre9">The first <a id="id302" class="calibre1"/>helper commonly used in Yii2 is the URL helper. The URL helper helps us retrieve specific URLs, such as the base and home URL, and generate URL routes to specific paths. The URL helper lives under the <code class="email">yii\helpers\Url</code> namespace.</p><p class="calibre9">To retrieve the home URL of your application, use the <code class="email">home()</code> static method. Several different arguments can be passed to get different types of URLs:</p><div class="note"><pre class="programlisting">$relativeHomeUrl = Url::home();
$absoluteHomeUrl = Url::home(true);
$httpsAbsoluteHomeUrl = Url::home('https');</pre></div><p class="calibre9">Alternatively, you can use the <code class="email">base()</code> method to retrieve the base URL of your application:</p><div class="note"><pre class="programlisting">$relativeBaseUrl = Url::base();
$absoluteBaseUrl = Url::base(true);
$httpsAbsoluteBaseUrl = Url::base('https');</pre></div><div class="note" title="Note"><h3 class="title2"><a id="tip98" class="calibre1"/>Tip</h3><p class="calibre9">The <code class="email">home()</code> method returns the home route for our application, whereas the <code class="email">base()</code> method returns the base URL for our application for internal use.</p></div><p class="calibre9">The URL helper can also be used to generate routes to other parts of your application using the <code class="email">toRoute()</code> and <code class="email">to()</code> method. In general, the <code class="email">toRoute()</code> method takes the following form:</p><div class="note"><pre class="programlisting">// Generate a relative URL to controller/action
$url = Url::toRoute(['controller/action', 'foo' =&gt; 'bar', 'let' =&gt; 'asl']);</pre></div><p class="calibre9">Alternatively, <code class="email">toRoute()</code> can generate absolute URLs by adding a preceding slash to the first array parameter:</p><div class="note"><pre class="programlisting">// Generate an absolute URL to controller/action with multiple params.
$url = Url::toRoute(['/controller/action', 'foo' =&gt; 'bar', 'let' =&gt; 'asl']);</pre></div><p class="calibre9">Furthermore, the<a id="id303" class="calibre1"/> method can be reduced to a single string if we do not have the need for extra parameters:</p><div class="note"><pre class="programlisting">// Navigate to controller/action
$url = Url::toRoute('controller/action');</pre></div><p class="calibre9">As an alternative to the <code class="email">toRoute()</code> method, the <code class="email">to()</code> method can be used. The <code class="email">to()</code> method is identical to the <code class="email">toRoute()</code> method, except that it always expects an array rather than a string:</p><div class="note"><pre class="programlisting">// Generates a URL to controller/action
echo Url::to(['controller/action']);

// Generates a URL to controller/action with params
// controller/action?foo=bar#name
echo Url::to(['controller/action', 'foo' =&gt; 'bar', '#' =&gt; 'name']);

// the currently requested URL
echo Url::to();</pre></div><p class="calibre9">Additionally, if we want to retrieve the current URL, we can use the <code class="email">current()</code> method. When passed without arguments, the current URL will be returned. Any array arguments passed to the method will generate the current URL with its parameters:</p><div class="note"><pre class="programlisting">// The current URL
echo Url::current();

// The current URL with params
echo Url::current([ 'foo' =&gt; 'bar' ]);</pre></div></div></div>

<div class="book" title="Helpers">
<div class="book" title="The HTML helper"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch05lvl2sec59" class="calibre1"/>The HTML helper</h2></div></div></div><p class="calibre9">Another<a id="id304" class="calibre1"/> common helper in Yii is the HTML helper. The HTML helper provides many different static methods to generate HTML safe tags. In general, HTML tags can be generated by calling the <code class="email">tag()</code> method, as follows:</p><div class="note"><pre class="programlisting"><span class="strong"><strong class="calibre2">use \yii\helpers\Html; // HTML Helper namespace</strong></span>
// Generates an HTML encoded span tag with the class name, and the users name HTML encoded.
// &lt;span class="name"&gt;Charles&lt;/span&gt;
Html::tag('span', Html::encode($user-&gt;name), ['class' =&gt; 'name']);</pre></div><p class="calibre9">As shown in the previous example, data can also be HTML-encoded to make it safe for client viewing using the <code class="email">Html::encode()</code> method.</p><div class="note" title="Note"><h3 class="title2"><a id="tip99" class="calibre1"/>Tip</h3><p class="calibre9">Any piece of data submitted by the end user should be wrapped within the <code class="email">encode()</code> method to prevent XSS injection.</p></div><p class="calibre9">The CSS styles for our HTML tags can also be managed by our HTML helper via the <code class="email">removeCssClass()</code> and <code class="email">addCssClass()</code> methods. The <code class="email">addCssClass()</code> method can work with either a string or an array definition of a class, and it will not add a class if it already exists:</p><div class="note"><pre class="programlisting">$options = ['class' =&gt; 'btn btn-default']; 

Html::removeCssClass($options, 'btn-default');
Html::addCssClass($options, 'btn-success');
Html::addCssClass($options, 'btn'); // Has no effect

Html::tag('span', Html::encode($user-&gt;name), $options);</pre></div><p class="calibre9">The HTML helper can also be used to generate links:</p><div class="note"><pre class="programlisting">// Generate a link to the user's profile
// &lt;a href="profile/view/id/$id" class="profile"&gt;My Profile&lt;/a&gt;
Html::a('My Profile', ['profile/view', 'id' =&gt; $id], ['class' =&gt; 'profile']);

Html::mailto('Contact me', 'admin@masteringyii.com');</pre></div><p class="calibre9">The helper can also be used to generate image tags:</p><div class="note"><pre class="programlisting">// Generates an IMG tag
// &lt;img src="https://www.masteringyii.com/images/logo.png" alt="masteringyii logo" /&gt;
Html::img('@web/images/logo.png', ['alt' =&gt; 'masteringyii logo']);</pre></div><p class="calibre9">Moreover, the HTML helper can be used to include inline CSS styles and JavaScript:</p><div class="note"><pre class="programlisting">// &lt;style&gt;.greeting { color: #2d2d2d; }&lt;/style&gt;
Html::style('.greeting { color: #2d2d2d; }');

//&lt;script defer&gt;alert("Hello World!");&lt;/script&gt;
Html::script('alert("Hello World!");');</pre></div><p class="calibre9">CSS files <a id="id305" class="calibre1"/>and JavaScript can also be included with the HTML helper:</p><div class="note"><pre class="programlisting">//&lt;link href="@web/css/styles.css" /&gt;
Html::cssFile('@web/css/styles.css');

// &lt;!--[if IE 9]&gt;
//     &lt;link href="http://example.com/css/ie9.css" /&gt;
// &lt;![endif]--&gt;
Html::cssFile('@web/css/ie9.css', ['condition' =&gt; 'IE 9']);

// &lt;script type="text/javascript src="@web/js/main.js"&gt;&lt;/script&gt;
Html::jsFile('@web/js/main.js');</pre></div><div class="note" title="Note"><h3 class="title2"><a id="tip100" class="calibre1"/>Tip</h3><p class="calibre9">The <a id="id306" class="calibre1"/>HTML helper can also be used to generate many different types of HTML tags. A complete method list is available at <a class="calibre1" href="http://www.yiiframework.com/doc-2.0/yii-helpers-html.html">http://www.yiiframework.com/doc-2.0/yii-helpers-html.html</a>.</p></div></div></div>

<div class="book" title="Helpers">
<div class="book" title="The JSON helper"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch05lvl2sec60" class="calibre1"/>The JSON helper</h2></div></div></div><p class="calibre9">Working<a id="id307" class="calibre1"/> with JSON objects can often be complicated. To help alleviate some of the problems with complex JSON objects, Yii2 provides the <code class="email">yii\helpers\Json</code> class, which provides support for the encoding and decoding of complex JSON objects:</p><div class="note"><pre class="programlisting">$data = [
    'foo' =&gt; 'bar,
    'a', =&gt; 'b',
    'param' =&gt; [
        'param2' =&gt; [ 'a' =&gt; 'b'],
        'foo' =&gt; 'bar'
    ]
];

// Encodes an array to JSON
$json = Json::encode($data);

// Decodes JSON to a PHP array
$decoded = Json::decode($json);</pre></div><div class="note" title="Note"><h3 class="title2"><a id="tip101" class="calibre1"/>Tip</h3><p class="calibre9">The <code class="email">yii\helpers\Json</code> class builds upon the native PHP <code class="email">json_enocde()</code> and <code class="email">json_decode()</code> classes to provide more robust support for complex JSON objects. It's<a id="id308" class="calibre1"/> recommended when using Yii that you use this class instead of the native PHP functions.</p></div></div></div>

<div class="book" title="Helpers">
<div class="book" title="The Markdown helper"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch05lvl2sec61" class="calibre1"/>The Markdown helper</h2></div></div></div><p class="calibre9">Markdown is a text to<a id="id309" class="calibre1"/> HTML conversion tool used to write on the Web. Meant to replace problematic WYSIWYG editors, Markdown has very quickly become the preferred writing method for professionals across the world. To help you work with Markdown, Yii2 provides the <code class="email">yii\helpers\Markdown</code> helper with support for some of the most common markdown flavors, including GitHub Flavored Markdown and Markdown Extra.</p><div class="note"><pre class="programlisting">use \yii\helpers\Markdown;
$html = Markdown::process($markdown); // use original markdown flavor
$html = Markdown::process($markdown, 'gfm'); // use github flavored markdown
$html = Markdown::process($markdown, 'extra'); // use markdown extra</pre></div></div></div>

<div class="book" title="Helpers">
<div class="book" title="Variable dumping"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch05lvl2sec62" class="calibre1"/>Variable dumping</h2></div></div></div><p class="calibre9">Often <a id="id310" class="calibre1"/>when debugging, we need to explore a given array or object. Most developers will use the native PHP functions <code class="email">var_dump()</code> or <code class="email">print_r()</code>, both of which can be problematic with large arrays or objects. To help work with objects and arrays, Yii2 provides the VarDumper helper within the <code class="email">yii\helpers\VarDumper</code> namespace.</p><p class="calibre9">While this class replicates much of the functionality of <code class="email">var_dump()</code> and <code class="email">print_r()</code>, it can identify recursive structures to avoid recursive display of the same object over and over again. VarDumper can be used as follows:</p><div class="note"><pre class="programlisting">yii\helpers\VarDumper;
VarDumper::dump($var);</pre></div></div></div>

<div class="book" title="Helpers">
<div class="book" title="Inflector"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_6"><a id="ch05lvl2sec63" class="calibre1"/>Inflector</h2></div></div></div><p class="calibre9">Often <a id="id311" class="calibre1"/>when working with strings, we need to apply inflection to the string to get the appropriate tense or plural. The <code class="email">yii\helpers\Inflector</code> class enables us to do this. Several examples of inflector are provided as follows:</p><div class="note"><pre class="programlisting">use \yii\helpers\Inflector;

// WhoIsOnline
echo Inflector::camelize('who is online?');

// person =&gt; people
echo Inflector::classify('person');

// Who is online
echo Inflector::humanize('WhoIsOnline');

// 26 =&gt; 26th
echo Inflector::ordinalize(26);

// person =&gt; People
echo Inflector::pluralize('person');

// People =&gt; Person
echo Inflector::singularize('People');

// SendEmail =&gt; send_email
echo Inflector::underscore('SendEmail');

// SendEmail =&gt; Send Email
echo Inflector::titlize('SendEmail');</pre></div><div class="note" title="Note"><h3 class="title2"><a id="tip102" class="calibre1"/>Tip</h3><p class="calibre9">The inflection class will work only with English words.</p></div></div></div>

<div class="book" title="Helpers">
<div class="book" title="FileHelper"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_7"><a id="ch05lvl2sec64" class="calibre1"/>FileHelper</h2></div></div></div><p class="calibre9">To help <a id="id312" class="calibre1"/>us work with files, Yii2 provides the <code class="email">yii\helpers\FileHelper</code> class. To search for files in a given directory, we can use <code class="email">FileHelper</code>, as follows:</p><div class="note"><pre class="programlisting">use \yii\helpers\FileHelper;
$files = FileHelper::findFiles('/path/to/search/');</pre></div><p class="calibre9">Now, you have all files listed in the <code class="email">$files</code> variable as an array.</p><p class="calibre9">With the find files method, we can specify the file type we want to have or exclude:</p><div class="note"><pre class="programlisting">// Only .php and .txt files
FileHelper::findFiles('.', ['only' =&gt; ['*.php', '*.txt']]);

// Exclude .php and .txt files
FileHelper::findFiles('.', ['except' =&gt; ['*.php', '*.txt']]);</pre></div><p class="calibre9">By default, <code class="email">fileHelper()</code> will perform a recursive search. To disable this behavior, we can set the <code class="email">recursive</code> attribute to <code class="email">false</code>:</p><div class="note"><pre class="programlisting">FileHelper::findFiles('.', ['recursive' =&gt; false]);</pre></div><p class="calibre9">
<code class="email">FileHelper</code> can also be used to determine the MIME type of a specific file or a file extension:</p><div class="note"><pre class="programlisting">// image/jpeg
FileHelper::getMimeType('/path/to/img.jpeg');

// image/jpeg
FileHelper::getMimeTypeByExtension('jpeg');</pre></div></div></div>
<div class="book" title="Summary" id="147LC1-ad3e09b384df46aea690d9c8897d5fe7"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec32" class="calibre1"/>Summary</h1></div></div></div><p class="calibre9">In this chapter, we covered many of the different tools we can use to help us develop applications quicker in Yii2 and extend Yii2. We first covered the basics of a module, its MVC structure, and how to integrate it into our main application. We also covered how to use Composer to automate the inclusion of modules in our projects for development as well as deployment. We then covered widgets in Yii2 and learned how we can use them in our application. We also covered how to create our own widgets. Finally, we covered several of the built-in helpers in Yii2 and learned how to use them.</p><p class="calibre9">In the next chapter, we'll explore how assets are managed in Yii2 and how to use <code class="email">yii\web\AssetManager</code> to optimize the usage of our assets. We'll also cover how we can integrate other tools, such as Grunt, Node, and Bower, to simplify the use of our assets in Yii2.</p></div></body></html>
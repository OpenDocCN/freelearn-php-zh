<html><head></head><body><div class="preface" title="Preface"><div class="titlepage"><div><div><h1 class="title"><a id="pre05"/>Preface</h1></div></div></div><p>CakePHP is a rapid development framework for PHP that provides an extensible architecture for developing, maintaining, and deploying web applications. While the framework has a lot of documentation and reference guides available for beginners, developing more sophisticated and scalable applications require a deeper knowledge of CakePHP features, a challenge that proves difficult even for well established developers.</p><p>The recipes in this cookbook will give you instant results and will help you to develop web applications, leveraging the CakePHP features that allow you to build robust and complex applications. Following the recipes in this book (which show how to work with AJAX, datasources, GEO location, routing, performance optimization, and more), you will be able to understand and use these features in no time.</p><div class="section" title="What this book covers"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec02"/>What this book covers</h1></div></div></div><p>
<span class="emphasis"><em><a class="link" href="ch01.html" title="Chapter 1. Authentication">Chapter 1</a></em></span>,<span class="emphasis"><em> Authentication</em></span>: This chapter explains how to set up authentication on a CakePHP application, starting from the most basic setup and finishing with advanced authorization mechanisms. This is accomplished through the use of tools that are built into the framework core, which allow us to quickly set up secure areas, without losing flexibility to build more complex solutions.</p><p>The first two recipes show us how to set up a basic, yet fully working authentication system. The next three recipes allow our users to log in using different information, have their user details saved after a successful login, and show us how to get this user information. The sixth recipe shows a more complex authorization technique that relies on route prefixes. The seventh recipe sets up a complex authentication system through the use of CakePHP's Access Control Layer. Finally, the last recipe shows us how to integrate our application with OpenID.</p><p>
<span class="emphasis"><em><a class="link" href="ch02.html" title="Chapter 2. Model Bindings">Chapter 2</a></em></span>,<span class="emphasis"><em> Model Bindings</em></span>: This chapter deals with one of the most important aspects of a CakePHP application: the relationship between models, also known as model bindings or associations. Being an integral part of any application's logic, it is of crucial importance that we master all aspects of how model bindings can be manipulated to get the data we need, when we need it.</p><p>In order to do so, we will go through a series of recipes that will show us how to change the way bindings are fetched, what bindings and what information from a binding is returned, how to create new bindings, and how to build hierarchical data structures</p><p>
<span class="emphasis"><em><a class="link" href="ch03.html" title="Chapter 3. Pushing the Search">Chapter 3</a></em></span>, Pushing the Search: Using models to fetch data is one of the most important aspects of any CakePHP application. As such, a good use of the find functions the framework provides can certainly guarantee the success of our application, and as importantly ensure that our code is readable and maintainable.</p><p>In this chapter, we have several recipes to resort to manual SQL-based queries when the need arises.</p><p>CakePHP also lets us define our custom find types that will extend the basic ones, allowing our code to be even more readable. The last recipes in this chapter show us how to add pagination support to our find type.</p><p>
<span class="emphasis"><em><a class="link" href="ch04.html" title="Chapter 4. Validation and Behaviors">Chapter 4</a></em></span>,<span class="emphasis"><em> Validation and Behaviors</em></span>: This chapter deals with two aspects of CakePHP models that are fundamental to most applications: validation and behaviors.</p><p>When we are saving information to a data source (such as a database), CakePHP will automatically ensure that the data is quoted in order to prevent attacks, SQL injection being the most common one. If we also need to ensure that the data follows a certain format (for example, that a phone number is valid), we use validation rules.</p><p>There are also times where we need to do more than just validate the data we are working with. In some cases, we need to set values for fields that the end user can't specify but are part of our application logic. CakePHP's behaviors allow us to extend the functionality provided by a model, using callbacks to manipulate the data before it's saved, or after it's fetched.</p><p>The third recipe shows us how to use model callbacks (such as<code class="literal"> beforeFind</code> and<code class="literal"> afterFind)</code> in behaviors, while the fourth recipe shows how to use behaviors to add additional field values when a<code class="literal"> save</code> operation is being undertaken.</p><p>The last two recipes in this chapter give examples on how to use the<code class="literal"> Sluggable</code> behavior (for creating SEO friendly URLs), and the<code class="literal"> Geocodable</code> behavior (to add geocoding support to an<code class="literal"> Address</code> model).</p><p>
<span class="emphasis"><em><a class="link" href="ch05.html" title="Chapter 5. Datasources">Chapter 5</a></em></span>,<span class="emphasis"><em> Datasources</em></span>: Datasources are the backbone of almost all model operations. They provide an abstraction between model logic and the underlying data layer, allowing a more flexible approach to data manipulation. Through this abstraction, CakePHP applications are able to manipulate data without knowing the specifics of how it's stored, or fetched.</p><p>This chapter shows how to get information from existing datasources, use pre-built datasources to deal with non-relational data, and teaches us how to create a full-featured twitter datasource.</p><p>
<span class="emphasis"><em><a class="link" href="ch06.html" title="Chapter 6. Routing Magic">Chapter 6</a></em></span>,<span class="emphasis"><em> Routing Magic</em></span>: Almost every web-based application will eventually have to develop a successful strategy to obtain better search engine position through a technique known as<span class="strong"><strong> search engine optimization</strong></span>.</p><p>This chapter starts by introducing some basic concepts of routing through the use of route parameters, and continues to build optimized routes to leverage our search engine placement.</p><p>The final section in this chapter shows us how to create highly optimized URLs for our user profiles, and how to build custom<code class="literal"> Route</code> classes to obtain even more flexibility.</p><p>
<span class="emphasis"><em><a class="link" href="ch07.html" title="Chapter 7. Creating and Consuming Web Services">Chapter 7</a></em></span>,<span class="emphasis"><em> Creating and Consuming Web Services</em></span>: Web services are essential when looking forward to expose application functionality to third-party applications, or when looking forward to integrate foreign services into our own applications. They offer a broad set of technologies and definitions so systems written in different programming languages can communicate.</p><p>This chapter introduces a set of recipes to consume web services and to expose parts of our application as web services.</p><p>
<span class="emphasis"><em><a class="link" href="ch08.html" title="Chapter 8. Working with Shells">Chapter 8</a></em></span>,<span class="emphasis"><em> Working with Shells</em></span>: One of the most powerful, yet unknown, features of CakePHP is its shell framework. It provides applications with all that is required for building command line tools, which can be used to perform intensive tasks and any other type of non interactive processing.</p><p>This chapter introduces the reader to CakePHP shells by starting with the process of building basic shells, and then moving on to more advanced features, such as sending e-mails, and running controller actions from shells. It finishes by presenting the robot plugin, which offers a fully featured solution for scheduling and running tasks.</p><p>
<span class="emphasis"><em><a class="link" href="ch09.html" title="Chapter 9. Internationalizing Applications">Chapter 9</a></em></span>,<span class="emphasis"><em> Internationalizing Applications</em></span>: This chapter includes a set of recipes that allow the reader to internationalize all aspects of their CakePHP applications, including static content (such as those available in views), and dynamic content (such as database records).</p><p>The first two recipes show how to allow text that is part of any CakePHP view, or model validation messages, to be ready for translation. The third recipe shows how to translate more complex expressions. The fourth recipe shows how to run CakePHP's built in tools to extract all static content that needs translation, and then translate that content to different languages. The fifth recipe shows how to translate database records. Finally, the last recipe shows how to allow users to change the current application language.</p><p>
<span class="emphasis"><em><a class="link" href="ch10.html" title="Chapter 10. Testing">Chapter 10</a></em></span>,<span class="emphasis"><em> Testing</em></span>: This chapter covers one of the most interesting areas of application programming: unit testing through CakePHP's built-in tools, which offers a complete and powerful unit testing framework.</p><p>The first recipe shows how to set up the test framework so that we can create our own test cases. The second recipe shows how to create test data (fixtures) and use that data to test model methods. The third and fourth recipes show how to test controller actions, and how to test that our views are showing what we expect. The last recipe shows how to run the test in a non-ordinary fashion.</p><p>
<span class="emphasis"><em><a class="link" href="ch11.html" title="Chapter 11. Utility Classes and Tools">Chapter 11</a></em></span>,<span class="emphasis"><em> Utility Classes and Tools</em></span>: This chapter introduces a set of utility classes and helpful techniques that improve the architecture of a CakePHP application.</p><p>The first recipe shows how to work with a CakePHP class that optimizes the manipulation of arrays. The second recipe shows how to send an e-mail using the<code class="literal"> Email</code> component. The third recipe shows how to use the<code class="literal"> MagicDb</code> class to detect the type of a file, and the last recipe shows how to create application exceptions, and properly handle them when they are thrown.</p></div></div>
<div class="section" title="What you need for this book"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec03"/>What you need for this book</h1></div></div></div><p>We need the following software for the book:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A web server supported by CakePHP (such as Apache)</li><li class="listitem" style="list-style-type: disc">A database engine supported by CakePHP (such as MySQL)</li><li class="listitem" style="list-style-type: disc">CakePHP installed, configured, and working properly</li></ul></div></div>
<div class="section" title="Who this book is for"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec04"/>Who this book is for</h1></div></div></div><p>If you are a CakePHP developer who wants to discover quick and easy ways to improve web applications, and to leverage all aspects of the framework, this book is for you. This book assumes that you already have knowledge of CakePHP and general PHP development skills.</p></div>
<div class="section" title="Conventions"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec05"/>Conventions</h1></div></div></div><p>In this book, you will find a number of styles of text that distinguish between different kinds of information. Here are some examples of these styles, and an explanation of their meaning.</p><p>Code words in text are shown as follows: "Create a file named<code class="literal"> query_log.php</code> and place it in your<code class="literal"> app/controllers/components</code> folder with the following contents:"</p><p>A block of code is set as follows:</p><div class="informalexample"><pre class="programlisting">CREATE TABLE `accounts`(
`id` INT UNSIGNED AUTO_INCREMENT NOT NULL,
`email` VARCHAR(255) NOT NULL,
PRIMARY KEY(`id`)
);
</pre></div><p>
<span class="strong"><strong>New terms</strong></span> and<span class="strong"><strong> important words</strong></span> are shown in bold. Words that you see on the screen, in menus or dialog boxes for example, appear in the text like this: "In that screen, make sure to grab what is shown as<span class="strong"><strong> Consumer key</strong></span> and<span class="strong"><strong> Consumer secret</strong></span>, as we will need it when going through this recipe."</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note01"/>Note</h3><p>Warnings or important notes appear in a box like this.</p></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip00"/>Tip</h3><p>Tips and tricks appear like this.</p></div></div>
<div class="section" title="Reader feedback"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec06"/>Reader feedback</h1></div></div></div><p>Feedback from our readers is always welcome. Let us know what you think about this book—what you liked or may have disliked. Reader feedback is important for us to develop titles that you really get the most out of.</p><p>To send us general feedback, simply send an e-mail to <code class="email">&lt;<a class="email" href="mailto:feedback@packtpub.com">feedback@packtpub.com</a>&gt;</code>, and mention the book title via the subject of your message.</p><p>If there is a book that you need and would like to see us publish, please send us a note in the<span class="strong"><strong> SUGGEST A TITLE</strong></span> form on <a class="ulink" href="http://www.packtpub.com">www.packtpub.com</a> or e-mail <code class="email">&lt;<a class="email" href="mailto:suggest@packtpub.com">suggest@packtpub.com</a>&gt;</code>.</p><p>If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, see our author guide on <a class="ulink" href="http://www.packtpub.com/authors">www.packtpub.com/authors</a>.</p></div>
<div class="section" title="Customer support"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec07"/>Customer support</h1></div></div></div><p>Now that you are the proud owner of a Packt book, we have a number of things to help you to get the most from your purchase.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip01"/>Tip</h3><p>
<span class="strong"><strong>Downloading the example code for this book</strong></span>
</p><p>You can download the example code files for all Packt books you have purchased from your account at <a class="ulink" href="http://www.PacktPub.com">http://www.PacktPub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.PacktPub.com/support">http://www.PacktPub.com/support</a> and register to have the files e-mailed directly to you.</p></div><div class="section" title="Errata"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec03"/>Errata</h2></div></div></div><p>Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you find a mistake in one of our books—maybe a mistake in the text or the code—we would be grateful if you would report this to us. By doing so, you can save other readers from frustration and help us improve subsequent versions of this book. If you find any errata, please report them by visiting <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a>, selecting your book, clicking on the<span class="strong"><strong> errata submission form</strong></span> link, and entering the details of your errata. Once your errata are verified, your submission will be accepted and the errata will be uploaded on our website, or added to any list of existing errata, under the Errata section of that title. Any existing errata can be viewed by selecting your title from <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a>.</p></div><div class="section" title="Piracy"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec04"/>Piracy</h2></div></div></div><p>Piracy of copyright material on the Internet is an ongoing problem across all media. At Packt, we take the protection of our copyright and licenses very seriously. If you come across any illegal copies of our works, in any form, on the Internet, please provide us with the location address or website name immediately so that we can pursue a remedy.</p><p>Please contact us at <code class="email">&lt;<a class="email" href="mailto:copyright@packtpub.com">copyright@packtpub.com</a>&gt;</code> with a link to the suspected pirated material.</p><p>We appreciate your help in protecting our authors, and our ability to bring you valuable content.</p></div><div class="section" title="Questions"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec05"/>Questions</h2></div></div></div><p>You can contact us at <code class="email">&lt;<a class="email" href="mailto:questions@packtpub.com">questions@packtpub.com</a>&gt;</code> if you are having a problem with any aspect of the book, and we will do our best to address it.</p></div></div></body></html>
<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Introduction and Shared Project Resources"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Introduction and Shared Project Resources</h1></div></div></div><p>What is this chapter for? I hope to use this first chapter to act as a primer for all other chapters and projects in the book. I would like you to use the introduction as a common resource containing all of the resources shared by the projects in the book.</p><p>The introduction will cover the installation of third-party software, libraries, helpers, and so on, that are required by the projects in the later chapters. By keeping these resources in this chapter, the projects aren't swamped with repetitive code and the project code can be kept as clean and concise as possible.</p><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">An overview of the book</li><li class="listitem" style="list-style-type: disc">Downloading CodeIgniter</li><li class="listitem" style="list-style-type: disc">Downloading and installing Twitter Bootstrap</li><li class="listitem" style="list-style-type: disc">Creating common header and footer files used for all projects</li><li class="listitem" style="list-style-type: disc">Installing Sparks</li><li class="listitem" style="list-style-type: disc">Common language items</li></ul></div><div class="section" title="Common resources"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Common resources</h1></div></div></div><p>The <a id="id0" class="indexterm"/>common resources used in this book are discussed in upcoming sections.</p><div class="section" title="Twitter Bootstrap"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec07"/>Twitter Bootstrap</h2></div></div></div><p>Every<a id="id1" class="indexterm"/> project in the chapters in this book uses Twitter <a id="id2" class="indexterm"/>Bootstrap. We will download Bootstrap and find a good place for it in our filesystem. We will then create the header and the footer files. All projects in the book will call these header and footer files (using the CodeIgniter function <code class="literal">$this-&gt;load-&gt;view()</code> to display views). However, these projects will not actually<a id="id3" class="indexterm"/> contain the code for the header and <a id="id4" class="indexterm"/>footer—only the <span class="emphasis"><em>working</em></span> code between the header and footer (what you might think of as the stuff in between the <code class="literal">&lt;body&gt;</code> and <code class="literal">&lt;/body&gt;</code> tags) will be detailed in each project.</p></div><div class="section" title="Headers and footers"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Headers and footers</h2></div></div></div><p>The<a id="id5" class="indexterm"/> menus will be different for individual projects. In<a id="id6" class="indexterm"/> the header file, we will include the code to display the menu, but the actual HTML contents for the menu will be included in each project's chapter. The footer file contains the closing HTML markup for each page.</p></div></div></div>
<div class="section" title="Downloading CodeIgniter"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Downloading CodeIgniter</h1></div></div></div><p>We'll <a id="id7" class="indexterm"/>need a copy of CodeIgniter to start with. This book isn't really aimed at the beginner, so the chances are reasonably high that you already have a copy of CodeIgniter installed or at least know your way around enough to skip this part; however, it does make sense to briefly go through the installation of CodeIgniter so that we have <a id="id8" class="indexterm"/>something to talk about in later chapters!</p><p>First things first, go to <a class="ulink" href="https://ellislab.com/codeigniter/user-guide/installation/downloads.html">https://ellislab.com/codeigniter/user-guide/installation/downloads.html</a>. You'll see something similar to what is shown in the following screenshot. This is the CodeIgniter download page. At the time of writing, the current CodeIgniter version is 2.2.0; this is why the screenshot says <span class="strong"><strong>Current version</strong></span> next to version 2.2.0; however, whichever version is the latest when you're reading this book is the version you want to use.</p><p>Click on the <span class="strong"><strong>Current version</strong></span> link, and CodeIgniter will begin to download.</p><div class="mediaobject"><img src="graphics/7093OS_01_01.jpg" alt="Downloading CodeIgniter"/></div><p>Once it's downloaded, navigate to where you have saved the file; this will be a compressed archive. Unpack it and move the contents of that file to a folder within your web root.</p><p>Specific<a id="id9" class="indexterm"/> details of routing, configuration, and database use are in each chapter (these details are specific to that particular chapter).</p><div class="section" title="CodeIgniter on newer versions of PHP"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec09"/>CodeIgniter on newer versions of PHP</h2></div></div></div><p>You may experience errors if you run CodeIgniter on newer versions of PHP. There is a hack for this that is explained at <a class="ulink" href="https://ellislab.com/forums/viewthread/244510/">https://ellislab.com/forums/viewthread/244510/</a>. A poster called <span class="emphasis"><em>milan.petrak</em></span> has described a work around. It can be summed up as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open the <code class="literal">/path/to/codeigniter/system/core/common.php</code> file and find the line 257.</li><li class="listitem">Find the following line:<div class="informalexample"><pre class="programlisting">$_config[0] =&amp; $config;
with
return $_config[0];
return $_config[0] =&amp; $config;</pre></div></li><li class="listitem">Save the <code class="literal">common.php</code> file.</li></ol></div><p>This will likely be permanently fixed in later releases of CodeIgniter, but for now, this is the fix.</p></div></div>
<div class="section" title="Installing Twitter Bootstrap"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Installing Twitter Bootstrap</h1></div></div></div><p>Twitter<a id="id10" class="indexterm"/> Bootstrap is a frontend HTML5 framework that allows anyone to easily construct reliable interfaces. At the time of writing, the version of Bootstrap used is version 3.1.1.</p><p>We will use Twitter Bootstrap throughout this book to provide the framework for all view files and templates. We will look at how to download Twitter Bootstrap and how to install it in the CodeIgniter filesystem.</p><p>Firstly, we will need to download the Twitter Bootstrap files. To do that, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open your<a id="id11" class="indexterm"/> web browser and go to the Bootstrap download link at <a class="ulink" href="http://getbootstrap.com/getting-started">http://getbootstrap.com/getting-started</a>. You'll see something similar to what is shown in the following screenshot:<div class="mediaobject"><img src="graphics/7093OS_01_02.jpg" alt="Installing Twitter Bootstrap"/></div></li><li class="listitem">Find the <span class="strong"><strong>Download Bootstrap</strong></span> link and click on it (as indicated in the preceding screenshot); the download will start automatically.</li></ol></div><p>Once the <a id="id12" class="indexterm"/>download is finished, go to its location on your machine and unpack the archived file. Inside the unpacked file, you should see something similar to what is shown in the following structure:</p><div class="informalexample"><pre class="programlisting">bootstrap/
├── css/
│   ├── bootstrap-theme.css
│   ├── bootstrap-theme.css.map
│   ├── bootstrap-theme.min.css
│   └── bootstrap.css
│   └── bootstrap.css.map
│   └── bootstrap.min.css
├── js/
│   ├── bootstrap.js
│   └── bootstrap.min.js
└── fonts/
    ├── glyphicons-halflings-regular.eot
    ├── glyphicons-halflings-regular.svg
    ├── glyphicons-halflings-regular.ttf
    └── glyphicons-halflings-regular.woff</pre></div><p>Move the <code class="literal">bootstrap</code> folder to your CodeIgniter installation so that the file hierarchy looks like the following:</p><div class="informalexample"><pre class="programlisting">/path/to/web/root/
├── application/
└── views/
    ├── common
        ├── header.php
        ├── footer.php
├── system/
├── bootstrap/
├── index.php
├── license.txt</pre></div><p>In the preceding tree structure, the <code class="literal">application</code> and <code class="literal">system</code> directories are to do with CodeIgniter, as are the <code class="literal">index.php</code> and <code class="literal">license.txt</code> files; however, the <code class="literal">bootstrap</code> directory contains the contents of your Bootstrap download.</p><p>I have also indicated the location of the common <code class="literal">header.php</code> and <code class="literal">footer.php</code> files. These files are used throughout the book and act as a wrapper for every other view file.</p></div>
<div class="section" title="Removing index.php from the address bar"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Removing index.php from the address bar</h1></div></div></div><p>It is <a id="id13" class="indexterm"/>possible to remove <code class="literal">index.php</code> from the web<a id="id14" class="indexterm"/> browser address bar when CodeIgniter is running. This can be done by following these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create or open a <code class="literal">.htaccess</code> file. If a <code class="literal">.htaccess</code> file does not already exist, you can create one using the following:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Linux/Mac</strong></span>: Open <a id="id15" class="indexterm"/>a terminal window and type the following:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>touch /path/to/CodeIgniter/.htaccess</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows</strong></span>: Create <a id="id16" class="indexterm"/>a text file in your CodeIgniter root, naming it <code class="literal">file.htaccess</code>. Hold down the Windows key and then press <span class="emphasis"><em>R</em></span> to open the <span class="strong"><strong>Run</strong></span> dialogue. Enter the following command and click on <span class="strong"><strong>OK</strong></span>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ren "C:\path\to\CodeIgniter\file.htaccess" .htaccess</strong></span>
</pre></div></li></ul></div></li><li class="listitem">Once your <code class="literal">.htaccess</code> file is opened, write the following lines at the top of the file:<div class="informalexample"><pre class="programlisting">&lt;IfModule mod_rewrite.c&gt;
RewriteEngine on
RewriteCond $1 !^(index\.php|images|robots\.txt)
RewriteRule ^(.*)$ index.php/$1 [L]
&lt;/IfModule&gt;</pre></div></li></ol></div></div>
<div class="section" title="Installing and using Sparks"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Installing and using Sparks</h1></div></div></div><p>For a <a id="id17" class="indexterm"/>long time, you had to search the Internet and download <a id="id18" class="indexterm"/>code from various places—blogs, code repositories, and so on—to find and use extensions, libraries, and other useful snippets of code for CodeIgniter. Useful installations for CodeIgniter were spread across the Internet; as such, they might have been hard to locate. Sparks acts as a single point of reference for extensions of CodeIgniter. It's simple to install and use and contains thousands of useful add-ons for CodeIgniter:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If you are using a Mac or Linux, then the command-line interface is open to you. Using the terminal application on your system, navigate to the root of your CodeIgniter application and enter the following line:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>php -r "$(curl -fsSL http://getsparks.org/go-sparks)"</strong></span>
</pre></div><p>If your installation was successful, you should see something similar to the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>user@server:/path/to/codeigniter$ php -r "$(curl -fsSL http://getsparks.org/go-sparks)"</strong></span>
<span class="strong"><strong>Pulling down spark manager from http://getsparks.org/static/install/spark-manager-0.0.9.zip ...</strong></span>
<span class="strong"><strong>Pulling down Loader class core extension from http://getsparks.org/static/install/MY_Loader.php.txt ...</strong></span>
<span class="strong"><strong>Extracting zip package ...</strong></span>
<span class="strong"><strong>Cleaning up ...</strong></span>
<span class="strong"><strong>Spark Manager has been installed successfully!</strong></span>
<span class="strong"><strong>Try: `php tools/spark help`</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">If you<a id="id19" class="indexterm"/> are using Windows, then you will need to download <a id="id20" class="indexterm"/>Sparks and unpack it manually; to do that, follow these instructions or check out the instructions on the GetSparks website for the latest version:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create <a id="id21" class="indexterm"/>a folder called <code class="literal">tools</code> in the top level (root) or in your CodeIgniter directory.</li><li class="listitem">Go to <a class="ulink" href="http://getsparks.org/install">http://getsparks.org/install</a>.</li><li class="listitem">Go to the <span class="strong"><strong>Normal Installation</strong></span> section and download the Sparks package.</li><li class="listitem">Unpack the download into the <code class="literal">tools</code> folder you created in step 1.</li><li class="listitem">Download<a id="id22" class="indexterm"/> the Loader class extension from <a class="ulink" href="http://getsparks.org/static/install/MY_Loader.php.txt">http://getsparks.org/static/install/MY_Loader.php.txt</a>.</li><li class="listitem">Rename the file <code class="literal">MY_Loader.php.txt</code> to <code class="literal">MY_Loader.php</code> and move it to the <code class="literal">application/core/MY_Loader.php</code> location in your CodeIgniter instance.</li></ol></div></li></ul></div><p>Now that Sparks is installed in your CodeIgniter instance, you can begin to install extensions and packages.</p><p>To install a package from Sparks, type the following in the command-line window:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>php tools/spark install [Package Version] Spark Name</strong></span>
</pre></div><p>Here, <code class="literal">Package Version</code> is the specific version of the Spark you wish to install. You are not required to state the version and, if you it out, Sparks will download the latest version by default. <code class="literal">Spark Name</code> is the name of the Spark you wish to install; for example, to install <code class="literal">example-spark</code> (version 1.0.0), which comes with the default installation, type the following in the command-line window:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>php tools/spark install -v1.0.0 example-spark</strong></span>
</pre></div><p>If the installation was successful, you should see something similar to the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>user@server:/path/to/codeigniter$ php tools/spark install -v1.0.0 example-spark</strong></span>
<span class="strong"><strong>[ SPARK ] Retrieving spark detail from getsparks.org</strong></span>
<span class="strong"><strong>[ SPARK ] From Downtown! Retrieving spark from Mercurial repository at https://url/of/the/spark/repo</strong></span>
<span class="strong"><strong>[ SPARK ] Spark installed to ./sparks/example-spark/1.0.0 - You're on fire!</strong></span>
</pre></div></div>
<div class="section" title="Creating a shared header and footer view"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Creating a shared header and footer view</h1></div></div></div><p>Every<a id="id23" class="indexterm"/> project throughout this book will use the common header and footer files that we will create here; navigation menus will be different for each project and, as such, we will build these in the project's chapter themselves. But for now, let's look at the common header and footer files:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create the <code class="literal">header.php</code> file at <code class="literal">/path/to/codeigniter/application/views/common/</code> and add the following code to it:<div class="informalexample"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
    &lt;meta name="description" content=""&gt;
    &lt;meta name="author" content=""&gt;
    &lt;link rel="shortcut icon" href="&lt;?php echo base_url('bootstrap/ico/favicon.ico'); ?&gt;"&gt;

    &lt;title&gt;&lt;?php echo $this-&gt;lang-&gt;line('system_system_name'); ?&gt;&lt;/title&gt;

    &lt;!-- Bootstrap core CSS --&gt;
    &lt;link href="&lt;?php echo base_url('bootstrap/css/bootstrap.min.css'); ?&gt;" rel="stylesheet"&gt;
    &lt;!-- Bootstrap theme --&gt;
    &lt;link href="&lt;?php echo base_url('bootstrap/css/bootstrap-theme.min.css'); ?&gt;" rel="stylesheet"&gt;

    &lt;!-- Custom styles for this template --&gt;
    &lt;link href="&lt;?php echo base_url('bootstrap/css/theme.css');?&gt;" rel="stylesheet"&gt;

    &lt;!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --&gt;
    &lt;!--[if lt IE 9]&gt;
      &lt;script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"&gt;&lt;/script&gt;
      &lt;script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"&gt;&lt;/script&gt;
    &lt;![endif]--&gt;
  &lt;/head&gt;

  &lt;body role="document"&gt;

&lt;!-- END header.php --&gt;

    &lt;div class="container theme-showcase" role="main"&gt;</pre></div><p>The preceding view file contains the HTML for the head of a document. This is to say that this HTML is used throughout the book for every project, and it contains the HTML markup for everything from the opening <code class="literal">html</code> tag, opening and closing <code class="literal">head</code> tags, and the opening <code class="literal">body</code> tag.</p></li><li class="listitem">Create<a id="id24" class="indexterm"/> the <code class="literal">footer.php</code> file at <code class="literal">/path/to/codeigniter/application/views/common/</code> and add the following code to it:<div class="informalexample"><pre class="programlisting">    &lt;/div&gt; &lt;!-- /container --&gt;
    &lt;link href="&lt;?php echo base_url('bootstrap/css/bootstrap.min.css'); ?&gt;" rel="stylesheet"&gt;

        &lt;!-- Bootstrap core JavaScript
    ================================================== --&gt;
    &lt;!-- Placed at the end of the document so the pages load faster --&gt;
    &lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"&gt;&lt;/script&gt;
    &lt;script src="&lt;?php echo base_url('bootstrap/js/bootstrap.min.js');?&gt;"&gt;&lt;/script&gt;
    &lt;script src="&lt;?php echo base_url('bootstrap/js/docs.min.js');?&gt;"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></div><p>The preceding block of code contains the HTML markup for the footer view file used for every project throughout this book.</p></li></ol></div></div>
<div class="section" title="Common language items"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Common language items</h1></div></div></div><p>In each project throughout the book, we will create a specific language file containing specific<a id="id25" class="indexterm"/> language items that are relevant to that particular project. However, there are also common language elements that we won't repeat in each project (as there's no need); thus, we can have them here instead.</p><p>The language items mostly cover screen elements such as general navigation, general error and success messages, and CRUD actions (edit, delete, and so on).</p><p>With that in mind, let's go ahead and create the base language file that will serve as a template for the chapters in this book.</p><p>Create the <code class="literal">en_admin_lang.php</code> file at <code class="literal">/path/to/codeigniter/application/language/english/</code> and add the following code to it:</p><div class="informalexample"><pre class="programlisting">// Common form elements
$lang['common_form_elements_next'] = "Next...";
$lang['common_form_elements_save'] = "Save...";
$lang['common_form_elements_cancel'] = "Cancel";
$lang['common_form_elements_go'] = "Go...";
$lang['common_form_elements_go_back'] = "Go back";
$lang['common_form_elements_submission_error'] = "There were errors with the form:";
$lang['common_form_elements_success_notifty'] = "Success:";
$lang['common_form_elements_error_notifty'] = "Error:";
$lang['common_form_elements_actions'] = "Actions";
$lang['common_form_elements_action_edit'] = "Edit";
$lang['common_form_elements_action_delete'] = "Delete";
$lang['common_form_elements_active'] = "Active";
$lang['common_form_elements_inactive'] = "Inactive";
$lang['common_form_elements_seccessful_change'] = "Your changes have been saved";
$lang['common_form_elements_seccessful_delete'] = "The item has been deleted";
$lang['common_form_elements_yes'] = "Yes";
$lang['common_form_elements_no'] = "No";
$lang['common_form_elements_to'] = "to";
$lang['common_form_elements_from'] = "from";
$lang['common_form_elements_history'] = "History";</pre></div><p>The preceding language items are mostly for HTML forms and tables of data, such as the text for the Submit, Edit, Delete, and History buttons. Also included are general error or success messages. Feel free to add to them if you wish.</p></div>
<div class="section" title="Creating the MY_Controller file"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec15"/>Creating the MY_Controller file</h1></div></div></div><p>All projects<a id="id26" class="indexterm"/> in this book make use of the <code class="literal">MY_Controller</code> file; this is the same for all projects.</p><p>Create the <code class="literal">MY_Controller.php</code> file at <code class="literal">/path/to/codeigniter/application/core/</code> and add the following code to it:</p><div class="informalexample"><pre class="programlisting">&lt;?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');
class MY_Controller extends CI_Controller {

    function __construct() {
        parent::__construct();
        $this-&gt;load-&gt;helper('form');
        $this-&gt;load-&gt;helper('url');
        $this-&gt;load-&gt;helper('security');
        $this-&gt;load-&gt;helper('language');

        // Load language file
        $this-&gt;lang-&gt;load('en_admin', 'english');
    }
}</pre></div><p>As you can see, we load helpers that are common to all projects, such as the <code class="literal">form</code> helper and the <code class="literal">language</code> helper, among others. The language file is also loaded here.</p><p>All the controllers in the project extend from this <code class="literal">MY_Controller</code> file rather than the default <code class="literal">CI_Controller</code> file.</p></div>
<div class="section" title="Autoloading common system resources"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec16"/>Autoloading common system resources</h1></div></div></div><p>We also<a id="id27" class="indexterm"/> are autoloading various resources such as support for database access and session management. We need to specify that we're using these resources.</p><p>Open the <code class="literal">autoload.php</code> file from <code class="literal">/path/to/codeigniter/application/config/</code> in your text editor and find the following line:</p><div class="informalexample"><pre class="programlisting">$autoload['libraries'] = array();</pre></div><p>Replace this line with the following:</p><div class="informalexample"><pre class="programlisting">$autoload['libraries'] = array('database', 'session');</pre></div><p>This will ensure that the resources that are required in order to access the database and to manage sessions are always with us.</p></div>
<div class="section" title="Security considerations"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec17"/>Security considerations</h1></div></div></div><p>Whatever<a id="id28" class="indexterm"/> you are programming, your two main priorities are security and maintainability; this is to say that your application should be as secure as is necessary and should be written in such a way that someone else can easily program and extend on what you're doing. I can't discuss maintainability—that's up to you—but I can give you guidance on CodeIgniter and security.</p><p>However, I should say that no security is 100 percent foolproof. Even banks and security agencies that spend hundreds of millions on systems still get hacked, so what chance do we have? Well, the best we can do is try to reduce the opportunity that someone might do something that could compromise our code or database.</p><div class="section" title="Moving the system folder"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Moving the system folder</h2></div></div></div><p>You <a id="id29" class="indexterm"/>should move your system folder<a id="id30" class="indexterm"/> out of your web root. This is to make it as hard as possible for anything other than the web server to access. Take a look at the line in the main <code class="literal">index.php</code> file:</p><div class="informalexample"><pre class="programlisting">$system_path = 'system';</pre></div><p>Make sure that you amend the preceding line to this:</p><div class="informalexample"><pre class="programlisting">$system_path = '<span class="strong"><strong>../</strong></span>system';</pre></div><p>So, if we moved the <code class="literal">system</code> folder out of the web root one level higher, we would use the<code class="literal">../</code> convention, prepending it to <code class="literal">system</code>.</p></div><div class="section" title="Error messages"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Error messages</h2></div></div></div><p>Obviously<a id="id31" class="indexterm"/> you don't want to actually display <a id="id32" class="indexterm"/>error messages to the outside world. Over time, everyone will gain an understanding of the architecture of your site and where its weaknesses are, especially if you allow SQL errors to be displayed in a production environment.</p><p>For this reason, you should change the environment variable in the main <code class="literal">index.php</code> file from <code class="literal">development</code> to <code class="literal">production</code>. This will suppress the reporting errors; 404 and 500 errors will still be caught and displayed normally but SQL errors and other similar errors will be suppressed.</p><p>For this, look at the following code in the <code class="literal">index.php</code> file:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>define('ENVIRONMENT', 'development');</strong></span>
/*
 *---------------------------------------------------------------
 * ERROR REPORTING
 *---------------------------------------------------------------
 *
 * Different environments will require different levels of error reporting.
 * By default development will show errors but testing and live will hide them.
 */

if (defined('ENVIRONMENT'))
{
  switch (ENVIRONMENT)
  {
    case 'development':
      error_reporting(E_ALL);
    break;

    case 'testing':
    case 'production':
      error_reporting(0);
    break;

    default:
      exit('The application environment is not set correctly.');
  }
}</pre></div><p>Look at<a id="id33" class="indexterm"/> the line in bold (the first line). This line <a id="id34" class="indexterm"/>has set CodeIgniter to run in development mode; to change to anything else (specifically, a live mode), change the line in bold to the following:</p><div class="informalexample"><pre class="programlisting">define('ENVIRONMENT', 'production');</pre></div><p>All errors will now be suppressed.</p></div><div class="section" title="Query binding"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Query binding</h2></div></div></div><p>Query <a id="id35" class="indexterm"/>binding is a good idea; it makes your queries<a id="id36" class="indexterm"/> easier to read; queries that use the CodeIgniter binding are automatically escaped, leading to more secure queries. The syntax is simple; for example, consider the following query:</p><div class="informalexample"><pre class="programlisting">$query = "SELECT * FROM `users` WHERE user_email = ? AND user_level = ?";</pre></div><p>Look at the end of the query; you can see that we use a question mark where we would normally use a variable; this is something that would normally look like this:</p><div class="informalexample"><pre class="programlisting">$query = "SELECT * FROM `users` WHERE user_email = $user_email AND user_level = $user_level";</pre></div><p>How does CodeIgniter know what the question mark means, and how does CodeIgniter put the correct value in the query? Take a look at this second line:</p><div class="informalexample"><pre class="programlisting">$this-&gt;db-&gt;query($query, array($user_email, $user_level));</pre></div><p>This is <a id="id37" class="indexterm"/>how it matches the value to the correct<a id="id38" class="indexterm"/> question mark. We use the <code class="literal">$this-&gt;db-&gt;query()</code>CodeIgniter function, passing to it two arguments. The first is the <code class="literal">$query</code> variable (containing the actual query), and the second is an array. Each position in the array matches the position of the question marks in the SQL string.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec18"/>Summary</h1></div></div></div><p>Now, you will discover that we are ready to start the book and are all set to tackle each chapter.</p><p>Remember that the code for each chapter is available at the Packt website, as is the SQL for each chapter; this will save you from having to type in all this stuff.</p></div></body></html>
<html><head></head><body><div class="chapter" title="Chapter&#xA0;6.&#xA0;Enhancing the Content Author's User Experience"><div class="titlepage"><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Enhancing the Content Author's User Experience</h1></div></div></div><p><span class="emphasis"><em>In this chapter, we are going to explore the built-in WYSIWYG editor that is in the Drupal 8 core, and explore the concepts of CKEditor plugins, Drupal Plugin API, and Block API.</em></span></p><p>In this chapter, we will learn:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">How to use the built-in WYSIWYG editor for Drupal</li><li class="listitem" style="list-style-type: disc">How inline editing works and how to get the best out of it</li><li class="listitem" style="list-style-type: disc">How to make changes and save them through configuration</li><li class="listitem" style="list-style-type: disc">How to create a custom block via the new Block API</li><li class="listitem" style="list-style-type: disc">How to include default configuration in our custom block</li></ul></div><div class="section" title="A quick introduction to CKEditor in Drupal 8"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec68"/>A quick introduction to CKEditor in Drupal 8</h1></div></div></div><p>Drupal 8 <a class="indexterm" id="id351"/>is finally<a class="indexterm" id="id352"/> shipping with a default WYSIWYG editor: CKEditor. CKEditor is an open source text editor that aims to bring word processing features to web pages. In previous versions of Drupal, several modules tried to fill this gap, but their configuration at most times was a bit tricky as they were relying on external JavaScript libraries.</p><p>Bringing CKEditor's capabilities directly in core, Drupal 8 can provide a richer authoring experience to content editors. Users are given a drag-and-drop interface to customize available functionality and export configurations to share with other systems. Developers are given a unified way of accessing properties, adding plugins, and extending the editor's functionality:</p><div class="mediaobject"><img alt="A quick introduction to CKEditor in Drupal 8" src="graphics/4659_06_00.jpg"/></div></div></div>
<div class="section" title="Configuring CKEditor profiles"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec69"/>Configuring CKEditor profiles</h1></div></div></div><p>CKEditor<a class="indexterm" id="id353"/> profiles would not be much without the ability of being customized to the editor's liking. Now we are going to customize the basic HTML profile. Log in to your Drupal 8 website and you should see the new admin toolbar.</p></div>
<div class="section" title="Time for action - adding some buttons to the basic HTML profile"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec70"/>Time for action - adding some buttons to the basic HTML profile</h1></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Click <a class="indexterm" id="id354"/>on <span class="strong"><strong>Configuration</strong></span> and then on <span class="strong"><strong>Text formats and editors</strong></span>:<div class="mediaobject"><img alt="Time for action - adding some buttons to the basic HTML profile" src="graphics/4659_06_01.jpg"/></div></li><li class="listitem">On<a class="indexterm" id="id355"/> the <span class="strong"><strong>Text formats and editor</strong></span> screen, click on the <span class="strong"><strong>Configure</strong></span> button next to the <span class="strong"><strong>Basic HTML</strong></span> profile:<div class="mediaobject"><img alt="Time for action - adding some buttons to the basic HTML profile" src="graphics/4659_06_02.jpg"/></div></li><li class="listitem">Scroll<a class="indexterm" id="id356"/> down to <span class="strong"><strong>TOOLBAR CONFIGURATION</strong></span>, and drag the image icon out of the toolbar into the pool of other elements to remove it from the configuration. Note that the image and the configuration are no longer part of the page:<div class="mediaobject"><img alt="Time for action - adding some buttons to the basic HTML profile" src="graphics/4659_06_03.jpg"/></div></li><li class="listitem">Click <a class="indexterm" id="id357"/>on <span class="strong"><strong>Save configuration</strong></span> at the very bottom of the page:<div class="mediaobject"><img alt="Time for action - adding some buttons to the basic HTML profile" src="graphics/4659_06_04.jpg"/></div></li><li class="listitem">That's it! If you<a class="indexterm" id="id358"/> visit a content page form and choose the <span class="strong"><strong>Basic HTML</strong></span> profile, then the image button will not be there anymore:<div class="mediaobject"><img alt="Time for action - adding some buttons to the basic HTML profile" src="graphics/4659_06_05.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec54"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>Following this procedure, we customized the existing profiles by removing the upload image button from the CKEditor profile.</p><p>Configurations are exportable in D8 and can be imported to other environments.</p></div></div>
<div class="section" title="Time for action - exporting CKEditor configuration"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec71"/>Time for action - exporting CKEditor configuration</h1></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Click<a class="indexterm" id="id359"/> on <span class="strong"><strong>Configuration</strong></span>. Then click on <span class="strong"><strong>Configuration </strong></span>synchronization and select the <span class="strong"><strong>Export</strong></span> tab. Click on <span class="strong"><strong>Single item</strong></span>.</li><li class="listitem">On the <span class="strong"><strong>Configuration type</strong></span>, choose <span class="strong"><strong>Text Editor</strong></span>, and on <span class="strong"><strong>Configuration name</strong></span>, choose <span class="strong"><strong>Basic HTML</strong></span>:<div class="mediaobject"><img alt="Time for action - exporting CKEditor configuration" src="graphics/4659_06_06.jpg"/></div></li><li class="listitem">Copy <a class="indexterm" id="id360"/>the configuration and import it into another environment by clicking on <span class="strong"><strong>Configuration</strong></span>. Then click on <span class="strong"><strong>Configuration synchronization</strong></span> and select the <span class="strong"><strong>Import</strong></span> tab. Click on <span class="strong"><strong>Single item</strong></span>:<div class="mediaobject"><img alt="Time for action - exporting CKEditor configuration" src="graphics/4659_06_07.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec55"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>You have<a class="indexterm" id="id361"/> configured an existing profile, removed some fields, and learned how to export that configuration and import it into another environment.</p></div></div>
<div class="section" title="Adding a new CKEditor profile"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec72"/>Adding a new CKEditor profile</h1></div></div></div><p>Most <a class="indexterm" id="id362"/>often, built-in profiles cover a website's needs. The defaults, however, do not provide a way for anonymous users to have a smooth editing experience when inputting text (for example, comments). To provide that functionality, we need to create a new profile and assign it to the anonymous user.</p></div>
<div class="section" title="Time for action - creating a text-only control profile for anonymous users"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec73"/>Time for action - creating a text-only control profile for anonymous users</h1></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From<a class="indexterm" id="id363"/> the admin toolbar, go to <span class="strong"><strong>Configuration</strong></span> | <span class="strong"><strong>Text formats and editors</strong></span> and choose <span class="strong"><strong>Add text format</strong></span>:<div class="mediaobject"><img alt="Time for action - creating a text-only control profile for anonymous users" src="graphics/4659_06_08.jpg"/></div></li><li class="listitem">For the name, enter <code class="literal">Text only controls</code>. Tick on <span class="strong"><strong>Anonymous user</strong></span> and choose <span class="strong"><strong>CKEditor</strong></span> in the <span class="strong"><strong>Text editor</strong></span> drop-down box.</li><li class="listitem">Add the <span class="strong"><strong>Underline</strong></span> button and keep <span class="strong"><strong>Bold, Italic and Ordered/Unordered</strong></span> lists.</li><li class="listitem">Enable the following filters:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Limit allowed HTML tags and correct faulty HTML</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Convert line breaks into HTML (i.e. &lt;br&gt; and &lt;p&gt;)</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Correct faulty and chopped off HTML</strong></span></li></ul></div></li><li class="listitem">Save <a class="indexterm" id="id364"/>the configuration:<div class="mediaobject"><img alt="Time for action - creating a text-only control profile for anonymous users" src="graphics/4659_06_09.jpg"/></div></li><li class="listitem">The <span class="strong"><strong>Text formats and editors</strong></span> configuration page should contain the newly created <a class="indexterm" id="id365"/>format. Move the new format above the <span class="strong"><strong>Restricted HTML</strong></span> format, which is an alternative provided by Drupal for anonymous users skipping the editor altogether:<div class="mediaobject"><img alt="Time for action - creating a text-only control profile for anonymous users" src="graphics/4659_06_10.jpg"/></div></li><li class="listitem">That's it! If you visit a page that allows comments from anonymous users, the newly created format will be used to capture those comments:<div class="mediaobject"><img alt="Time for action - creating a text-only control profile for anonymous users" src="graphics/4659_06_11.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec56"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>You just <a class="indexterm" id="id366"/>added a new CKEditor profile that targets anonymous users on your website, giving them the ability to input rich text and lists.</p></div></div>
<div class="section" title="Classic editor and inline editing"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec74"/>Classic editor and inline editing</h1></div></div></div><p>The examples<a class="indexterm" id="id367"/> we have seen so far used CKEditor at the backend. This is based on an iframe being added to the page, and they do not share the CSS styles as they appear on the frontend. You can, however, customize the CSS of the editor by including the following in your <code class="literal">.info.yml</code> theme file:</p><div class="informalexample"><pre class="programlisting">ckeditor_stylesheets[] = css/ckeditor-iframe.css</pre></div><p>An exciting new <a class="indexterm" id="id368"/>possibility in Drupal 8 is the use of inline editing. This is used for quick in-place edits and is used without an iframe. Inline editing gives editors the ability to quickly edit a piece of content without the need to edit the full node. CSS styles are inherited from the theme, leading to a real WYSISYG experience.</p></div>
<div class="section" title="Time for action &#x2013; using inline editing"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec75"/>Time for action – using inline editing</h1></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Ensure<a class="indexterm" id="id369"/> that the <span class="strong"><strong>Quick edit</strong></span> module is enabled.</li><li class="listitem">Click on the pencil icon in the top left of the page and select <span class="strong"><strong>Quick edit</strong></span>:<div class="mediaobject"><img alt="Time for action – using inline editing" src="graphics/4659_06_12.jpg"/></div></li><li class="listitem">The new <a class="indexterm" id="id370"/>editor instance opens at the top of the content area, and you can start editing text straightaway:<div class="mediaobject"><img alt="Time for action – using inline editing" src="graphics/4659_06_13.jpg"/></div></li><li class="listitem">That's it! You <a class="indexterm" id="id371"/>can now use this instead of visiting the edit form to quickly edit things on the fly.</li></ol></div></div>
<div class="section" title="Adding widgets to CKEditor"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec76"/>Adding widgets to CKEditor</h1></div></div></div><p>CKEditor <a class="indexterm" id="id372"/>comes preconfigured with a series of buttons that can be added to a profile. As a programmer, you can extend CKEditor and add your own buttons. This can happen by adding plugins or widgets. The difference between the two is that widgets are plugins that group the behavior of more than one component. An example of a widget is an image where the image itself, alternative text, and a caption form an item and they can be moved around the WYSIWYG area as one item.</p><p>To use additional widgets, you will need to do two things:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download or create a plugin for CKEditor.</li><li class="listitem">Tell the Drupal core that a new CKEditor plugin should be loaded.</li></ol></div><p>To learn more about the CKEditor side of things, read the documentation on adding CKEditor plugins or CKEditor widgets. Plugins and widgets<a class="indexterm" id="id373"/> for CKEditor can be downloaded from <a class="ulink" href="http://ckeditor.com/addons/plugins/all">http://ckeditor.com/addons/plugins/all</a>.</p><p>Once you have a CKEditor plugin, you need to tell Drupal core that a new CKEditor plugin needs to be loaded via <code class="literal">\Drupal\ckeditor\CKEditorPluginInterface</code>. This will create a 1:1 relationship between the CKEditor JavaScript plugin and the Drupal CKEditor Plugin plugin (a confusing name, nonetheless). A default implementation is provided via <code class="literal">Drupal\ckeditor\CKEditorPluginBase</code>, so not every method needs to be implemented by CKEditor plugins.</p><p>Additionally, the following interfaces can be implemented on the Drupal side to extend the plugin functionality:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">\Drupal\ckeditor\CKEditorPluginButtonsInterface</code> allows a CKEditor plugin to define which buttons it provides so that users can configure a CKEditor toolbar instance via the drag-and-drop-based UI</li><li class="listitem" style="list-style-type: disc"><code class="literal">\Drupal\ckeditor\CKEditorPluginContextualInterface</code> allows a CKEditor plugin to enable itself automatically based on the context: if some other CKEditor plugin's button is enabled, if some filter is enabled, if some CKEditor plugin's setting has a certain value, or a combination of all of these</li><li class="listitem" style="list-style-type: disc"><code class="literal">\Drupal\ckeditor\CKEditorPluginConfigurableInterface</code> allows a CKEditor plugin to define a settings form to configure any settings that this CKEditor plugin may have</li><li class="listitem" style="list-style-type: disc"><code class="literal">\Drupal\ckeditor\CKEditorPluginCssInterface</code> allows a CKEditor plugin to define additional CSS to be loaded in iframe instances of CKEditor</li></ul></div><p>To do that, you will need to create a new module utilizing the Drupal Plugin API. Even though CKEditor and Drupal share the notation of plugins, note that these are very different things. As per the Drupal Plugin API, plugin implementations must be annotated with the <code class="literal">@CKEditorPlugin</code> annotation so that they can be discovered.</p><p>When creating <a class="indexterm" id="id374"/>CKEditor plugins, keep in mind that you are creating functionality intended for content editors, so the user interface and user experience should be excellent. Have a look at <code class="literal">ckeditor.drupalimage.admin.js</code> and <code class="literal">ckeditor.stylescombo.admin.js</code> for examples of good implementations (see also <a class="ulink" href="https://www.drupal.org/node/2567801">https://www.drupal.org/node/2567801</a>).</p><p>We will extensively make use of the Drupal Plugin API in the next section of this chapter when adding a new block, but Drupal plugins are essentially swappable pieces of functionality.</p><div class="section" title="Have a go hero - create a CKEditor plugin and allow Drupal to discover it"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec57"/>Have a go hero - create a CKEditor plugin and allow Drupal to discover it</h2></div></div></div><p>To declare a <a class="indexterm" id="id375"/>Drupal instance of a CKEditor plugin, you need to follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create your module structure as follows. Within <code class="literal">js</code>, the CKEditor plugin is placed, and the Drupal plugin is placed within <code class="literal">lib</code>:<div class="mediaobject"><img alt="Have a go hero - create a CKEditor plugin and allow Drupal to discover it" src="graphics/4659_06_14.jpg"/></div></li><li class="listitem">Ensure that the CKEditor plugin (named <code class="literal">plugin.js</code> within the <code class="literal">js</code> directory) is namespaced as Drupal expects it:<div class="informalexample"><pre class="programlisting">(function ($, Drupal, drupalSettings, CKEDITOR) {

  /* existing plugin code */

})(jQuery, Drupal, drupalSettings, CKEDITOR)</pre></div></li><li class="listitem">Create the file that will contain the class:<div class="informalexample"><pre class="programlisting">DRUPAL_ROOT/modules/MODULE_NAME/lib/Drupal/PLUGIN_NAME/Plugin/CKEditorPlugin/PLUGIN_NAME.php</pre></div></li><li class="listitem">Extend <a class="indexterm" id="id376"/>the <code class="literal">CKEditorPluginBase</code> class within that file:<div class="informalexample"><pre class="programlisting">&lt;?php
/**
 * @file
 * Contains \Drupal\PLUGIN_NAME\Plugin\CKEditorPlugin\PLUGIN_NAME.
 */

namespace Drupal\PLUGIN_NAME\Plugin\CKEditorPlugin;

use Drupal\ckeditor\CKEditorPluginBase;
use Drupal\Core\Plugin\PluginBase;
use Drupal\ckeditor\CKEditorPluginInterface;
use Drupal\ckeditor\CKEditorPluginButtonsInterface;
use Drupal\ckeditor\CKEditorPluginConfigurableInterface;
use Drupal\ckeditor\CKEditorPluginContextualInterface;
use Drupal\editor\Entity\Editor;
use Drupal\ckeditor\Annotation\CKEditorPlugin;
use Drupal\Core\Annotation\Translation;

/**
 * Defines the "PLUGIN_NAME" plugin.
 * @see MetaContextual
 * @see MetaButton
 * @see MetaContextualAndButton
 *
 * @CKEditorPlugin(
 *   id = "PLUGIN_NAME",
 *   label = @Translation("PLUGIN_NAME")
 * )
 */

class PLUGIN_NAME extends CKEditorPluginBase implements CKEditorPluginConfigurableInterface, CKEditorPluginContextualInterface {

// your code here

}</pre></div></li></ol></div><p>For further information, you can visit the documentation for the <code class="literal">Drupal\ckeditor</code> namespace at <a class="ulink" href="https://api.drupal.org/api/drupal/namespace/Drupal%21ckeditor/8.2.x">https://api.drupal.org/api/drupal/namespace/Drupal%21ckeditor/8.2.x</a>.</p></div></div>
<div class="section" title="Introduction to the Block API for Drupal 8"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec77"/>Introduction to the Block API for Drupal 8</h1></div></div></div><p>In Drupal 7, adding <a class="indexterm" id="id377"/>a block was just a matter of implementing a hook such as <code class="literal">hook_block_info()</code> and a few more in a custom module. The block then was available in the user interface for you to place wherever you wanted.</p><p>In Drupal 8, custom blocks provided by a module implement the Block Plugin API, which is a subset of the more generic Plugin API. What used to be info hooks that returned arrays for block discovery is now composed of Annotations and the use of PSR-0, so Drupal can both find and understand your blocks. Callback functions that returned the content of your block are now methods on <code class="literal">Drupal\block\BlockPluginInterface</code> that we can override as needed in our custom block code.</p><p>Creating a block in Drupal 8 requires creating a plugin according to the Plugin API and annotation-based plugin discovery. Throughout the book, we have seen both of these at play when creating field widgets or CKEditor profiles.</p><p>A workflow of creating a block can be visualized as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a block plugin using annotations.</li><li class="listitem">Implement the <code class="literal">Drupal\Core\Block\BlockBase</code> class.</li><li class="listitem">Implement the <code class="literal">Drupal\Core\Block\BlockPluginInterface</code> class methods according to the use case.</li></ol></div><p>For a custom block named <code class="literal">author_tool</code>, a PSR-4-compliant structure is <code class="literal">author_tool/src/Plugin/Block</code>:</p><div class="mediaobject"><img alt="Introduction to the Block API for Drupal 8" src="graphics/4659_06_15.jpg"/></div></div>
<div class="section" title="Time for action &#x2013; creating a block to aid the authoring experience"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec78"/>Time for action – creating a block to aid the authoring experience</h1></div></div></div><p>Let's create <a class="indexterm" id="id378"/>a custom block that will be available to authenticated users to create new recipes when visiting a recipe page. Our module will be called <code class="literal">author_tool</code>:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a structure similar to what we saw in the last screenshot.</li><li class="listitem">Create a <code class="literal">author_tool.info.yml</code> file and create a dependency of your module with the block system:<div class="informalexample"><pre class="programlisting">name: Author tool
type: module
description: A custom block to allow content editors to quickly add a new recipe.
core: 8.x
dependencies:
  - block</pre></div></li><li class="listitem">Extend<a class="indexterm" id="id379"/> the <code class="literal">BlockBase</code> class with your own implementation, <code class="literal">AuthorToolBlock</code>, and place the following code in it:<div class="informalexample"><pre class="programlisting">&lt;?php

/**
 * @file
 * Contains \Drupal\author_tool\Plugin\Block\AuthorToolBlock.php.
 */

namespace Drupal\author_tool\Plugin\Block;

use Drupal\Core\Block\BlockBase;

/**
 * Provides a custom block.
 *
 * Drupal\Core\Block\BlockBase gives us a very useful set of basic functionality
 * for this configurable block. We can just fill in a few of the blanks with
 * defaultConfiguration(), blockForm(), blockSubmit(), and build().
 *
 * @Block(
 *   id = "author_tool_block",
 *   admin_label = @Translation("Author tool block")
 * )
 */
classAuthorToolBlock extends BlockBase {

  // our code goes here.

}</pre></div></li><li class="listitem">Within your class, implement the <code class="literal">BlockPluginInterface::build</code> method like this:<div class="informalexample"><pre class="programlisting">    /**
     * {@inheritdoc}
     */
public function build() {

    }</pre></div></li><li class="listitem">The build<a class="indexterm" id="id380"/> method is returning a renderable array or content like <code class="literal">hook_block_view</code> did for Drupal 7. Render arrays are the preferred way in Drupal 8. The complete implementation is shown as follows:<div class="informalexample"><pre class="programlisting">&lt;?php

/**
 * @file
 * Contains \Drupal\author_tool\Plugin\Block\AuthorToolBlock.php.
 */

namespace Drupal\author_tool\Plugin\Block;

use Drupal\Core\Block\BlockBase;

/**
 * Provides a custom block.
 *
 * Drupal\Core\Block\BlockBase gives us a very useful set of basic functionality
 * for this configurable block. We can just fill in a few of the blanks with
 * defaultConfiguration(), blockForm(), blockSubmit(), and build().
 *
 * @Block(
 *   id = "author_tool_block",
 *   admin_label = @Translation("Author tool block")
 * )
 */
classAuthorToolBlock extends BlockBase {

    /**
     * {@inheritdoc}
     */
public function build() {

        $link = array(
            '#type' =&gt; 'markup',
     '#title' =&gt; 'Author tools',
            '#markup' =&gt; $this-&gt;t('&lt;a href=":url"&gt;Add another recipe&lt;/a&gt;', array(':url' =&gt; 'add/recipe')),
        );

return $link;
    }

}</pre></div></li><li class="listitem">Your <a class="indexterm" id="id381"/>module is ready. Go to <span class="strong"><strong>Extend</strong></span>, locate it, and enable it.</li><li class="listitem">Now it's time to place your block on the recipe pages for authenticated users to see. From the main menu, select <span class="strong"><strong>Structure</strong></span> | <span class="strong"><strong>Block Layout</strong></span>, scroll down to <span class="strong"><strong>Sidebar first</strong></span>, and click on the <span class="strong"><strong>Place block</strong></span> button:<div class="mediaobject"><img alt="Time for action – creating a block to aid the authoring experience" src="graphics/4659_06_16.jpg"/></div></li><li class="listitem">Locate <a class="indexterm" id="id382"/>your block and click on <span class="strong"><strong>Place block</strong></span>:<div class="mediaobject"><img alt="Time for action – creating a block to aid the authoring experience" src="graphics/4659_06_17.jpg"/></div></li><li class="listitem">Configure your <a class="indexterm" id="id383"/>block to display only recipe content types:<div class="mediaobject"><img alt="Time for action – creating a block to aid the authoring experience" src="graphics/4659_06_18.jpg"/></div></li><li class="listitem">Configure <a class="indexterm" id="id384"/>your block to display for authenticated users only:<div class="mediaobject"><img alt="Time for action – creating a block to aid the authoring experience" src="graphics/4659_06_19.jpg"/></div></li><li class="listitem">Save the image, and<a class="indexterm" id="id385"/> that's it! Now visit a recipe page to verify that it is there:<div class="mediaobject"><img alt="Time for action – creating a block to aid the authoring experience" src="graphics/4659_06_20.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec58"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>Although this is a very simple example of creating a block through code, the simplicity of creating a block through the newly arrived Block API in Drupal 8 is clear. You created a block to aid with the author UI and learned the basics of extending the Plugin API to add custom functionality to the system.</p><p>To explore further, have a look at <a class="ulink" href="https://api.drupal.org/api/drupal">https://api.drupal.org/api/drupal</a> for the BlockBase class to get a sense of all the methods there that can be added.</p></div></div>
<div class="section" title="Time for action &#x2013; including default configuration in your module"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec79"/>Time for action – including default configuration in your module</h1></div></div></div><p>Once <a class="indexterm" id="id386"/>you have placed your block in your theme, you may wish to include that configuration when the module installs. By including a default configuration at installation time, you are able to provide a sensible default for placing that block. Also, within your deployment mechanism, all you have to worry about is installing the module, and the rest of the configuration will be applied at that step:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Export the configuration by going to <span class="strong"><strong>Structure</strong></span> | <span class="strong"><strong>Configuration</strong></span> | <span class="strong"><strong>Configuration synchronization</strong></span> | <span class="strong"><strong>Export</strong></span> | <span class="strong"><strong>Single item</strong></span>, and choose <span class="strong"><strong>Block</strong></span> and <span class="strong"><strong>Author tool block</strong></span>.</li><li class="listitem">Make <a class="indexterm" id="id387"/>sure you copy and paste everything but the <code class="literal">uuid</code> line (shown in the following screenshot):<div class="mediaobject"><img alt="Time for action – including default configuration in your module" src="graphics/4659_06_21.jpg"/></div></li><li class="listitem">Within your module, create the following structure and place the contents in a file named <code class="literal">block.block.authortoolblock.yml</code>:<div class="mediaobject"><img alt="Time for action – including default configuration in your module" src="graphics/4659_06_22.jpg"/></div></li><li class="listitem">That's it again! Try <a class="indexterm" id="id388"/>uninstalling and installing the module again. The block should be placed automatically at exactly the same position with the same visibility rules.</li></ol></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec80"/>Summary</h1></div></div></div><p>In this chapter, you learned how to enhance the author UI by installing, configuring, and reusing that configuration of the built-in WYSIWYG editor, which is a part of Drupal 8 core now. You explored both the backend editor instance as well as the inline editing capabilities, and had a go of adding your own CKEditor plugin. You also learned how to use the new Block API, add a new block to the system through a custom module, extend default methods, and provide default configuration when installing modules.</p><p>In the next chapter, we are going to see how to work with media and integrate them into our new Drupal 8 site.</p></div></body></html>
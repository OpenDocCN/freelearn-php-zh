- en: Up and Running with Drupal 8
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Drupal 8 运行起来
- en: 'In this chapter, we will get introduced to Drupal 8 and cover the following
    recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍 Drupal 8 并涵盖以下食谱：
- en: Installing Drupal
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装 Drupal
- en: Using a distribution with Drupal
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用带有 Drupal 的发行版
- en: Installing modules and themes
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装模块和主题
- en: Using multisites in Drupal 8
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Drupal 8 中使用多站点
- en: Tools for setting up an environment
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置环境的工具
- en: 'Running tests: Simpletest and PHPUnit'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 运行测试：Simpletest 和 PHPUnit
- en: Introduction
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: 'This chapter will kick off with an introduction to installing a Drupal 8 site.
    We will walk through Drupal''s interactive installer. We will cover installing
    Drupal using a command-line tool called Drush. Drupal provides two installation
    types: standard and minimal. Throughout this book, we will use the standard installation.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将从介绍安装 Drupal 8 网站开始。我们将介绍 Drupal 的交互式安装程序。我们将介绍使用名为 Drush 的命令行工具安装 Drupal。Drupal
    提供两种安装类型：标准型和最小型。在本书中，我们将使用标准安装。
- en: Once we have installed our Drupal 8 site, we will cover the basics of extending
    Drupal. We will discuss using distributions and installing contributed projects,
    such as modules and themes. We will also include uninstalling modules, as the
    process for uninstalling modules has changed in Drupal 8.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们安装了我们的 Drupal 8 网站，我们将介绍扩展 Drupal 的基础知识。我们将讨论使用发行版和安装贡献项目，例如模块和主题。我们还将包括卸载模块，因为在
    Drupal 8 中卸载模块的过程已经发生了变化。
- en: This book will involve a hands-on example for working with Drupal 8, and this
    chapter will provide information on setting up a local development environment.
    This chapter will also provide recipes on how to set up a Multisite installation
    in Drupal 8 and run the available test suites.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本书将涉及一个与 Drupal 8 一起工作的动手示例，本章将提供有关设置本地开发环境的信息。本章还将提供如何在 Drupal 8 中设置多站点安装和运行可用测试套件的食谱。
- en: 'Before we get started, you should install Composer. Composer is the de facto
    package management tool for PHP. In case you are unfamiliar with Composer, it
    is just like using Gems for Ruby, npm for Node.js, and Bower for frontend libraries.
    Go to the Composer documentation to learn how to install Composer globally on
    your system:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始之前，您应该安装 Composer。Composer 是 PHP 的既定包管理工具。如果您不熟悉 Composer，它就像使用 Ruby 的
    Gems、Node.js 的 npm 和前端库的 Bower 一样。请访问 Composer 文档了解如何在您的系统上全局安装 Composer：
- en: 'Linux / Unix / macOS: [https://getcomposer.org/doc/00-intro.md#installation-linux-unix-osx](https://getcomposer.org/doc/00-intro.md#installation-linux-unix-osx)'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Linux / Unix / macOS: [https://getcomposer.org/doc/00-intro.md#installation-linux-unix-osx](https://getcomposer.org/doc/00-intro.md#installation-linux-unix-osx)'
- en: 'Windows: [https://getcomposer.org/doc/00-intro.md#installation-windows](https://getcomposer.org/doc/00-intro.md#installation-windows)'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Windows: [https://getcomposer.org/doc/00-intro.md#installation-windows](https://getcomposer.org/doc/00-intro.md#installation-windows)'
- en: Installing Drupal
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 Drupal
- en: There are many different methods to download Drupal and install it. In this
    recipe, we will focus on downloading Drupal from [https://www.drupal.org/](https://www.drupal.org/)
    and setting it up on a basic Linux, Apache, MySQL, or PHP (LAMP) server.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 下载 Drupal 并安装有许多不同的方法。在本食谱中，我们将专注于从 [https://www.drupal.org/](https://www.drupal.org/)
    下载 Drupal 并在基本的 Linux、Apache、MySQL 或 PHP（LAMP）服务器上设置它。
- en: In this recipe, we will set up the files for Drupal 8 and step through the installation
    process.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在本食谱中，我们将设置 Drupal 8 的文件并逐步介绍安装过程。
- en: Getting ready
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Before we start, you will need a development environment that meets the new
    system requirements for Drupal 8:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始之前，您需要一个满足 Drupal 8 的新系统要求的开发生态系统：
- en: Apache 2.0 (or higher) or Nginx 1.1 (or higher) web server
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache 2.0（或更高版本）或 Nginx 1.1（或更高版本）的 Web 服务器
- en: PHP 5.5.9 or higher, but PHP 5.6 or PHP 7 is recommended, as PHP 5.5 has reached
    its end-of-life support
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 需要 PHP 5.5.9 或更高版本，但推荐使用 PHP 5.6 或 PHP 7，因为 PHP 5.5 已经达到其生命周期的结束支持。
- en: MySQL 5.5 or MariaDB 5.5.20 for your database
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据库需要 MySQL 5.5 或 MariaDB 5.5.20
- en: You will need a user with privileges to create databases or a created database
    with a user who has privileges to make tables in that database.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要一个具有创建数据库权限的用户，或者一个已经创建的数据库，其中包含具有在该数据库中创建表权限的用户。
- en: Access to upload or move files to the server
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 上传或移动文件到服务器的访问权限
- en: While a default installation of PHP will work with Drupal, it does require certain
    PHP extensions, such as mbstring. Check out [https://www.drupal.org/requirements/php](https://www.drupal.org/requirements/php)
    for up-to-date requirement information.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虽然默认安装的 PHP 可以与 Drupal 一起工作，但它确实需要某些 PHP 扩展，例如 mbstring。请查看[https://www.drupal.org/requirements/php](https://www.drupal.org/requirements/php)以获取最新的要求信息。
- en: Drupal 8 ships with Symfony ([https://symfony.com/](https://symfony.com/)) components.
    One of the new dependencies in Drupal 8, to support the Symfony routing system,
    is the Drupal `Clean URL` functionality. If the server is using Apache, ensure
    that `mod_rewrite` is enabled. If the server is using Nginx, the `ngx_http_rewrite_module`
    must be enabled.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal 8附带Symfony ([https://symfony.com/](https://symfony.com/))组件。Drupal 8中的新依赖之一，以支持Symfony路由系统，是Drupal的“清洁URL”功能。如果服务器使用Apache，请确保已启用`mod_rewrite`。如果服务器使用Nginx，则必须启用`ngx_http_rewrite_module`。
- en: We will download Drupal 8 and place its files in your web server's document
    root. This is the `/var/www` folder. If you used a tool, such as XAMPP, WAMP,
    or MAPP, consult the proper documentation to know your document root.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将下载Drupal 8并将其文件放置在您的Web服务器的文档根目录中。这是`/var/www`文件夹。如果您使用了XAMPP、WAMP或MAPP等工具，请查阅适当的文档以了解您的文档根目录。
- en: For full system requirements for Drupal 8, check out [https://www.drupal.org/docs/8/system-requirements/](https://www.drupal.org/docs/8/system-requirements/).
    The Drupal.org documentation is currently being migrated. Also, review the Drupal
    7 requirements page on [https://www.drupal.org/docs/7/system-requirements/overview](https://www.drupal.org/docs/7/system-requirements/overview),
    which highlights Drupal 8 items, as well.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看Drupal 8的完整系统需求，请查看[https://www.drupal.org/docs/8/system-requirements/](https://www.drupal.org/docs/8/system-requirements/)。Drupal.org文档目前正在迁移。此外，请查看[https://www.drupal.org/docs/7/system-requirements/overview](https://www.drupal.org/docs/7/system-requirements/overview)上的Drupal
    7需求页面，该页面突出显示了Drupal 8的项目。
- en: How to do it...
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We need to follow these steps to install Drupal 8:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要遵循以下步骤来安装Drupal 8：
- en: 'First, we will need to navigate to [https://www.drupal.org/download](https://www.drupal.org/download)
    and download the latest release of Drupal 8.x. You can find the most recent and
    recommended release on the [https://www.drupal.org/project/drupal](https://www.drupal.org/project/drupal)
    page for Drupal 8 (8.3.1, 8.4.0, and so on). Extract the archive and place the
    files in your document root as the `drupal8` folder :'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要导航到[https://www.drupal.org/download](https://www.drupal.org/download)并下载Drupal
    8.x的最新版本。您可以在Drupal 8（8.3.1、8.4.0等）的[https://www.drupal.org/project/drupal](https://www.drupal.org/project/drupal)页面上找到最新和推荐的版本。解压缩存档并将文件放置在您的文档根目录下的`drupal8`文件夹中：
- en: '![](img/1e2ed62e-6edf-4ee9-81ac-6656bdab7c2c.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/1e2ed62e-6edf-4ee9-81ac-6656bdab7c2c.png)'
- en: 'Open your browser and visit your web server, for example, `http://localhost/drupal8`,
    which will then take you to the Drupal installation wizard. You will land on the
    new multilingual options install screen. Select your language and click on Save
    and continue:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开您的浏览器并访问您的Web服务器，例如`http://localhost/drupal8`，这将带您到Drupal安装向导。您将进入新的多语言选项安装屏幕。选择您的语言并点击保存并继续：
- en: '![](img/73e14053-ff4e-47c1-a917-7514a82ef907.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/73e14053-ff4e-47c1-a917-7514a82ef907.png)'
- en: On the next screen, select the default Standard option for the installation
    profile. This will provide us with a standard configuration with the most commonly
    used modules installed.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一屏，选择安装配置的默认标准选项。这将为我们提供一个带有已安装最常用模块的标准配置。
- en: The next step will verify your system requirements. If your system does not
    have any reportable issues, the screen will be skipped. If you do have any requirement
    conflicts, you can resolve them and click on the button to try again.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步将验证您的系统需求。如果您的系统没有任何可报告的问题，屏幕将被跳过。如果您确实有任何需求冲突，您可以解决它们并点击按钮重试。
- en: If you have requirement issues, the installer will report the specific issues.
    Nearly every requirement will link to a Drupal.org handbook page with solution
    steps.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有需求问题，安装程序将报告具体问题。几乎每个需求都会链接到一个Drupal.org手册页面，其中包含解决方案步骤。
- en: 'Enter the database information for Drupal. In most cases, you will only need
    to supply the username, password, and database name and leave others as defaults.
    If your database does not exist, the installer will attempt to create the database:'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入Drupal的数据库信息。在大多数情况下，您只需要提供用户名、密码和数据库名称，并将其他设置为默认值。如果您的数据库不存在，安装程序将尝试创建数据库：
- en: '![](img/ccd32a82-ecf9-4a95-9fd0-9b86e3676bd8.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/ccd32a82-ecf9-4a95-9fd0-9b86e3676bd8.png)'
- en: See the *There's more...* section of this recipe for information on setting
    up your database.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 请参阅此菜谱的“更多...”部分，了解设置数据库的信息。
- en: Your Drupal 8 site will begin installing. When it is done installing the base
    modules, you will be taken to a site configuration screen.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您的Drupal 8站点将开始安装。当它安装完基本模块后，您将被带到站点配置屏幕。
- en: The configure site form provides the base configuration for your Drupal site.
    Enter your site name and the email address for the site. The site email will be
    used to send administrative notifications and has the originating email for outgoing
    emails from the Drupal site. This form allows you to set regional information
    regarding the country and time zone of the site. Setting the timezone ensures
    that time values display correctly.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置网站表单提供了你的Drupal网站的基本配置。输入你的网站名称和网站的电子邮件地址。网站电子邮件将用于发送管理通知，并作为从Drupal网站发出的电子邮件的原始电子邮件地址。此表单允许你设置有关网站的国家和时区的地区信息。设置时区确保时间值正确显示。
- en: Fill in the site maintenance account information, also known as user 1, which
    acts in a similar way to the root on Unix-based systems. The site maintenance
    account is crucial. As stated, this acts as the first user and is given the user
    ID of 1\. In Drupal, the user with the user ID of 1 often can bypass permission
    checks automatically and have global access.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写网站维护账户信息，也称为用户1，它在Unix系统中的root类似。网站维护账户至关重要。正如所述，它作为第一个用户存在，并赋予用户ID为1。在Drupal中，具有用户ID为1的用户通常可以自动绕过权限检查并拥有全局访问权限。
- en: Enter the site's regional information, and check whether the site should check
    for updates available for modules enabled and Drupal itself. By checking for updates
    automatically, your site will report anonymous usage statistics to Drupal along
    with providing a summary of your version status. You have the option to also opt-in
    for the site to email you notifications of new releases, including security releases.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入网站的地区信息，并检查网站是否应该检查已启用的模块和Drupal本身的可用更新。通过自动检查更新，你的网站将向Drupal报告匿名使用统计信息，并提供你的版本状态摘要。你也可以选择让网站通过电子邮件通知你新版本发布，包括安全更新。
- en: When the information is satisfied, click on Save and continue, and congratulations,
    you installed Drupal! The next screen will provide you a link to your installed
    Drupal site.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当信息满足条件时，点击保存并继续，恭喜你，你已经安装了Drupal！下一屏将为你提供一个链接到你的已安装Drupal网站。
- en: How it works...
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The Drupal installation process will provide a Drupal installation for the selected
    language and install modules and configuration based on the installation profile
    (standard or minimal in this recipe.)
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal的安装过程将为所选语言提供Drupal安装，并根据安装配置文件（本食谱中的标准或最小）安装模块和配置。
- en: When you visit the installer, it reads the language code from the browser. With
    this language code, it will then select a supported language. If you choose a
    non-English installation, the translation files will be automatically downloaded
    from [https://localize.drupal.org/](https://localize.drupal.org/). Previous versions
    of Drupal did not support automated multilingual installs. More on multilingual
    will be covered in [*Chapter 8*](459ccdb8-7d36-44a8-b476-e34649e310a2.xhtml),
    *Multilingual and Internationalization*.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 当你访问安装程序时，它会从浏览器中读取语言代码。有了这个语言代码，它将选择一个支持的语言。如果你选择非英语安装，翻译文件将自动从 [https://localize.drupal.org/](https://localize.drupal.org/)
    下载。Drupal的早期版本不支持自动的多语言安装。关于多语言的内容将在[*第8章*](459ccdb8-7d36-44a8-b476-e34649e310a2.xhtml)，*多语言和国际化*中进一步介绍。
- en: The installation profile instructs Drupal what modules to install by default.
    Contributed install profiles are termed distributions; we will discuss this more
    in the next recipe.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 安装配置文件指示Drupal安装默认的模块。贡献的安装配置文件被称为发行版；我们将在下一食谱中进一步讨论这一点。
- en: When verifying requirements, Drupal checks application versions and PHP configurations.
    For example, if your server has the PHP Xdebug ([https://xdebug.org](https://xdebug.org))
    extension installed, the minimum `max_nesting_level` must be 256 or else Drupal
    will not be installed ([https://www.drupal.org/node/2393531](https://www.drupal.org/node/2393531)).
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在验证需求时，Drupal会检查应用程序版本和PHP配置。例如，如果你的服务器已安装PHP Xdebug ([https://xdebug.org](https://xdebug.org))
    扩展，则`max_nesting_level`的最小值必须是256，否则Drupal将无法安装 ([https://www.drupal.org/node/2393531](https://www.drupal.org/node/2393531))。
- en: There's more...
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: The Drupal installation process is straightforward, but there are a few things
    worth discussing.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal的安装过程很简单，但有一些值得讨论的地方。
- en: Creating a database user and a database
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建数据库用户和数据库
- en: As mentioned earlier, to install Drupal, you will need to have access to a database
    server (or the ability to create one) and an existing database (or the ability
    to create one). This process will depend on your environment setup.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，要安装Drupal，您需要能够访问数据库服务器（或创建一个）以及现有的数据库（或创建一个）。此过程将取决于您的环境设置。
- en: If you are working with a hosting provider, there is more than likely a web-based
    control panel. This should allow you to create databases and users. Refer to your
    hosting provider's documentation for more information on this topic.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您与托管提供商合作，很可能有一个基于Web的控制面板。这应该允许您创建数据库和用户。有关此主题的更多信息，请参阅您的托管提供商的文档。
- en: 'If you are using **phpMyAdmin** ([https://www.phpmyadmin.net/](https://www.phpmyadmin.net/))
    on your server, often installed by MAMP, WAMP, and XAMPP, and have root access,
    you can create your databases and users by following these steps:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您在服务器上使用**phpMyAdmin** ([https://www.phpmyadmin.net/](https://www.phpmyadmin.net/))，通常由MAMP、WAMP和XAMPP安装，并且拥有root权限，您可以通过以下步骤创建数据库和用户：
- en: Sign in to phpMyAdmin as the root user.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以root用户身份登录到phpMyAdmin。
- en: Click on Add a new User from the bottom of the privileges page.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从权限页面底部点击“添加新用户”。
- en: Fill in the user's information.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写用户信息。
- en: Select to create a database for the user with all privileges granted.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择为用户创建数据库并授予所有权限。
- en: You can now use that user's information to connect Drupal to your database.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在可以使用该用户信息将Drupal连接到您的数据库。
- en: 'If you do not have a user interface but have a command-line access, you can
    set up your database and user using the MySQL command line. These instructions
    can be found in the `core/INSTALL.mysql.txt` file. From the command line of your
    site, perform the following:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您没有用户界面但有命令行访问权限，您可以使用MySQL命令行设置数据库和用户。这些说明可以在`core/INSTALL.mysql.txt`文件中找到。从您站点的命令行执行以下操作：
- en: 'Log in to MySQL:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到MySQL：
- en: '[PRE0]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Create the database; you will use the following command to create the `my_database`
    database:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建数据库；您将使用以下命令创建`my_database`数据库：
- en: '[PRE1]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Create a new user to access the database:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新用户以访问数据库：
- en: '[PRE2]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Grant the new user permissions on the database, as follows:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 授予新用户数据库权限，具体操作如下：
- en: '[PRE3]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: If you are installing Drupal with a PostgreSQL or SQLite database, check out
    the appropriate installation instructions, either `INSTALL.pgsql.txt` or `INSTALL.sqlite.txt`.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用PostgreSQL或SQLite数据库安装Drupal，请查看相应的安装说明，即`INSTALL.pgsql.txt`或`INSTALL.sqlite.txt`。
- en: Database prefixes
  id: totrans-72
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据库前缀
- en: 'Drupal, like other content management systems, allows you to prefix its database
    tables from the database set-up form. This prefix will be placed before table
    names to help make them unique. Although it is not recommended, this would allow
    multiple installations to share one database. Utilizing table prefixes can, however,
    provide some level of security through obscurity since the tables will not be
    their default names:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal与其他内容管理系统类似，允许您从数据库设置表单中为数据库表设置前缀。此前缀将放置在表名之前，以帮助使它们独特。虽然不推荐这样做，但这将允许多个安装共享一个数据库。利用表前缀可以在一定程度上通过隐藏提供安全性，因为表将不会使用它们的默认名称：
- en: '![](img/1441d718-6ef2-49c2-ab51-a26dfec36d65.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1441d718-6ef2-49c2-ab51-a26dfec36d65.png)'
- en: Downloading and installing with Drush
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Drush下载和安装
- en: You may also install Drupal using the PHP command-line tool, Drush. Drush is
    a command-line tool created by the Drupal community and must be installed if you
    wish to use it. Drush is covered in [*Chapter 13*](099b7376-2149-4af8-9649-45445745f068.xhtml),
    *The Drupal CLI*.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以使用PHP命令行工具Drush安装Drupal。Drush是由Drupal社区创建的命令行工具，如果您想使用它，则必须安装Drush。Drush在[*第13章*](099b7376-2149-4af8-9649-45445745f068.xhtml)，*The
    Drupal CLI*中有介绍。
- en: As of Drush 9, which supports Drupal 8.3+, this section is deprecated. Using
    Drush to download Drupal core or contributed modules will throw a warning to use
    Composer instead.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 截至Drush 9，它支持Drupal 8.3+，本节已被弃用。使用Drush下载Drupal核心或贡献模块将抛出警告，建议使用Composer。
- en: 'The `pm-download` command will download packages from Drupal.org. The `site-install`
    command will allow you to specify an installation profile and other options to
    install a Drupal site. The installation steps in this recipe could be run through
    Drush, as follows:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '`pm-download`命令将从Drupal.org下载包。`site-install`命令允许您指定安装配置文件和其他选项以安装Drupal站点。本食谱中的安装步骤可以通过Drush执行，如下所示：'
- en: '[PRE4]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: We used Drush to download the latest Drupal 8 and place it in a folder named
    `drupal8`. Then, the `site-install` command instructs Drush to use the standard
    install profile, configure the maintenance account, and provide a database URI
    string so that Drupal can connect to its database.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 Drush 下载最新的 Drupal 8 并将其放置在名为 `drupal8` 的文件夹中。然后，`site-install` 命令指示 Drush
    使用标准安装配置文件，配置维护账户，并提供数据库 URI 字符串，以便 Drupal 可以连接到其数据库。
- en: Using Composer to create a Drupal site
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Composer 创建 Drupal 网站
- en: You can download Drupal using Composer, the de facto PHP package manager. The
    preferred method is to use the Drupal Composer project template provided by the
    community.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 Composer 下载 Drupal，这是事实上的 PHP 包管理器。社区提供的 Drupal Composer 项目模板是首选方法。
- en: 'To build your Drupal 8 site, run the following commands:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 要构建您的 Drupal 8 网站，请运行以下命令：
- en: '[PRE5]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Wait for the commands to finish--it may take some time, as it downloads all
    the required dependencies. You can feel free to grab a coffee (the first time
    takes a while; it primes caches. Have faith, it will be much faster the next time.)
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 等待命令完成--这可能需要一些时间，因为它会下载所有必需的依赖项。您可以随意拿一杯咖啡（第一次可能需要一段时间；它会预热缓存。请有信心，下次会快得多。）
- en: When finished, you will find a different directory structure inside your `drupal8`
    directory. The `vendor` directory contains all third-party PHP libraries, and
    the `web` directory contains your Drupal 8 site. You will need to modify your
    web server to use the `web` directory as the new docroot within your `drupal8`
    directory.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 完成后，您将在 `drupal8` 目录内找到一个不同的目录结构。`vendor` 目录包含所有第三方 PHP 库，而 `web` 目录包含您的 Drupal
    8 网站。您需要修改您的 web 服务器，以便在 `drupal8` 目录中使用 `web` 目录作为新的 docroot。
- en: The project and its details can be found at [https://github.com/drupal-composer/drupal-project](https://github.com/drupal-composer/drupal-project),
    along with its full documentation.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 项目及其详细信息可在 [https://github.com/drupal-composer/drupal-project](https://github.com/drupal-composer/drupal-project)
    找到，以及其完整文档。
- en: Security updates
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安全更新
- en: If you choose to disable the update options, you will have to check manually
    for module upgrades. While most upgrades are for bug fixes or features, some are
    for security updates. It is highly recommended that you subscribe to the Drupal
    security team's updates. These updates are available on Twitter at `@drupalsecurity`
    ([https://twitter.com/drupalsecurity](https://twitter.com/drupalsecurity)) or
    the feeds on
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您选择禁用更新选项，您将不得不手动检查模块升级。虽然大多数升级是为了修复错误或添加功能，但其中一些是为了安全更新。强烈建议您订阅 Drupal 安全团队的更新。这些更新可在
    Twitter 上的 `@drupalsecurity` ([https://twitter.com/drupalsecurity](https://twitter.com/drupalsecurity))
    或相关订阅源上找到。
- en: '[https://www.drupal.org/security](https://www.drupal.org/security).'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.drupal.org/security](https://www.drupal.org/security).'
- en: See also
  id: totrans-91
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参见
- en: For more on multilingual, check out [*Chapter 8*](459ccdb8-7d36-44a8-b476-e34649e310a2.xhtml),
    *Multilingual and Internationalization*
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 想了解更多关于多语言的内容，请查看第 *8章*，*多语言和国际化*
- en: For more on using the command line and Drupal, check out [*Chapter 13*](099b7376-2149-4af8-9649-45445745f068.xhtml),
    *The Drupal CLI*
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 想了解更多关于使用命令行和 Drupal 的信息，请查看第 *13章*，*Drupal CLI*
- en: Check out the Drupal.org handbook on installing Drupal at [https://www.drupal.org/documentation/install](https://www.drupal.org/documentation/install)
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看关于在 Drupal.org 上安装 Drupal 的手册，链接为 [https://www.drupal.org/documentation/install](https://www.drupal.org/documentation/install)
- en: Check out the Drupal.org handbook that discusses Drupal 8 and Composer at [https://www.drupal.org/docs/develop/using-composer/using-composer-with-drupal](https://www.drupal.org/docs/develop/using-composer/using-composer-with-drupal)
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看讨论 Drupal 8 和 Composer 的 Drupal.org 手册，链接为 [https://www.drupal.org/docs/develop/using-composer/using-composer-with-drupal](https://www.drupal.org/docs/develop/using-composer/using-composer-with-drupal)
- en: Check out more information on Drush site install at [https://drushcommands.com/drush-8x/core/site-install/](https://drushcommands.com/drush-8x/core/site-install/)
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看有关 Drush 网站安装的更多信息，链接为 [https://drushcommands.com/drush-8x/core/site-install/](https://drushcommands.com/drush-8x/core/site-install/)
- en: Using a distribution with Drupal
  id: totrans-97
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用带有 Drupal 的发行版
- en: Why would you want to use a distribution? A distribution is a contributed installation
    profile that is not provided by Drupal core. Distributions provide a specialized
    version of Drupal with specific installed modules and themes along with specific
    configurations (content types, and blocks.) On Drupal.org, when you download an
    installation profile, it not only includes the profile and its modules but a version
    of Drupal core, hence the name distribution. You can find a list of all Drupal
    distributions at [https://www.drupal.org/project/project_distribution](https://www.drupal.org/project/project_distribution).
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么您想使用分发？分发是一个由 Drupal 核心不提供的贡献安装配置文件。分发提供具有特定已安装模块和主题以及特定配置（内容类型和块）的 Drupal
    特殊版本。在 Drupal.org 上，当您下载安装配置文件时，它不仅包括配置文件及其模块，还包括 Drupal 核心的一个版本，因此得名分发。您可以在 [https://www.drupal.org/project/project_distribution](https://www.drupal.org/project/project_distribution)
    找到所有 Drupal 分发的列表。
- en: How to do it...
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We will follow these steps to download a distribution to use as a customized
    version of Drupal 8:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将遵循以下步骤下载分发，用作 Drupal 8 的定制版本：
- en: Download a distribution from Drupal.org. For this recipe, let's use the Demo
    Framework provided by Acquia at [https://www.drupal.org/project/df](https://www.drupal.org/project/df).
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 Drupal.org 下载分发。对于这个配方，让我们使用 Acquia 提供的 Demo Framework，网址为 [https://www.drupal.org/project/df](https://www.drupal.org/project/df)。
- en: Select the recommended version for the 8.x branch.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 8.x 分支推荐版本。
- en: Extract the folder contents to your web server's document root--you'll note
    that there is Drupal core; within the `profiles` folder, there's the installation
    profile's folder--`df`.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将文件夹内容提取到您的 Web 服务器文档根目录中--您会注意到其中包含 Drupal 核心文件；在 `profiles` 文件夹中，有安装配置文件的文件夹--`df`。
- en: 'Due to current Drupal.org packaging limitations, there is a manual step that
    you will need to run in order to install additional dependencies. Run the following
    command using your terminal inside of the extracted contents:'
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于当前 Drupal.org 打包限制，您需要运行一个手动步骤来安装额外的依赖项。在提取内容内的终端中运行以下命令：
- en: '[PRE6]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Install Drupal as you would normally, by navigating to your Drupal site in your
    browser.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照常规方式安装 Drupal，通过在浏览器中导航到您的 Drupal 网站。
- en: Follow the installation instructions in the site to install the distribution.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照网站上的安装说明安装分发。
- en: How it works...
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Installation profiles work by including additional modules that are part of
    the contributed project realm or custom modules. The profile will then define
    them as dependencies to be installed with Drupal. When you select an installation
    profile, you are instructing Drupal to install a set of modules on installation.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 安装配置文件通过包含贡献项目领域或自定义模块的额外模块来工作。然后配置文件将它们定义为与 Drupal 一起安装的依赖项。当您选择安装配置文件时，您是在指示
    Drupal 在安装时安装一组模块。
- en: Demo Framework declares itself as an exclusive installation profile. Distributions
    that declare this are automatically selected and assumed to be the default installation
    option. The exclusive flag was added with Drupal 7.22 to improve the experience
    of using a Drupal distribution ([http://drupal.org/node/1961012](http://drupal.org/node/1961012)).
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: Demo Framework 声明自己为独家安装配置文件。声明此配置文件的分发将自动选中并假定是默认安装选项。独家标志是在 Drupal 7.22 中添加的，以改善使用
    Drupal 分发的体验 ([http://drupal.org/node/1961012](http://drupal.org/node/1961012))。
- en: There's more...
  id: totrans-111
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Distributions provide a specialized version of Drupal with specific feature
    sets, but there are a few items worth discussing.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 分发提供具有特定功能集的 Drupal 特殊版本，但有一些项目值得讨论。
- en: Makefiles
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Makefiles
- en: The current standard for generating a built distribution is the utilization
    of Drush and makefiles. Makefiles allow a user to define a specific version of
    Drupal core and other projects (such as themes, modules, and third-party libraries)
    that will make up a Drupal code base. It is not a dependency management workflow,
    like Composer, but is a build tool.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 生成构建分发的当前标准是使用 Drush 和 makefiles。Makefiles 允许用户定义 Drupal 核心和其它项目（如主题、模块和第三方库）的特定版本，这些项目将构成
    Drupal 代码库。它不是一个像 Composer 那样的依赖管理流程，而是一个构建工具。
- en: If you take a look at the Demo Framework's `profile` folder, you will see `drupal-org.make`
    and `drupal-org-core.make`. These are parsed by the Drupal.org packager to compile
    the code base and package it as a `.zip` or `.tar.gz`, like the one you downloaded.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您查看 Demo Framework 的 `profile` 文件夹，您将看到 `drupal-org.make` 和 `drupal-org-core.make`。这些文件被
    Drupal.org 打包器解析，以编译代码库并将其打包成 `.zip` 或 `.tar.gz` 格式，就像您下载的那样。
- en: Installing with Drush
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Drush 安装
- en: As discussed in the first recipe's *There's more...* section, you can install
    a Drupal site through the Drush command-line tool. You can instruct Drush to use
    a specific installation profile by providing it as the first argument.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 如第一道菜谱中的 *还有更多...* 部分所述，您可以通过 Drush 命令行工具安装 Drupal 网站。您可以通过将其作为第一个参数提供来指示 Drush
    使用特定的安装配置文件。
- en: As of Drush 9, which supports Drupal 8.3+, this section is deprecated. Using
    Drush to download Drupal core or contributed modules will throw a warning to use
    Composer instead.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 截至 Drush 9，它支持 Drupal 8.3+，本节已被弃用。使用 Drush 下载 Drupal 核心或贡献模块将抛出警告，建议使用 Composer。
- en: 'The following command would install the Drupal 8 site using the Demo Framework:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令将使用 Demo Framework 安装 Drupal 8 网站：
- en: '[PRE7]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Using Composer
  id: totrans-121
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Composer
- en: Currently, Drupal.org does not package distributions using Composer, which is
    why there was an extra step to add dependencies when installing the distribution.
    Many distributions provide project templates to make scaffolding projects simpler.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，Drupal.org 不使用 Composer 打包发行版，这就是为什么在安装发行版时需要额外步骤来添加依赖项。许多发行版都提供了项目模板，以简化项目构建。
- en: 'For example, the following command will set up a Demo Framework site with `docroot`
    as the directory for the web server document root, which contains Drupal 8:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，以下命令将设置一个以 `docroot` 作为 Web 服务器文档根目录的 Demo Framework 网站，其中包含 Drupal 8：
- en: '[PRE8]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The project template is available on Acqua's GitHub at [https://github.com/acquia/df-project/](https://github.com/acquia/df-project/).
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 项目模板可在 Acqua 的 GitHub 上找到，链接为 [https://github.com/acquia/df-project/](https://github.com/acquia/df-project/)。
- en: 'Another distribution, Open Social, provides a template of its own:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个发行版 Open Social 提供了自己的模板：
- en: '[PRE9]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The project template is available at [https://github.com/goalgorilla/social_template](https://github.com/goalgorilla/social_template).
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 项目模板可在 [https://github.com/goalgorilla/social_template](https://github.com/goalgorilla/social_template)
    上找到。
- en: See also...
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参见...
- en: Refer to [*Chapter 13*](099b7376-2149-4af8-9649-45445745f068.xhtml), *The Drupal
    CLI*, for information on makefiles.
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参阅 *第 13 章*，*Drupal CLI*，了解 makefile 的信息。
- en: Refer to Distribution documentation on Drupal at [https://www.drupal.org/documentation/build/distributions](https://www.drupal.org/documentation/build/distributions).
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参阅 Drupal 上的发行版文档 [https://www.drupal.org/documentation/build/distributions](https://www.drupal.org/documentation/build/distributions)。
- en: Refer to *Managing Your Drupal Project with Composer* at [https://glamanate.com/blog/managing-your-drupal-project-composer](https://glamanate.com/blog/managing-your-drupal-project-composer).
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参阅 [https://glamanate.com/blog/managing-your-drupal-project-composer](https://glamanate.com/blog/managing-your-drupal-project-composer)
    上的 *使用 Composer 管理您的 Drupal 项目*。
- en: Refer to Managing your Drupal platform with Drush at [https://glamanate.com/blog/managing-your-drupal-platform-drush](https://glamanate.com/blog/managing-your-drupal-platform-drush).
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参阅 [https://glamanate.com/blog/managing-your-drupal-platform-drush](https://glamanate.com/blog/managing-your-drupal-platform-drush)
    上的 *使用 Drush 管理您的 Drupal 平台*。
- en: Installing modules and themes
  id: totrans-134
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装模块和主题
- en: Drupal 8 provides more functionality out-of-the-box than previous versions of
    Drupal, allowing you to do more with less. However, one of the more appealing
    aspects of Drupal is the ability to extend and customize.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal 8 比之前的 Drupal 版本提供了更多的内置功能，让您可以以更少的努力做更多的事情。然而，Drupal 更吸引人的一个方面是扩展和定制的功能。
- en: In this recipe, we will download and enable the Honeypot module ([https://www.drupal.org/project/honeypot](https://www.drupal.org/project/honeypot))
    and tell Drupal to use the Bootstrap theme ([https://www.drupal.org/project/bootstrap](https://www.drupal.org/project/bootstrap)).
    The Honeypot module provides Honeypot and timestamps antispam measures on Drupal
    sites. This module helps protect forms from spam submissions. The Bootstrap theme
    implements the Bootstrap frontend framework and supports using Bootswatch styles
    to theme your Drupal site.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在本菜谱中，我们将下载并启用 Honeypot 模块 ([https://www.drupal.org/project/honeypot](https://www.drupal.org/project/honeypot))，并告诉
    Drupal 使用 Bootstrap 主题 ([https://www.drupal.org/project/bootstrap](https://www.drupal.org/project/bootstrap))。Honeypot
    模块为 Drupal 网站提供 Honeypot 和时间戳反垃圾邮件措施。此模块有助于保护表单免受垃圾邮件提交。Bootstrap 主题实现了 Bootstrap
    前端框架，并支持使用 Bootswatch 风格来为主题 Drupal 网站。
- en: This chapter's recipe will use the standard way of installing modules, by downloading
    archives available on Drupal.org. As of Drupal 8.2.0, installing modules through
    Composer has been possible and is the required method for some modules. Installing
    modules and themes using Composer is covered in the *There's more...* section
    of this recipe and is highly recommended.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的食谱将使用标准方式安装模块，即下载Drupal.org上可用的存档。截至Drupal 8.2.0，通过Composer安装模块已成为可能，并且对于某些模块来说是必需的方法。使用Composer安装模块和主题的内容包含在本食谱的“更多内容...”部分，并强烈推荐。
- en: Getting ready
  id: totrans-138
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: If you have used Drupal before, note that the folder structure has changed.
    Modules, themes, and profiles are now placed in their respective folders in the
    `root` directory and no longer under `sites/all`. For more information about the
    developer experience change, refer to [https://www.drupal.org/node/22336](https://www.drupal.org/node/22336).
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你之前使用过Drupal，请注意文件夹结构已更改。模块、主题和配置文件现在放置在`root`目录下的相应文件夹中，而不是在`sites/all`下。有关开发者体验变更的更多信息，请参阅[https://www.drupal.org/node/22336](https://www.drupal.org/node/22336)。
- en: 'Downloading the example code: You can download the example code files for all
    Packt books you have purchased from your account at [http://www.packtpub.com](http://www.packtpub.com).
    If you have purchased this book from elsewhere, you can go to [http://www.packtpub.com/support](http://www.packtpub.com/support)
    and register yourself to have the files emailed directly to you.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 下载示例代码：您可以从您在[http://www.packtpub.com](http://www.packtpub.com)的账户中下载您购买的所有Packt书籍的示例代码文件。如果您在其他地方购买了此书，您可以访问[http://www.packtpub.com/support](http://www.packtpub.com/support)并注册自己，以便将文件直接通过电子邮件发送给您。
- en: How to do it...
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Let''s install modules and themes:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们安装模块和主题：
- en: Visit [https://www.drupal.org/project/honeypot](https://www.drupal.org/project/honeypot)
    and download the latest 8.x release for Honeypot.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问[https://www.drupal.org/project/honeypot](https://www.drupal.org/project/honeypot)并下载Honeypot的最新8.x版本。
- en: 'Extract the archive and place the `honeypot` folder inside the `modules` folder,
    which is inside of your Drupal core installation:'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解压存档并将`honeypot`文件夹放置在您的Drupal核心安装目录下的`modules`文件夹中：
- en: '![](img/94b95366-ac39-43c8-9d00-04ffe7f1beb5.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/94b95366-ac39-43c8-9d00-04ffe7f1beb5.png)'
- en: In Drupal, log in and select the Extend option to access the list of available
    modules.
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Drupal中登录并选择“扩展”选项以访问可用模块的列表。
- en: Using the search text field, type in `Honeypot`. Check the checkbox and click
    on Install.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用搜索文本框输入`Honeypot`。勾选复选框并点击“安装”。
- en: 'Once enabled, search for it again. Clicking on the module''s description will
    expand the row and expose links to configure permissions and module settings:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦启用，再次搜索它。点击模块的描述将展开行并显示配置权限和模块设置的链接：
- en: '![](img/652eb39e-937f-4346-bcd6-a0e75b4bc773.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/652eb39e-937f-4346-bcd6-a0e75b4bc773.png)'
- en: Visit [https://www.drupal.org/project/bootstrap](https://www.drupal.org/project/bootstrap)
    and download the latest 8.x release for Bootstrap.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问[https://www.drupal.org/project/bootstrap](https://www.drupal.org/project/bootstrap)并下载Bootstrap的最新8.x版本。
- en: 'Extract the archive and place the `bootstrap` folder inside the `themes` folder,
    which is inside your Drupal core installation:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解压存档并将`bootstrap`文件夹放置在您的Drupal核心安装目录下的`themes`文件夹中：
- en: '![](img/94680f06-9b25-4e69-9d8a-798505482308.png)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/94680f06-9b25-4e69-9d8a-798505482308.png)'
- en: In Drupal, select the Appearance option to manage your Drupal themes.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Drupal中，选择“外观”选项以管理您的Drupal主题。
- en: 'Scroll down the page and click on Install and set as default under Bootstrap
    to enable and set the theme as default:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动到页面底部并点击“安装”和“Bootstrap”下的“设置为默认”以启用并设置主题为默认：
- en: '![](img/bfb2612f-3cad-47a2-851c-b2809a64d5d3.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/bfb2612f-3cad-47a2-851c-b2809a64d5d3.png)'
- en: How it works...
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The following sections outline the procedure for installing a module or theme
    and how Drupal discovers these extensions.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 以下部分概述了安装模块或主题的流程以及Drupal如何发现这些扩展。
- en: Discovering modules and themes
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 发现模块和主题
- en: 'Drupal scans specific folder locations to identify modules and themes defined
    by the `.info.yml` file in their directory. The following is the order in which
    projects will be discovered:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal扫描特定文件夹位置以识别由其目录中的`.info.yml`文件定义的模块和主题。以下为项目将被发现的顺序：
- en: Their respective core folders (modules, or themes)
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它们各自的核心文件夹（模块或主题）
- en: The currently installed profile
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当前安装的配置文件
- en: The root `modules` or `themes` folder
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根`modules`或`themes`文件夹
- en: The current site directory (default or current domain)
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当前站点目录（默认或当前域名）
- en: Module installation
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模块安装
- en: By placing the module inside the root `modules` folder, we are allowing Drupal
    to discover the module and allow it to be installed. When a module is installed,
    Drupal will register its code with the system through the `module_installer` service.
    The service will check for required dependencies and prompt them to be enabled
    if required. The configuration system will run any configuration definitions provided
    by the module on installation. If there are conflicting configuration items, the
    module *will not be installed*.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将模块放置在根目录下的 `modules` 文件夹中，我们允许 Drupal 发现该模块并允许其安装。当模块安装时，Drupal 将通过 `module_installer`
    服务将其代码注册到系统中。该服务将检查所需的依赖项，并在需要时提示启用它们。配置系统将在安装时运行模块提供的任何配置定义。如果有冲突的配置项，模块*将不会安装*。
- en: Theme installation
  id: totrans-166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 主题安装
- en: A theme is installed through the `theme_installer` service and sets any default
    configuration by the theme along with rebuilding the theme registry. Setting a
    theme to default is a configuration change in `system.theme.default` to the theme's
    machine name (in the recipe, it would be `bootstrap`).
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 主题是通过 `theme_installer` 服务安装的，并设置主题提供的任何默认配置，同时重建主题注册表。将主题设置为默认是在 `system.theme.default`
    配置中更改到主题的机器名（在菜谱中将是 `bootstrap`）。
- en: There's more...
  id: totrans-168
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更多内容...
- en: The following section outlines the procedure for installing a module or theme
    and includes some additional information for installing.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 以下部分概述了安装模块或主题的步骤，并包括一些有关安装的附加信息。
- en: Installing a module or theme using Composer
  id: totrans-170
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Composer 安装模块或主题
- en: Although it is not the required way to install an extension, this should become
    your default method. Why? Because each module is a dependency in your project,
    and each of those may have its own dependencies. Composer can manage dependencies
    for you, or you can manage them manually. Your time and capabilities probably
    will not grow to scale as well as Composer will. Not to mention, it also provides
    a standard way for PHP projects to interoperate and load classes.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然这不是安装扩展的必需方式，但这应该成为你的默认方法。为什么？因为每个模块都是你项目中的一个依赖项，而且每个模块都可能有自己的依赖项。Composer
    可以为你管理依赖项，或者你可以手动管理它们。你的时间和能力可能不会像 Composer 那样增长到规模。更不用说，它还提供了一个标准方式，让 PHP 项目能够相互操作和加载类。
- en: 'You can get the Honeypot module and Bootstrap using the following two commands:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用以下两个命令获取 Honeypot 模块和 Bootstrap：
- en: '[PRE10]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Here is an example of contributed projects, which require Composer for installation,
    because they leverage existing libraries in the PHP community at large:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是一个贡献项目的示例，这些项目需要 Composer 进行安装，因为它们利用了整个 PHP 社区中的现有库：
- en: Drupal Commerce
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Drupal Commerce
- en: GeoIP
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: GeoIP
- en: Search API Solr
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 搜索 API Solr
- en: Entity Print
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实体打印
- en: As more and more modules integrate existing SDK libraries, the requirement to
    use Composer will increase.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 随着越来越多的模块集成了现有的 SDK 库，使用 Composer 的需求将会增加。
- en: Installing a module with Drush
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Drush 安装模块
- en: 'Modules can be downloaded and enabled through the command line using `drush`.
    The command to replicate the recipe would resemble the following:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过命令行使用 `drush` 下载和启用模块。复制菜谱的命令可能类似于以下内容：
- en: '[PRE11]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: As of Drush 9, which supports Drupal 8.3+, this section is deprecated. Using
    Drush to download Drupal core or contributed modules will throw a warning to use
    Composer instead.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 截至 Drush 9，它支持 Drupal 8.3+，本节已弃用。使用 Drush 下载 Drupal 核心或贡献模块将抛出警告，建议使用 Composer。
- en: It will prompt you to confirm your action. If there were dependencies for the
    module, it would ask whether you will like to enable those, too.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 它将提示你确认你的操作。如果模块有依赖项，它将询问你是否想启用这些依赖项。
- en: Drush simply downloads the archive available from Drupal.org. If the module
    or theme requires third-party PHP library dependencies, these will not be downloaded
    or be available in Drupal's class autoloading process.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: Drush 仅下载来自 Drupal.org 的存档。如果模块或主题需要第三方 PHP 库依赖项，这些依赖项将不会被下载或在 Drupal 的类自动加载过程中可用。
- en: Uninstalling a module
  id: totrans-186
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 卸载模块
- en: One of the substantial changes in Drupal 8 is the module disable and uninstall
    process. Previously, modules were first disabled and then uninstalled once disabled.
    This created a confusing process, which would disable its features, but not clean
    up any database schema changes. In Drupal 8, modules cannot just be disabled but
    must be uninstalled. This ensures that when a module is uninstalled it can safely
    be removed from the code base.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal 8中的一个重大变化是模块禁用和卸载过程。以前，模块首先被禁用，然后禁用后卸载。这造成了一个令人困惑的过程，它会禁用其功能，但不会清理任何数据库模式更改。在Drupal
    8中，模块不能只是被禁用，而必须被卸载。这确保了当模块被卸载时，它可以安全地从代码库中删除。
- en: A module can only be uninstalled if it is not a dependency of another module
    or does not have a configuration item in use--such as a field type--which could
    disrupt the installation's integrity.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一个模块不是另一个模块的依赖项，或者没有正在使用的配置项（例如字段类型），则可以卸载该模块。这可能会破坏安装的完整性。
- en: With a standard installation, the `Comment` module cannot be uninstalled until
    you delete all the `Comment` fields on the article `content` type. This is because
    the `field` type is in use.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 使用标准安装，在删除文章内容类型上的所有`Comment`字段之前，无法卸载`Comment`模块。这是因为`field`类型正在使用中。
- en: See also
  id: totrans-190
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考信息
- en: Refer to [*Chapter 4*](a634af62-2148-4382-9121-b8500df169ed.xhtml), *Extending
    Drupal*, to learn about setting defaults on enabling a module.
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参考第[*第4章*](a634af62-2148-4382-9121-b8500df169ed.xhtml)，*扩展Drupal*，了解在启用模块时设置默认值。
- en: Refer to [*Chapter 9*](b2659986-a8dc-4503-a043-6071ab7b6722.xhtml), *Configuration
    Management - Deploying in Drupal 8.*
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参考第[*第9章*](b2659986-a8dc-4503-a043-6071ab7b6722.xhtml)，*配置管理 - 在Drupal 8中部署*。
- en: Using multisites in Drupal 8
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Drupal 8中使用多站点
- en: Drupal provides the ability to run multiple sites from one single Drupal code
    base instance. This feature is referred to as multisite. Each site has a separate
    database; however, extensions stored in *modules*, *profiles*, and *themes* can
    be installed by all of the sites. Site folders can also contain their own modules
    and themes. When provided, these can only be used by that one site.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal提供了从单个Drupal代码库实例运行多个站点的功能。这个功能被称为多站点。每个站点都有一个独立的数据库；然而，存储在`modules`、`profiles`和`themes`中的扩展可以被所有站点安装。站点文件夹也可以包含它们自己的模块和主题。当提供时，这些只能由该站点使用。
- en: The `default` folder is the default folder used if there is no matching domain
    name.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '`default`文件夹是在没有匹配域名时使用的默认文件夹。'
- en: Getting ready
  id: totrans-196
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: If you are going to work with multisite functionality, you should have an understanding
    of how to set up virtual host configurations with your web server. In this recipe,
    we will use two subdomains under localhost, called `dev1` and `dev2`.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您将要使用多站点功能，您应该了解如何设置您的Web服务器上的虚拟主机配置。在这个菜谱中，我们将使用localhost下的两个子域名，称为`dev1`和`dev2`。
- en: How to do it...
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We will use multisites in Drupal 8 by two subdomains under localhost:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过localhost下的两个子域名来使用Drupal 8的多站点：
- en: Copy `sites/example.sites.php` to `sites/sites.php`.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`sites/example.sites.php`复制到`sites/sites.php`。
- en: Create a `dev1.localhost` and `dev2.localhost` folder inside the `sites` folder.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`sites`文件夹内创建一个`dev1.localhost`和`dev2.localhost`文件夹。
- en: 'Copy the `sites/default/default.settings.php` file into `dev1.localhost` and
    `dev2.localhost` as `settings.php` in their respective folder:'
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`sites/default/default.settings.php`文件复制到`dev1.localhost`和`dev2.localhost`，并在各自的文件夹中作为`settings.php`使用：
- en: '![](img/e4f64b42-01bd-49e0-9ba4-588514f69700.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/e4f64b42-01bd-49e0-9ba4-588514f69700.png)'
- en: Got to `dev1.localhost` and run the installation wizard.
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往`dev1.localhost`并运行安装向导。
- en: Got to `dev2.localhost` and verify that you still have the option to install
    a site!
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往`dev2.localhost`并验证您是否仍然有安装站点的选项！
- en: How it works...
  id: totrans-206
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The `sites.php` must exist for the multisite functionality to work. By default,
    you do not need to modify its contents. The `sites.php` file provides a way to
    map aliases to specific site folders. The file contains the documentation for
    using aliases.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '`sites.php`必须存在，多站点功能才能工作。默认情况下，您不需要修改其内容。`sites.php`文件提供了一种将别名映射到特定站点文件夹的方法。该文件包含了使用别名的文档。'
- en: The `DrupalKernel` class provides `findSitePath` and `getSitePath` methods to
    discover the site folder path. On Drupal's Bootstrap, this is initiated and reads
    the incoming HTTP host to load the proper `settings.php` file from the appropriate
    folder. The `settings.php` file is then loaded and parsed into a `\Drupal\Core\Site\Settings`
    instance. This allows Drupal to connect to the appropriate database.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: '`DrupalKernel` 类提供了 `findSitePath` 和 `getSitePath` 方法来发现站点文件夹路径。在 Drupal 的引导过程中，这被启动并读取传入的
    HTTP 主机以从适当的文件夹加载正确的 `settings.php` 文件。然后加载并解析 `settings.php` 文件到 `\Drupal\Core\Site\Settings`
    实例。这允许 Drupal 连接到适当的数据库。'
- en: There's more...
  id: totrans-209
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Let's understand the security concerns of using multisite.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们了解使用多站点的安全问题。
- en: Security concerns
  id: totrans-211
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安全问题
- en: There can be cause for concern if you are using multisite. Arbitrary PHP code
    executed on a Drupal site might be able to affect other sites sharing the same
    code base. Drupal 8 marked the removal of the PHP filter ([https://www.drupal.org/docs/8/modules/php/overview](https://www.drupal.org/docs/8/modules/php/overview))
    module that allowed site administrators to use PHP code in the administrative
    interface. Although this mitigates the various ways an administrator had easy
    access to run PHP through an interface, it does not mitigate the risk wholesale.
    For example, the PHP filter module is now a contributed project and could be installed.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用多站点，可能会有一些担忧。在 Drupal 站点上执行的任意 PHP 代码可能会影响共享相同代码库的其他站点。Drupal 8 标记了移除 PHP
    过滤器 ([https://www.drupal.org/docs/8/modules/php/overview](https://www.drupal.org/docs/8/modules/php/overview))
    模块，该模块允许站点管理员在管理界面中使用 PHP 代码。尽管这减少了管理员通过界面轻松运行 PHP 的各种方式，但它并没有完全减轻风险。例如，PHP 过滤器模块现在是一个贡献项目，可以被安装。
- en: Domain aliases
  id: totrans-213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 域名别名
- en: The `sites.php` file provides a way to add domain aliases. This can be useful
    when you use a multisite functionality and need to develop it locally. A simple
    example would be providing a `local.alias` to each site.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: '`sites.php` 文件提供了一种添加域名别名的方法。当你使用多站点功能并在本地开发时，这可能很有用。一个简单的例子是为每个站点提供一个 `local.alias`。'
- en: 'If you had `example.com` and `mycompany.com` as different site directories,
    the following mapping would allow `local.example.com` and `local.mycompany.com`
    to map to those directories:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你将 `example.com` 和 `mycompany.com` 作为不同的站点目录，以下映射将允许 `local.example.com` 和
    `local.mycompany.com` 映射到这些目录：
- en: '[PRE12]'
  id: totrans-216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: See also...
  id: totrans-217
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参见...
- en: Refer to Multisite documentation on Drupal at [https://www.drupal.org/documentation/install/multi-site](https://www.drupal.org/documentation/install/multi-site).
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参考Drupal的多站点文档，请访问 [https://www.drupal.org/documentation/install/multi-site](https://www.drupal.org/documentation/install/multi-site)。
- en: Tools for setting up an environment
  id: totrans-219
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置环境的工具
- en: One of the initial hurdles to getting started with Drupal is a local development
    environment. This recipe will cover how to set up the DrupalVM project by Jeff
    Geerling. DrupalVM is a VirtualBox virtual machine run through Vagrant, provisioned
    and configured with Ansible. It will set up all of your services and build a Drupal
    installation for you.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 开始使用 Drupal 的一个初步障碍是本地开发环境。本食谱将介绍如何通过 Jeff Geerling 的 DrupalVM 项目设置。DrupalVM
    是通过 Vagrant 运行的 VirtualBox 虚拟机，通过 Ansible 配置和部署。它将为你设置所有服务并构建一个 Drupal 安装。
- en: Luckily, you will only need to have VirtualBox and Vagrant installed on your
    machine, and DrupalVM works on Windows, macOS X, and Linux.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，你只需要在你的机器上安装 VirtualBox 和 Vagrant，DrupalVM 支持Windows、macOS X 和 Linux。
- en: Getting ready
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To get started, you will need to install the two dependencies required for
    DrupalVM:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始，你需要安装 DrupalVM 所需的两个依赖项：
- en: '**VirtualBox**: [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)'
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VirtualBox**: [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)'
- en: '**Vagrant**: [http://www.vagrantup.com/downloads.html](http://www.vagrantup.com/downloads.html)'
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Vagrant**: [http://www.vagrantup.com/downloads.html](http://www.vagrantup.com/downloads.html)'
- en: How to do it...
  id: totrans-226
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Let''s set up the DrupalVM project by Jeff Geerling by following these steps:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们按照以下步骤设置 Jeff Geerling 的 DrupalVM 项目：
- en: Download the DrupalVM archive from [https://github.com/geerlingguy/drupal-vm/archive/master.zip](https://github.com/geerlingguy/drupal-vm/archive/master.zip).
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 [https://github.com/geerlingguy/drupal-vm/archive/master.zip](https://github.com/geerlingguy/drupal-vm/archive/master.zip)
    下载 DrupalVM 存档。
- en: Extract the archive and place the project in the directory of your choice.
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解压存档并将项目放置在你选择的目录中。
- en: Copy `example.drupal.make.yml` to `drupal.make.yml`.
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `example.drupal.make.yml` 复制到 `drupal.make.yml`。
- en: Copy `default.config.yml` to `config.yml`.
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `default.config.yml` 复制到 `config.yml`。
- en: 'Edit `config.yml` and modify the `local_path` setting to be the directory where
    you''ve placed the DrupalVM project. This will be synchronized into the virtual
    machine:'
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑`config.yml`并修改`local_path`设置，使其成为您放置DrupalVM项目的目录。这将同步到虚拟机中：
- en: '[PRE13]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Open a terminal and navigate to the directory where you have placed the
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开终端并导航到您放置文件的目录。
- en: DrupalVM project.
  id: totrans-235
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: DrupalVM项目。
- en: Enter the `vagrant up` command to tell Vagrant to build the virtual machine
    and begin the provisioning process.
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入`vagrant up`命令来告诉Vagrant构建虚拟机并开始配置过程。
- en: While this process is ongoing, modify your host file to provide easy access
    to the development site. Add the `192.168.88.88 drupalvm.dev` line to your host
    file.
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此过程进行时，修改您的hosts文件以提供对开发站点的便捷访问。将`192.168.88.88 drupalvm.dev`行添加到您的hosts文件中。
- en: Open your browser and access [http://www.drupalvm.com/](http://www.drupalvm.com/).
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开您的浏览器并访问[http://www.drupalvm.com/](http://www.drupalvm.com/)。
- en: Log in to your Drupal site with the username `admin` and password `admin`.
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用用户名`admin`和密码`admin`登录到您的Drupal站点。
- en: How it works...
  id: totrans-240
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 工作原理...
- en: DrupalVM is a development project that utilizes the Vagrant tool to create a
    VirtualBox virtual machine. Vagrant is configured through the project's `Vagrantfile`.
    Vagrant then uses Ansible--an open source IT automation platform--to install Apache,
    PHP, MySQL, and other services on the virtual machine.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: DrupalVM是一个开发项目，它利用Vagrant工具创建一个VirtualBox虚拟机。Vagrant通过项目的`Vagrantfile`进行配置。然后，Vagrant使用Ansible（一个开源的IT自动化平台）在虚拟机上安装Apache、PHP、MySQL和其他服务。
- en: The `config.yml` file has been set up to provide a simple way to customize variables
    for the virtual machine and provisioning process. It also uses Drush to create
    and install a Drupal 8 site, or whatever components are specified in `drupal.make.yml`.
    This file is a Drush `make` file, which contains a definition for Drupal core
    by default and can be modified to include other contributed projects.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: '`config.yml`文件已经设置好，提供了一种简单的方式来自定义虚拟机和配置过程中的变量。它还使用Drush创建和安装Drupal 8站点，或者`drupal.make.yml`中指定的任何组件。此文件是一个Drush
    `make`文件，默认包含Drupal核心的定义，并且可以修改以包含其他贡献项目。'
- en: The `vagrant up` command tells Vagrant to either launch an existing virtual
    machine or create one anew in a headless manner. When Vagrant creates a new virtual
    machine, it triggers the provisioning process. In this instance, Ansible will
    read the `provisioning/playbook.yml` file and follow each step to create the final
    virtual machine. The only files that need to be modified, however, are the `config.yml`
    and `drupal.make.yml` files.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '`vagrant up`命令告诉Vagrant要么启动一个现有的虚拟机，要么以无头方式创建一个新的虚拟机。当Vagrant创建一个新的虚拟机时，它会触发配置过程。在这种情况下，Ansible将读取`provisioning/playbook.yml`文件，并遵循每个步骤来创建最终的虚拟机。然而，需要修改的文件只有`config.yml`和`drupal.make.yml`文件。'
- en: There's more...
  id: totrans-244
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更多内容...
- en: The topic of automating and streamlining a local environment is quite popular
    right now with quite a few different options. If you are not comfortable with
    using Vagrant, there are a few other options that provide a server installation
    and Drupal.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 自动化和简化本地环境的主题目前非常流行，有相当多的不同选项。如果你不习惯使用Vagrant，还有一些其他选项可以提供服务器安装和Drupal。
- en: Acquia Dev Desktop
  id: totrans-246
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Acquia Dev Desktop
- en: Acquia Dev Desktop is developed by Acquia and can be found at [https://docs.acquia.com/dev-desktop2](https://docs.acquia.com/dev-desktop2).
    It is an automated environment installer for Windows and Mac. It is a xAMP stack
    (or DAMP stack) installer that provides a full Drupal-specific stack that includes
    Apache, MySQL, and PHP. The Dev Desktop application allows you to create a regular
    Drupal installation or select from a distribution.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: Acquia Dev Desktop由Acquia开发，可在[https://docs.acquia.com/dev-desktop2](https://docs.acquia.com/dev-desktop2)找到。它是一个Windows和Mac的自动化环境安装程序。它是一个xAMP堆栈（或DAMP堆栈）安装程序，提供包含Apache、MySQL和PHP的完整Drupal特定堆栈。Dev
    Desktop应用程序允许您创建一个常规的Drupal安装或从分发版中选择。
- en: XAMPP + Bitnami
  id: totrans-248
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: XAMPP + Bitnami
- en: XAMPP - Apache + MySQL + PHP + Perl - is a cross-platform environment installation.
    XAMPP is an open source project from Apache Friends. XAMPP has partnered with
    Bitnami ([https://bitnami.com/](https://bitnami.com/)) to provide free all-in-one
    installations for common applications, including Drupal 8\. You can download XAMPP
    at [https://www.apachefriends.org/download.html](https://www.apachefriends.org/download.html).
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: XAMPP - Apache + MySQL + PHP + Perl - 是一个跨平台环境安装。XAMPP 是 Apache Friends 的开源项目。XAMPP
    与 Bitnami ([https://bitnami.com/](https://bitnami.com/)) 合作，为常见应用程序提供免费的集成安装，包括
    Drupal 8。您可以在 [https://www.apachefriends.org/download.html](https://www.apachefriends.org/download.html)
    下载 XAMPP。
- en: Kalabox
  id: totrans-250
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Kalabox
- en: Kalabox is developed by the Kalamuna group and intends to be a robust workflow
    solution for Drupal development. Kalabox is cross-platform compatible, allowing
    you to easily work on Windows machines. It is based on the command line and provides
    application binaries for you to install. You can learn more about Kalabox at [http://www.kalamuna.com/products/kalabox/](http://www.kalamuna.com/products/kalabox/).
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: Kalabox 由 Kalamuna 团队开发，旨在成为 Drupal 开发的强大工作流程解决方案。Kalabox 兼容跨平台，允许您轻松地在 Windows
    机器上工作。它基于命令行，并提供应用程序二进制文件供您安装。您可以在 [http://www.kalamuna.com/products/kalabox/](http://www.kalamuna.com/products/kalabox/)
    上了解更多关于 Kalabox 的信息。
- en: See also
  id: totrans-252
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参见
- en: Refer to [*Chapter 13*](099b7376-2149-4af8-9649-45445745f068.xhtml), *The Drupal
    CLI*, for information on makefiles.
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参阅 [*第 13 章*](099b7376-2149-4af8-9649-45445745f068.xhtml)，*Drupal CLI*，了解 makefile
    的信息。
- en: DrupalVM documentation [http://docs.drupalvm.com/en/latest/](http://docs.drupalvm.com/en/latest/).
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DrupalVM 文档 [http://docs.drupalvm.com/en/latest/](http://docs.drupalvm.com/en/latest/)。
- en: Refer to Drupal.org community documentation on local environment setup at [https://www.drupal.org/node/157602](https://www.drupal.org/node/157602).
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参考 Drupal.org 社区文档中的本地环境设置信息，链接为 [https://www.drupal.org/node/157602](https://www.drupal.org/node/157602)。
- en: Running tests - Simpletest and PHPUnit
  id: totrans-256
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 运行测试 - Simpletest 和 PHPUnit
- en: Drupal 8 ships with two testing suites. Previously, Drupal only supported Simpletest.
    Now, there are PHPUnit tests as well. In the official change record, PHPUnit was
    added to provide testing without requiring a full Drupal Bootstrap, which occurs
    with each Simpletest test. You can read the change record at [https://www.drupal.org/node/2012184](https://www.drupal.org/node/2012184).
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal 8 随带两个测试套件。之前，Drupal 只支持 Simpletest。现在，还有 PHPUnit 测试。在官方变更记录中，PHPUnit
    被添加以提供无需完整 Drupal Bootstrap 的测试，这在每次 Simpletest 测试时都会发生。您可以在 [https://www.drupal.org/node/2012184](https://www.drupal.org/node/2012184)
    阅读变更记录。
- en: There is currently a PHPUnit initiative active in Drupal core development. The
    goal is to fully remove the Simpletest framework by Drupal 9\. No new Simpletest
    tests are being written, at least since 8.2\. All current tests are currently
    being converted by contributors. More about the initiative can be found in this
    issue, [https://www.drupal.org/node/2807237](https://www.drupal.org/node/2807237),
    where it is being coordinated.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 目前在 Drupal 核心开发中有一个活跃的 PHPUnit 创新项目。目标是到 Drupal 9 时完全移除 Simpletest 框架。至少从 8.2
    版本开始，不再编写新的 Simpletest 测试。所有当前测试正在由贡献者转换。更多关于这个项目的信息可以在这个问题中找到，[https://www.drupal.org/node/2807237](https://www.drupal.org/node/2807237)，那里正在进行协调。
- en: We will be running tests using the `run-tests.sh` test runner. This is a test
    runner provided by Drupal that supports concurrency and running all of the various
    test suites. Running tests directly with PHPUnit will be covered in the following
    *There's more...* section.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用 `run-tests.sh` 测试运行器来运行测试。这是一个由 Drupal 提供的测试运行器，支持并发运行所有各种测试套件。在接下来的 *还有更多...*
    部分将介绍如何直接使用 PHPUnit 运行测试。
- en: Getting ready
  id: totrans-260
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: Drupal 8.1.0 introduced the ability to perform JavaScript browser tests. This
    is powered using PhantomJS ([http://phantomjs.org/](http://phantomjs.org/)), which
    uses a browser emulator powered by the Mink PHP library ([http://mink.behat.org/](http://mink.behat.org/)).
    In order to run the FunctionalJavascript test suite, you must have PhantomJS running.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal 8.1.0 引入了执行 JavaScript 浏览器测试的能力。这是使用 PhantomJS ([http://phantomjs.org/](http://phantomjs.org/))
    实现的，它使用由 Mink PHP 库 ([http://mink.behat.org/](http://mink.behat.org/)) 提供的浏览器模拟器。为了运行
    FunctionalJavascript 测试套件，您必须运行 PhantomJS。
- en: To install PhantomJS, refer to the official installation instructions at [http://phantomjs.org/download.html](http://phantomjs.org/download.html).
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装 PhantomJS，请参考官方安装说明，链接为 [http://phantomjs.org/download.html](http://phantomjs.org/download.html)。
- en: How to do it...
  id: totrans-263
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: First, install the `Simpletest` module. Even though you might only want to run
    PHPUnit, this is a soft dependency for running the test runner script.
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，安装`Simpletest`模块。即使你可能只想运行PHPUnit，这也是运行测试运行器脚本的软依赖。
- en: Open a command-line terminal and navigate to your Drupal installation directory.
  id: totrans-265
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开命令行终端，导航到您的Drupal安装目录。
- en: 'Next, we will run the test runner script. We will pass it a `url` option so
    that the Functional tests can run the browser emulator properly. We will also
    specify the test suites to run. This allows us to skip FunctionalJavascript tests
    due to PhantomJS not handling concurrency properly in the test runner:'
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将运行测试运行器脚本。我们将传递一个`url`选项，以便功能测试可以正确运行浏览器模拟器。我们还将指定要运行的测试套件。这允许我们跳过功能JavaScript测试，因为PhantomJS在测试运行器中无法正确处理并发：
- en: '[PRE14]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Running `FunctionalJavascripts` tests require PhantomJS to be running. Since
    PhantomJS prints output to the terminal, open a new tab or terminal and run the
    following command:'
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行`FunctionalJavascripts`测试需要PhantomJS正在运行。由于PhantomJS将输出打印到终端，请打开一个新标签或终端并运行以下命令：
- en: '[PRE15]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'With PhantomJS running, we can now execute the FunctionalJavascript test suite:'
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当PhantomJS运行时，我们现在可以执行功能JavaScript测试套件：
- en: '[PRE16]'
  id: totrans-271
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Review test output from each test suite run.
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看每个测试套件运行的测试输出。
- en: How it works...
  id: totrans-273
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The `run-tests.sh` script has been shipped with Drupal since 2008, then named
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: '`run-tests.sh`脚本自2008年以来一直与Drupal一起提供，当时命名为'
- en: '`run-functional-tests.php`. This command interacts with the test suites in
    Drupal to run all or specific tests and sets up other configuration items.'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: '`run-functional-tests.php`。此命令与Drupal中的测试套件交互，运行所有或特定测试，并设置其他配置项。'
- en: 'There are several different test suites that operate in specific ways:'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 有几个不同的测试套件，它们以特定的方式运行：
- en: '**Simpletest**: The deprecated test system, full bootstraps and installs Drupal
    and uses its own browser emulator pattern using curl and XPath.'
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Simpletest**：已弃用的测试系统，完全引导并安装Drupal，并使用curl和XPath的自己的浏览器模拟模式。'
- en: '**PHPUnit-Unit**: Unit tests backed by PHPUnit. These are intended to test
    specific classes and not interact with the database.'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PHPUnit-Unit**：由PHPUnit支持的单元测试。这些测试旨在测试特定的类，而不与数据库交互。'
- en: '**PHPUnit-Kernel**: Integration-level tests backed by PHPUnit. It is a test
    that has the ability to install schema and configuration to the database, minimally
    bootstrapping Drupal for basic integration testing.'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PHPUnit-Kernel**：由PHPUnit支持的集成级别测试。这是一个能够将模式配置安装到数据库中的测试，它以最小化引导Drupal进行基本集成测试。'
- en: '**PHPUnit-Functional**: Functional tests are tests that require a fully bootstrapped
    Drupal and provide browser emulation via Mink. These can be considered a direct
    replacement of Simpletest tests but leveraging third-party testing libraries.'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PHPUnit-Functional**：功能测试是需要在完全引导的Drupal中运行的测试，并通过Mink提供浏览器模拟。这些可以被认为是Simpletest测试的直接替代品，但利用第三方测试库。'
- en: '**PHPUnit-FunctionalJavascript**: Functional tests that have the ability to
    interact with PhantomJS in order to test JavaScript, such as AJAX operations and
    specific user interface interactions.'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PHPUnit-FunctionalJavascript**：具有与PhantomJS交互的能力的功能测试，以测试JavaScript，例如AJAX操作和特定的用户界面交互。'
- en: 'The following are some of the useful options:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些有用的选项：
- en: '`--help`: This displays the items covered in the following bullets'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--help`：此选项显示以下要点涵盖的内容'
- en: '`--list`: This displays the available test groups that can be run'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--list`：此选项显示可以运行的可用测试组'
- en: '`--url`: This is required unless the Drupal site is accessible through `http://localhost:80`'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--url`：除非Drupal站点可通过`http://localhost:80`访问，否则此选项是必需的'
- en: '`--sqlite`: This allows you to run tests without having Drupal installed'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--sqlite`：这允许您在没有安装Drupal的情况下运行测试'
- en: '`--concurrency`: This allows you to define how many tests run in parallel'
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--concurrency`：这允许你定义并行运行的测试数量'
- en: There's more...
  id: totrans-288
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: We will now discuss more techniques and information for running Drupal's test
    suites.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将讨论更多关于运行Drupal测试套件的技巧和信息。
- en: Is run-tests a shell script?
  id: totrans-290
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: run-tests 是一个shell脚本吗？
- en: The `run-tests.sh` isn't actually a shell script. It is a PHP script--which
    is why you must execute it with PHP. In fact, within `core/scripts`, each file
    is a PHP script file meant to be executed using the command line. These scripts
    are not intended to be run through a web server, which is one of the reasons for
    the `.sh` extension.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: '`run-tests.sh`实际上不是一个shell脚本。它是一个PHP脚本--这就是为什么你必须用PHP来执行它。实际上，在`core/scripts`中，每个文件都是一个PHP脚本文件，旨在通过命令行执行。这些脚本不是旨在通过Web服务器运行，这是`.sh`扩展名的原因之一。'
- en: There can be issues with PHP across platforms that prevent providing a shebang
    line to allow executing the file as a normal `bash` or `bat` script. For more
    information, refer to this Drupal.org issue at [https://www.drupal.org/node/655178](https://www.drupal.org/node/655178).
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 在跨平台之间可能会有问题，这阻止了提供 shebang 行以允许将文件作为正常的 `bash` 或 `bat` 脚本执行。有关更多信息，请参阅此 Drupal.org
    问题 [https://www.drupal.org/node/655178](https://www.drupal.org/node/655178)。
- en: Running tests without Drupal installed
  id: totrans-293
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在未安装 Drupal 的情况下运行测试
- en: With Drupal 8, tests can also be run from SQLlite and no longer requires an
    installed database. This can be accomplished by passing the `sqlite` and `dburl`
    options to the
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Drupal 8 中，测试也可以从 SQLite 运行，不再需要安装数据库。这可以通过将 `sqlite` 和 `dburl` 选项传递给
- en: '`run-tests.sh` script. This requires the PHP SQLite extension to be installed.'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: '`run-tests.sh` 脚本。这需要安装 PHP SQLite 扩展。'
- en: 'Here is an example adapted from the DrupalCI test runner for Drupal core. DrupalCI
    is the continuous integration service, which runs on Drupal.org for all submitted
    patches and commits:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是一个从 DrupalCI 测试运行器改编的示例，用于 Drupal 核心测试。DrupalCI 是持续集成服务，它在 Drupal.org 上为所有提交的补丁和提交运行：
- en: '[PRE17]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Combined with the built-in PHP web server for debugging, you can run test suites
    without a full-fledged environment.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 结合内置的 PHP 网络服务器进行调试，您可以在没有完整环境的情况下运行测试套件。
- en: Running specific tests
  id: totrans-299
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 运行特定测试
- en: 'Each example so far has used the `all` option to run every `Simpletest` available.
    There are various ways to run specific tests:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止的每个示例都使用了 `all` 选项来运行所有可用的 `Simpletest`。有各种方法来运行特定的测试：
- en: '`--module`: This allows you to run all the tests of a specific module'
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--module`: 这允许您运行特定模块的所有测试'
- en: '`--class`: This runs a specific path, identified by a full namespace path'
  id: totrans-302
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--class`: 运行一个由完整命名空间路径标识的特定路径'
- en: '`--file`: This runs tests from a specified file'
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--file`: 从指定的文件运行测试'
- en: '`--directory`: This run tests within a specified directory'
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--directory`: 在指定的目录内运行测试'
- en: Previously in Drupal, tests were grouped inside the `module.test` files, which
    is where the file option derives from. Drupal 8 utilizes the `PSR-4 autoloading`
    method and requires one class per file.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Drupal 中，测试以前是分组在 `module.test` 文件中，这也是文件选项的来源。Drupal 8 使用 `PSR-4 自动加载` 方法，并要求每个文件有一个类。
- en: PhpStorm - Drupal Test Runner
  id: totrans-306
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PhpStorm - Drupal 测试运行器
- en: Drupal 8 has seen a surge in test coverage for both Drupal core and contributed
    projects, most likely due to PHPUnit adoption. In response to this, the author
    has written a PhpStorm plugin called Drupal Test Runner that simplifies executing
    the `run-tests.sh` script runner.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: Drupal 8 在 Drupal 核心和贡献项目中的测试覆盖率都有所增加，这很可能是由于PHPUnit的采用。作为回应，作者编写了一个名为 Drupal
    Test Runner 的 PhpStorm 插件，该插件简化了执行 `run-tests.sh` 脚本运行器的操作。
- en: The plugin's page can be found at [https://plugins.jetbrains.com/plugin/8384-drupal-test-runner](https://plugins.jetbrains.com/plugin/8384-drupal-test-runner),
    and it's public source code can be found at [https://github.com/mglaman/intellij-drupal-run-tests](https://github.com/mglaman/intellij-drupal-run-tests).
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 插件的页面可以在 [https://plugins.jetbrains.com/plugin/8384-drupal-test-runner](https://plugins.jetbrains.com/plugin/8384-drupal-test-runner)
    找到，其公开源代码可以在 [https://github.com/mglaman/intellij-drupal-run-tests](https://github.com/mglaman/intellij-drupal-run-tests)
    找到。
- en: DrupalCI
  id: totrans-309
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DrupalCI
- en: With Drupal 8 came a new initiative to upgrade the testing infrastructure on
    Drupal.org. The outcome was DrupalCI. DrupalCI is open source and can be downloaded
    and run locally. The project page for DrupalCI is [https://www.drupal.org/project/drupalci](https://www.drupal.org/project/drupalci).
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 随着 Drupal 8 的推出，一个新的举措是为了升级 Drupal.org 上的测试基础设施。结果是 DrupalCI。DrupalCI 是开源的，可以下载并在本地运行。DrupalCI
    的项目页面是 [https://www.drupal.org/project/drupalci](https://www.drupal.org/project/drupalci)。
- en: The test bot utilizes Docker and can be downloaded locally to run tests. The
    project ships with a Vagrant file that allows it to be run within a virtual machine
    or locally. Learn more on the testbot's project page at [https://www.drupal.org/project/drupalci_testbot](https://www.drupal.org/project/drupalci_testbot).
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 测试机器人使用 Docker，可以本地下载以运行测试。项目附带一个 Vagrant 文件，允许它在虚拟机或本地运行。有关测试机器人的更多信息，请访问其项目页面
    [https://www.drupal.org/project/drupalci_testbot](https://www.drupal.org/project/drupalci_testbot)。
- en: See also...
  id: totrans-312
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参见...
- en: Refer to the PHPUnit manual at [https://phpunit.de/manual/4.8/en/writing-tests-for-phpunit.html](https://phpunit.de/manual/4.8/en/writing-tests-for-phpunit.html).
  id: totrans-313
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参考PHPUnit手册 [https://phpunit.de/manual/4.8/en/writing-tests-for-phpunit.html](https://phpunit.de/manual/4.8/en/writing-tests-for-phpunit.html)。
- en: Refer to the Drupal PHPUnit handbook at [https://drupal.org/phpunit](https://drupal.org/phpunit).
  id: totrans-314
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参考Drupal PHPUnit手册 [https://drupal.org/phpunit](https://drupal.org/phpunit)。
- en: Refer to Running tests from the command line at [https://www.drupal.org/node/645286](https://www.drupal.org/node/645286).
  id: totrans-315
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参考[从命令行运行测试](https://www.drupal.org/node/645286)。
- en: 'Refer to Commerce 2.x: Unit, Kernel, and Functional Tests Oh My! Authors blog
    post and tutorial for running tests in Drupal 8 for Drupal Commerce at [https://drupalcommerce.org/blog/45322/commerce-2x-unit-kernel-and-functional-tests-oh-my](https://drupalcommerce.org/blog/45322/commerce-2x-unit-kernel-and-functional-tests-oh-my).'
  id: totrans-316
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参考《Commerce 2.x：单元、内核和功能测试，哦，我的天！》作者博客文章和教程，了解如何在Drupal 8中为Drupal Commerce运行测试，链接为[https://drupalcommerce.org/blog/45322/commerce-2x-unit-kernel-and-functional-tests-oh-my](https://drupalcommerce.org/blog/45322/commerce-2x-unit-kernel-and-functional-tests-oh-my)。

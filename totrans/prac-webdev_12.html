<html><head></head><body><div class="chapter" title="Chapter&#xA0;12.&#xA0;Mobile First, Responsive Design with Progressive Enhancement"><div class="titlepage"><div><div><h1 class="title"><a id="ch12"/>Chapter 12. Mobile First, Responsive Design with Progressive Enhancement</h1></div></div></div><p>This is most definitely the chapter with the longest title. There is also a lot of text inside the first part of this chapter, as you will find little or no code examples there. Here, we discuss the newest trends in web development, what is causing it, and what it replaces.</p><div class="section" title="Responsive design"><div class="titlepage"><div><div><h1 class="title"><a id="ch12lvl1sec80"/>Responsive design</h1></div></div></div><p>A viewport, or the section of the <a id="id796" class="indexterm"/>screen where your browser is, comes in all kinds of sizes. Some are very small, such as the screen of your smartphone, and some can be very large. When I looked at my old website on a screen a lot larger than the one I was used to work on, it was so ugly that I decided to completely redo it using a <span class="strong"><strong>responsive design</strong></span>.</p><p>Designing a web page with a fixed width specified in pixels today really is out of the question, as is making several versions of your website to accommodate all these sizes.</p><p>In responsive design—I am always tempted to call it responsible design—one does not start off with a canvas of, let us say, 960 px wide and build a site that way, chopping it into fixed size <code class="literal">&lt;div&gt;</code> blocks. As soon as the view port is smaller than 960px, a part of the site would not be visible and, maybe worse, when the screen is really big, everything around your 960x wide rectangle will look boring and empty. This is simply not done today.</p><p>A good design should<a id="id797" class="indexterm"/> adjust, respond, to the screen size and always look good. To have a good responsive design, you need to:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Use a flexible grid: have your building blocks sit side by side when there is room, stack them on top of each other when there is none, and proportionally adjust sizes to do so</li><li class="listitem" style="list-style-type: disc">Use percentages, not pixels, in your CSS when you define those sizes</li><li class="listitem" style="list-style-type: disc">Use media queries to specify different properties for different screen sizes, resolutions, orientations, and so on</li><li class="listitem" style="list-style-type: disc">Use flexible<a id="id798" class="indexterm"/> images and fonts</li></ul></div><p>This seems like a lot of work. The good news is that others have already done that hard work for you. There are<a id="id799" class="indexterm"/> several CSS/JavaScript frameworks available that feature all the things we just listed. You will simply have to add media queries, customized to your site. The hardest part is probably which framework to choose, as there are several really good <a id="id800" class="indexterm"/>ones, in particular <span class="strong"><strong>Bootstrap</strong></span> and<a id="id801" class="indexterm"/> <span class="strong"><strong>Foundation</strong></span>.</p><p>We have chosen for Foundation and that will be the topic of the next chapter. That choice was a matter of taste or preference. <span class="emphasis"><em>De gustibus non disputandum!</em></span>
</p><div class="section" title="Déjà vu"><div class="titlepage"><div><div><h2 class="title"><a id="ch12lvl2sec127"/>Déjà vu</h2></div></div></div><p>As I am writing this, I am having a flashback-like experience. In my first job in the software industry, I was responsible<a id="id802" class="indexterm"/> for porting a software package, TEN/PLUS, to several different flavors of UNIX. Its main component was a full-screen editor.</p><p>A full screen in those days was that of a so called<a id="id803" class="indexterm"/> <span class="strong"><strong>dumb terminal</strong></span> with 24 lines holding 80 characters each. Then came the <span class="strong"><strong>X Window System</strong></span> and monitors in graphics mode, with icons<a id="id804" class="indexterm"/> and many utilities, support for a mouse, and so on. One of those utilities is <span class="strong"><strong>xterm</strong></span>, an X client <a id="id805" class="indexterm"/>emulating a dumb terminal. That of course meant you could run full screen editors inside it. But you could resize the xterm window, to be one with more lines or longer lines.</p><p>So I had to modify our software to adjust to that size and still be a full-screen editor inside xterm, even if it was 64 lines by 120 characters. This was responsive design 25 years ago! And in 2015 people are still using editors such as vi, emacs, nano, and so on inside terminal windows.</p></div><div class="section" title="Media queries"><div class="titlepage"><div><div><h2 class="title"><a id="ch12lvl2sec128"/>Media queries</h2></div></div></div><p>The keyword <a id="id806" class="indexterm"/>
<span class="strong"><strong>media</strong></span> has<a id="id807" class="indexterm"/> been in use from the very beginning in HTML and<a id="id808" class="indexterm"/> CSS, but it was basically limited to specifying <code class="literal">media="print"</code> or <code class="literal">media="screen"</code> inside the <code class="literal">&lt;link&gt;</code> tag where you specified your CSS file, or by using <code class="literal">@media</code> screen inside the CSS file itself.</p><p>As of CSS3 and HTML5, we can use media queries in more sophisticated ways, to have specific styling that is applied only when certain conditions are met. Although the <code class="literal">media</code> attribute can still be used inside the <code class="literal">&lt;link&gt;</code> tag, we recommend you use them inside your CSS files. Media queries are essential to responsive design and, even though we promised you little or no work thanks to available frameworks, it is essential to know how to write or read them.</p><p>Here is a typical <a id="id809" class="indexterm"/>media query:</p><div class="informalexample"><pre class="programlisting">@media only screen and (orientation: portrait) and (min-width: 480px) and (max-width: 690px) {  /* your rules here */   }</pre></div><p>In between the curly braces, you would write the styling that is applicable to viewports that are between 480 and 690 pixels wide and your device is in portrait mode. Everything that came before will apply. Everything that is between those curly braces will override what came before.</p><p>Here are some of the most common keywords that can be used in media queries:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>width</strong></span>: Width of display<a id="id810" class="indexterm"/> area</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>height</strong></span>: Height of display <a id="id811" class="indexterm"/>area</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>device-width</strong></span>: Width<a id="id812" class="indexterm"/> of device</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>device-height</strong></span>: Height <a id="id813" class="indexterm"/>of device</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>orientation</strong></span>: Orientation<a id="id814" class="indexterm"/> of device (portrait or landscape)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>resolution</strong></span>: Density of pixels, expressed as <a id="id815" class="indexterm"/>dpi or dpcm</li></ul></div><p>All, except for orientation of course, can be preceded by minimum or maximum.</p><p>Starting the media query with the word <code class="literal">only</code> is a handy way to deal with browsers that do not support these newer media queries. It will be silently ignored.</p><p>The difference between width and height and the equivalent values prefixed by device should be easy to understand: width and height refer to the size of the browser viewport, whereas device-width and device-height refer to the dimensions of the monitor. Not everybody runs his or her browser full-screen, so width and height are the measurements that you need to use. There is one big caveat though.</p><p>Mobile browsers fill the available screen, so you might expect width and device-width to be the same. Unfortunately, that's not always the case. Most smart-phones set the width to a nominal value approximately 1,000 pixels wide (for an iPhone, it's 980 pixels). You have seen several adds of mobile phones showing a full page of the New York Times on the tiny phone. That's why!</p><p>With the fine retina displays of today, you would even be able to read the paper that way. But if you worked hard in getting your media queries right for various devices and have one for, let's say <code class="literal">max-width:480px</code>, your beautiful responsive design will not show up on that mobile phone. Fortunately, there is a remedy for this. Simply put the following line in the <code class="literal">&lt;head&gt;</code> section of your page:</p><div class="informalexample"><pre class="programlisting">&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</pre></div><p>Now we are<a id="id816" class="indexterm"/> truly on our way to a responsive design. By using media queries, we can create a page with a single design that will show elements on the page (think <code class="literal">&lt;div&gt;</code>) next to each other on a large screen, show them stacked on top of each other on a tablet in portrait mode, and show fewer of them on a mobile phone.</p><div class="section" title="Using the media attribute"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl3sec66"/>Using the media attribute</h3></div></div></div><p>You have probably seen sites<a id="id817" class="indexterm"/> containing a line like this in the <code class="literal">&lt;head&gt;</code> section:</p><div class="informalexample"><pre class="programlisting">&lt;link rel="stylesheet" type="text/css" href="print.css" media="print"&gt;</pre></div><p>It uses the <code class="literal">media</code> attribute to indicate if this stylesheet needs to be used. In HTML4 this was basically <code class="literal">screen</code> or <code class="literal">print</code>. In HTML5 the media attribute can have a lot more values. Those can be the same as what we put after <code class="literal">@media</code> only on our examples. So if we wanted, we could organize our CSS code in separate stylesheets, one for each media type and use them as appropriate, as is shown in the following example:</p><div class="informalexample"><pre class="programlisting">&lt;link rel="stylesheet" type="text/css" href="small.css" media="screen and (max-width:480px)"&gt;</pre></div></div></div><div class="section" title="Do more with less"><div class="titlepage"><div><div><h2 class="title"><a id="ch12lvl2sec129"/>Do more with less</h2></div></div></div><p>This term probably brings back bad memories to people who lived through the period before and during the financial crisis, but that is not what we are going to talk about.</p><p>Now that we have introduced <a id="id818" class="indexterm"/>media queries, we are at risk of having to write a lot more CSS, one set of rules for each media query we decide to use. Assume we divide it like three T-shirt sizes: small, medium, large. Add to that portrait and landscape flavors of each: you now have six.</p><p>Imagine that someone in the marketing department decides to change the corporate color: you now have to make six changes to your stylesheet.</p><p>This is where extensions<a id="id819" class="indexterm"/> to CSS, such as <span class="strong"><strong>less</strong></span> (<span class="strong"><strong>SASS</strong></span> is another one) prove to be very handy. One of its features is the use <a id="id820" class="indexterm"/>of <span class="strong"><strong>variables</strong></span>. Create a <code class="literal">.less</code> file to hold your stylesheet information. Use a variable to hold the color information:</p><div class="informalexample"><pre class="programlisting">@mycolor: #FFDEAD;</pre></div><p>Inside your media queries, wherever you need to specify this color, use:</p><div class="informalexample"><pre class="programlisting">color: @mycolor;</pre></div><p>Imagine you want to change it to <code class="literal">teal</code>. Just replace that single line by:</p><div class="informalexample"><pre class="programlisting">@mycolor: teal;</pre></div><p>Bingo! You have changed your color in all six places. Isn't that nice?</p><p>Less has more features<a id="id821" class="indexterm"/> such as mixins, nested rules, media queries, and more, resulting in better structured and easier to maintain stylesheets. It is all described very clearly<a id="id822" class="indexterm"/> at <a class="ulink" href="http://lesscss.org">lesscss.org</a>. The name of the site immediately explains why they call it less: You will end up writing less CSS. Just look at these two examples. The following is the <code class="literal">less</code> code:</p><div class="informalexample"><pre class="programlisting">@mycolor: #FFDEAD;
@mygreen: teal;
#content {
  background-color: @mycolor;
  .greenp {
  color: @mygreen;
  font-size:12px;
  font-family:Avenir, sans-serif;
  }
  .thumb {
  border: 2px solid @mygreen;
  width:150px;
  }
}</pre></div><p>This will be translated into the following CSS. And if you really start nesting, this can become a lot more:</p><div class="informalexample"><pre class="programlisting">#content {
  background-color: #FFDEAD;
  }
#content  .greenp {
  color: teal;
  font-size:12px;
  font-family:Avenir, sans-serif;
  }
#content  .thumb {
  border: 2px solid teal;
  width:150px;
}</pre></div><p>Let's have one<a id="id823" class="indexterm"/> more example with media queries. We could write:</p><div class="informalexample"><pre class="programlisting">@medium: 16px;
@portraitfont: "Avenir, sans-serif";
.container {
@media screen {
  background-color:@mycolor;
  @media (min-width:786px) {
    font-size:@medium;
    @media (orientation:landscape) {
      margin:auto;
          }
    @media (orientation:portratit) {
      font-family:@portraitfont;
          }
        }
      }
    }</pre></div><p>This will be translated into the following CSS. Don't you think the <code class="literal">less</code> version is less verbose?</p><div class="informalexample"><pre class="programlisting">@media screen {
    .container {
    background-color:#FFDEAD;
    }
}
@media screen and (min-width:786px) {
    .container {
      font-size:16px;
    }
  }
@media screen and (min-width:786px) and (orientation:landscape) {
    .container {
      margin:auto;
      }
}
@media screen and (min-width:786px) and (orientation:portrait) {
    .container {
      font-family:Avenir, Verdana, sans-serif;
      }
}</pre></div><p>Now how do we convert the less file to CSS content? There are two ways to do this. When we reach the production stage, we want to use a compiler to generate the CSS file from our less file. In <a class="link" href="ch14.html" title="Chapter 14. Node.js">Chapter 14</a>, <span class="emphasis"><em>Node.js</em></span>, you will learn about Node.js and node modules. There is a <code class="literal">node</code> module for less.</p><p>For now, while<a id="id824" class="indexterm"/> we are still developing and experimenting more with less, download <code class="literal">less.js</code> from the <a class="ulink" href="http://lesscss.org">lesscss.org</a> site.</p><p>Inside the <code class="literal">&lt;head&gt;</code> section of your page, list your <code class="literal">less</code> file in a <code class="literal">link</code> tag:</p><div class="informalexample"><pre class="programlisting">&lt;link rel="stylesheet/less" type="text/css"
href="less/mystyles.less"&gt;&lt;/link&gt;</pre></div><p>I like to keep my <code class="literal">less</code> files in a <code class="literal">less</code> folder. In the right spot on your page, for example, right before the closing <code class="literal">&lt;/body&gt;</code> tag, add:</p><div class="informalexample"><pre class="programlisting">&lt;script src="js/less.js"&gt;&lt;/script&gt;</pre></div><p>Now your <code class="literal">less</code> file will be converted to CSS on-the-fly, each time the page is loaded. Note that, when editing your <code class="literal">less</code> files, not all editors will give you the nice color coding and formatting they feature when you edit CSS files. I use Textastic to edit my <code class="literal">less</code> files. To paraphrase the governator: <span class="emphasis"><em>You have to watch this editor: it is fantastic!</em></span>
</p></div><div class="section" title="Mobile first"><div class="titlepage"><div><div><h2 class="title"><a id="ch12lvl2sec130"/>Mobile first</h2></div></div></div><p>Now that we covered how to make our design responsive and make our page look good on screens of all sizes, you might think we have covered mobile devices as well. Nope.</p><p>Supporting mobiles is not<a id="id825" class="indexterm"/> just about screen sizes. You may have seen the add we talked about where a guy is reading the <span class="emphasis"><em>New York Times</em></span> on his iPhone, a full page spread. This is how mobile devices will render websites on high- resolution displays, unless you tell them not to. Before <a id="id826" class="indexterm"/>we continue this thread, I would like to stress that this discussion is about how to design<a id="id827" class="indexterm"/> <span class="strong"><strong>web applications</strong></span> that are interpreted by mobile browsers, not native iOS or Android apps.</p><div class="section" title="Why mobile first?"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl3sec67"/>Why mobile first?</h3></div></div></div><p>Let's reply with a question: why not? Or let's answer it: because mobile <span class="emphasis"><em>is</em></span> first. Mobile devices (smart-phones and tablets) have been shipping 4-5x more units than PCs or TVs for several years now. More<a id="id828" class="indexterm"/> users are visiting the Web using a mobile connection than with fixed Internet access. That is why it is important to think first what experience these mobile users will have when they visit our site and not create a fixed canvas version of a site first and then make changes to deal with mobile users. That would be another case of (not so) <span class="emphasis"><em>graceful degradation</em></span>.</p><p>You may not always have the choice if your marketing person shows up with yet another static design from the design firm. But marketing people like numbers, so tell them to check the numbers and you<a id="id829" class="indexterm"/> may have a soul mate soon.</p><div class="section" title="We have come a long way"><div class="titlepage"><div><div><h4 class="title"><a id="ch12lvl4sec32"/>We have come a long way</h4></div></div></div><p>In 2007, not all that long ago, I was developing a modest website with my photographs. A friend of mine was checking it out on his smartphone. After seeing this, I had to buy one myself, not because it was so great but because I needed one to test my website; at least, that was my justification. Even though I could not really afford it, I got the latest greatest Nokia, a brick compared to today's iPhone, that you could flip open to give you a bigger screen and a real keyboard. But the web access on it was terrible. It took what seemed like forever to get a browser started. The little keyboard was OK but the experience is quite different today when I use my iPhone or iPad with a sturdy Bluetooth keyboard. As a matter of fact, a lot of this book was written on an iPad while sitting on the train.</p><p>The year before I made<a id="id830" class="indexterm"/> several trips back to Belgium and, because my parents had no Internet at home, I went to a so-called Internet hotspot to check my e-mails. For 10 Euros an hour, you could buy a scratchcard that revealed an access code that you needed to use on the local carrier's website together with your cell phone number; then they sent you a password by SMS. This whole procedure would sometimes take 20 minutes and cost me international roaming charges because I had a U.S. phone number. Now I had 40 minutes worth of Wi-Fi left to myself. Mobile Internet was slow and expensive.</p><p>Now most of these barriers are gone, bandwidth is up, Wi-Fi is free in most places, or you can install a SIM card.</p><p>To take the term <span class="emphasis"><em>We have come a long way</em></span> one step further, allow me to share one little anecdote. I am a big fan of the Eastern Sierra and have taken many trips there, most of the time going through Yosemite National Park. I know a nice alternate road to take you to the West entrance of the Park that goes through the Gold Country town of Coulterville.</p><p>The local Jeffery Hotel has a saloon with two signs above the entrance door. One says: <span class="emphasis"><em>"Magnolia Saloon - est. 1851 - California's Oldest Operating Saloon"</em></span>. The one right above it says: <span class="emphasis"><em>Free WiFi</em></span>.</p></div><div class="section" title="Mobile devices have newer capabilities"><div class="titlepage"><div><div><h4 class="title"><a id="ch12lvl4sec33"/>Mobile devices have newer capabilities</h4></div></div></div><p>The situation described in the last few paragraphs—except for the saloon—has definitely turned around. Mobile devices<a id="id831" class="indexterm"/> perform well, Internet access is affordable, and the majority of the devices used can access the World Wide Web, so we better make sure people can access our site or applications with them.</p><p>I am not in the habit of using a lot of numbers, I have only used a few so far, but in a recent survey I learned that, of mobile phone users, 84% use them while at home, 63% while in the office, and 42% while on the move.</p><p>On mobile devices, there is no clicking with the mouse and no hovering on a phone or tablet, but there is <span class="strong"><strong>swiping</strong></span>. There are<a id="id832" class="indexterm"/> many new interfaces, often tied to hardware and iOS that you will not find on desktops. The interface to select a date on a phone is different than, for example, using the jQuery UI date picker.</p><p>If you read the specs<a id="id833" class="indexterm"/> of the latest greatest iPhone on the Apple website, I bet you they forgot to mention one important feature of the product, at least not in a very visible and obvious way: you can make phone calls with it. So if the contact information of your site contains phone numbers, let the user make a phone call by just clicking that number. It is as easy as putting an <code class="literal">&lt;a&gt;</code> tag around it:</p><div class="informalexample"><pre class="programlisting">&lt;a href="tel:6505555555"&gt;6505555555&lt;/a&gt;</pre></div><p>This may be a trivial example, but it illustrates mobile first thinking. And the phone will do the rest. So make sure that, when an application is used on a mobile with one of these new capabilities, it can be used.</p></div><div class="section" title="Mobile devices are not only used while on the road"><div class="titlepage"><div><div><h4 class="title"><a id="ch12lvl4sec34"/>Mobile devices are not only used while on the road</h4></div></div></div><p>Forget screen sizes, think <a id="id834" class="indexterm"/>content. It is not about small versus large, but about mobile versus local, about on-the-road versus at home. When someone is traveling and is looking for his hotel, he expects to quickly find contact info when he checks the hotel's website on his mobile, not photographs of the rooms and the indoor and outdoor pool. But he may have used that same mobile, while sitting in his couch at home to make the reservation, because the kids were using the computer or iPad. So on that day he was interested in those pictures.</p><p>So if he is looking for the hotel we could, if the phone supports it, show him a map on his smart phone, in a GPS-like fashion, showing his location as well as that of his hotel.</p><p>What we do not want to do is to make his cellular phone carrier wealthy by forcing a download of 900x600 JPG files in areas where bandwidth is poor yet expensive, because someone decided to have a photo banner on the home page at any given time.</p></div><div class="section" title="Content first, navigation next"><div class="titlepage"><div><div><h4 class="title"><a id="ch12lvl4sec35"/>Content first, navigation next</h4></div></div></div><p>The previous comments boil down to this. In our thinking, we should put the most important content within immediate reach. Having a horizontal menu with <span class="emphasis"><em>contact</em></span> all the way to the right or, worse, somewhere at the bottom of the page is not going to help our traveler.</p><p>In a recent project where I had to deal with a design firm's wireframe made for a desktop screen, containing a horizontal navigation, I looked at all the navigation items and rearranged them, contact first, replaced the photo banner with responsive images and replaced that menu with the word <code class="literal">menu</code> with three stripes underneath.</p><p>I placed most of <a id="id835" class="indexterm"/>my code inside my <code class="literal">max-width:480px</code> media query. A simple tab on <code class="literal">menu</code> would present the visitor with a menu on the small screen with all the relevant topics.</p><p>The way I did this, the menu will appear to be coming from the left of your phone somewhere, similar to what the Facebook app does. I used <a id="id836" class="indexterm"/>
<span class="strong"><strong>Foundation</strong></span> to achieve that. You will learn about Foundation in the next chapter.</p></div><div class="section" title="Small means big"><div class="titlepage"><div><div><h4 class="title"><a id="ch12lvl4sec36"/>Small means big</h4></div></div></div><p>You may have noticed on many sites, even really good ones, that you are being switched to a mobile version of the site, a different URL like <code class="literal">m.site.com</code>, while visiting them on your smart-phone. This is not what we recommend. Once you decide to go with two, what is to stop you from creating a third, and so on? Many web designers who stay with a single site react to smaller by shrinking everything down so things still fit on the screen.</p><p>In many cases, you may <a id="id837" class="indexterm"/>want to do the opposite because it is going to become hard to read. Retina screens and the like are so crisp these days that smaller typefaces on these screens are actually easy to read. You could do both by handling the Retina or not question in a media query.</p><p>On the other hand, this is an as-good-as-ever moment to point out that, of these millions of new people accessing the Web on mobiles, many are of an older generation who would appreciate a bigger font size because their eyes are not what they used to be.</p><p>The real issue is not the text but that you do not have the pixel-level accuracy of a mouse. When you want to click on something you will have to use your finger. If these areas are shrunk down as well, the risk of clicking on the wrong thing goes up dramatically.</p></div><div class="section" title="Mobile input"><div class="titlepage"><div><div><h4 class="title"><a id="ch12lvl4sec37"/>Mobile input</h4></div></div></div><p>We mentioned reading, we<a id="id838" class="indexterm"/> mentioned clicking, how about filling out a web form? A lot of old-school websites—for example, web shops containing registration forms—have many <code class="literal">&lt;input&gt;</code> fields and are designed to fit on a full screen with a single <span class="emphasis"><em>submit</em></span> button at the end. So, on a phone this is going to be hard; therefore you may want to consider splitting up these forms. If the input field is not big enough, tapping with a finger may take the user to the wrong spot. So you want to make these bigger than on a desktop. But there is one other thing about input that is often forgotten: the keyboard.</p><p>On a smart phone or tablet, there is no keyboard. When the web application/browser detects that input is needed, a soft keyboard shows up as part of your screen. On a smart phone in portrait mode, that makes it hard to type.</p><p>When there is a need to type in a number, you need to first switch that keyboard to a different mode, and yet another mode for some symbols. Not everybody is schlepping a Bluetooth keyboard with him everywhere he goes, like I do. For this part, you can use the new <code class="literal">&lt;input&gt;</code> types<a id="id839" class="indexterm"/> in HTML5. Most mobile browsers are HTML5-capable so when you use the following:</p><div class="informalexample"><pre class="programlisting">&lt;input type="email" name="email"&gt;&lt;/input&gt;</pre></div><p>Those browsers will present you with a keyboard layout that has at least the <code class="literal">@</code> sign in it, which on some keyboards is hard to find. I live in <span class="emphasis"><em>azerty</em></span> country again. I know.</p></div></div><div class="section" title="Mobile first recap"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl3sec68"/>Mobile first recap</h3></div></div></div><p>You probably get the<a id="id840" class="indexterm"/> picture. In this new world with millions of mobile devices, we need a new way of thinking about what information we provide on our site and how we do that. Use features of the phone, when you can; put content before navigation. Design your site as <span class="emphasis"><em>one site fits all</em></span>, not <span class="emphasis"><em>one size fits all</em></span>. This is not a technology, but a philosophy.</p><p>But we will need a technology to determine whether the browser/device combination supports certain features, such as <a id="id841" class="indexterm"/>
<span class="strong"><strong>geolocation</strong></span>, or even interprets JavaScript, and use it only when present. When we do that, we are practicing <span class="strong"><strong>progressive enhancement</strong></span>.</p></div></div></div></div>
<div class="section" title="Progressive enhancement"><div class="titlepage"><div><div><h1 class="title"><a id="ch12lvl1sec81"/>Progressive enhancement</h1></div></div></div><p>A few years ago, a<a id="id842" class="indexterm"/> colleague once told our project manager that 80% of the time he spent changing already finished code to make it work in old browsers. In those days, a lot of people spent a lot of time making <span class="emphasis"><em>round corners</em></span> work on Internet Explorer in a costly (in terms of development time and performance) attempt to make everything look exactly the same everywhere. A lot of folks decided to postpone adapting the new features in CSS3 and HTML5 because some browsers did not support them. This was just to support a single digit number of browsers and make sure the website was still functional when you switched off JavaScript (graceful degradation).</p><p>Today, there is bad news and there is good news. The bad news is that there are more browsers than you can imagine and a lot of browser/device pairs support APIs that others don't. The good news is that several technologies have emerged to tackle this problem in a more proactive or, shall I say, progressive way.</p><p>So how do we handle this and still come up with a single version of our site? First, we need another philosophical change: do not be afraid to use the features that are available, make your sites and applications more cool and exciting, and enhance them with those features. How will we handle browsers or devices that do not support those features?</p><p>We propose a two-stage process. First, we will determine what the minimal content of our site has to be if virtually no modern features (for example JavaScript, fancy CSS features, and media queries) are available and start by writing our page accordingly. This is our basic site. Next we will add things such as jQuery and JavaScript code, media queries, and newer CSS and HTML <a id="id843" class="indexterm"/>features, animation, and so on to make our site nicer, to enhance it. This is called progressive enhancement.</p><p>Once again, there is jQuery and another library, called <span class="strong"><strong>EnhanceJS</strong></span>, to help us do that. We will illustrate how. After that we show how to refine this technique: test for a particular feature, use it if available, and possibly use a replacement library or polyfill that adds the feature to non-capable browsers. We already used such a polyfill in a previous chapter—the history plugin for jQuery.</p><div class="section" title="EnhanceJS"><div class="titlepage"><div><div><h2 class="title"><a id="ch12lvl2sec131"/>EnhanceJS</h2></div></div></div><p>EnhanceJS will test the browser for a<a id="id844" class="indexterm"/> comprehensive set of features. If they all pass, we load the files that make up the enhanced version of our site, such as jQuery, a CSS file with media queries, and so on. If not, the site that we look at is our basic site.</p><p>Please note, if we <a id="id845" class="indexterm"/>want to use Ajax to dynamically inject HTML into parts of our page, we will not be able to do this in the basic version. Depending on how much content we decide we want on there, it may be "Back to the future" all over again, as we will have to provide links to static pages. That way, all our visitors using old equipment will see at least a functional site with reasonable content.</p><p>Look at this example:</p><div class="informalexample"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset=utf-8" /&gt;
&lt;title&gt;Progressive Hello World&lt;/title&gt;
&lt;link href="css/basic.css" type="text/css" rel="stylesheet" /&gt;
&lt;script type="text/javascript" src="js/enhance.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  // Run capabilities test
  enhance({
  loadScripts: [
    'js/jquery.min.js',
    'js/enhanced.js'
    ],
  loadStyles: ['css/enhanced.css']
    });
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="content"&gt;&lt;h1&gt;Hello, world&lt;/h1&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><div class="section" title="enhance.js"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl3sec69"/>enhance.js</h3></div></div></div><p>
<span class="strong"><strong>enhance.js</strong></span> is a JavaScript library that performs a comprehensive suite of tests to see whether the browser supports <a id="id846" class="indexterm"/>enough features to handle what you had in<a id="id847" class="indexterm"/> mind for your enhanced site. At the time of writing, one could find it at <a class="ulink" href="https://code.google.com/p/enhancejs">https://code.google.com/p/enhancejs</a>. You can also find documentation there and useful<a id="id848" class="indexterm"/> links.</p><p>If the test fails, nothing inside <code class="literal">enhance()</code> will happen and your basic site, in our example good ol' <span class="emphasis"><em>Hello World</em></span>, will be what the visitor sees. If the test succeeds, enhance.js will add the class <code class="literal">enhanced</code> to the <code class="literal">&lt;html&gt;</code> tag and attempt to perform the tasks you put inside it.</p></div><div class="section" title="loadStyles and loadScripts"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl3sec70"/>loadStyles and loadScripts</h3></div></div></div><p>
<span class="strong"><strong>loadStyles</strong></span> and <span class="strong"><strong>loadScripts</strong></span> are two arrays where you can specify which stylesheets and JavaScript files you <a id="id849" class="indexterm"/>want to load. You <a id="id850" class="indexterm"/>can also specify conditions such as media queries to conditionally load one file or another. Instead of placing simply the pathname of the<a id="id851" class="indexterm"/> files in your array, you could<a id="id852" class="indexterm"/> use a JavaScript object using attribute names as the keys. So in our first example, we could have written:</p><div class="informalexample"><pre class="programlisting">enhance({
  loadScripts: [
    { src: 'js/jquery.min.js'},
    { src: 'js/enhanced.js'  }
    ],
  loadStyles: [
    { href: 'css/enhanced.css' }
    ]
  });</pre></div><p>Here is a more elaborate example:</p><div class="informalexample"><pre class="programlisting">enhance({
   loadStyles: [
     {media: 'screen', href: 'js/mediumlarge.css',
     excludemedia: 'screen and (max-device-width: 480px)',},
     {media: 'screen and (max-device-width: 480px)', href: 'js/small.css'}
   ],
   loadScripts: [
     {media: 'screen', src: 'js/mediumlarge.js',
     excludemedia: 'screen and (max-device-width: 480px)'},
     {media: 'screen and (max-device-width: 480px)', src: 'js/small.js'}
   ]
});</pre></div></div><div class="section" title="enhanced and FOUC"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl3sec71"/>enhanced and FOUC</h3></div></div></div><p>There is a common<a id="id853" class="indexterm"/> problem known as <span class="strong"><strong>Flash of unstyled </strong></span><a id="id854" class="indexterm"/>
<span class="strong"><strong>content</strong></span> (<span class="strong"><strong>FOUC</strong></span>)—be careful how you spell the acronym. This is the phenomenon where your see some flickering on your screen caused by temporarily displaying your HTML that is not yet processed by your JavaScript code during page load. There is an opportunity here to tackle this problem based on the knowledge that, if the enhance.js test is successful, it will add the class <code class="literal">enhanced</code> to the <code class="literal">&lt;html&gt;</code> tag.</p><p>In our <a id="id855" class="indexterm"/>example, you could add the following to your <a id="id856" class="indexterm"/>
<span class="strong"><strong>enhanced.css</strong></span> and<a id="id857" class="indexterm"/> <span class="strong"><strong>enhanced.js</strong></span><a id="id858" class="indexterm"/> respectively:</p><div class="informalexample"><pre class="programlisting">#content {
html.enhanced display:none;
}

$('#content').show(); // this of course at the end of the processing</pre></div><p>The above statement almost implies that, in the enhanced version of the site, we have code in our enhanced.js that will result in HTML being injected inside the <code class="literal">#content</code> div. Another approach would be to have <code class="literal">#basiccontent</code> div and <code class="literal">#enhancedcontent</code> div and make only the one that is appropriate visible.</p><p>Enhance.js, as described here, gives us an all-or-nothing approach. It runs a comprehensive set of tests to determine whether the visitor should see the basic version or the enhanced version. They are described in the documentation and of course in the code of enhance.js itself. At the time of writing, enhance.js had not been updated since 2010. There is nothing wrong with that: it does a job that has not changed and it does it well.</p><p>None of these tests check support for some of the newer HTML5 and CSS3 features such as <span class="strong"><strong>Canvas</strong></span>. Enhance.js has<a id="id859" class="indexterm"/> more configurable options that allow you to add your own tests and, if you like, run <code class="literal">enhance()</code> more than once to test different conditions. So you could do it that way.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>There really is no need to because, as is often the case in the world of web development, an entire team has done this for us already.</p></div></div></div></div><div class="section" title="Modernizr"><div class="titlepage"><div><div><h2 class="title"><a id="ch12lvl2sec132"/>Modernizr</h2></div></div></div><p>
<span class="strong"><strong>Modernizr.js</strong></span> is similar to<a id="id860" class="indexterm"/> Enhance.js, it is a JavaScript library that tests browsers for features. But it has a lot more tests, can be customized, and can be used at a more granular level than Enhance.js. Modernizr tests for<a id="id861" class="indexterm"/> individual features. Depending on whether the test succeeds (<span class="emphasis"><em>Yep</em></span>) or not (<span class="emphasis"><em>Nope</em></span>), we can load different stylesheets and <code class="literal">.js</code> scripts.</p><p>You can even use the<a id="id862" class="indexterm"/> two together. Start by using enhance.js to determine whether the browser supports JavaScript. If it does, load modernizr.js together with jQuery and refine what you want to do, in your own JavaScript code. Your basic page could look like this:</p><div class="informalexample"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html class="no-js"&gt;
&lt;head&gt;
&lt;meta charset=utf-8" /&gt;
&lt;title&gt;My first progressive enhancement site&lt;/title&gt;
&lt;link href="css/basic.css" type="text/css" rel="stylesheet" /&gt;
&lt;script type="text/javascript" src="js/enhance.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  enhance({
  loadScripts: [
    'js/jquery.js',
    'js/modernizr.js',
    'js/enhanced.js'
    ],
  loadStyles: ['css/enhanced.css']
    });
 &lt;/script&gt;
 &lt;/head&gt;
 &lt;body&gt;
 &lt;div id="basiccontent"&gt;&lt;h1&gt;Welcome to Polbol Productions&lt;/h1&gt;&lt;p&gt;
Thank you for visiting us. Apparently you cannot use your browser to access all the
cool goodies on our site. Click &lt;a href="basic.html"&gt;here&lt;/a&gt; for more information on our
company.&lt;br/&gt; The Polbol Productions Team&lt;/p&gt;&lt;/div&gt;
&lt;div id="enhancedcontent"&gt; &lt;!-- Your real home page here --&gt; &lt;/div&gt;
 &lt;/body&gt;
 &lt;/html&gt;</pre></div><p>So, we have changed it a<a id="id863" class="indexterm"/> little bit from the previous section. We of course added the <code class="literal">modernizr.js</code> library to be part of our JavaScript line-up, but one remarkable tiny change is the <code class="literal">class="no-js"</code> attribute for the <code class="literal">&lt;html&gt;</code> tag. Whereas enhance.js adds the class <code class="literal">enhanced</code> to this tag, Modernizr will replace this class with <code class="literal">js</code> when it runs. So if it does not, because there is no JavaScript, you can account for it in your stylesheets with the <code class="literal">.no-js</code> class.</p><p>Modernizr will add a lot more classes to the <code class="literal">&lt;html&gt;</code> tag, almost one for every test passed. So once again you could accommodate them in your stylesheet. Using this example on my MacBook Pro with Firefox as the browser, I checked with Firebug and noticed that modernizr.js had replaced <code class="literal">no-js</code> with <code class="literal">js</code> and added the following classes to the <code class="literal">&lt;html&gt;</code> tag:</p><div class="informalexample"><pre class="programlisting">js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage no-websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients no-cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths</pre></div><div class="section" title="The Modernizr object"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl3sec72"/>The Modernizr object</h3></div></div></div><p>Once you have loaded <a id="id864" class="indexterm"/>modernizr.js and all the tests have been performed, you have access to the <code class="literal">Modernizr</code> object and can check in your JavaScript code whether or not a test has passed:</p><div class="informalexample"><pre class="programlisting">if (Modernizr.history) {
// code to use the HTML5 history API
}
else {
// code to use the API of your history plugin  or <span class="strong"><strong>polyfill</strong></span>
}</pre></div></div><div class="section" title="Polyfills and Modernizr"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl3sec73"/>Polyfills and Modernizr</h3></div></div></div><p>
<span class="strong"><strong>Polyfills</strong></span> are scripts that take care of functionality a<a id="id865" class="indexterm"/> browser lacks when you need it. The <code class="literal">history.js</code> library that we discussed at length in <a class="link" href="ch09.html" title="Chapter 9. The History API – Not Forgetting Where We Are">Chapter 9</a>, <span class="emphasis"><em>The History API— Not Forgetting Where We Are</em></span>, could be a polyfill for the HTML 5 History API. I said, could, because in our example in that chapter we used history.js regardless. True polyfills are used only when the feature is lacking. So the code above could use a different <a id="id866" class="indexterm"/>API if HTML5 support is there compared to the API available through the polyfill.</p><p>This could explain why the name Modernizr is chosen. Whereas enhance.js allows you to take care of people using the old stuff and give them an interface using the current stuff, Modernizr allows you to write today the code that your visitor will use tomorrow or next week, when they<a id="id867" class="indexterm"/> update their computer or buy a new phone or tablet. You are now ahead of the game.</p><p>Your site or application already uses all the cool stuff HTML5 and CSS3 offers and has fallback code in case older technology is involved. You can motivate your customer or visitor to update sooner rather than later, but your site or application already supports what to them lies in the future. Is this cool, or what?</p></div><div class="section" title="yepnope.js or Modernizr.load"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl3sec74"/>yepnope.js or Modernizr.load</h3></div></div></div><p>Just like you saw in the <span class="emphasis"><em>Enhance.js</em></span> section, you conditionally load files based on passing or failing a test. The coolest conditional loader<a id="id868" class="indexterm"/> is <span class="strong"><strong>yepnope.js</strong></span>. At the time of <a id="id869" class="indexterm"/>writing, it was going to be deprecated, so its<a id="id870" class="indexterm"/> inclusion inside Modernizr might disappear. For sure, something newer will show up. So, for now, we include a short example of how you can do conditional loading of static assets with Modernizr:</p><div class="informalexample"><pre class="programlisting">Modernizr.load({
 test: Modernizr.geolocation,
  yep : 'geo.js',
  nope: 'geo-polyfill.js'
});</pre></div></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch12lvl1sec82"/>Summary</h1></div></div></div><p>This chapter has the longest title in the book, fitting for the most important one. In it, we explained the difference between web development yesterday and web development tomorrow. We explained that you need to think mobile first, that your design has to be responsive, and that you should reward customers who have the latest, greatest stuff by using the cool new features through progressive enhancement.</p><p>In the next chapters, we will guide you through how to apply all that came before using a cool CSS/JavaScript framework, Foundation, so you can use what someone already did for you. We will also show you a way to take full control of how you want things to be handled on the server side, using node.js.</p><p>If you stop right here, you have learned the basics of modern web development and I congratulate you for doing that. If you go on, you will learn to use a framework that will save you a lot of time and work in the long run as well as what looks like a totally different way of doing things. As we go on explaining it, you will realize that it is not all that different in the first place.</p></div></body></html>
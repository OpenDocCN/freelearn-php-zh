<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Setting Up Our First Project"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Setting Up Our First Project</h1></div></div></div><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"Chi ben comincia è a metà dell'opera."</em></span></p><p><span class="emphasis"><em>(Italian for "Well begun is half done.")</em></span>
</p></blockquote></div><p>Every journey has a beginning, and only a hero with the right equipment can attain a victory. Of course, there are no exceptions for the 21st century hero: the developer!</p><p>In order to avoid problems and fight the bad (and malfunctioning) code monster, the good code artisan will prepare everything necessary before the start.</p><p>A developer has to be comfortable with the tools they are going to use, and a good development environment can awesomely improve the process. So, before getting our hands dirty, in this chapter, we will discover how to deal with Composer and Homestead.</p><p>Composer is an awesome dependency management tool, which is used by many PHP projects around the world. Homestead is the official Laravel Vagrant box that lets you create a fully functional development environment on a dedicated virtual machine in a matter of minutes. Finally, we will cover the installation process of our very first Laravel project.</p><p>I know what you are thinking: you just want to write code, code, and more code.</p><p>Be patient for a little while: if you know the tools we are going to analyze, at the end of this chapter, you will feel an enormous difference.</p><p>Trust me.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Your Swiss Army Knife: Composer</li><li class="listitem" style="list-style-type: disc">Your safe place: Homestead</li><li class="listitem" style="list-style-type: disc">The new hideout: Homestead improved</li><li class="listitem" style="list-style-type: disc">A bonus tool: Adminer</li><li class="listitem" style="list-style-type: disc">Your best friend: Laravel</li><li class="listitem" style="list-style-type: disc">Your first project: EloquentJourney</li><li class="listitem" style="list-style-type: disc">Summary</li></ul></div><div class="section" title="Your Swiss Army Knife – Composer"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Your Swiss Army Knife – Composer</h1></div></div></div><p>The very first thing you will need to work with Laravel (and then Eloquent) is <a id="id0" class="indexterm"/>Composer. Composer is a dependency management tool for PHP. With this tool, you can easily include every dependency that is needed in your project. This is done in seconds, using a JSON configuration file named <code class="literal">composer.json</code>.</p><p>Usually, dependencies in a PHP project were managed with PEAR or other methods. Composer has a different policy: everything works on a per-project basis. This means that you can have two projects on the same server with different versions of the same dependency package.</p><div class="section" title="Installing Composer"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec06"/>Installing Composer</h2></div></div></div><p>The installation <a id="id1" class="indexterm"/>procedure is ridiculously easy. All you have to do, is to go on the <span class="strong"><strong>Download</strong></span> page of the Composer website and find the right method for your operating system.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If you have Linux or Mac, just use this:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>curl -sS https://getcomposer.org/installer | php</strong></span>
</pre></div><p>Or, if you don't have cURL, then use this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>php -r "readfile('https://getcomposer.org/installer');" | php</strong></span>
</pre></div><p>Also, the <code class="literal">composer.phar</code> file will be downloaded in your current directory.</p></li><li class="listitem" style="list-style-type: disc">On Windows, you can simply download the dedicated installer.</li></ul></div><p>Once Composer is installed, I suggest putting its path in the <code class="literal">PATH</code> variable of your system, in order to use it wherever you want. There are many ways to do it, which depend on your operating system. Let's look at each.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">On Linux, you can move Composer to the right directory simply with the following command:<div class="informalexample"><pre class="programlisting">mv composer.phar /usr/local/bin/composer</pre></div></li><li class="listitem" style="list-style-type: disc">The same goes for OS X, but sometimes, the <code class="literal">usr</code> directory doesn't exist. You must create <code class="literal">usr/local/bin</code> manually.</li><li class="listitem" style="list-style-type: disc">Finally, on Windows, you must open the control panel and type <code class="literal">environment variable</code> or something similar. The search utility will do the rest for you. Once in the right window, you will get a list of all environment variables. Find <code class="literal">PATH</code> and add the composer installation path to it.</li></ul></div></div><div class="section" title="The composer.json and autoload files"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec07"/>The composer.json and autoload files</h2></div></div></div><p>Before we go deep into our project, let's take a look at how Composer works.</p><p>In the <a id="id2" class="indexterm"/>
<code class="literal">composer.json</code> file, the developer specifies every single dependency for its project. You can also create your packages, but we are not going to look at how to create them in this book.</p><p>So, let's say that you want to create a project that uses Monolog for logging purposes.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a folder for the project, then create an empty text file, and name it <code class="literal">composer.json</code>.</li><li class="listitem">Open it and all you will have to do is to include your dependency as shown:<div class="informalexample"><pre class="programlisting">  {
      "require": {
          "monolog/monolog": "1.12.0"
      }
  }</pre></div></li><li class="listitem">After that, save the file and type the following in your project directory:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer update</strong></span>
</pre></div></li></ol></div><p>Wait a minute to download everything, and then you are done!</p><p>What? OK, here<a id="id3" class="indexterm"/> is how it works: Composer downloads every package you may need and automatically creates a loader for all your packages. So, to use your dependencies in your project, you will just need to include <code class="literal">vendor/autoload.php</code>, and you are good to go.</p><p>Let's say that you have an <code class="literal">index.php</code> file as a start file for your application. You will have to perform something like the following:</p><div class="informalexample"><pre class="programlisting">  &lt;?php // index.php file

    require('vendor/autoload.php');

    // your code here...</pre></div><p>Nothing more!</p><p>Why am I showing this to you? Well, Laravel and Eloquent are Composer packages. So, in order to use it and create a Laravel application, you have to know how the mechanism works!</p></div><div class="section" title="The most used commands"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>The most used commands</h2></div></div></div><p>Composer is a command-line tool. Every<a id="id4" class="indexterm"/> good CLI tool has some important commands, and in this little section, I will show you what we are going to use the most.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">First of all, we have the following:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer create-project</strong></span>
</pre></div><p>With this command, you can create a new project using a specific package as a base. You will use this command to create a new Laravel project using the following syntax:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer create-project laravel/laravel my_project_folder</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">Then, you can find:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer install</strong></span>
<span class="strong"><strong>composer update</strong></span>
</pre></div><p>These are two similar commands; they are similar, but not the same. When you specify your dependencies in the <code class="literal">composer.json</code> file, you can use <code class="literal">install</code> to install them. If you already installed them but you want to update your dependencies to a newer version, use <code class="literal">update</code>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p>In order to know what must and must not be updated, Composer uses the <code class="literal">composer.lock</code> file, which you can see in the root of your project. Actually, you will never have to work with it, but it's important to know that Composer uses it as a <span class="emphasis"><em>log</em></span> of what it does.</p></div></div></li><li class="listitem" style="list-style-type: disc">Sometimes, you will also see this:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer require</strong></span>
</pre></div><p>You can use <code class="literal">require</code> to include dependencies in your project on the fly. Here's an example of Monolog inclusion using <code class="literal">require</code>:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer.phar require monolog/monolog:1.12.0</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">Another often used command is:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer dump-autoload</strong></span>
</pre></div><p>This command regenerates the <code class="literal">autoload.php</code> file. It can be useful if you add some classes into your projects without using namespaces or PSR conventions and rules.</p></li><li class="listitem" style="list-style-type: disc">Sometimes, you will have to use (after a warning):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer self-update</strong></span>
</pre></div><p>This command updates Composer itself. Just a few seconds, and you are up and running again!</p></li><li class="listitem" style="list-style-type: disc">Finally, you can use the following special command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer global COMMAND_HERE</strong></span>
</pre></div><p>Use it to execute a specific command in the Composer home directory. As I mentioned before, Composer works on a per-project basis, but sometimes you will need to install some tools globally. With the global command, you can do it easily.</p></li></ul></div><p>That's all <a id="id5" class="indexterm"/>you need to know about Composer right now, and yes, there are many other commands, but we don't need them now.</p><p>Let's take a step forward: it's time to learn about Homestead!</p></div></div></div>
<div class="section" title="Your safe place &#x2013; Homestead"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Your safe place – Homestead</h1></div></div></div><p>When <a id="id6" class="indexterm"/>we start a new project, we might also stumble upon many compatibility and environment issues. The first one to think about is the PHP version. Maybe you are using XAMPP or some preconfigured stack on your local machine. For your new project, you want to use PHP 5.6, but the installed version is 5.3 (as you used it for some older projects). Fine, no problem; you can just install 5.6, and you are good to go.</p><p>Yes, but after two days, the phone rings. It's your <span class="emphasis"><em>old</em></span> customer; finally, it's time to make some improvements and add new features! So, you start your stack services, browse your old project index, and BOOM! Compatibility issues, compatibility issues everywhere! Not exactly the best way to start your day.</p><p>This is not a code problem, but an environment problem.</p><p>Actually, the best solution is to start using Vagrant. Vagrant is a fantastic tool that lets you create a virtual machine with a headless operating system in order to configure the virtual machine on a per-project basis. Also, you can share some folders from your local machine with that machine, so you can work on an isolated environment while working with your favorite IDE and operating system.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>Note that the per-project basis is the most important part of the entire thing. If you configure a separate machine for a single project, you can tweak everything you want to reach the perfect environment. Also, with Vagrant, you will be able to set your local environment in the same way your production machine is configured. So, no more <span class="emphasis"><em>local to production</em></span> bugs and issues!</p></div></div><p>Last but not<a id="id7" class="indexterm"/> least, the fun (and useful) thing about Vagrant is that you can put a specific box under version control. So, for every new team member, all you have to do is to clone the repository and start the machine.</p><p>This looks complicated, but it is not. With Vagrant you can easily download a box (a ready-to-use virtual machine with all the tools and applications you need) and start it with a simple command from the shell as shown:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ vagrant up</strong></span>
</pre></div><p>The Laravel community knows a couple of things about Vagrant and makes up a Vagrant Box to help you in your job.</p><div class="mediaobject"><img src="graphics/3634_01_01.jpg" alt="Your safe place – Homestead"/></div><p>Homestead is the official Vagrant Box for Laravel and already has everything you need to get started. You will find it (already installed and working), by default:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Ubuntu 14.04</p>
</th><th style="text-align: left" valign="bottom">
<p>Node (with Bower, Grunt, and Gulp)</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>PHP 5.6</p>
</td><td style="text-align: left" valign="top">
<p>Redis</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>HHVM</p>
</td><td style="text-align: left" valign="top">
<p>Memcached</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>nginx</p>
</td><td style="text-align: left" valign="top">
<p>Beanstalkd</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>MySQL</p>
</td><td style="text-align: left" valign="top">
<p>Laravel Envoy</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>PostgreSQL</p>
</td><td style="text-align: left" valign="top">
<p>Fabric + Hipchat Extension</p>
</td></tr></tbody></table></div><p>Not too bad for a tool <a id="id8" class="indexterm"/>box that you can prepare in a matter of minutes!</p><p>Now let's stop discussing and install Homestead.</p><div class="section" title="Installing Homestead"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Installing Homestead</h2></div></div></div><p>First<a id="id9" class="indexterm"/> of all, ensure<a id="id10" class="indexterm"/> that you have <a id="id11" class="indexterm"/>already installed VirtualBox (<a class="ulink" href="https://www.virtualbox.org/">https://www.virtualbox.org/</a>) and <a id="id12" class="indexterm"/>Vagrant (<a class="ulink" href="https://www.vagrantup.com/">https://www.vagrantup.com/</a>). You can install them on every operating system, so feel free to use whichever you want.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>If you want to work with a good shell on Windows, I suggest you use <a id="id13" class="indexterm"/>Cmder (<a class="ulink" href="http://bliker.github.io/cmder/">http://bliker.github.io/cmder/</a>). While writing this book, I referred to the same link.</p></div></div><p>Next, we can add Homestead to our local boxes. This means that Vagrant will download the Homestead box in order to be used locally.</p><p>You can do it with a simple command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>vagrant box add laravel/homestead</strong></span>
</pre></div><p>You will have to wait a couple of minutes to download the box. So, if you want to have a coffee, this is the perfect moment.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>Here, you don't have to worry about where Vagrant is placing the box, as it is going to save it locally in the Vagrant folder. In the future, every time you will need a specific box, Vagrant will clone and use it.</p></div></div><p>Alright, your box is now on your local machine and ready to be started. However, accordingly to your local machine settings, you can install Homestead in two different ways. They are both present in the official Laravel documentation, so they are both <span class="emphasis"><em>official</em></span>.</p><div class="section" title="The Composer and PHP tool way"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec01"/>The Composer and PHP tool way</h3></div></div></div><p>Let's <a id="id14" class="indexterm"/>start with the first one: it is a perfect choice if you already have Composer and PHP on your local machine. Note that you are only going to do these steps the first time.</p><p>Use this command to install the Homestead CLI tool.</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer global require "laravel/homestead=~2.0"</strong></span>
</pre></div><p>Then, be sure to put the <code class="literal">~/.composer/vendor/bin</code> directory in the <code class="literal">PATH</code> environment variable, in order to use the tool wherever you want.</p><p>After that, you can initialize your machine. Use the <code class="literal">init</code> command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>homestead init</strong></span>
</pre></div><p>This will create a <code class="literal">~/.homestead</code> folder with a <code class="literal">Homestead.yaml</code> inside of it. This file will be used by Vagrant at the virtual machine start.</p><div class="mediaobject"><img src="graphics/3634_01_02.jpg" alt="The Composer and PHP tool way"/></div></div><div class="section" title="The Git way"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec02"/>The Git way</h3></div></div></div><p>If you don't <a id="id15" class="indexterm"/>have PHP and Composer installed on your local machine (or maybe you just don't want to use them), no problem. You can simply use Git.</p><p>Choose a folder where you want to save your virtual machine. Then, clone the repository with:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>git clone https://github.com/laravel/homestead.git HomesteadFolder</strong></span>
</pre></div><p>Here, <code class="literal">HomesteadFolder</code> is the place you chose for your VM files. After the clone process, use <code class="literal">cd</code> to get into the folder and start the <code class="literal">init</code> script using the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>bash init.sh</strong></span>
</pre></div><p>This script will create a <code class="literal">Homestead.yaml</code> file in a <code class="literal">~/.homestead</code> directory, and that's it!</p><p>The following steps for installation are the same for both the methods you just saw.</p></div></div><div class="section" title="Configuring Homestead"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Configuring Homestead</h2></div></div></div><p>Before we go <a id="id16" class="indexterm"/>forward, let's take a look at the default <code class="literal">Homestead.yaml</code> file.</p><div class="informalexample"><pre class="programlisting">  ---
  ip: "192.168.10.10"
  memory: 2048
  cpus: 1

  authorize: ~/.ssh/id_rsa.pub

  keys:
      - ~/.ssh/id_rsa

  folders:
      - map: ~/Code
        to: /home/vagrant/Code

  sites:
      - map: homestead.app
        to: /home/vagrant/Code/Laravel/public

  databases:
      - homestead

  variables:
      - key: APP_ENV
        value: local</pre></div><p>If you are unfamiliar with this syntax, no problem; it's a simple YAML (YAML <span class="emphasis"><em>ain't</em></span> a markup language) markup file. It is a very readable way to specify settings, and Homestead uses it. Here, you can choose the IP address for your virtual machine and other settings. Tweak the configuration file accordingly to your needs.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Do you see the <code class="literal">authorize</code> property in the <code class="literal">Homestead.yaml</code> file? Well, we are going to set up our SSH key and put its path there. If it scares you, don't worry; it is just a command.<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ssh-keygen -t rsa -C "you@homestead"</strong></span>
</pre></div><p>If you are using Windows, the Laravel documentation recommends Git Bash. Personally, as I mentioned before, I prefer to use Cmder. However, you can also use PuTTY or whatever you want. Use <code class="literal">ssh-keygen –t rsa –C "you@homestead"</code> to generate your ssh key. This is shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/3634_01_03.jpg" alt="Configuring Homestead"/></div></li><li class="listitem">Put the <a id="id17" class="indexterm"/>generated SSH key path in the <code class="literal">authorize</code> property of <code class="literal">Homestead.yaml</code>, as shown in the following:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>authorize: ~/.ssh/id_rsa.pub</strong></span>
</pre></div><p>Done? Good. Now, you can see a <code class="literal">folders</code> property as well.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note05"/>Note</h3><p>As I mentioned before, Vagrant lets the developer share some folders between the local and virtual machines.</p><p>What is the point of that? Well, it is really important because with this system we can work on our project on a separate machine, while being able to use whatever IDE or tool we want from our local machine. For example, even if the VM has Ubuntu, I can easily use Windows 8.1 and PHPStorm. The best of both worlds!</p></div></div></li><li class="listitem">By default, Homestead suggests this structure:<div class="informalexample"><pre class="programlisting">folders:
      - map: ~/Code
        to: /home/vagrant/Code</pre></div><p>Also, this means that you will have to create a <code class="literal">Code</code> folder in your user folder. This local folder will be mapped to a <code class="literal">/home/vagrant/Code</code> folder on the VM; every change that you make there will be reflected on the virtual machine and vice versa.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note06"/>Note</h3><p>You can customize this mapping to your needs.</p></div></div></li><li class="listitem">Next, let's take a look at the <code class="literal">sites</code> property. Here's what you can see in a default setup:<div class="informalexample"><pre class="programlisting">  sites:
      - map: homestead.app
        to: /home/vagrant/Code/Laravel/public</pre></div><p>You can define a custom domain for every project, which is a really comfortable way to work with your projects, as you will no longer need to test your project with an IP (like 192.168.10.10), only a simple local domain, such as <code class="literal">myproject.dev</code>.</p></li><li class="listitem">This <a id="id18" class="indexterm"/>is a good point to define a separate site for our project. So, feel free to add these lines to your file:<div class="informalexample"><pre class="programlisting">  - map: eloquent.dev
      to: /home/vagrant/Code/EloquentJourney/public</pre></div></li><li class="listitem">Next, go to your host's file (on the host machine) and add this record:<div class="informalexample"><pre class="programlisting">  192.168.10.10 eloquent.dev</pre></div><p>You can see how you need to add it in the following screenshot:</p><div class="mediaobject"><img src="graphics/3634_01_04.jpg" alt="Configuring Homestead"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note07"/>Note</h3><p>Of course, you have to insert the same IP you specified in the <code class="literal">Homestead.yaml</code> file.</p></div></div></li><li class="listitem">The last thing we are going to see here is the <code class="literal">database</code> property. For every name you add here, Homestead will automatically create a database to work with. So, edit the property to something like this:<div class="informalexample"><pre class="programlisting">  databases:
      - homestead
      - eloquent_journey</pre></div></li></ol></div><p>This is because we are going<a id="id19" class="indexterm"/> to use a separate <code class="literal">eloquent_journey</code> MySQL database for our test application.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note08"/>Note</h3><p>The default username for the MySQL server is <code class="literal">homestead</code>, and the default password is <code class="literal">secret</code>.</p></div></div><p>We have nothing more to do here; our setup is complete, and now we are ready to boot up our virtual machine and use it.</p></div></div>
<div class="section" title="The new hideout: Homestead improved"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>The new hideout: Homestead improved</h1></div></div></div><p>Even if Homestead <a id="id20" class="indexterm"/>is a fantastic box, many people complain about some of its structural <span class="emphasis"><em>choices</em></span>. As I mentioned previously, Vagrant is used to create virtual machines on a per-project basis. This means that, in an ideal situation, every project must have its own VM. Now, with Homestead, you can create a single VM and manage all your projects on it. Some people like this idea, and it is more familiar to the classical XAMPP approach. Quite familiar!</p><p>However, other people like a more <span class="emphasis"><em>pure</em></span> approach to Vagrant. While doing some researches on this concept, I stumbled upon <span class="emphasis"><em>Homestead Improved</em></span> (<a class="ulink" href="https://github.com/Swader/homestead_improved">https://github.com/Swader/homestead_improved</a>) by <span class="emphasis"><em>Swader</em></span>, on GitHub.</p><p>It is an improved version of Homestead that you can install and run without saving files all around your user folder. A really good approach! Also, you won't have to configure any SSH keys or execute <code class="literal">apt-get update</code> and <code class="literal">composer auto-update</code>. Everything will be done automatically.</p><p>If you want to use Homestead Improved, just open your terminal and type the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>git clone https://github.com/Swader/homestead_improved.git MyHomesteadImprovedVM</strong></span>
</pre></div><p>Here, <code class="literal">MyHomesteadImprovedVM</code> will be the containing folder of all the VM's files.</p><p>After the clone procedure, just type the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>vagrant up</strong></span>
</pre></div><p>So, you're done! Easier than before, isn't it?</p></div>
<div class="section" title="A bonus tool &#x2013; Adminer"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>A bonus tool – Adminer</h1></div></div></div><p>Before <a id="id21" class="indexterm"/>going deeper along our journey, there is another really useful tool that I want to show you. I am talking about Adminer, a Database Management tool entirely contained in a single <code class="literal">.php</code> file. You can<a id="id22" class="indexterm"/> download it at <a class="ulink" href="http://www.adminer.org/">http://www.adminer.org/</a>.</p><p>Maybe you will find the Adminer interface very similar to the phpMyAdmin interface. It's true, but Adminer has more features. Just to make a simple example, phpMyAdmin only supports MySQL. Instead, Adminer supports MySQL, PostgreSQL, SQLite, Oracle, and MS SQL.</p><div class="mediaobject"><img src="graphics/3634_01_05.jpg" alt="A bonus tool – Adminer"/></div><p>Obviously, you can use whatever you want to deal with your database. However, I wanted to show you Adminer because it is what I am going to use to show, from time to time, some query results or various examples. So, it would be good if you get more familiar with this tool.</p></div>
<div class="section" title="Your best friend: Laravel"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Your best friend: Laravel</h1></div></div></div><p>We are <a id="id23" class="indexterm"/>close to the end. You have a weapon (Composer) and a safe place to do everything you want without worrying about issues (Homestead). What about an ally? Laravel could be a good one, don't you think? Also, Laravel is the Eloquent container: we are going to create a new project with it to fully embrace its power.</p><div class="section" title="Installing Laravel"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Installing Laravel</h2></div></div></div><p>Before <a id="id24" class="indexterm"/>going <a id="id25" class="indexterm"/>further, remember that Laravel has some prerequisites. You will need the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">PHP 5.4 (or more recent versions)</li><li class="listitem" style="list-style-type: disc">The PHP Mcrypt extension</li><li class="listitem" style="list-style-type: disc">The PHP OpenSSL extension</li><li class="listitem" style="list-style-type: disc">The PHP Mbstring extension</li></ul></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note09"/>Note</h3><p>If you are using PHP 5.5, you may need to install the JSON PHP extension. If this is the case, just type this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>apt-get install php5-json</strong></span>
</pre></div><p>So, you are good to go.</p></div></div><p>Obviously, if you have installed Homestead, everything is already in its right place.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">All you have to do is to boot up the VM with the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>homestead up</strong></span>
</pre></div></li><li class="listitem">And when the bootstrap procedure is done, use the following command to get in the machine via SSH:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>homestead ssh</strong></span>
</pre></div></li></ol></div><p>Having said that, as you may have experienced from Homestead, Laravel also gives you two different ways to install it and create a new project.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The first one is done using a specific tool, the Laravel installer tool. It's a CLI tool that you can install as a global Composer package.</li><li class="listitem" style="list-style-type: disc">The second one is a simple <code class="literal">composer create-project</code> command. Of course, we will now see both ways.</li></ul></div><div class="section" title="Using the Laravel installer tool"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec03"/>Using the Laravel installer tool</h3></div></div></div><p>The Laravel installer tool is a nice utility that lets you create a new <a id="id26" class="indexterm"/>Laravel project with a very simple syntax. Imagine that you want to create a new project in a folder called <code class="literal">my_project</code>. All you have to do, if you have the tool installed, is to type this and nothing more:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>laravel new my_project</strong></span>
</pre></div><p>Installing the tool is easy. Just open the terminal and type the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer global require "laravel/installer=~1.1"</strong></span>
</pre></div><p>As you saw before, we are executing the <code class="literal">require</code> command with the <code class="literal">global</code> keyword. This means that the installer tool package will be saved in the Composer's <code class="literal">global</code> folder and the tool will be available everywhere.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note11"/>Note</h3><p>If you have any problems running the tool, just be sure to put <code class="literal">~/.composer/vendor/bin</code> in the <code class="literal">PATH</code> environment variable. Otherwise, it won't work!</p></div></div></div><div class="section" title="Using the Composer create-project command"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec04"/>Using the Composer create-project command</h3></div></div></div><p>If you don't <a id="id27" class="indexterm"/>want to install the Laravel installer tool, you can simply use the <code class="literal">create-project</code> command of Composer.</p><p>All you have to do, in this case, is use this command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer create-project laravel/laravel ProjectName</strong></span>
</pre></div><p>Here, <code class="literal">ProjectName</code> stands for the folder name that you want to use as the root of your new Laravel project.</p><p>Nothing more to do here! Your Laravel project is now fully installed in your specified folder.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note12"/>Note</h3><p>Be sure to configure the right permissions on your folders and ensure you take a good look at the URL rewriting rules. If you take a look at the <a id="id28" class="indexterm"/>Laravel-dedicated documentation page (<a class="ulink" href="http://laravel.com/docs/5.0/installation#pretty-urls">http://laravel.com/docs/5.0/installation#pretty-urls</a>), you can learn how to do it on Apache or nginx.</p></div></div></div></div></div>
<div class="section" title="The first project &#x2013; EloquentJourney"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>The first project – EloquentJourney</h1></div></div></div><p>A new project will<a id="id29" class="indexterm"/> be the perfect metaphor for our new, fantastic journey! While studying Eloquent, we will build a simple project. More specifically, we will analyze a hypothetical library management system's data-related part and its components.</p><p>What are you <a id="id30" class="indexterm"/>waiting for? Let's start! First of all, create a new project (using your favorite method). We will call our new project <code class="literal">EloquentJourney</code>. Type the following in your server folder:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>laravel new EloquentJourney</strong></span>
</pre></div><p>Otherwise, type the following if you prefer:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>composer create-project laravel/laravel EloquentJourney</strong></span>
</pre></div><p>Wait a few seconds to build the project, and after the installation procedure, you are done! You can use <code class="literal">cd</code> to get into your new folder and see what's there.</p><p>Cool! All right, but what are we going to do now? There are thousands of files here and in other subfolders! Don't worry. Take a breath and follow me. First of all, we need to do some practice with the Laravel configuration system in order to set up an appropriate database connection.</p><p>Without it, we could not use Eloquent!</p><div class="section" title="The configuration system"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>The configuration system</h2></div></div></div><p>Everything you <a id="id31" class="indexterm"/>could need on configuration is stored in the <code class="literal">config</code> directory. Every file here has quite a descriptive name: <code class="literal">app.php</code>, <code class="literal">database.php</code>, <code class="literal">filesystems.php</code>, <code class="literal">cache.php</code>, and so on. Actually, we are going to use two of these files: <code class="literal">app.php</code>, for some basic settings, and <code class="literal">database.php</code>, for obvious reasons.</p><p>First of all, let's open the <code class="literal">app.php</code> file and see what you can find inside.</p><div class="informalexample"><pre class="programlisting">&lt;?php

return [

  'debug' =&gt; true,

  'url' =&gt; 'http://localhost',

  'timezone' =&gt; 'Europe/Rome',

  'locale' =&gt; 'en',

  'fallback_locale' =&gt; 'en',

  'key' =&gt; env('APP_KEY', 'SomeRandomString'),

  'cipher' =&gt; MCRYPT_RIJNDAEL_128,

  'log' =&gt; 'daily',

  // other items here...

];</pre></div><p>A Laravel config file contains a return instruction. The returned value is an associative array. As you can easily imagine, the key-value system represents the configuration item name and its value. For example, let's examine the first item:</p><div class="informalexample"><pre class="programlisting">  'debug' =&gt; true,</pre></div><p>This <a id="id32" class="indexterm"/>means that the <code class="literal">app.debug</code> configuration item is set on the Boolean value true.</p><p>Laravel uses these values all around the framework code, and you can use them too with the <code class="literal">\Config</code> class.</p><p>Specifically, if you want to retrieve a specific item value, you have to call the <code class="literal">get()</code> method, as follows:</p><div class="informalexample"><pre class="programlisting">  $myItem = \Config::get('item.name');
  var_dump($myItem);

  // true</pre></div><p>You can also set a specific <code class="literal">Config</code> value at runtime, this time using the <code class="literal">set()</code> method, as follows:</p><div class="informalexample"><pre class="programlisting">  \Config::set('item.name', 'my value!');

  $myItem = \Config::get('item.name');
  var_dump($myItem);

  // "my value!"</pre></div></div><div class="section" title="Setting up the database connection"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Setting up the database connection</h2></div></div></div><p>Yes, we finally arrived <a id="id33" class="indexterm"/>at the end of this chapter. The last thing we need to do here, is to set up the database connection.</p><p>Let's open the <code class="literal">database.php</code> file under <code class="literal">config</code>. You should see something like this:</p><div class="informalexample"><pre class="programlisting">&lt;?php

return [

  'fetch' =&gt; PDO::FETCH_CLASS,

  'default' =&gt; 'mysql',

  'connections' =&gt; [

    'sqlite' =&gt; [
      'driver'   =&gt; 'sqlite',
      'database' =&gt; storage_path().'/database.sqlite',
      'prefix'   =&gt; '',
    ],

    'mysql' =&gt; [
      'driver'    =&gt; 'mysql',
      'host'      =&gt; 'localhost',
      'database'  =&gt; 'homestead',
      'username'  =&gt; 'homestead',
      'password'  =&gt; 'secret',
      'charset'   =&gt; 'utf8',
      'collation' =&gt; 'utf8_unicode_ci',
      'prefix'    =&gt; '',
      'strict'    =&gt; false,
    ],

    'pgsql' =&gt; [
      'driver'   =&gt; 'pgsql',
      'host'     =&gt; env('DB_HOST', 'localhost'),
      'database' =&gt; env('DB_DATABASE', 'forge'),
      'username' =&gt; env('DB_USERNAME', 'forge'),
      'password' =&gt; env('DB_PASSWORD', ''),
      'charset'  =&gt; 'utf8',
      'prefix'   =&gt; '',
      'schema'   =&gt; 'public',
    ],

    'sqlsrv' =&gt; [
      'driver'   =&gt; 'sqlsrv',
      'host'     =&gt; env('DB_HOST', 'localhost'),
      'database' =&gt; env('DB_DATABASE', 'forge'),
      'username' =&gt; env('DB_USERNAME', 'forge'),
      'password' =&gt; env('DB_PASSWORD', ''),
      'prefix'   =&gt; '',
    ],

  ],

  'migrations' =&gt; 'migrations',

  'redis' =&gt; [

    'cluster' =&gt; false,

    'default' =&gt; [
      'host'     =&gt; '127.0.0.1',
      'port'     =&gt; 6379,
      'database' =&gt; 0,
    ],

  ],

];</pre></div><p>The two most <a id="id34" class="indexterm"/>important items are <code class="literal">default</code> and <code class="literal">connections</code>. In this second item, <code class="literal">connections</code>, we are storing all the information we need to connect to our databases. By default, you will find many examples. In fact, here you can see the <code class="literal">sqlite</code>, then <code class="literal">mysql</code>, and also <code class="literal">sqlsrv</code> connections.</p><p>Every connection has a driver. The <code class="literal">driver</code> element indicates the used database for that connection. If you want, you can specify more than one connection, when necessary. The <code class="literal">default</code> element represents the chosen connection.</p><p>Let's delete everything and replace the <code class="literal">default</code> and <code class="literal">connections</code> elements with the following:</p><div class="informalexample"><pre class="programlisting">  'default' =&gt; 'eloquentJourney',

  'connections' =&gt; [

    'eloquentJourney' =&gt; [
      'driver'    =&gt; 'mysql',
      'host'      =&gt; 'localhost',
      'database'  =&gt; 'eloquent_journey',
      'username'  =&gt; 'homestead',
      'password'  =&gt; 'secret',
      'charset'   =&gt; 'utf8',
      'collation' =&gt; 'utf8_unicode_ci',
      'prefix'    =&gt; '',
      'strict'    =&gt; false,
    ],
  ],</pre></div><p>What did we just do?</p><p>Quite simple! We have defined an <code class="literal">eloquentJourney</code> connection. This connection will use the <code class="literal">mysql</code> driver. So, we are going to connect Laravel to a MySQL server. I am not going to explain the other properties, as it is really easy to understand their meanings.</p><p>After that, we<a id="id35" class="indexterm"/> specified the connection name as the default option. This means that, for every future call to a database-related operation, Laravel will connect to the server specified in the <code class="literal">eloquentJourney</code> connection with the given credentials.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Summary</h1></div></div></div><p>We did it!</p><p>We prepared everything that is needed to work with Laravel and Eloquent. We set up a local development server, learned the basics of Composer to correctly manage our dependencies, installed a couple of more useful tools, and, finally, successfully configured our database connection. Not bad for the first chapter, huh?</p><p>However, we have just begun, and our journey inside Eloquent is at the very beginning. We are ready to leave our safe house, go into the darkest corner of the Eloquent ORM to explore it, and understand all of its secrets.</p><p>It will be a great ride. And now, let's explore our first topic on our way: the Schema Builder and the migrations system, to build the perfect database!</p></div></body></html>
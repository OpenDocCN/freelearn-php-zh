- en: Chapter 8. Working with Themes and Add-ons
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第8章. 使用主题和附加包
- en: 'In this chapter we will cover the following:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下内容：
- en: Creating a custom theme
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个自定义主题
- en: Including the concrete5 required scripts and styles
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 包含concrete5所需的脚本和样式
- en: Defining editable content areas
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义可编辑的内容区域
- en: Creating page type templates
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建页面类型模板
- en: Using elements for repeated portions of HTML
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用元素重复HTML的某些部分
- en: Customizing system pages
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自定义系统页面
- en: Creating a custom add-on package
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个自定义的附加包
- en: Using the package controller to execute custom code
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用包控制器执行自定义代码
- en: Introduction
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: concrete5 is a little different from other content management systems. Of course,
    it has world-class inline editing capabilities and a powerful development framework,
    but it also is incredibly easy to create custom themes and add-ons. Developers
    and designers can even sell their creations in the concrete5 marketplace. In this
    chapter, we will learn how to create a very basic theme and also how to create
    a simple add-on package. Though each of these recipes has its own purpose, it
    might be useful for beginners to run through the recipes in order to make sure
    all of the required knowledge is attained.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5与其他内容管理系统略有不同。当然，它拥有世界级的内联编辑功能和强大的开发框架，但它也非常容易创建自定义主题和附加包。开发者和设计师甚至可以在concrete5市场中销售他们的作品。在本章中，我们将学习如何创建一个非常基本的主题，以及如何创建一个简单的附加包。尽管每个食谱都有其自己的目的，但对于初学者来说，按照顺序运行这些食谱以确保获得所有必需的知识可能是有用的。
- en: Creating a custom theme
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建一个自定义主题
- en: Themes are an essential part of any content management system, and for good
    reason. Nobody wants their site to look just like all of the other websites out
    there. concrete5 comes with a handful of decent-looking themes, but many times
    you or your clients will want a custom theme developed. The subject of creating
    themes can actually become quite lengthy and there have been entire books dedicated
    to this (the book *Creating concrete5 Themes*, by Remo Laubacher, Packt Publishing
    is highly recommended). In this recipe, we will only demonstrate the minimum requirements
    to create a custom theme in concrete5.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 主题是任何内容管理系统的一个基本组成部分，这是有充分理由的。没有人希望他们的网站看起来和其他所有网站一样。concrete5附带了一些看起来不错的主题，但很多时候您或您的客户可能希望开发一个自定义主题。实际上，创建主题的主题可以相当长，甚至有整本书专门介绍这个话题（由Remo
    Laubacher所著，Packt Publishing出版的《Creating concrete5 Themes》一书强烈推荐）。在本食谱中，我们将仅演示在concrete5中创建自定义主题的最基本要求。
- en: Getting ready
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The complete basic theme code for this recipe is available for free on the website
    for this book.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱的完整基本主题代码可在本书的网站上免费获取。
- en: How to do it...
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for creating a custom theme are as follows:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 创建自定义主题的步骤如下：
- en: Create a new directory in `/themes` called `basic_theme`.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`/themes`目录下创建一个名为`basic_theme`的新目录。
- en: Create a file in `basic_theme` called `description.txt`.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`basic_theme`目录下创建一个名为`description.txt`的文件。
- en: Place the title of the theme on the first line of the description file.
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在描述文件的第一个位置放置主题的标题。
- en: '[PRE0]'
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Place a short description of the theme on the second line of the text file.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文本文件的第二行放置对主题的简要描述。
- en: '[PRE1]'
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Save the `description.txt` file.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存`description.txt`文件。
- en: Create a new file in `/themes/basic_theme` called `default.php`.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`/themes/basic_theme`目录下创建一个名为`default.php`的新文件。
- en: 'Enter the following basic HTML code in the file:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文件中输入以下基本的HTML代码：
- en: '[PRE2]'
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Save `default.php`.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存`default.php`。
- en: Create a file called `view.php` and keep it empty.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`view.php`的文件并保持它为空。
- en: Visit the themes area of your site's dashboard at `http://example.com/dashboard/pages/themes`.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问您网站仪表板的主题区域，网址为`http://example.com/dashboard/pages/themes`。
- en: Click on the **Install** button of your new theme. The page will look like the
    following screenshot:![How to do it...](img/4548OS_08_01.jpg)
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击您新主题的**安装**按钮。页面将看起来像以下截图：![如何操作...](img/4548OS_08_01.jpg)
- en: Click on **Activate** and then on **OK** to apply the theme to all of the pages
    in your site.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**激活**然后点击**确定**以将主题应用到您网站的所有页面。
- en: 'You website should now look like the following screenshot:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您的网站现在应该看起来像以下截图：
- en: '![How to do it...](img/4548OS_08_02.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![如何操作...](img/4548OS_08_02.jpg)'
- en: How it works...
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 only requires that the files `description.txt`, `default.php`, and
    `view.php` need to exist in a theme. The file `description.txt` contains the themes
    title and description.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5只要求主题中存在`description.txt`、`default.php`和`view.php`这三个文件。`description.txt`文件包含主题的标题和描述。
- en: There's more...
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: Obviously this would be unusable for real-life use. There's nowhere to put content!
    Where's the concrete5 edit bar? The next few recipes will expand on this simple
    theme to make it a real concrete5 theme.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，这对于实际使用来说将是不可用的。没有地方可以放置内容！concrete5 的编辑栏在哪里？接下来的几个菜谱将在此基础上扩展这个简单主题，使其成为一个真正的
    concrete5 主题。
- en: See also
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Including the concrete5 required scripts and styles* recipe
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**包括 concrete5 所需的脚本和样式** 菜谱'
- en: The *Using elements for repeated portions of HTML* recipe
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用元素为 HTML 的重复部分** 菜谱'
- en: The *Defining editable content areas* recipe
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**定义可编辑的内容区域** 菜谱'
- en: Including the concrete5 required scripts and styles
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 包括 concrete5 所需的脚本和样式
- en: You may have noticed that after creating the extremely simple theme in the previous
    recipe, the concrete5 edit bar that normally appears at the top of the screen,
    has gone away. This is because the theme did not include the required collection
    of JavaScript and CSS files, that concrete5 needs to do its job. In this recipe,
    we will add the necessary code to include those components in our simple theme.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能已经注意到，在上一道菜谱中创建的极其简单的主题之后，通常出现在屏幕顶部的 concrete5 编辑栏已经消失了。这是因为该主题没有包括 concrete5
    需要执行其工作的必需的 JavaScript 和 CSS 文件集合。在本菜谱中，我们将添加必要的代码，将这些组件包含到我们的简单主题中。
- en: Getting ready
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: This recipe will build upon the code of the simple theme from the previous recipe.
    Feel free to download the source code from the book's website to catch up, or
    adapt this recipe to fit your own theme.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 本菜谱将在前一道菜谱中的简单主题代码基础上进行构建。您可以自由地从本书的网站上下载源代码以跟上进度，或者调整这个菜谱以适应您自己的主题。
- en: How to do it...
  id: totrans-47
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'The steps for including the concrete5 required scripts and styles are as follows:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 包括 concrete5 所需脚本和样式的步骤如下：
- en: Open the `/themes/basic_theme/default.php` file where our theme's HTML was stored.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开存储我们主题 HTML 的 `/themes/basic_theme/default.php` 文件。
- en: Remove the `<title>` tag, as we will not need it any longer.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除 `<title>` 标签，因为我们不再需要它。
- en: 'Just before the closing `</head>` tag, add the following code to the file:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在关闭 `</head>` 标签之前，将以下代码添加到文件中：
- en: '[PRE3]'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Just before the closing `</body>` tag, add the following code to the file:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在关闭 `</body>` 标签之前，将以下代码添加到文件中：
- en: '[PRE4]'
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Refresh the website.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 刷新网站。
- en: How it works...
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: By calling `Loader::element`, we are actually injecting a partial template of
    PHP code into our theme. This code contains JavaScript and CSS files, as well
    as additional markup.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 通过调用 `Loader::element`，我们实际上是将 PHP 代码的部分模板注入到我们的主题中。此代码包含 JavaScript 和 CSS 文件，以及额外的标记。
- en: There's more...
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Now that we have the edit bar visible, there are still no ways to add content
    to our simple theme. The next recipe will show how to add an editable area to
    the theme.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经使编辑栏可见，但仍没有方法向我们的简单主题添加内容。下一道菜谱将展示如何向主题添加可编辑区域。
- en: See also
  id: totrans-60
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Creating a custom theme* recipe
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**创建自定义主题** 菜谱'
- en: The *Defining editable content areas* recipe
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**定义可编辑的内容区域** 菜谱'
- en: Defining editable content areas
  id: totrans-63
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 定义可编辑的内容区域
- en: One great feature of concrete5's theme conventions is the ability to specify
    exactly where site editors are allowed to edit content. This prevents users from
    messing up the design and structure of the site, but still enables them to make
    edits to all the necessary content. In this recipe, we will add an editable area
    to the simple theme that we created earlier in the chapter.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 的主题约定中的一个伟大功能是能够指定站点编辑员可以编辑内容的精确位置。这防止了用户破坏网站的设计和结构，但仍然使他们能够编辑所有必要的内容。在本菜谱中，我们将向我们在本章早期创建的简单主题中添加一个可编辑区域。
- en: Getting ready
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: We will expand on the theme created in the previous recipes. If you would like
    to catch up, the source code for this chapter is available for free on the book's
    website. You could also adapt this recipe to your own theme, if you'd like.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在前几道菜谱中创建的主题基础上进行扩展。如果您想赶上进度，本章的源代码可以在本书的网站上免费获取。如果您愿意，也可以根据您自己的主题调整这个菜谱。
- en: How to do it...
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'The steps for defining editable content areas are as follows:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 定义可编辑内容区域的步骤如下：
- en: Open `/themes/basic_theme/default.php` in your preferred code editor.
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您偏好的代码编辑器中打开 `/themes/basic_theme/default.php` 文件。
- en: 'Replace the current `<h1>` tag with the following code:'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将当前的 `<h1>` 标签替换为以下代码：
- en: '[PRE5]'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The screens will appear as shown in the following two screenshots:'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 屏幕将显示如下两个截图所示：
- en: '![How to do it...](img/4548OS_08_03.jpg)![How to do it...](img/4548OS_08_04.jpg)'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何做...](img/4548OS_08_03.jpg)![如何做...](img/4548OS_08_04.jpg)'
- en: How it works...
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The snippet of code that we added in this recipe essentially tells concrete5
    that this is the place where blocks can be added.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在本菜谱中添加的代码片段本质上告诉 concrete5 这是我们添加块的地方。
- en: There's more...
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: The snippet defining content areas can be placed anywhere in your site's HTML
    between the `<body>` tags. Imagine adding an area for the sidebar, and another
    area for the page's header. The only thing to note is that the name of the area
    (in this example, `content`) needs to be different in each place where it is used
    on a page.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 定义内容区域的代码片段可以放置在您网站HTML的`<body>`标签之间的任何位置。想象一下添加一个用于侧边栏的区域，以及另一个用于页面页眉的区域。需要注意的是，区域名称（在本例中为`content`）在页面上的每个使用位置都需要不同。
- en: See also
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: The *Creating a custom theme* recipe
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**创建自定义主题**菜谱'
- en: The *Including the required concrete5 scripts and styles* recipe
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**包含所需的 concrete5 脚本和样式**菜谱'
- en: Creating page type templates
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建页面类型模板
- en: concrete5 allows designers to create unlimited page templates for the pages
    in the website. These templates allow for different layouts, such as a sidebar,
    or may be a three-column layout. In this recipe, we will add a new page type template
    that shows a footer with a copyright statement to our existing basic theme.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 允许设计师为网站中的页面创建无限数量的页面模板。这些模板允许不同的布局，例如侧边栏或三列布局。在本菜谱中，我们将向现有的基本主题添加一个新的页面类型模板，该模板显示带有版权声明的页脚。
- en: Getting ready
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: We will be building upon the basic theme that was created in the first recipe
    of this chapter. The code for this chapter is freely available on the book's website,
    so feel free to download that for a starting point. Or, as always, you can adapt
    the recipe to fit your own website and theme's needs.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在此基础上构建本章第一道菜谱中创建的基本主题。本章的代码在本书网站上免费提供，因此您可以随时下载作为起点。或者，像往常一样，您可以将菜谱适应到您自己的网站和主题需求中。
- en: How to do it...
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for creating page type templates are as follows:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 创建页面类型模板的步骤如下：
- en: Create a new file in your theme directory (/`themes/basic_theme` for our current
    example) called `with_footer.php`.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的主题目录中（对于我们当前的示例，是`/themes/basic_theme`）创建一个名为`with_footer.php`的新文件。
- en: Open the new file and paste the contents of `default.php`.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开新文件，粘贴`default.php`的内容。
- en: '[PRE6]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Add a footer to the page, displaying the copyright symbol, the current year,
    and the copyright holder.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在页面上添加页脚，显示版权符号、当前年份和版权所有者。
- en: '[PRE7]'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: How it works...
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: concrete5 will use this template for all page types that have a handle of `with_footer`.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 将使用此模板为所有具有`with_footer`处理器的页面类型。
- en: Tip
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: If the page type has not been added through the concrete5 dashboard interface,
    this template cannot be used (page types can be added by visiting `/dashboard/pages/types`).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 如果页面类型未通过 concrete5 控制台界面添加，则无法使用此模板（可以通过访问`/dashboard/pages/types`添加页面类型）。
- en: There's more...
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: 'Now, we have a new template, but we have violated one of the most important
    rules of programming: **don''t repeat yourself** (**DRY**). We copied the complete
    HTML from the default template and pasted it into the new one. If something changes
    in the template and we want the change to be reflected on both of these templates,
    the developer would need to remember to update both the locations. The next recipe
    will cover the solution to this problem.'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们有一个新的模板，但我们违反了编程中最重要的一条规则之一：**不要重复自己**（DRY）。我们从默认模板中复制了完整的HTML并将其粘贴到新模板中。如果模板中有所更改，并且我们希望更改反映在这两个模板上，开发者需要记住更新两个位置。下一个菜谱将介绍解决这个问题的方法。
- en: See also
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: The *Creating a custom theme* recipe
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**创建自定义主题**菜谱'
- en: The *Using elements for repeating portions of HTML* recipe
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用元素重复 HTML 的部分**菜谱'
- en: Using elements for repeated portions of HTML
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用元素重复 HTML 的部分
- en: One of the fundamental rules for writing good code is summed up in the acronym,
    DRY. When creating themes, developers and designers will recognize that there
    are certain bits of code that get repeated on every page, such as a header or
    footer. In this recipe, we will learn how to use elements to safely repeat code
    between pages.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 编写良好代码的基本规则之一可以用缩写DRY（不要重复自己）来概括。在创建主题时，开发者和设计师会认识到某些代码会在每个页面上重复出现，例如页眉或页脚。在本菜谱中，我们将学习如何使用元素在页面之间安全地重复代码。
- en: Getting ready
  id: totrans-103
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: We are continuing to work on the very basic theme that was created in the first
    recipe of this chapter. The code for this chapter is available for free on the
    book's website if you'd like to use that as a starting point.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 我们正在继续完善本章第一道菜谱中创建的非常基础的主题。如果您想将其作为起点，本书网站上可以免费获取本章的代码。
- en: How to do it...
  id: totrans-105
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for using elements for repeated portions of HTML are as follows:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 使用元素重复HTML部分步骤如下：
- en: Create a new directory in your `themes` folder called `elements`.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的`themes`文件夹中创建一个名为`elements`的新目录。
- en: Create a new file in `elements/` called `header.php`.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`elements/`目录下创建一个名为`header.php`的新文件。
- en: 'Insert the following code into `header.php`:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下代码插入到`header.php`中：
- en: '[PRE8]'
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Create a new file in `elements/` called `footer.php`.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`elements/`目录下创建一个新文件，命名为`footer.php`。
- en: 'Insert the following code into `footer.php`:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下代码插入到`footer.php`中：
- en: '[PRE9]'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Open `default.php` from the `themes` directory.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从`themes`目录中打开`default.php`。
- en: 'Replace the header and footer code with the following code snippet, so that
    the entire file looks like the following:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将页眉和页脚代码替换为以下代码片段，使整个文件看起来如下所示：
- en: '[PRE10]'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Repeat the preceding steps for any page type templates that have been created.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对任何已创建的页面类型模板重复前面的步骤。
- en: How it works...
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: By storing the header and footer HTML in separate files, we can then tell concrete5
    to include them in all of the templates that use them. This allows us to make
    edits to these elements in only one place and keep our template code clean.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将页眉和页脚的HTML存储在单独的文件中，我们就可以告诉concrete5将这些文件包含在所有使用它们的模板中。这使我们能够在仅一个地方对这些元素进行编辑，并保持我们的模板代码整洁。
- en: See also
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Creating a custom theme* recipe
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*创建自定义主题* 菜谱'
- en: Customizing system pages
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 定制系统页面
- en: concrete5 makes it easy to create themes, but out of the box it does not apply
    themes to system pages, such as the login page. For most websites, this is fine,
    since only site editors will see the login page. On sites where site readers can
    log in and leave comments, or post in forums, it would be nice to have the login
    page match everything else. In this recipe, we will make the login page use the
    same theme as the rest of the site.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5使创建主题变得容易，但默认情况下它不会将主题应用于系统页面，如登录页面。对于大多数网站来说，这是可以的，因为只有网站编辑者会看到登录页面。在网站读者可以登录并发表评论，或在论坛中发帖的网站上，登录页面与其它页面保持一致会更好。在这个菜谱中，我们将使登录页面使用与网站其余部分相同的主题。
- en: Getting ready
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: We will continue working with the custom theme that we built at the beginning
    of this chapter. As always, the code for this recipe is available to download
    for free from the website for this book.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将继续使用本章开头构建的自定义主题。像往常一样，这个菜谱的代码可以从本书的网站上免费下载。
- en: How to do it...
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for customizing system pages are as follows:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 定制系统页面的步骤如下：
- en: Open `/config/site_theme_paths.php` in your preferred code editor.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您首选的代码编辑器中打开`/config/site_theme_paths.php`。
- en: 'Enter the following code in the `site_theme_paths.php` file:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`site_theme_paths.php`文件中输入以下代码：
- en: '[PRE11]'
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Open `/themes/basic_theme/view.php` in your code editor.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的代码编辑器中打开`/themes/basic_theme/view.php`。
- en: 'Enter the following code in `view.php`:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`view.php`中输入以下代码：
- en: '[PRE12]'
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: How it works...
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: concrete5 comes with the `site_theme_paths.php` configuration file, but all
    of the configuration settings are commented out by default. This file lets you
    set the theme of any page on the site, and in this example, we tell it to use
    our basic theme for the login page.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5附带`site_theme_paths.php`配置文件，但默认情况下所有配置设置都被注释掉了。此文件允许您设置网站上任何页面的主题，在这个例子中，我们告诉它为登录页面使用我们的基本主题。
- en: You'll also notice that the `view.php` page was empty in our theme up until
    this point. This file is the template that concrete5 uses for single pages that
    do not have their own template defined. The `$innerContent` variable contains
    all of the PHP and HTML for the single page.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 您还会注意到，在我们的主题中，直到这一点，`view.php`页面都是空的。这个文件是concrete5用于没有定义自己模板的单页模板。`$innerContent`变量包含单页的所有PHP和HTML。
- en: See also
  id: totrans-137
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Creating a custom theme* recipe
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*创建自定义主题* 菜谱'
- en: Creating a custom add-on package
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建自定义附加包
- en: concrete5 allows developers to create modular components that can be reused
    and installed on any concrete5 website. These modules are called add-ons and are
    similar to plugins and modules in other content management systems. In this recipe,
    we will create a basic add-on that installs a single page to the concrete5 dashboard.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5允许开发者创建可重用和可安装在任何concrete5网站上的模块化组件。这些模块被称为插件，类似于其他内容管理系统中的插件和模块。在本菜谱中，我们将创建一个基本的插件，该插件将安装一个单页到concrete5仪表板。
- en: Getting ready
  id: totrans-141
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The complete code for this recipe is available for free from the book's website.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 此菜谱的完整代码可在书籍网站上免费获取。
- en: How to do it...
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for creating a custom add-on package are as follows:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 创建自定义插件包的步骤如下：
- en: Create a new directory in `/packages` called `basic_addon`.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`/packages`中创建一个名为`basic_addon`的新目录。
- en: Create a file called `controller.php` in `/packages/basic_addon`.
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`/packages/basic_addon`中创建一个名为`controller.php`的文件。
- en: Define the package class in `controller.php`.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`controller.php`中定义包类。
- en: '[PRE13]'
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Add the member variables to the class.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将成员变量添加到类中。
- en: '[PRE14]'
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Define the function to return the package's name.
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一个函数以返回包的名称。
- en: '[PRE15]'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Define a function to return the package's description.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一个函数以返回包的描述。
- en: '[PRE16]'
  id: totrans-154
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Overwrite the `install` function, telling the package controller to also install
    a new single page on the dashboard.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 覆盖`install`函数，告诉包控制器还要在仪表板上安装一个新的单页。
- en: '[PRE17]'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Create a directory in `basic_addon/` called `single_pages`.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`basic_addon/`中创建一个名为`single_pages`的目录。
- en: Create a directory called `dashboard` in `single_pages/`.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`single_pages/`中创建一个名为`dashboard`的目录。
- en: Create a file called `hello.php` in `/packages/basic_addon/single_pages/dashboard`.
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`/packages/basic_addon/single_pages/dashboard`中创建一个名为`hello.php`的文件。
- en: Enter the following code in `hello.php`.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`hello.php`中输入以下代码。
- en: '[PRE18]'
  id: totrans-161
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: In your web browser, visit the add-ons installation page in concrete5 at `/dashboard/extend/install/`.
    The page will look like the following screenshot:![How to do it...](img/4548OS_08_05.jpg)
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你的网络浏览器中，访问concrete5的插件安装页面，地址为`/dashboard/extend/install/`。页面将类似于以下截图：![如何操作...](img/4548OS_08_05.jpg)
- en: Click on the **Install** button by the new add-on that you have created.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击你创建的新插件旁边的**安装**按钮。
- en: Visit `/dashboard/hello` in your web browser to see the single page that got
    created by the package installer. The page will look like the following screenshot:![How
    to do it...](img/4548OS_08_06.jpg)
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你的网络浏览器中访问`/dashboard/hello`以查看由包安装器创建的单页。页面将类似于以下截图：![如何操作...](img/4548OS_08_06.jpg)
- en: How it works...
  id: totrans-165
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The only required file in a package is `controller.php`. This file contains
    a class that provides methods for concrete5 to get the name and description of
    the add-on. We also modify the package installer by having it also add a new single
    page to the dashboard. By visiting `http://example.com/dashboard/hello`, we will
    see the HTML from the single page that we created.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 包中唯一的必需文件是`controller.php`。此文件包含一个类，它为concrete5提供获取插件名称和描述的方法。我们还通过让包安装器添加一个新的单页到仪表板来修改包安装器。通过访问`http://example.com/dashboard/hello`，我们将看到我们创建的单页的HTML。
- en: There's more...
  id: totrans-167
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多...
- en: The structure of a package directory is very similar to the overall directory
    of a normal concrete5 site. Since we wanted to bundle a single page with our package,
    we simply had to create it and store it in a directory much like we would normally
    in concrete5\. You can see how a package would be structured if it had to contain
    blocks, controllers, helpers, or any other type of file that concrete5 uses.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 包目录的结构与正常concrete5网站的总体目录非常相似。由于我们想要将单页与我们的包捆绑在一起，我们只需创建它并将其存储在一个目录中，就像我们在concrete5中通常做的那样。你可以看到如果包必须包含块、控制器、助手或其他任何concrete5使用的文件类型，它将如何被结构化。
- en: See also
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Using the package controller to execute custom code* recipe
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用包控制器执行自定义代码*菜谱'
- en: Using the package controller to execute custom code
  id: totrans-171
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用包控制器执行自定义代码
- en: A unique and advanced feature of the package controller is the ability to run
    code automatically whenever a page is accessed. This can give add-on developers
    tremendous potential to tap into system events, hook into site HTTP requests,
    and more. In this recipe, we will show how easy it is to automatically run code
    from our package whenever a page is visited by redirecting all requests containing
    a special parameter to the home page.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 包控制器的一个独特且高级的功能是能够在页面访问时自动运行代码。这可以为插件开发者提供巨大的潜力，以利用系统事件、挂钩到网站 HTTP 请求等。在这个菜谱中，我们将展示如何通过将包含特殊参数的所有请求重定向到主页，轻松地从我们的包中自动运行代码。
- en: Getting ready
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: We will use the simple add-on package that was created in the previous recipe
    for this example. The code for this recipe and all others is available for download
    on the book's website.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用在前一个菜谱中创建的简单插件包来演示这个例子。本菜谱及所有其他菜谱的代码都可以在本书的网站上下载。
- en: How to do it...
  id: totrans-175
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for using the package controller to execute custom code are as follows:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 使用包控制器执行自定义代码的步骤如下：
- en: Open the package controller file, located at `/packages/basic_addon/controller.php`.
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开位于 `/packages/basic_addon/controller.php` 的包控制器文件。
- en: Add a function called `on_start` that will redirect anyone that enters the parameter
    `redirect_me` in the URL.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个名为 `on_start` 的函数，该函数将重定向任何在 URL 中输入参数 `redirect_me` 的人。
- en: '[PRE19]'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Test it out by adding `?redirect_me` to the URL.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在 URL 中添加 `?redirect_me` 来测试它。
- en: How it works...
  id: totrans-181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 automatically runs the function `on_start` whenever a page is loaded,
    so any code that you place there in your package will get automatically run. Our
    example in this case is pretty useless, but you can see where the opportunities
    are nearly endless for developers (automatically parsing page requests, intercepting
    form submissions, adding CSS or JavaScript to pages, and more).
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 在页面加载时自动运行函数 `on_start`，因此你将包中放置的任何代码都会自动运行。在这个例子中，我们的示例相当无用，但你可以看到开发者几乎有无限的机会（自动解析页面请求、拦截表单提交、向页面添加
    CSS 或 JavaScript 等）。
- en: See also
  id: totrans-183
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Creating a custom add-on package* recipe
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*创建自定义插件包* 菜谱'

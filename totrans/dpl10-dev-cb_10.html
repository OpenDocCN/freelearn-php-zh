<html><head></head><body>
<div id="_idContainer067">
<h1 class="chapter-number" id="_idParaDest-290"><a id="_idTextAnchor319"/><span class="koboSpan" id="kobo.1.1">10</span></h1>
<h1 id="_idParaDest-291"><a id="_idTextAnchor320"/><span class="koboSpan" id="kobo.2.1">Theming and Frontend Development</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.3.1">Theming</span></strong><span class="koboSpan" id="kobo.4.1"> is the process through which we can affect the output of entities (nodes, users, taxonomy terms, media, and so on) with CSS, JavaScript, Twig templates, and HTML. </span><span class="koboSpan" id="kobo.4.2">Drupal comes with a handful of out-of-the-box themes to provide a basic look and feel after you install it. </span><span class="koboSpan" id="kobo.4.3">Olivero is the default site theme in Drupal 10 and Claro provides the </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">administration theme.</span></span></p>
<p><span class="koboSpan" id="kobo.6.1">There are numerous options available on </span><a href="http://Drupal.org"><span class="koboSpan" id="kobo.7.1">Drupal.org</span></a><span class="koboSpan" id="kobo.8.1"> that either provide a starting point for your own theme (Bootstrap, ZURB Foundation, or Barrio, for example) or a full ready-to-use solution. </span><span class="koboSpan" id="kobo.8.2">It is also possible to create your own custom theme </span><span class="No-Break"><span class="koboSpan" id="kobo.9.1">from scratch.</span></span></p>
<p><span class="koboSpan" id="kobo.10.1">Everything you see on the screen after a page has loaded in Drupal has gone through the theming and rendering pipeline. </span><span class="koboSpan" id="kobo.10.2">This means that you can customize the theme that you see and control its markup and styling. </span><span class="koboSpan" id="kobo.10.3">Understanding how Drupal theming works will make you a more effective developer and this chapter will help you </span><span class="No-Break"><span class="koboSpan" id="kobo.11.1">do so.</span></span></p>
<p><span class="koboSpan" id="kobo.12.1">In this chapter, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.13.1">following recipes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.14.1">Creating a custom theme to style your </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">Drupal site</span></span></li>
<li><span class="koboSpan" id="kobo.16.1">Adding CSS and JavaScript to </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">your theme</span></span></li>
<li><span class="koboSpan" id="kobo.18.1">Using Twig templates in </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">your theme</span></span></li>
<li><span class="koboSpan" id="kobo.20.1">Delivering </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">responsive images</span></span></li>
<li><span class="koboSpan" id="kobo.22.1">Compiling CSS and JavaScript pre- and post-processors with </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">Laravel Mix</span></span></li>
<li><span class="koboSpan" id="kobo.24.1">Using Laravel Mix to theme your Drupal site with </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">live reloading</span></span></li>
</ul>
<h1 id="_idParaDest-292"><a id="_idTextAnchor321"/><span class="koboSpan" id="kobo.26.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.27.1">You can find the full code used in this chapter on </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">GitHub: </span></span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">https://github.com/PacktPublishing/Drupal-10-Development-Cookbook/tree/main/chp10</span></span></p>
<h1 id="_idParaDest-293"><a id="_idTextAnchor322"/><span class="koboSpan" id="kobo.30.1">Creating a custom theme to style your Drupal site</span></h1>
<p><span class="koboSpan" id="kobo.31.1">Drupal </span><a id="_idIndexMarker577"/><span class="koboSpan" id="kobo.32.1">provides </span><a id="_idIndexMarker578"/><span class="koboSpan" id="kobo.33.1">a theme generator to create custom themes for Drupal sites based on the Starterkit theme. </span><span class="koboSpan" id="kobo.33.2">This provides all of the base CSS stylesheets, JavaScript files, and Twig templates to begin customizing the look and feel of your Drupal site. </span><span class="koboSpan" id="kobo.33.3">The theme generator is bundled with a developer command-line tool provided by Drupal core </span><span class="No-Break"><span class="koboSpan" id="kobo.34.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.35.1">core/scripts/drupal</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">.</span></span></p>
<h2 id="_idParaDest-294"><a id="_idTextAnchor323"/><span class="koboSpan" id="kobo.37.1">How to do it…</span></h2>
<ol>
<li><span class="koboSpan" id="kobo.38.1">The script for</span><a id="_idIndexMarker579"/><span class="koboSpan" id="kobo.39.1"> generating a theme needs </span><a id="_idIndexMarker580"/><span class="koboSpan" id="kobo.40.1">to be executed in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.41.1">web</span></strong><span class="koboSpan" id="kobo.42.1"> directory, so navigate there in </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">your terminal:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.44.1">
cd web</span></pre></li>
<li><span class="koboSpan" id="kobo.45.1">Run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.46.1">generate-theme</span></strong><span class="koboSpan" id="kobo.47.1"> command from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.48.1">core/scripts/drupal</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.49.1"> script:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.50.1">
php core/scripts/drupal generate-theme mytheme --name</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.51.1">
  "My theme"</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.52.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.53.1">generate-theme</span></strong><span class="koboSpan" id="kobo.54.1"> command accepts one argument – the machine name for the theme. </span><span class="koboSpan" id="kobo.54.2">You can also pass the </span><strong class="source-inline"><span class="koboSpan" id="kobo.55.1">name</span></strong><span class="koboSpan" id="kobo.56.1"> option to give it a </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">human-readable name.</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.58.1">After the theme has been generated, it will be available in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.59.1">web/themes</span></strong><span class="koboSpan" id="kobo.60.1"> directory. </span><span class="koboSpan" id="kobo.60.2">The command will output something similar to </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">the following:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.62.1">
Theme generated successfully to themes/mytheme</span></pre></li>
<li><span class="koboSpan" id="kobo.63.1">You can now visit </span><strong class="source-inline"><span class="koboSpan" id="kobo.64.1">/admin/appearance</span></strong><span class="koboSpan" id="kobo.65.1"> and install your </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">new theme:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer061">
<span class="koboSpan" id="kobo.67.1"><img alt="Figure 10.1 – Appearance management screen to install the new custom theme" src="image/Figure_10.01_B18548.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.68.1">Figure 10.1 – Appearance management screen to install the new custom theme</span></p>
<h2 id="_idParaDest-295"><a id="_idTextAnchor324"/><span class="koboSpan" id="kobo.69.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.70.1">The </span><a id="_idIndexMarker581"/><span class="koboSpan" id="kobo.71.1">theme </span><a id="_idIndexMarker582"/><span class="koboSpan" id="kobo.72.1">generator uses a </span><em class="italic"><span class="koboSpan" id="kobo.73.1">copy-and-forget</span></em><span class="koboSpan" id="kobo.74.1"> model, also known as </span><em class="italic"><span class="koboSpan" id="kobo.75.1">fork-and-forget</span></em><span class="koboSpan" id="kobo.76.1">, with the Starterkit theme. </span><span class="koboSpan" id="kobo.76.2">This means your theme is a copy of the Starterkit theme as it was when you created your theme and cannot be broken if the Starterkit theme changes in later versions </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">of Drupal.</span></span></p>
<p><span class="koboSpan" id="kobo.78.1">This differs from other systems that need to be built upon child themes, such as WordPress, or built from scratch, such as </span><em class="italic"><span class="koboSpan" id="kobo.79.1">Laravel</span></em><span class="koboSpan" id="kobo.80.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.81.1">Symfony</span></em><span class="koboSpan" id="kobo.82.1">. </span><span class="koboSpan" id="kobo.82.2">This allows you to create a theme from a starting point and begin working without worrying about backward incompatibility due to changes to a </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">base theme.</span></span></p>
<p><span class="koboSpan" id="kobo.84.1">Other themes may act as a starterkit. </span><span class="koboSpan" id="kobo.84.2">They are contributed themes and can be specified using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.85.1">--</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.86.1">starterkit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.87.1"> option.</span></span></p>
<p><span class="koboSpan" id="kobo.88.1">The next recipe will cover how to add new CSS stylesheets and JavaScript files to your </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">Drupal site.</span></span></p>
<h2 id="_idParaDest-296"><a id="_idTextAnchor325"/><span class="koboSpan" id="kobo.90.1">There’s more</span></h2>
<p><span class="koboSpan" id="kobo.91.1">Next, we will dive into additional information on themes and the </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">theme generator.</span></span></p>
<h3><span class="koboSpan" id="kobo.93.1">Creating your starter kit theme</span></h3>
<p><span class="koboSpan" id="kobo.94.1">Very often, organizations </span><a id="_idIndexMarker583"/><span class="koboSpan" id="kobo.95.1">have a shared starting base for their </span><a id="_idIndexMarker584"/><span class="koboSpan" id="kobo.96.1">themes. </span><span class="koboSpan" id="kobo.96.2">You can define your own starterkit for creating new themes and leveraging existing setups. </span><span class="koboSpan" id="kobo.96.3">This is done by adding the </span><strong class="source-inline"><span class="koboSpan" id="kobo.97.1">starterkit</span></strong><span class="koboSpan" id="kobo.98.1"> key to your theme’s </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.99.1">info.yml</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.100.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.101.1">
startekit: true</span></pre>
<p><span class="koboSpan" id="kobo.102.1">When this value is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.103.1">true</span></strong><span class="koboSpan" id="kobo.104.1">, the theme generation command allows you to generate new themes using it. </span><span class="koboSpan" id="kobo.104.2">This flag is required since some themes are not intended to be starterkits with a generic base </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">of features.</span></span></p>
<h3><span class="koboSpan" id="kobo.106.1">Theme screenshots</span></h3>
<p><span class="koboSpan" id="kobo.107.1">Themes can </span><a id="_idIndexMarker585"/><span class="koboSpan" id="kobo.108.1">provide a </span><a id="_idIndexMarker586"/><span class="koboSpan" id="kobo.109.1">screenshot that shows up on the </span><strong class="bold"><span class="koboSpan" id="kobo.110.1">Appearance</span></strong><span class="koboSpan" id="kobo.111.1"> page. </span><span class="koboSpan" id="kobo.111.2">A theme’s screenshot can be provided by placing a </span><strong class="source-inline"><span class="koboSpan" id="kobo.112.1">screenshot.png</span></strong><span class="koboSpan" id="kobo.113.1"> image file into the theme folder or a file specified in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.114.1">info.yml</span></strong><span class="koboSpan" id="kobo.115.1"> file under the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.116.1">screenshot</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.117.1"> key.</span></span></p>
<h3><span class="koboSpan" id="kobo.118.1">Themes, logos, and favicons</span></h3>
<p><span class="koboSpan" id="kobo.119.1">Drupal controls </span><a id="_idIndexMarker587"/><span class="koboSpan" id="kobo.120.1">the site’s</span><a id="_idIndexMarker588"/><span class="koboSpan" id="kobo.121.1"> favicon and logo settings as a</span><a id="_idIndexMarker589"/><span class="koboSpan" id="kobo.122.1"> theme setting. </span><span class="koboSpan" id="kobo.122.2">These settings are active on a theme-by-theme basis and are not global. </span><span class="koboSpan" id="kobo.122.3">A </span><strong class="source-inline"><span class="koboSpan" id="kobo.123.1">favicon.ico</span></strong><span class="koboSpan" id="kobo.124.1"> placed in the theme’s directory will also be the default value of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.125.1">favicon</span></strong><span class="koboSpan" id="kobo.126.1"> for the website. </span><span class="koboSpan" id="kobo.126.2">Themes can provide a default logo by providing </span><strong class="source-inline"><span class="koboSpan" id="kobo.127.1">logo.svg</span></strong><span class="koboSpan" id="kobo.128.1"> in the theme’s directory. </span><span class="koboSpan" id="kobo.128.2">An alternative logo file can be specified by using a </span><strong class="source-inline"><span class="koboSpan" id="kobo.129.1">logo</span></strong><span class="koboSpan" id="kobo.130.1"> key in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.131.1">info.yml</span></strong><span class="koboSpan" id="kobo.132.1"> file with a path to </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">the file.</span></span></p>
<p><span class="koboSpan" id="kobo.134.1">You can change the site’s logo and favicon by navigating to </span><strong class="bold"><span class="koboSpan" id="kobo.135.1">Appearance</span></strong><span class="koboSpan" id="kobo.136.1"> and then clicking on </span><strong class="bold"><span class="koboSpan" id="kobo.137.1">Settings</span></strong><span class="koboSpan" id="kobo.138.1"> for your current theme. </span><span class="koboSpan" id="kobo.138.2">Unchecking the default checkboxes for the favicon and logo settings allows you to provide </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">custom files:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer062">
<span class="koboSpan" id="kobo.140.1"><img alt="Figure 10.2 – Overview of the theme settings for logos and favicons" src="image/Figure_10.02_B18548.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.141.1">Figure 10.2 – Overview of the theme settings for logos and favicons</span></p>
<h2 id="_idParaDest-297"><a id="_idTextAnchor326"/><span class="koboSpan" id="kobo.142.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.143.1">Documentation for the Starterkit </span><span class="No-Break"><span class="koboSpan" id="kobo.144.1">theme: </span></span><a href="https://www.drupal.org/docs/core-modules-and-themes/core-themes"><span class="No-Break"><span class="koboSpan" id="kobo.145.1">https://www.drupal.org/docs/core-modules-and-themes/core-themes</span></span></a></li>
<li><span class="koboSpan" id="kobo.146.1">Documentation for theme </span><span class="No-Break"><span class="koboSpan" id="kobo.147.1">generation: </span></span><a href="https://www.drupal.org/docs/theming-drupal"><span class="No-Break"><span class="koboSpan" id="kobo.148.1">https://www.drupal.org/docs/theming-drupal</span></span></a></li>
<li><span class="koboSpan" id="kobo.149.1">Documentation on the properties of a theme’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.150.1">info.yml</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.151.1">file: </span></span><a href="https://www.drupal.org/node/2349827"><span class="No-Break"><span class="koboSpan" id="kobo.152.1">https://www.drupal.org/node/2349827</span></span></a></li>
</ul>
<h1 id="_idParaDest-298"><a id="_idTextAnchor327"/><span class="koboSpan" id="kobo.153.1">Adding CSS and JavaScript to your theme</span></h1>
<p><span class="koboSpan" id="kobo.154.1">In Drupal, CSS stylesheets</span><a id="_idIndexMarker590"/><span class="koboSpan" id="kobo.155.1"> and JavaScript files are associated with</span><a id="_idIndexMarker591"/><span class="koboSpan" id="kobo.156.1"> libraries, and specific libraries are added to a page. </span><span class="koboSpan" id="kobo.156.2">This allows CSS style sheets and JavaScript files to be attached only when they are needed. </span><span class="koboSpan" id="kobo.156.3">Themes can be associated with libraries that must always be attached for </span><span class="No-Break"><span class="koboSpan" id="kobo.157.1">global styling.</span></span></p>
<p><span class="koboSpan" id="kobo.158.1">In this recipe, we will update a theme’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.159.1">libraries.yml</span></strong><span class="koboSpan" id="kobo.160.1"> file to register a CSS stylesheet and JavaScript file provided by the </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">custom theme.</span></span></p>
<h2 id="_idParaDest-299"><a id="_idTextAnchor328"/><span class="koboSpan" id="kobo.162.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.163.1">This recipe uses a theme created by the theme generator as done in the </span><em class="italic"><span class="koboSpan" id="kobo.164.1">Creating a custom theme to style your Drupal </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.165.1">site</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.166.1"> recipe.</span></span></p>
<h2 id="_idParaDest-300"><a id="_idTextAnchor329"/><span class="koboSpan" id="kobo.167.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.168.1">First, create </span><strong class="source-inline"><span class="koboSpan" id="kobo.169.1">css</span></strong><span class="koboSpan" id="kobo.170.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.171.1">js</span></strong><span class="koboSpan" id="kobo.172.1"> directories in your theme’s directory that will contain the CSS stylesheets and JavaScript </span><span class="No-Break"><span class="koboSpan" id="kobo.173.1">files, respectively:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.174.1">
mkdir -p css js</span></pre></li>
<li><span class="koboSpan" id="kobo.175.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.176.1">css</span></strong><span class="koboSpan" id="kobo.177.1"> directory, add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.178.1">styles.css</span></strong><span class="koboSpan" id="kobo.179.1"> file that will hold your theme’s CSS declarations. </span><span class="koboSpan" id="kobo.179.2">For the purpose of demonstration, add the following CSS declaration </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.181.1">styles.css</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.182.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.183.1">
body {</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.184.1">
  background: cornflowerblue;</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.185.1">
}</span></pre></li>
<li><span class="koboSpan" id="kobo.186.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.187.1">js</span></strong><span class="koboSpan" id="kobo.188.1"> directory, add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">scripts.js</span></strong><span class="koboSpan" id="kobo.190.1"> file that will hold the theme’s JavaScript items. </span><span class="koboSpan" id="kobo.190.2">For the purpose of demonstration, add the following JavaScript code </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.192.1">scripts.js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.193.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.194.1">
(function(Drupal) {</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.195.1">
  Drupal.behaviors.myTheme = {</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.196.1">
    attach() {</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.197.1">
      console.log('Hello world!')</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.198.1">
    }</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.199.1">
  }</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.200.1">
})(Drupal);</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.201.1">This script will print a message in the console when the script </span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">is loaded.</span></span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.203.1">Modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">mytheme.libraries.yml</span></strong><span class="koboSpan" id="kobo.205.1"> file and add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">global-styling</span></strong><span class="koboSpan" id="kobo.207.1"> library </span><a id="_idIndexMarker592"/><span class="koboSpan" id="kobo.208.1">definition</span><a id="_idIndexMarker593"/><span class="koboSpan" id="kobo.209.1"> for </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">your theme:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.211.1">
global-styling:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.212.1">
  version: VERSION</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.213.1">
  css:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.214.1">
    theme:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.215.1">
      css/styles.css: {}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.216.1">
  js:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.217.1">
    js/scripts.js: {}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.218.1">
  dependencies:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.219.1">
    - core/drupal</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.220.1">The library’s name is </span><strong class="source-inline"><span class="koboSpan" id="kobo.221.1">global-styling</span></strong><span class="koboSpan" id="kobo.222.1">. </span><span class="koboSpan" id="kobo.222.2">Libraries can define a </span><strong class="source-inline"><span class="koboSpan" id="kobo.223.1">version</span></strong><span class="koboSpan" id="kobo.224.1"> key and use </span><strong class="source-inline"><span class="koboSpan" id="kobo.225.1">VERSION</span></strong><span class="koboSpan" id="kobo.226.1"> as a default, which defaults to the most recent version of Drupal core. </span><span class="koboSpan" id="kobo.226.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.227.1">css/styles.css</span></strong><span class="koboSpan" id="kobo.228.1"> file is added to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">theme</span></strong><span class="koboSpan" id="kobo.230.1"> group for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">css</span></strong><span class="koboSpan" id="kobo.232.1"> key. </span><strong class="source-inline"><span class="koboSpan" id="kobo.233.1">js/script.js</span></strong><span class="koboSpan" id="kobo.234.1"> is added to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.236.1"> key.</span></span></p>
<p><span class="koboSpan" id="kobo.237.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">dependencies</span></strong><span class="koboSpan" id="kobo.239.1"> key specifies other libraries that must be present for JavaScript </span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">to work.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.241.1">Edit </span><strong class="source-inline"><span class="koboSpan" id="kobo.242.1">mytheme.info.yml</span></strong><span class="koboSpan" id="kobo.243.1"> to add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.244.1">global-styling</span></strong><span class="koboSpan" id="kobo.245.1"> library to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.246.1">libraries</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.247.1"> key:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.248.1">
name: 'My theme'</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.249.1">
type: theme</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.250.1">
'base theme': stable9</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.251.1">
libraries:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.252.1">
  - mytheme/global-styling</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.253.1">
  - mytheme/base</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.254.1">
  - mytheme/messages</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.255.1">
  - core/normalize</span></pre></li>
<li><span class="koboSpan" id="kobo.256.1">Rebuild your Drupal site’s cache to rebuild the library definitions cache, triggering a rediscovery of the library definitions and </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">theme information:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.258.1">
php vendor/bin/drush cr</span></pre></li>
<li><span class="koboSpan" id="kobo.259.1">View</span><a id="_idIndexMarker594"/><span class="koboSpan" id="kobo.260.1"> your </span><a id="_idIndexMarker595"/><span class="koboSpan" id="kobo.261.1">Drupal site to verify that the background color has changed and that </span><strong class="source-inline"><span class="koboSpan" id="kobo.262.1">Hello world!</span></strong><span class="koboSpan" id="kobo.263.1"> has been printed to the </span><span class="No-Break"><span class="koboSpan" id="kobo.264.1">browser’s console:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer063">
<span class="koboSpan" id="kobo.265.1"><img alt="Figure 10.3 – Custom theme with a global library attached" src="image/Figure_10.03_B18548.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.266.1">Figure 10.3 – Custom theme with a global library attached</span></p>
<h2 id="_idParaDest-301"><a id="_idTextAnchor330"/><span class="koboSpan" id="kobo.267.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.268.1">Drupal uses libraries to attach CSS stylesheets and JavaScript files to a page. </span><span class="koboSpan" id="kobo.268.2">This allows libraries to have dependencies on other libraries, such as base CSS stylesheets or JavaScript functionality. </span><span class="koboSpan" id="kobo.268.3">In this recipe, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">core/drupal</span></strong><span class="koboSpan" id="kobo.270.1"> dependency ensures that </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">core/misc/drupal.js</span></strong><span class="koboSpan" id="kobo.272.1"> is attached to the page. </span><strong class="source-inline"><span class="koboSpan" id="kobo.273.1">core/misc/core.js</span></strong><span class="koboSpan" id="kobo.274.1"> adds the global </span><strong class="source-inline"><span class="koboSpan" id="kobo.275.1">Drupal</span></strong><span class="koboSpan" id="kobo.276.1"> object, which allows you to define </span><strong class="source-inline"><span class="koboSpan" id="kobo.277.1">behaviors</span></strong><span class="koboSpan" id="kobo.278.1">. </span><span class="koboSpan" id="kobo.278.2">Each entry in </span><strong class="source-inline"><span class="koboSpan" id="kobo.279.1">Drupal.behaviors</span></strong><span class="koboSpan" id="kobo.280.1"> has its </span><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">attach</span></strong><span class="koboSpan" id="kobo.282.1"> function invoked whenever the page is loaded or AJAX events </span><span class="No-Break"><span class="koboSpan" id="kobo.283.1">are triggered.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.284.1">Asset aggregation</span></p>
<p class="callout"><span class="koboSpan" id="kobo.285.1">If Drupal is configured to aggregate assets, you will have to rebuild Drupal’s caches after each file time so that a new aggregate is created. </span><span class="koboSpan" id="kobo.285.2">This is done by visiting </span><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">/admin/config/development/performance</span></strong><span class="koboSpan" id="kobo.287.1"> and unchecking the checkboxes </span><span class="No-Break"><span class="koboSpan" id="kobo.288.1">for aggregation.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.289.1">Drupal’s CSS architecture</span></strong><span class="koboSpan" id="kobo.290.1"> borrows</span><a id="_idIndexMarker596"/><span class="koboSpan" id="kobo.291.1"> concepts from the </span><strong class="bold"><span class="koboSpan" id="kobo.292.1">Scalable and Modular Architecture for CSS</span></strong><span class="koboSpan" id="kobo.293.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.294.1">SMACSS</span></strong><span class="koboSpan" id="kobo.295.1">) system to organize CSS </span><a id="_idIndexMarker597"/><span class="koboSpan" id="kobo.296.1">declarations. </span><span class="koboSpan" id="kobo.296.2">CSS styles are applied with </span><a id="_idIndexMarker598"/><span class="koboSpan" id="kobo.297.1">cascading layers. </span><span class="koboSpan" id="kobo.297.2">Drupal libraries have different</span><a id="_idIndexMarker599"/><span class="koboSpan" id="kobo.298.1"> groups that a CSS stylesheet may be attached to, to control the ordering of when a stylesheet is loaded. </span><span class="koboSpan" id="kobo.298.2">The CSS groups are </span><span class="No-Break"><span class="koboSpan" id="kobo.299.1">as follows:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.300.1">base</span></strong><span class="koboSpan" id="kobo.301.1">: Intended for styles that target </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">HTML elements</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.303.1">layout</span></strong><span class="koboSpan" id="kobo.304.1">: Intended for styles that lay out </span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">a page</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.306.1">component</span></strong><span class="koboSpan" id="kobo.307.1">: Intended for styles that apply to </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">design components</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.309.1">state</span></strong><span class="koboSpan" id="kobo.310.1">: Intended for styles that apply states </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">to components</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.312.1">theme</span></strong><span class="koboSpan" id="kobo.313.1">: Intended for styles to </span><span class="No-Break"><span class="koboSpan" id="kobo.314.1">customize components</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.315.1">Themes may then specify libraries to be included on every page that the theme </span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">is used.</span></span></p>
<h2 id="_idParaDest-302"><a id="_idTextAnchor331"/><span class="koboSpan" id="kobo.317.1">There’s more</span></h2>
<p><span class="koboSpan" id="kobo.318.1">We will explore more options with libraries in more detail in the </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">next section.</span></span></p>
<h3><span class="koboSpan" id="kobo.320.1">Library file options</span></h3>
<p><strong class="bold"><span class="koboSpan" id="kobo.321.1">Libraries files</span></strong><span class="koboSpan" id="kobo.322.1"> can have </span><a id="_idIndexMarker600"/><span class="koboSpan" id="kobo.323.1">configuration data associated with them. </span><span class="koboSpan" id="kobo.323.2">If there are no additional configuration items provided, an empty YAML array (</span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">{  }</span></strong><span class="koboSpan" id="kobo.325.1">) </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">is used.</span></span></p>
<p><span class="koboSpan" id="kobo.327.1">The following example, taken from </span><strong class="source-inline"><span class="koboSpan" id="kobo.328.1">core.libraries.yml</span></strong><span class="koboSpan" id="kobo.329.1">, adds the </span><strong class="source-inline"><span class="koboSpan" id="kobo.330.1">es6-promise</span></strong><span class="koboSpan" id="kobo.331.1"> polyfill for </span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">the library:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.333.1">
es6-promise:
  version: "4.2.8"
  license:
    name: MIT
    url: https://raw.githubusercontent.com/stefanpenner
        /es6-promise/v4.2.8/LICENSE
    gpl-compatible: true
  js:
    assets/vendor/es6-promise/es6-promise.auto.min.js: {
        weight: -20, minified: true }</span></pre>
<p><span class="koboSpan" id="kobo.334.1">This library provides a compatibility layer for </span><strong class="bold"><span class="koboSpan" id="kobo.335.1">ES6 Promise</span></strong><span class="koboSpan" id="kobo.336.1"> in JavaScript, which means it must be added to the page early on. </span><span class="koboSpan" id="kobo.336.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">weight</span></strong><span class="koboSpan" id="kobo.338.1"> property allows you to control the priority of the library among other libraries. </span><span class="koboSpan" id="kobo.338.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">minified</span></strong><span class="koboSpan" id="kobo.340.1"> property specifies that the file has already been minified and does not need to be processed </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">by Drupal.</span></span></p>
<p><span class="koboSpan" id="kobo.342.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.343.1">preprocess</span></strong><span class="koboSpan" id="kobo.344.1"> property supports a Boolean value. </span><span class="koboSpan" id="kobo.344.2">If a file has </span><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">preprocess: false</span></strong><span class="koboSpan" id="kobo.346.1">, it will not be aggregated with other files at the </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">same time.</span></span></p>
<h3><span class="koboSpan" id="kobo.348.1">Overriding and extending other libraries</span></h3>
<p><span class="koboSpan" id="kobo.349.1">Themes </span><a id="_idIndexMarker601"/><span class="koboSpan" id="kobo.350.1">can </span><a id="_idIndexMarker602"/><span class="koboSpan" id="kobo.351.1">override libraries using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.352.1">libraries-override</span></strong><span class="koboSpan" id="kobo.353.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">libraries-extend</span></strong><span class="koboSpan" id="kobo.355.1"> keys in their </span><strong class="source-inline"><span class="koboSpan" id="kobo.356.1">info.yml</span></strong><span class="koboSpan" id="kobo.357.1"> files. </span><span class="koboSpan" id="kobo.357.2">This allows themes to easily customize existing libraries without having to add the logic to conditionally remove or add their assets when a particular library is attached to </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">a page.</span></span></p>
<p><span class="koboSpan" id="kobo.359.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.360.1">libraries-override</span></strong><span class="koboSpan" id="kobo.361.1"> key can be used to replace an entire library, replace selected files in a library, remove an asset from a library, or disable an entire library. </span><span class="koboSpan" id="kobo.361.2">The following code will allow a theme to provide a custom jQuery </span><span class="No-Break"><span class="koboSpan" id="kobo.362.1">UI theme:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.363.1">
libraries-override:
  core/jquery.ui:
    css:
      component:
        assets/vendor/jquery.ui/themes/base/core.css: false
      theme:
        assets/vendor/jquery.ui/themes/base/theme.css:
            css/jqueryui.css</span></pre>
<p><span class="koboSpan" id="kobo.364.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.365.1">override</span></strong><span class="koboSpan" id="kobo.366.1"> declaration</span><a id="_idIndexMarker603"/><span class="koboSpan" id="kobo.367.1"> mimics the original configuration. </span><span class="koboSpan" id="kobo.367.2">Specifying </span><strong class="source-inline"><span class="koboSpan" id="kobo.368.1">false</span></strong><span class="koboSpan" id="kobo.369.1"> will</span><a id="_idIndexMarker604"/><span class="koboSpan" id="kobo.370.1"> remove the asset; otherwise, a supplied path will replace </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">that asset.</span></span></p>
<p><span class="koboSpan" id="kobo.372.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.373.1">libraries-extend</span></strong><span class="koboSpan" id="kobo.374.1"> key can be used to load additional libraries with an existing library. </span><span class="koboSpan" id="kobo.374.2">The following code will allow a theme to associate a CSS style sheet with selected jQuery UI declaration overrides without always including them in the rest of the </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">theme’s assets:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.376.1">
libraries-extend:
  core/jquery.ui:
    - mytheme/jqueryui-theme</span></pre>
<p><span class="koboSpan" id="kobo.377.1">The theme generated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.378.1">starterkit</span></strong><span class="koboSpan" id="kobo.379.1"> already has examples </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.381.1">libraries-extend</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.383.1">Using a CDN or external resource as a library</span></h3>
<p><span class="koboSpan" id="kobo.384.1">Libraries also</span><a id="_idIndexMarker605"/><span class="koboSpan" id="kobo.385.1"> work with external resources, such as assets loaded over a CDN. </span><span class="koboSpan" id="kobo.385.2">This is done by providing a URL for the file location, along with selected </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">file parameters.</span></span></p>
<p><span class="koboSpan" id="kobo.387.1">Here is an example of adding the Font Awesome font icon library from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.388.1">BootstrapCDN</span></strong><span class="koboSpan" id="kobo.389.1"> provided </span><span class="No-Break"><span class="koboSpan" id="kobo.390.1">by </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.391.1">jsDeliver</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.392.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.393.1">
mytheme.fontawesome:
  remote: http://fontawesome.io/
  version: 5.15.4
  license:
    name: SIL OFL 1.1
    url: https://github.com/FortAwesome/Font-
        Awesome/blob/5.x/LICENSE.txt
    gpl-compatible: true
  css:
    base:
      https://cdn.jsdelivr.net/npm/@fortawesome
        /fontawesome-free@5.15.4/css/fontawesome.min.css: {
            type: external, minified: true }</span></pre>
<p><strong class="bold"><span class="koboSpan" id="kobo.394.1">Remote libraries</span></strong><span class="koboSpan" id="kobo.395.1"> require</span><a id="_idIndexMarker606"/><span class="koboSpan" id="kobo.396.1"> additional meta information to work properly. </span><span class="koboSpan" id="kobo.396.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">remote</span></strong><span class="koboSpan" id="kobo.398.1"> key describes the library as using external resources. </span><span class="koboSpan" id="kobo.398.2">While this key is not validated beyond its existence, it is best to define it with the external resource’s </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">primary website:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.400.1">
  remote: http://fontawesome.io/</span></pre>
<p><span class="koboSpan" id="kobo.401.1">Like all libraries, </span><strong class="source-inline"><span class="koboSpan" id="kobo.402.1">version</span></strong><span class="koboSpan" id="kobo.403.1"> information is required. </span><span class="koboSpan" id="kobo.403.2">This should match the version of the external resource </span><span class="No-Break"><span class="koboSpan" id="kobo.404.1">being added:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.405.1">
  version: 5.15.4</span></pre>
<p><span class="koboSpan" id="kobo.406.1">If a library defines the </span><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">remote</span></strong><span class="koboSpan" id="kobo.408.1"> key, it also needs to define the </span><strong class="source-inline"><span class="koboSpan" id="kobo.409.1">license</span></strong><span class="koboSpan" id="kobo.410.1"> key. </span><span class="koboSpan" id="kobo.410.2">This defines the license name and the URL for the license, and checks whether it is GPL-compatible. </span><span class="koboSpan" id="kobo.410.3">If this key is not provided, </span><strong class="source-inline"><span class="koboSpan" id="kobo.411.1">\Drupal\Core\Asset\Extension\LibraryDefinitionMissingLicenseException</span></strong><span class="koboSpan" id="kobo.412.1"> will </span><span class="No-Break"><span class="koboSpan" id="kobo.413.1">be thrown:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.414.1">
  license:
    name: SIL OFL 1.1
    url: https://github.com/FortAwesome/Font-
        Awesome/blob/5.x/LICENSE.txt
    gpl-compatible: true</span></pre>
<p><span class="koboSpan" id="kobo.415.1">Finally, specific</span><a id="_idIndexMarker607"/><span class="koboSpan" id="kobo.416.1"> external resources are added as normal. </span><span class="koboSpan" id="kobo.416.2">Instead of providing a relative file path, the external URL </span><span class="No-Break"><span class="koboSpan" id="kobo.417.1">is provided.</span></span></p>
<h3><span class="koboSpan" id="kobo.418.1">Manipulating libraries from hooks</span></h3>
<p><span class="koboSpan" id="kobo.419.1">Modules can </span><a id="_idIndexMarker608"/><span class="koboSpan" id="kobo.420.1">provide dynamic library definitions and alter libraries. </span><span class="koboSpan" id="kobo.420.2">A module can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.421.1">hook_library_info()</span></strong><span class="koboSpan" id="kobo.422.1"> hook to provide a library definition dynamically. </span><span class="koboSpan" id="kobo.422.2">This is not the recommended way to define a library, but it is provided for edge </span><span class="No-Break"><span class="koboSpan" id="kobo.423.1">use cases.</span></span></p>
<p><span class="koboSpan" id="kobo.424.1">Modules cannot use </span><strong class="source-inline"><span class="koboSpan" id="kobo.425.1">libraries-override</span></strong><span class="koboSpan" id="kobo.426.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.427.1">libraries-extend</span></strong><span class="koboSpan" id="kobo.428.1"> and need to rely on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.429.1">hook_library_info_alter()</span></strong><span class="koboSpan" id="kobo.430.1"> hook. </span><span class="koboSpan" id="kobo.430.2">You can read about this hook at </span><strong class="source-inline"><span class="koboSpan" id="kobo.431.1">core/lib/Drupal/Core/Render/theme.api.php</span></strong><span class="koboSpan" id="kobo.432.1"> or </span><span class="No-Break"><span class="koboSpan" id="kobo.433.1">at </span></span><a href="https://api.drupal.org/api/drupal/core!lib!Drupal!Core!Render!theme.api.php/function/hook_library_info_alter/10"><span class="No-Break"><span class="koboSpan" id="kobo.434.1">https://api.drupal.org/api/drupal/core!lib!Drupal!Core!Render!theme.api.php/function/hook_library_info_alter/10</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.435.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.436.1">Placing JavaScript in the header</span></h3>
<p><span class="koboSpan" id="kobo.437.1">By default, Drupal</span><a id="_idIndexMarker609"/><span class="koboSpan" id="kobo.438.1"> ensures that JavaScript is </span><a id="_idIndexMarker610"/><span class="koboSpan" id="kobo.439.1">placed last on the page. </span><span class="koboSpan" id="kobo.439.2">This improves the page’s load performance by allowing the critical portions of the page to load first. </span><span class="koboSpan" id="kobo.439.3">Placing JavaScript in the header is now an </span><span class="No-Break"><span class="koboSpan" id="kobo.440.1">opt-in option.</span></span></p>
<p><span class="koboSpan" id="kobo.441.1">To render a library in the header, you will need to add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.442.1">header: true</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.443.1">key-value pair:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.444.1">
js-library:
  header: true
  js:
    js/myscripts.js: {}</span></pre>
<p><span class="koboSpan" id="kobo.445.1">This will load a custom JavaScript library and its dependencies into the header of </span><span class="No-Break"><span class="koboSpan" id="kobo.446.1">a page.</span></span></p>
<h2 id="_idParaDest-303"><a id="_idTextAnchor332"/><span class="koboSpan" id="kobo.447.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.448.1">Refer to the CSS architecture for Drupal: Separate concerns </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">at </span></span><a href="https://www.drupal.org/node/1887918#separate-concerns"><span class="No-Break"><span class="koboSpan" id="kobo.450.1">https://www.drupal.org/node/1887918#separate-concerns</span></span></a></li>
<li><span class="koboSpan" id="kobo.451.1">SMACSS </span><span class="No-Break"><span class="koboSpan" id="kobo.452.1">website: </span></span><a href="http://smacss.com/"><span class="No-Break"><span class="koboSpan" id="kobo.453.1">http://smacss.com/</span></span></a></li>
</ul>
<h1 id="_idParaDest-304"><a id="_idTextAnchor333"/><span class="koboSpan" id="kobo.454.1">Using Twig templates in your theme</span></h1>
<p><span class="koboSpan" id="kobo.455.1">Drupal’s</span><a id="_idIndexMarker611"/><span class="koboSpan" id="kobo.456.1"> theming layer uses the </span><strong class="bold"><span class="koboSpan" id="kobo.457.1">Twig templating system</span></strong><span class="koboSpan" id="kobo.458.1">, a</span><a id="_idIndexMarker612"/><span class="koboSpan" id="kobo.459.1"> component from the Symfony project. </span><strong class="bold"><span class="koboSpan" id="kobo.460.1">Twig</span></strong><span class="koboSpan" id="kobo.461.1"> is a template</span><a id="_idIndexMarker613"/><span class="koboSpan" id="kobo.462.1"> language that uses a syntax similar to Django and </span><span class="No-Break"><span class="koboSpan" id="kobo.463.1">Jinja templates.</span></span></p>
<p><span class="koboSpan" id="kobo.464.1">In this recipe, we will override the default Twig template used for text inputs to provide customizations for the email form</span><a id="_idIndexMarker614"/><span class="koboSpan" id="kobo.465.1"> element. </span><span class="koboSpan" id="kobo.465.2">We will use the </span><strong class="bold"><span class="koboSpan" id="kobo.466.1">Twig syntax</span></strong><span class="koboSpan" id="kobo.467.1"> to add a new class to the input element and provide a </span><span class="No-Break"><span class="koboSpan" id="kobo.468.1">placeholder attribute.</span></span></p>
<h2 id="_idParaDest-305"><a id="_idTextAnchor334"/><span class="koboSpan" id="kobo.469.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.470.1">This recipe uses a theme created by the theme generator as done in the </span><em class="italic"><span class="koboSpan" id="kobo.471.1">Creating a custom theme to style your Drupal </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.472.1">site</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.473.1"> recipe.</span></span></p>
<h2 id="_idParaDest-306"><a id="_idTextAnchor335"/><span class="koboSpan" id="kobo.474.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.475.1">To begin, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.476.1">template/form</span></strong><span class="koboSpan" id="kobo.477.1"> directory, copy the </span><strong class="source-inline"><span class="koboSpan" id="kobo.478.1">input.html.twig</span></strong><span class="koboSpan" id="kobo.479.1"> file as </span><strong class="source-inline"><span class="koboSpan" id="kobo.480.1">input--email.html.twig</span></strong><span class="koboSpan" id="kobo.481.1">. </span><span class="koboSpan" id="kobo.481.2">The template will look like </span><span class="No-Break"><span class="koboSpan" id="kobo.482.1">the following:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.483.1">
{#</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.484.1">
/**</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.485.1">
 * @file</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.486.1">
 * Theme override for an 'input' #type form element.</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.487.1">
 *</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.488.1">
 * Available variables:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.489.1">
 * - attributes: A list of HTML attributes for the</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.490.1">
    input element.</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.491.1">
 * - children: Optional additional rendered elements.</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.492.1">
 *</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.493.1">
 * @see template_preprocess_input()</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.494.1">
 */</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.495.1">
#}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.496.1">
&lt;input{{ attributes }} /&gt;{{ children }}</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.497.1">The attributes</span><a id="_idIndexMarker615"/><span class="koboSpan" id="kobo.498.1"> variable is</span><a id="_idIndexMarker616"/><span class="koboSpan" id="kobo.499.1"> an instance of </span><strong class="source-inline"><span class="koboSpan" id="kobo.500.1">\Drupal\Core\Template\Attribute</span></strong><span class="koboSpan" id="kobo.501.1">, a value object for storing HTML </span><span class="No-Break"><span class="koboSpan" id="kobo.502.1">element attributes.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.503.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.504.1">Attribute</span></strong><span class="koboSpan" id="kobo.505.1"> class has an </span><strong class="source-inline"><span class="koboSpan" id="kobo.506.1">addClass</span></strong><span class="koboSpan" id="kobo.507.1"> method for adding new </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">class</span></strong><span class="koboSpan" id="kobo.509.1"> attribute values. </span><span class="koboSpan" id="kobo.509.2">We will use </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">addClass</span></strong><span class="koboSpan" id="kobo.511.1"> to add a new class to the </span><span class="No-Break"><span class="koboSpan" id="kobo.512.1">input element:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.513.1">
&lt;input{{ attributes.addClass('input--email') }} /&gt;{{</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.514.1">
    children }}</span></pre></li>
<li><span class="koboSpan" id="kobo.515.1">Before the preceding line, we will create a Twig variable using ternary operators to provide a default placeholder using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">setAttribute</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.517.1"> method:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.518.1">
{% set placeholder = attributes.placeholder ?</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.519.1">
  attributes.placeholder :</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.520.1">
  'email@example.com'</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.521.1">
%}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.522.1">
&lt;input{{ attributes.addClass('input--</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.523.1">
    email').setAttribute('placeholder', placeholder)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.524.1">
        }} /&gt;{{ children }}</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.525.1">This creates a new variable called </span><strong class="source-inline"><span class="koboSpan" id="kobo.526.1">placeholder</span></strong><span class="koboSpan" id="kobo.527.1"> using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.528.1">set</span></strong><span class="koboSpan" id="kobo.529.1"> operator. </span><span class="koboSpan" id="kobo.529.2">The question mark (</span><strong class="source-inline"><span class="koboSpan" id="kobo.530.1">?</span></strong><span class="koboSpan" id="kobo.531.1">) operator checks whether the placeholder property is empty in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.532.1">attributes</span></strong><span class="koboSpan" id="kobo.533.1"> object. </span><span class="koboSpan" id="kobo.533.2">If it is not empty, it uses the existing value. </span><span class="koboSpan" id="kobo.533.3">If the value is empty, it provides a </span><span class="No-Break"><span class="koboSpan" id="kobo.534.1">default value.</span></span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.535.1">Rebuild your Drupal site’s cache to rebuild your Drupal site’s </span><span class="No-Break"><span class="koboSpan" id="kobo.536.1">Twig templates:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.537.1">
php vendor/bin/drush cr</span></pre></li>
<li><span class="koboSpan" id="kobo.538.1">Assuming that you have used the standard Drupal install, go to the </span><strong class="bold"><span class="koboSpan" id="kobo.539.1">Feedback</span></strong><span class="koboSpan" id="kobo.540.1"> contact form installed at </span><strong class="source-inline"><span class="koboSpan" id="kobo.541.1">/contact/feedback</span></strong><span class="koboSpan" id="kobo.542.1"> while logged out, and review the changes to the </span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">email field:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer064">
<span class="koboSpan" id="kobo.544.1"><img alt="Figure 10.4 – HTML element source for email input" src="image/Figure_10.04_B18548.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.545.1">Figure 10.4 – HTML element source for email input</span></p>
<h2 id="_idParaDest-307"><a id="_idTextAnchor336"/><span class="koboSpan" id="kobo.546.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.547.1">Drupal’s theme </span><a id="_idIndexMarker617"/><span class="koboSpan" id="kobo.548.1">system</span><a id="_idIndexMarker618"/><span class="koboSpan" id="kobo.549.1"> is built around theme hooks and theme hook suggestions. </span><span class="koboSpan" id="kobo.549.2">When a theme hook has double underscores (</span><strong class="source-inline"><span class="koboSpan" id="kobo.550.1">__</span></strong><span class="koboSpan" id="kobo.551.1">), Drupal’s theme system understands this, and it can break apart the theme hook to find a more </span><span class="No-Break"><span class="koboSpan" id="kobo.552.1">generic template.</span></span></p>
<p><span class="koboSpan" id="kobo.553.1">The element definition of the email input element defines the </span><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">input__email</span></strong><span class="koboSpan" id="kobo.555.1"> theme hook. </span><span class="koboSpan" id="kobo.555.2">If there is no </span><strong class="source-inline"><span class="koboSpan" id="kobo.556.1">input__email</span></strong><span class="koboSpan" id="kobo.557.1"> hook implemented through a Twig template or PHP function, it will step down to just the </span><strong class="source-inline"><span class="koboSpan" id="kobo.558.1">input</span></strong><span class="koboSpan" id="kobo.559.1"> theme hook </span><span class="No-Break"><span class="koboSpan" id="kobo.560.1">and template.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.561.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.562.1">Drupal theme hooks are defined with underscores (</span><strong class="source-inline"><span class="koboSpan" id="kobo.563.1">_</span></strong><span class="koboSpan" id="kobo.564.1">), but use hyphens (</span><strong class="source-inline"><span class="koboSpan" id="kobo.565.1">-</span></strong><span class="koboSpan" id="kobo.566.1">) when used in Twig </span><span class="No-Break"><span class="koboSpan" id="kobo.567.1">template files.</span></span></p>
<p><span class="koboSpan" id="kobo.568.1">Given the email element definition provides </span><strong class="source-inline"><span class="koboSpan" id="kobo.569.1">input__email</span></strong><span class="koboSpan" id="kobo.570.1"> as its theme hook, Drupal understands this </span><span class="No-Break"><span class="koboSpan" id="kobo.571.1">as follows:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.572.1">Look for a Twig template named </span><strong class="source-inline"><span class="koboSpan" id="kobo.573.1">input--email.html.twig</span></strong><span class="koboSpan" id="kobo.574.1"> provided by a theme or a theme hook in a module that </span><span class="No-Break"><span class="koboSpan" id="kobo.575.1">defines </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.576.1">input__email</span></strong></span></li>
<li><span class="koboSpan" id="kobo.577.1">If the template is not found, look for a Twig template named </span><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">input.html.twig</span></strong><span class="koboSpan" id="kobo.579.1"> or a theme hook in a module that defines </span><span class="No-Break"><span class="koboSpan" id="kobo.580.1">the </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.581.1">input</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.582.1">Drupal utilizes theme hook suggestions for ways to allow output variations based on different conditions. </span><span class="koboSpan" id="kobo.582.2">It allows site themes to provide a more specific template for certain instances. </span><span class="koboSpan" id="kobo.582.3">Theme hook suggestions can be provided by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.583.1">hook_theme_suggestions()</span></strong><span class="koboSpan" id="kobo.584.1"> hook in a </span><strong class="source-inline"><span class="koboSpan" id="kobo.585.1">.module</span></strong><span class="koboSpan" id="kobo.586.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.587.1">.</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.588.1">theme</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.589.1"> file.</span></span></p>
<p><span class="koboSpan" id="kobo.590.1">A processor, such as Drupal’s theme layer, passes variables to Twig. </span><span class="koboSpan" id="kobo.590.2">Variables or properties of objects can be printed by wrapping the variable name in curly brackets. </span><span class="koboSpan" id="kobo.590.3">All of Drupal core’s default templates provide information in the file’s document block that details the available </span><span class="No-Break"><span class="koboSpan" id="kobo.591.1">Twig variables.</span></span></p>
<p><span class="koboSpan" id="kobo.592.1">Twig has a simplistic syntax with basic logic and functions. </span><span class="koboSpan" id="kobo.592.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">addClass</span></strong><span class="koboSpan" id="kobo.594.1"> method will take the </span><strong class="source-inline"><span class="koboSpan" id="kobo.595.1">attributes</span></strong><span class="koboSpan" id="kobo.596.1"> variable and add the class provided, in addition to the </span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">existing contents.</span></span></p>
<p><span class="koboSpan" id="kobo.598.1">When providing a </span><a id="_idIndexMarker619"/><span class="koboSpan" id="kobo.599.1">theme </span><a id="_idIndexMarker620"/><span class="koboSpan" id="kobo.600.1">hook suggestion or altering an existing template, you will need to rebuild Drupal’s cache. </span><span class="koboSpan" id="kobo.600.2">The compiled Twig template, as with PHP, is cached by Drupal so that Twig does not need to be compiled every time the template </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">is invoked.</span></span></p>
<h2 id="_idParaDest-308"><a id="_idTextAnchor337"/><span class="koboSpan" id="kobo.602.1">There’s more</span></h2>
<p><span class="koboSpan" id="kobo.603.1">We will discuss more on using Twig in the </span><span class="No-Break"><span class="koboSpan" id="kobo.604.1">following sections.</span></span></p>
<h3><span class="koboSpan" id="kobo.605.1">Debugging template file selection and hook suggestions</span></h3>
<p><span class="koboSpan" id="kobo.606.1">Debugging </span><a id="_idIndexMarker621"/><span class="koboSpan" id="kobo.607.1">can be enabled to inspect the various</span><a id="_idIndexMarker622"/><span class="koboSpan" id="kobo.608.1"> template files that make up a page and their theme hook suggestions, and check which are active. </span><span class="koboSpan" id="kobo.608.2">This can be accomplished by editing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.609.1">sites/default/services.yml</span></strong><span class="koboSpan" id="kobo.610.1"> file. </span><span class="koboSpan" id="kobo.610.2">If a </span><strong class="source-inline"><span class="koboSpan" id="kobo.611.1">services.yml</span></strong><span class="koboSpan" id="kobo.612.1"> file does not exist, copy </span><strong class="source-inline"><span class="koboSpan" id="kobo.613.1">default.services.yml</span></strong><span class="koboSpan" id="kobo.614.1"> to </span><span class="No-Break"><span class="koboSpan" id="kobo.615.1">create one.</span></span></p>
<p><span class="koboSpan" id="kobo.616.1">You need to change </span><strong class="source-inline"><span class="koboSpan" id="kobo.617.1">debug: false</span></strong><span class="koboSpan" id="kobo.618.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.619.1">debug: true</span></strong><span class="koboSpan" id="kobo.620.1"> under the </span><strong class="source-inline"><span class="koboSpan" id="kobo.621.1">twig.config</span></strong><span class="koboSpan" id="kobo.622.1"> section of the file. </span><span class="koboSpan" id="kobo.622.2">This will cause the Drupal theming layer to print out the source code comments that contain the template information. </span><span class="koboSpan" id="kobo.622.3">When </span><strong class="source-inline"><span class="koboSpan" id="kobo.623.1">debug</span></strong><span class="koboSpan" id="kobo.624.1"> is on, Drupal will not cache the compiled versions of Twig templates and render them on </span><span class="No-Break"><span class="koboSpan" id="kobo.625.1">the fly.</span></span></p>
<p><span class="koboSpan" id="kobo.626.1">There is another setting that prevents you from having to rebuild Drupal’s cache on each template file change without leaving </span><strong class="source-inline"><span class="koboSpan" id="kobo.627.1">debug</span></strong><span class="koboSpan" id="kobo.628.1"> enabled. </span><span class="koboSpan" id="kobo.628.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.629.1">twig.config.auto_reload</span></strong><span class="koboSpan" id="kobo.630.1"> Boolean can be set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.631.1">true</span></strong><span class="koboSpan" id="kobo.632.1">. </span><span class="koboSpan" id="kobo.632.2">If this is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">true</span></strong><span class="koboSpan" id="kobo.634.1">, the Twig </span><a id="_idIndexMarker623"/><span class="koboSpan" id="kobo.635.1">templates</span><a id="_idIndexMarker624"/><span class="koboSpan" id="kobo.636.1"> will be recompiled if the source </span><span class="No-Break"><span class="koboSpan" id="kobo.637.1">code changes.</span></span></p>
<h2 id="_idParaDest-309"><a id="_idTextAnchor338"/><span class="koboSpan" id="kobo.638.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.639.1">Refer to the Twig documentation </span><span class="No-Break"><span class="koboSpan" id="kobo.640.1">at </span></span><a href="https://twig.symfony.com/"><span class="No-Break"><span class="koboSpan" id="kobo.641.1">https://twig.symfony.com/</span></span></a></li>
<li><span class="koboSpan" id="kobo.642.1">Refer to the API documentation for </span><strong class="source-inline"><span class="koboSpan" id="kobo.643.1">hook_theme_suggestions</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.644.1">at </span></span><a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Render%21theme.api.php/function/hook_theme_suggestions_HOOK/10"><span class="No-Break"><span class="koboSpan" id="kobo.645.1">https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Render%21theme.api.php/function/hook_theme_suggestions_HOOK/10</span></span></a></li>
</ul>
<h1 id="_idParaDest-310"><a id="_idTextAnchor339"/><span class="koboSpan" id="kobo.646.1">Delivering responsive images</span></h1>
<p><span class="koboSpan" id="kobo.647.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.648.1">Responsive Image</span></strong><span class="koboSpan" id="kobo.649.1"> module </span><a id="_idIndexMarker625"/><span class="koboSpan" id="kobo.650.1">provides a field formatter for image fields that use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.651.1">HTML5</span></strong><span class="koboSpan" id="kobo.652.1"> picture tag and source sets. </span><span class="koboSpan" id="kobo.652.2">Utilizing the </span><strong class="bold"><span class="koboSpan" id="kobo.653.1">Breakpoint</span></strong><span class="koboSpan" id="kobo.654.1"> module, mappings</span><a id="_idIndexMarker626"/><span class="koboSpan" id="kobo.655.1"> to breakpoints are made to denote an image style to be used at each breakpoint. </span><span class="koboSpan" id="kobo.655.2">The responsive image field formatter works by using a defined responsive image style. </span><span class="koboSpan" id="kobo.655.3">Responsive image styles are configurations that map image formats to specific breakpoints and modifiers. </span><span class="koboSpan" id="kobo.655.4">First, you will need to define a responsive image style, and then you can apply it to an </span><span class="No-Break"><span class="koboSpan" id="kobo.656.1">image field.</span></span></p>
<p><span class="koboSpan" id="kobo.657.1">In this recipe, we will create a responsive image style set called </span><strong class="bold"><span class="koboSpan" id="kobo.658.1">Article image</span></strong><span class="koboSpan" id="kobo.659.1"> and apply it to the </span><strong class="bold"><span class="koboSpan" id="kobo.660.1">Article</span></strong><span class="koboSpan" id="kobo.661.1"> content type’s </span><span class="No-Break"><span class="koboSpan" id="kobo.662.1">image field.</span></span></p>
<h2 id="_idParaDest-311"><a id="_idTextAnchor340"/><span class="koboSpan" id="kobo.663.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.664.1">First, you need to install the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.665.1">responsive_image</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.666.1"> module:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.667.1">
php vendor/bin/drush en responsive_image -y</span></pre></li>
<li><span class="koboSpan" id="kobo.668.1">From the administrative toolbar, go to </span><strong class="bold"><span class="koboSpan" id="kobo.669.1">Configuration</span></strong><span class="koboSpan" id="kobo.670.1"> and then to </span><strong class="bold"><span class="koboSpan" id="kobo.671.1">Responsive image styles</span></strong><span class="koboSpan" id="kobo.672.1"> under the </span><strong class="bold"><span class="koboSpan" id="kobo.673.1">MEDIA</span></strong><span class="koboSpan" id="kobo.674.1"> section. </span><span class="koboSpan" id="kobo.674.2">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.675.1">Add responsive image style</span></strong><span class="koboSpan" id="kobo.676.1"> to create a new </span><span class="No-Break"><span class="koboSpan" id="kobo.677.1">style set.</span></span></li>
<li><span class="koboSpan" id="kobo.678.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.679.1">Olivero</span></strong><span class="koboSpan" id="kobo.680.1"> from </span><a id="_idIndexMarker627"/><span class="koboSpan" id="kobo.681.1">the </span><strong class="bold"><span class="koboSpan" id="kobo.682.1">Breakpoint group</span></strong><span class="koboSpan" id="kobo.683.1"> select list to use the breakpoints defined by the </span><span class="No-Break"><span class="koboSpan" id="kobo.684.1">Olivero theme.</span></span></li>
<li><span class="koboSpan" id="kobo.685.1">Each breakpoint will be grouped by a fieldset. </span><span class="koboSpan" id="kobo.685.2">Expand the fieldset, choose </span><strong class="bold"><span class="koboSpan" id="kobo.686.1">Select a single image style.</span></strong><span class="koboSpan" id="kobo.687.1">, and then pick an appropriate </span><strong class="bold"><span class="koboSpan" id="kobo.688.1">Image </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.689.1">style</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.690.1"> option:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer065">
<span class="koboSpan" id="kobo.691.1"><img alt="Figure 10.5 – Responsive image style form" src="image/Figure_10.05_B18548.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.692.1">Figure 10.5 – Responsive image style form</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.693.1">Additionally, choose</span><a id="_idIndexMarker628"/><span class="koboSpan" id="kobo.694.1"> a </span><strong class="bold"><span class="koboSpan" id="kobo.695.1">Fallback image style</span></strong><span class="koboSpan" id="kobo.696.1"> option in the event of a browser that doesn’t support source sets or an </span><span class="No-Break"><span class="koboSpan" id="kobo.697.1">error occurring.</span></span></li>
<li><span class="koboSpan" id="kobo.698.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.699.1">Save</span></strong><span class="koboSpan" id="kobo.700.1"> to save the configuration, and add the new </span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">style set.</span></span></li>
<li><span class="koboSpan" id="kobo.702.1">Go to </span><strong class="bold"><span class="koboSpan" id="kobo.703.1">Structure</span></strong><span class="koboSpan" id="kobo.704.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.705.1">Content types</span></strong><span class="koboSpan" id="kobo.706.1"> and select </span><strong class="bold"><span class="koboSpan" id="kobo.707.1">Manage Display</span></strong><span class="koboSpan" id="kobo.708.1"> from the </span><strong class="bold"><span class="koboSpan" id="kobo.709.1">Article</span></strong><span class="koboSpan" id="kobo.710.1"> content type’s </span><span class="No-Break"><span class="koboSpan" id="kobo.711.1">drop-down menu.</span></span></li>
<li><span class="koboSpan" id="kobo.712.1">Change the </span><strong class="bold"><span class="koboSpan" id="kobo.713.1">Image</span></strong><span class="koboSpan" id="kobo.714.1"> field’s formatter to </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.715.1">Responsive image</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.716.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.717.1">Click on the </span><strong class="bold"><span class="koboSpan" id="kobo.718.1">Settings</span></strong><span class="koboSpan" id="kobo.719.1"> cog of the field formatter to choose your new </span><strong class="bold"><span class="koboSpan" id="kobo.720.1">Responsive</span></strong><strong class="bold"><span class="koboSpan" id="kobo.721.1"> image style</span></strong><span class="koboSpan" id="kobo.722.1"> set. </span><span class="koboSpan" id="kobo.722.2">Select </span><strong class="bold"><span class="koboSpan" id="kobo.723.1">Article image</span></strong><span class="koboSpan" id="kobo.724.1"> from</span><a id="_idIndexMarker629"/><span class="koboSpan" id="kobo.725.1"> the </span><strong class="bold"><span class="koboSpan" id="kobo.726.1">Responsive image </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.727.1">style</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.728.1"> dropdown:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer066">
<span class="koboSpan" id="kobo.729.1"><img alt="Figure 10.6 – Responsive image style configuration form" src="image/Figure_10.06_B18548.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.730.1">Figure 10.6 – Responsive image style configuration form</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.731.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.732.1">Update</span></strong><span class="koboSpan" id="kobo.733.1"> to save the field formatter settings, and then click on </span><strong class="bold"><span class="koboSpan" id="kobo.734.1">Save</span></strong><span class="koboSpan" id="kobo.735.1"> to save the field </span><span class="No-Break"><span class="koboSpan" id="kobo.736.1">display settings.</span></span></li>
</ol>
<h2 id="_idParaDest-312"><a id="_idTextAnchor341"/><span class="koboSpan" id="kobo.737.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.738.1">A benefit of using the responsive image formatter is its performance. </span><span class="koboSpan" id="kobo.738.2">Browsers will only download the resources defined in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.739.1">srcset</span></strong><span class="koboSpan" id="kobo.740.1"> of the appropriate </span><strong class="source-inline"><span class="koboSpan" id="kobo.741.1">source</span></strong><span class="koboSpan" id="kobo.742.1"> tag. </span><span class="koboSpan" id="kobo.742.2">This not only allows you to deliver a more appropriate image size but also carries a smaller payload on </span><span class="No-Break"><span class="koboSpan" id="kobo.743.1">smaller devices.</span></span></p>
<p><span class="koboSpan" id="kobo.744.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.745.1">Responsive image</span></strong><span class="koboSpan" id="kobo.746.1"> style provides </span><span class="No-Break"><span class="koboSpan" id="kobo.747.1">three components:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.748.1">A responsive </span><span class="No-Break"><span class="koboSpan" id="kobo.749.1">image element</span></span></li>
<li><span class="koboSpan" id="kobo.750.1">The responsive image style </span><span class="No-Break"><span class="koboSpan" id="kobo.751.1">configuration entity</span></span></li>
<li><span class="koboSpan" id="kobo.752.1">The responsive image </span><span class="No-Break"><span class="koboSpan" id="kobo.753.1">field formatter</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.754.1">The configuration entity is consumed by the field formatter and displayed through the responsive </span><span class="No-Break"><span class="koboSpan" id="kobo.755.1">image element.</span></span></p>
<p><span class="koboSpan" id="kobo.756.1">The responsive image style entity contains an array of breakpoints to image style mappings. </span><span class="koboSpan" id="kobo.756.2">The available breakpoints are defined by the selected breakpoint groups. </span><span class="koboSpan" id="kobo.756.3">Breakpoint groups can be changed anytime; however, the previous mappings will </span><span class="No-Break"><span class="koboSpan" id="kobo.757.1">be lost.</span></span></p>
<p><span class="koboSpan" id="kobo.758.1">The responsive image element prints a picture element with each breakpoint, defining a new source </span><a id="_idIndexMarker630"/><span class="koboSpan" id="kobo.759.1">element. </span><span class="koboSpan" id="kobo.759.2">The breakpoint’s media query value is provided as the media attribute for </span><span class="No-Break"><span class="koboSpan" id="kobo.760.1">the element.</span></span></p>
<h2 id="_idParaDest-313"><a id="_idTextAnchor342"/><span class="koboSpan" id="kobo.761.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.762.1">Refer to the picture</span><a id="_idIndexMarker631"/><span class="koboSpan" id="kobo.763.1"> element on the </span><strong class="bold"><span class="koboSpan" id="kobo.764.1">Mozilla Developer Network</span></strong><span class="koboSpan" id="kobo.765.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.766.1">MDN</span></strong><span class="koboSpan" id="kobo.767.1">) </span><span class="No-Break"><span class="koboSpan" id="kobo.768.1">at </span></span><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture"><span class="No-Break"><span class="koboSpan" id="kobo.769.1">https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture</span></span></a></li>
</ul>
<h1 id="_idParaDest-314"><a id="_idTextAnchor343"/><span class="koboSpan" id="kobo.770.1">Compiling CSS and JavaScript pre- and post-processors with Laravel Mix</span></h1>
<p><strong class="bold"><span class="koboSpan" id="kobo.771.1">Laravel Mix</span></strong><span class="koboSpan" id="kobo.772.1"> is a</span><a id="_idIndexMarker632"/><span class="koboSpan" id="kobo.773.1"> project that</span><a id="_idIndexMarker633"/><span class="koboSpan" id="kobo.774.1"> streamlines </span><a id="_idIndexMarker634"/><span class="koboSpan" id="kobo.775.1">configuring </span><a id="_idIndexMarker635"/><span class="koboSpan" id="kobo.776.1">Webpack, a bundler for frontend development. </span><span class="koboSpan" id="kobo.776.2">Laravel Mix was originally built to be used with Laravel projects but can be used for any project that bundles JavaScript or CSS pre- </span><span class="No-Break"><span class="koboSpan" id="kobo.777.1">and post-processing.</span></span></p>
<p><span class="koboSpan" id="kobo.778.1">In this recipe, we will add Laravel Mix to our theme for transpiling our ES6 JavaScript and PostCSS to post-process our CSS based on the desired </span><span class="No-Break"><span class="koboSpan" id="kobo.779.1">browser support.</span></span></p>
<h2 id="_idParaDest-315"><a id="_idTextAnchor344"/><span class="koboSpan" id="kobo.780.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.781.1">The </span><em class="italic"><span class="koboSpan" id="kobo.782.1">Adding CSS and JavaScript to your theme</span></em><span class="koboSpan" id="kobo.783.1"> recipe from this chapter covers how to create asset libraries for your theme. </span><span class="koboSpan" id="kobo.783.2">This section will use information from </span><span class="No-Break"><span class="koboSpan" id="kobo.784.1">that recipe.</span></span></p>
<h2 id="_idParaDest-316"><a id="_idTextAnchor345"/><span class="koboSpan" id="kobo.785.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.786.1">First, create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.787.1">src</span></strong><span class="koboSpan" id="kobo.788.1"> directory in your theme to store source files for your CSS and JavaScript that will be processed </span><span class="No-Break"><span class="koboSpan" id="kobo.789.1">by Webpack:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.790.1">
mkdir src</span></pre></li>
<li><span class="koboSpan" id="kobo.791.1">Next, create </span><a id="_idIndexMarker636"/><span class="koboSpan" id="kobo.792.1">a </span><strong class="source-inline"><span class="koboSpan" id="kobo.793.1">styles.css</span></strong><span class="koboSpan" id="kobo.794.1"> file</span><a id="_idIndexMarker637"/><span class="koboSpan" id="kobo.795.1"> in </span><a id="_idIndexMarker638"/><span class="koboSpan" id="kobo.796.1">the </span><strong class="source-inline"><span class="koboSpan" id="kobo.797.1">src</span></strong><span class="koboSpan" id="kobo.798.1"> directory </span><a id="_idIndexMarker639"/><span class="koboSpan" id="kobo.799.1">with </span><span class="No-Break"><span class="koboSpan" id="kobo.800.1">the following:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.801.1">
:root {</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.802.1">
  --text-color: rgb(43, 43, 43);</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.803.1">
}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.804.1">
body {</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.805.1">
  color: var(--text-color);</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.806.1">
}</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.807.1">This CSS file uses CSS variables. </span><span class="koboSpan" id="kobo.807.2">While commonly supported now, </span><strong class="source-inline"><span class="koboSpan" id="kobo.808.1">PostCSS</span></strong><span class="koboSpan" id="kobo.809.1"> will ensure backward compatibility in the post-processed </span><span class="No-Break"><span class="koboSpan" id="kobo.810.1">CSS stylesheet.</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.811.1">Then, create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.812.1">scripts.js</span></strong><span class="koboSpan" id="kobo.813.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.814.1">src</span></strong><span class="koboSpan" id="kobo.815.1"> directory with </span><span class="No-Break"><span class="koboSpan" id="kobo.816.1">the following:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.817.1">
(function(Drupal) {</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.818.1">
  Drupal.behaviors.myTheme = {</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.819.1">
    attach() {</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.820.1">
      console.log('Hello world!')</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.821.1">
    }</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.822.1">
  }</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.823.1">
})(Drupal);</span></pre></li>
<li><span class="koboSpan" id="kobo.824.1">Now, we will get ready to install Laravel Mix. </span><span class="koboSpan" id="kobo.824.2">In your theme’s directory, use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.825.1">npm init</span></strong><span class="koboSpan" id="kobo.826.1"> command to initialize </span><span class="No-Break"><span class="koboSpan" id="kobo.827.1">a project:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.828.1">
npm init -y</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.829.1">This creates a </span><strong class="source-inline"><span class="koboSpan" id="kobo.830.1">package.json</span></strong><span class="koboSpan" id="kobo.831.1"> file, which stores dependency information for projects </span><span class="No-Break"><span class="koboSpan" id="kobo.832.1">using npm.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.833.1">Use </span><strong class="source-inline"><span class="koboSpan" id="kobo.834.1">npm install</span></strong><span class="koboSpan" id="kobo.835.1"> to install </span><span class="No-Break"><span class="koboSpan" id="kobo.836.1">Laravel Mix:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.837.1">
npm install laravel-mix --save-dev</span></pre></li>
<li><span class="koboSpan" id="kobo.838.1">We also need to install </span><strong class="source-inline"><span class="koboSpan" id="kobo.839.1">postcss-present-env</span></strong><span class="koboSpan" id="kobo.840.1"> to ensure our CSS is post-processed to be compatible with </span><span class="No-Break"><span class="koboSpan" id="kobo.841.1">all browsers:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.842.1">
npm install postcss-preset-env --save-dev</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.843.1">Laravel </span><a id="_idIndexMarker640"/><span class="koboSpan" id="kobo.844.1">Mix </span><a id="_idIndexMarker641"/><span class="koboSpan" id="kobo.845.1">comes bundled</span><a id="_idIndexMarker642"/><span class="koboSpan" id="kobo.846.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.847.1">@babel/preset-env</span></strong><span class="koboSpan" id="kobo.848.1">, which </span><a id="_idIndexMarker643"/><span class="koboSpan" id="kobo.849.1">ensures browser compatibility </span><span class="No-Break"><span class="koboSpan" id="kobo.850.1">with JavaScript.</span></span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.851.1">Now that we have Laravel Mix, we must configure it. </span><span class="koboSpan" id="kobo.851.2">Create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.852.1">webpack.mix.js</span></strong><span class="koboSpan" id="kobo.853.1"> file in your theme’s directory with the </span><span class="No-Break"><span class="koboSpan" id="kobo.854.1">following configuration:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.855.1">
let mix = require('laravel-mix');</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.856.1">
mix.js('src/scripts.js', 'dist/');</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.857.1">
mix.css('src/styles.css', 'dist/', [</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.858.1">
  require('postcss-preset-env')</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.859.1">
]);</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.860.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.861.1">js</span></strong><span class="koboSpan" id="kobo.862.1"> method on </span><strong class="source-inline"><span class="koboSpan" id="kobo.863.1">mix</span></strong><span class="koboSpan" id="kobo.864.1"> sets up JavaScript bundling and transpiling with Webpack. </span><span class="koboSpan" id="kobo.864.2">The first argument is the source file and the second argument is the destination. </span><span class="koboSpan" id="kobo.864.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.865.1">css</span></strong><span class="koboSpan" id="kobo.866.1"> method on </span><strong class="source-inline"><span class="koboSpan" id="kobo.867.1">mix</span></strong><span class="koboSpan" id="kobo.868.1"> sets up PostCSS. </span><span class="koboSpan" id="kobo.868.2">The first argument is the source file and the second argument is the destination. </span><span class="koboSpan" id="kobo.868.3">The third argument passes additional plugins </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">to PostCSS.</span></span></p>
<ol>
<li value="8"><span class="koboSpan" id="kobo.870.1">To compile our CSS and JavaScript files, run </span><strong class="source-inline"><span class="koboSpan" id="kobo.871.1">npx mix</span></strong><span class="koboSpan" id="kobo.872.1">. </span><span class="koboSpan" id="kobo.872.2">This will create </span><strong class="source-inline"><span class="koboSpan" id="kobo.873.1">dist/styles.css</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.874.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.875.1">dist/scripts.js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.876.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.877.1">
npx mix</span></pre></li>
<li><span class="koboSpan" id="kobo.878.1">Now, we need to create our theme’s</span><a id="_idIndexMarker644"/><span class="koboSpan" id="kobo.879.1"> library, which registers our CSS and JavaScript </span><a id="_idIndexMarker645"/><span class="koboSpan" id="kobo.880.1">files</span><a id="_idIndexMarker646"/><span class="koboSpan" id="kobo.881.1"> from</span><a id="_idIndexMarker647"/><span class="koboSpan" id="kobo.882.1"> the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.883.1">dist</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.884.1"> directory:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.885.1">
theme-styling:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.886.1">
  version: VERSION</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.887.1">
  css:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.888.1">
    theme:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.889.1">
      dist/styles.css: {}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.890.1">
  js:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.891.1">
    dist/scripts.js: {}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.892.1">
  dependencies:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.893.1">
    - core/drupal</span></pre></li>
<li><span class="koboSpan" id="kobo.894.1">Edit </span><strong class="source-inline"><span class="koboSpan" id="kobo.895.1">mytheme.info.yml</span></strong><span class="koboSpan" id="kobo.896.1"> to add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.897.1">theme-styling</span></strong><span class="koboSpan" id="kobo.898.1"> library to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.899.1">libraries</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.900.1"> key:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.901.1">
name: 'My theme'</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.902.1">
type: theme</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.903.1">
'base theme': stable9</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.904.1">
starterkit: true</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.905.1">
libraries:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.906.1">
  - mytheme/theme-styling</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.907.1">
  - mytheme/base</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.908.1">
  - mytheme/messages</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.909.1">
  - core/normalize</span></pre></li>
<li><span class="koboSpan" id="kobo.910.1">Rebuild your Drupal site’s cache to rebuild the library definitions cache, triggering a rediscovery of the library definitions and </span><span class="No-Break"><span class="koboSpan" id="kobo.911.1">theme information:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.912.1">
php vendor/bin/drush cr</span></pre></li>
<li><span class="koboSpan" id="kobo.913.1">Your CSS and JavaScript files are now registered and will allow you to write the latest in CSS and JavaScript while preserving </span><span class="No-Break"><span class="koboSpan" id="kobo.914.1">browser compatibility.</span></span></li>
</ol>
<h2 id="_idParaDest-317"><a id="_idTextAnchor346"/><span class="koboSpan" id="kobo.915.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.916.1">Laravel Mix is a package to simplify configuring Webpack. </span><span class="koboSpan" id="kobo.916.2">When running </span><strong class="source-inline"><span class="koboSpan" id="kobo.917.1">npx mix</span></strong><span class="koboSpan" id="kobo.918.1">, this runs the scripts for </span><a id="_idIndexMarker648"/><span class="koboSpan" id="kobo.919.1">Laravel</span><a id="_idIndexMarker649"/><span class="koboSpan" id="kobo.920.1"> Mix. </span><span class="koboSpan" id="kobo.920.2">Laravel </span><a id="_idIndexMarker650"/><span class="koboSpan" id="kobo.921.1">Mix</span><a id="_idIndexMarker651"/><span class="koboSpan" id="kobo.922.1"> reads </span><strong class="source-inline"><span class="koboSpan" id="kobo.923.1">webpack.mix.js</span></strong><span class="koboSpan" id="kobo.924.1">, builds a Webpack configuration, and executes Webpack on </span><span class="No-Break"><span class="koboSpan" id="kobo.925.1">your behalf.</span></span></p>
<h2 id="_idParaDest-318"><a id="_idTextAnchor347"/><span class="koboSpan" id="kobo.926.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.927.1">Laravel Mix </span><span class="No-Break"><span class="koboSpan" id="kobo.928.1">documentation: </span></span><a href="https://laravel-mix.com/docs"><span class="No-Break"><span class="koboSpan" id="kobo.929.1">https://laravel-mix.com/docs</span></span></a></li>
</ul>
<h1 id="_idParaDest-319"><a id="_idTextAnchor348"/><span class="koboSpan" id="kobo.930.1">Using Laravel Mix to theme your Drupal site with live reloading</span></h1>
<p><span class="koboSpan" id="kobo.931.1">In the</span><a id="_idIndexMarker652"/><span class="koboSpan" id="kobo.932.1"> previous </span><a id="_idIndexMarker653"/><span class="koboSpan" id="kobo.933.1">recipe, </span><em class="italic"><span class="koboSpan" id="kobo.934.1">Compiling CSS and JavaScript pre and post processors with Laravel Mix</span></em><span class="koboSpan" id="kobo.935.1">, we set up Laravel Mix for a theme. </span><span class="koboSpan" id="kobo.935.2">Laravel Mix supports </span><strong class="source-inline"><span class="koboSpan" id="kobo.936.1">Browsersync</span></strong><span class="koboSpan" id="kobo.937.1">. </span><strong class="source-inline"><span class="koboSpan" id="kobo.938.1">Browsersync</span></strong><span class="koboSpan" id="kobo.939.1"> is a tool that monitors changes in your source files and injects the changes into the browser so that you do not need to refresh the </span><span class="No-Break"><span class="koboSpan" id="kobo.940.1">page manually.</span></span></p>
<p><span class="koboSpan" id="kobo.941.1">In this recipe, we will leverage the </span><strong class="source-inline"><span class="koboSpan" id="kobo.942.1">BrowserSync</span></strong><span class="koboSpan" id="kobo.943.1"> functionality to speed up the development of building your </span><span class="No-Break"><span class="koboSpan" id="kobo.944.1">Drupal theme.</span></span></p>
<h2 id="_idParaDest-320"><a id="_idTextAnchor349"/><span class="koboSpan" id="kobo.945.1">Getting started</span></h2>
<p><span class="koboSpan" id="kobo.946.1">Make sure that aggregation of CSS and JavaScript files is disabled by visiting the </span><strong class="bold"><span class="koboSpan" id="kobo.947.1">Performance</span></strong><span class="koboSpan" id="kobo.948.1"> configuration form </span><span class="No-Break"><span class="koboSpan" id="kobo.949.1">at </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.950.1">/admin/config/development/performance</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.951.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.952.1">Alternatively, you can add the following configuration override to your </span><strong class="source-inline"><span class="koboSpan" id="kobo.953.1">settings.php</span></strong><span class="koboSpan" id="kobo.954.1"> to </span><span class="No-Break"><span class="koboSpan" id="kobo.955.1">force-disable aggregation:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.956.1">
$config['system.performance']['css']['preprocess'] = FALSE;
$config['system.performance']['js']['preprocess'] = FALSE;</span></pre>
<p><span class="koboSpan" id="kobo.957.1">This is also set up by default with </span><strong class="source-inline"><span class="koboSpan" id="kobo.958.1">example.settings.local.php</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.959.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.960.1">sites/default</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.961.1">.</span></span></p>
<h2 id="_idParaDest-321"><a id="_idTextAnchor350"/><span class="koboSpan" id="kobo.962.1">How to do it…</span></h2>
<ol>
<li value="1"><span class="koboSpan" id="kobo.963.1">To configure Browsersync with Laravel Mix, we call the </span><strong class="source-inline"><span class="koboSpan" id="kobo.964.1">browserSync</span></strong><span class="koboSpan" id="kobo.965.1"> method </span><span class="No-Break"><span class="koboSpan" id="kobo.966.1">on </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.967.1">mix</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.968.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.969.1">
let mix = require('laravel-mix');</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.970.1">
mix.js('src/scripts.js', 'dist/');</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.971.1">
mix.css('src/styles.css', 'dist/', [</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.972.1">
  require('postcss-preset-env')</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.973.1">
]);</span></pre><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.974.1">mix.browserSync();</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.975.1">Before configuring Browsersync, we need Laravel Mix to download the additional Webpack dependencies for Browsersync. </span><span class="koboSpan" id="kobo.975.2">Laravel Mix does this automatically when run and </span><span class="No-Break"><span class="koboSpan" id="kobo.976.1">first configured:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.977.1">
npx mix</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.978.1">You will see a message similar to the following: </span><em class="italic"><span class="koboSpan" id="kobo.979.1">Additional dependencies must be installed. </span><span class="koboSpan" id="kobo.979.2">This will only take </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.980.1">a moment.</span></em></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.981.1">We need to specify the URL of our Drupal site for </span><strong class="source-inline"><span class="koboSpan" id="kobo.982.1">Browsersync</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.983.1">to proxy:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.984.1">
mix.browserSync({</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.985.1">
  proxy: 'mysite.ddev.site:80'</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.986.1">
});</span></pre></li>
</ol>
<p><strong class="bold"><span class="koboSpan" id="kobo.987.1">Browsersync</span></strong><span class="koboSpan" id="kobo.988.1"> launches </span><a id="_idIndexMarker654"/><span class="koboSpan" id="kobo.989.1">on </span><strong class="source-inline"><span class="koboSpan" id="kobo.990.1">localhost:3000</span></strong><span class="koboSpan" id="kobo.991.1"> and will proxy content from the </span><a id="_idIndexMarker655"/><span class="koboSpan" id="kobo.992.1">Drupal </span><a id="_idIndexMarker656"/><span class="koboSpan" id="kobo.993.1">site at the URL provided. </span><span class="koboSpan" id="kobo.993.2">Replace </span><strong class="source-inline"><span class="koboSpan" id="kobo.994.1">mysite.ddev.site</span></strong><span class="koboSpan" id="kobo.995.1"> with the domain of your </span><span class="No-Break"><span class="koboSpan" id="kobo.996.1">Drupal site.</span></span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.997.1">Next, we need to specify which files should be watched by Browsersync to inject updates into the browser by providing a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.998.1">files</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.999.1"> option:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1000.1">
mix.browserSync({</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1001.1">
  proxy: 'mysite.ddev.site:80',</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1002.1">
  files: [</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1003.1">
    'dist/styles.css',</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1004.1">
    'dist/scripts.js',</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1005.1">
  ]</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1006.1">
});</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1007.1">This tells Browsersync to react to changes to our compiled assets, which are the ones added to </span><span class="No-Break"><span class="koboSpan" id="kobo.1008.1">the page.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.1009.1">Finally, we need to run Laravel Mix in development mode to watch for changes. </span><span class="koboSpan" id="kobo.1009.2">This will open a browser that uses Browsersync and will update as files </span><span class="No-Break"><span class="koboSpan" id="kobo.1010.1">are changed:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1011.1">
npx mix watch</span></pre></li>
<li><span class="koboSpan" id="kobo.1012.1">With your browser now open, modify </span><strong class="source-inline"><span class="koboSpan" id="kobo.1013.1">src/styles.css</span></strong><span class="koboSpan" id="kobo.1014.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.1015.1">src/scripts.js</span></strong><span class="koboSpan" id="kobo.1016.1"> and watch your Drupal site’s theme update without having to refresh </span><span class="No-Break"><span class="koboSpan" id="kobo.1017.1">the page.</span></span></li>
</ol>
<h2 id="_idParaDest-322"><a id="_idTextAnchor351"/><span class="koboSpan" id="kobo.1018.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.1019.1">It can be cumbersome to configure and gather all of the necessary plugins for Webpack. </span><span class="koboSpan" id="kobo.1019.2">Laravel Mix provides a way to configure Webpack easily across any project. </span><span class="koboSpan" id="kobo.1019.3">Laravel Mix supports bundling JavaScript for Vue, React, and Preact. </span><span class="koboSpan" id="kobo.1019.4">It also has built-in support for Sass and Less, along </span><a id="_idIndexMarker657"/><span class="koboSpan" id="kobo.1020.1">with PostCSS. </span><span class="koboSpan" id="kobo.1020.2">All</span><a id="_idIndexMarker658"/><span class="koboSpan" id="kobo.1021.1"> of these options can be found in the API documentation for Laravel Mix </span><span class="No-Break"><span class="koboSpan" id="kobo.1022.1">at </span></span><a href="https://laravel-mix.com/docs/6.0/api"><span class="No-Break"><span class="koboSpan" id="kobo.1023.1">https://laravel-mix.com/docs/6.0/api</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1024.1">.</span></span></p>
<h2 id="_idParaDest-323"><a id="_idTextAnchor352"/><span class="koboSpan" id="kobo.1025.1">There’s more</span></h2>
<p><span class="koboSpan" id="kobo.1026.1">Browsersync can be used for more than just watching changes to your CSS and </span><span class="No-Break"><span class="koboSpan" id="kobo.1027.1">JavaScript files.</span></span></p>
<h3><span class="koboSpan" id="kobo.1028.1">Watching changes to Twig templates</span></h3>
<p><span class="koboSpan" id="kobo.1029.1">Browsersync</span><a id="_idIndexMarker659"/><span class="koboSpan" id="kobo.1030.1"> can also be configured to watch for changes in Twig files as well so that your browser updates when Twig templates are modified. </span><span class="koboSpan" id="kobo.1030.2">To watch for changes to Twig templates, add </span><strong class="source-inline"><span class="koboSpan" id="kobo.1031.1">templates/**/*</span></strong><span class="koboSpan" id="kobo.1032.1"> to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1033.1">files</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1034.1"> option:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1035.1">
mix.browserSync({
  proxy: 'mysite.ddev.site:80',
  files: [
    'dist/styles.css',
    'dist/scripts.js',
    'templates/**/*'
  ]
});</span></pre>
<p><span class="koboSpan" id="kobo.1036.1">Whenever you modify a Twig template for your theme, Browsersync will refresh the page </span><span class="No-Break"><span class="koboSpan" id="kobo.1037.1">for you.</span></span></p>
<p><span class="koboSpan" id="kobo.1038.1">For the best results, you will want to turn on Twig debugging by ensuring you have a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1039.1">sites/default/services.yml</span></strong><span class="koboSpan" id="kobo.1040.1"> file with </span><span class="No-Break"><span class="koboSpan" id="kobo.1041.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1042.1">
  twig.config:
    debug: true
    auto_reload: null
    cache: true</span></pre>
<p><span class="koboSpan" id="kobo.1043.1">This will ensure </span><a id="_idIndexMarker660"/><span class="koboSpan" id="kobo.1044.1">your Twig templates are rebuilt whenever they are modified. </span><span class="koboSpan" id="kobo.1044.2">This is covered in the </span><em class="italic"><span class="koboSpan" id="kobo.1045.1">Using Twig templates in your theme</span></em><span class="koboSpan" id="kobo.1046.1"> recipe and the </span><em class="italic"><span class="koboSpan" id="kobo.1047.1">There’s more</span></em><span class="koboSpan" id="kobo.1048.1"> section under </span><em class="italic"><span class="koboSpan" id="kobo.1049.1">Debugging template file selection and </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1050.1">hook suggestions</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1051.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1052.1">You will also need to bypass Drupal’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.1053.1">render</span></strong><span class="koboSpan" id="kobo.1054.1"> cache, which could cause stale output. </span><span class="koboSpan" id="kobo.1054.2">Ensure </span><strong class="source-inline"><span class="koboSpan" id="kobo.1055.1">settings.php</span></strong><span class="koboSpan" id="kobo.1056.1"> has the following lines, which can also be found </span><span class="No-Break"><span class="koboSpan" id="kobo.1057.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1058.1">example.settings.local.php</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1059.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1060.1">
$settings['container_yamls'][] = DRUPAL_ROOT . </span><span class="koboSpan" id="kobo.1060.2">'/sites/
development.services.yml';
$settings['cache']['bins']['render'] = 'cache.backend.null';
$settings['cache']['bins']['page'] = 'cache.backend.null';
$settings['cache']['bins']['dynamic_page_cache'] = 'cache.
</span><span class="koboSpan" id="kobo.1060.3">backend.null';</span></pre>
<p><span class="koboSpan" id="kobo.1061.1">This forces Drupal to use a cached backend that does not cache any data for its </span><strong class="source-inline"><span class="koboSpan" id="kobo.1062.1">render</span></strong><span class="koboSpan" id="kobo.1063.1"> output. </span><span class="koboSpan" id="kobo.1063.2">Your Drupal site may operate slower, but it allows you to build your theme without rebuilding </span><span class="No-Break"><span class="koboSpan" id="kobo.1064.1">Drupal’s cache.</span></span></p>
<h2 id="_idParaDest-324"><a id="_idTextAnchor353"/><span class="koboSpan" id="kobo.1065.1">See also</span></h2>
<ul>
<li><span class="koboSpan" id="kobo.1066.1">Browsersync </span><span class="No-Break"><span class="koboSpan" id="kobo.1067.1">documentation: </span></span><a href="https://browsersync.io/docs/options/"><span class="No-Break"><span class="koboSpan" id="kobo.1068.1">https://browsersync.io/docs/options/</span></span></a></li>
<li><span class="koboSpan" id="kobo.1069.1">Laravel Mix </span><span class="No-Break"><span class="koboSpan" id="kobo.1070.1">documentation: </span></span><a href="https://laravel-mix.com/docs"><span class="No-Break"><span class="koboSpan" id="kobo.1071.1">https://laravel-mix.com/docs</span></span></a></li>
</ul>
</div>
</body></html>
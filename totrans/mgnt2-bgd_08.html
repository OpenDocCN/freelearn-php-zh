<html><head></head><body><div class="book" title="Indexer(s)" id="1O8H61-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec53" class="calibre1"/>Indexer(s)</h1></div></div></div><p class="calibre7">Indexing is<a id="id276" class="calibre1"/> the process of transforming data by reducing it to flattened data with less database tables. This process is run for products, categories, and so on in order to improve the performance of a web store. Since data constantly changes, this is not a one-time process. Rather, it is a periodic one. The <code class="email">Magento_Indexer</code> module is a base of the <code class="email">Magento</code> Indexing functionality.</p><p class="calibre7">The <code class="email">Magento</code> console tool supports the following indexer commands.</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">indexer</strong></span>
<span class="strong"><strong class="calibre8">    indexer:info        Shows allowed Indexers</strong></span>
<span class="strong"><strong class="calibre8">    indexer:reindex     Reindexes Data</strong></span>
<span class="strong"><strong class="calibre8">    indexer:set-mode    Sets index mode type</strong></span>
<span class="strong"><strong class="calibre8">    indexer:show-mode   Shows Index Mode</strong></span>
<span class="strong"><strong class="calibre8">    indexer:status      Shows status of Indexer</strong></span>
</pre></div><p class="calibre7">On<a id="id277" class="calibre1"/> running <code class="email">php bin/magento indexer:info</code>, you will get a list of all the Magento indexers; the default ones are as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">catalog_category_product    Category Products</strong></span>
<span class="strong"><strong class="calibre8">catalog_product_category    Product Categories</strong></span>
<span class="strong"><strong class="calibre8">catalog_product_price       Product Price</strong></span>
<span class="strong"><strong class="calibre8">catalog_product_attribute   Product EAV</strong></span>
<span class="strong"><strong class="calibre8">foggyline_office_employee   Employee Flat Data</strong></span>
<span class="strong"><strong class="calibre8">cataloginventory_stock      Stock</strong></span>
<span class="strong"><strong class="calibre8">catalogrule_rule            Catalog Rule Product</strong></span>
<span class="strong"><strong class="calibre8">catalogrule_product         Catalog Product Rule</strong></span>
<span class="strong"><strong class="calibre8">catalogsearch_fulltext      Catalog Search</strong></span>
</pre></div><p class="calibre7">You will see all the indexers listed in the Magento admin in the <span class="strong"><strong class="calibre8">System</strong></span> | <span class="strong"><strong class="calibre8">Tools</strong></span> | <span class="strong"><strong class="calibre8">Index</strong></span> <span class="strong"><strong class="calibre8">Management</strong></span> menu.</p><p class="calibre7">From within the admin area, we can only change the indexer mode. There are two modes of indexers:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre8">Update on Save</strong></span>: Index tables are updated right after the dictionary data is changed</li><li class="listitem"><span class="strong"><strong class="calibre8">Update by Schedule</strong></span>: Index tables are updated by <code class="email">cron</code> jobs according to the configured schedule</li></ul></div><p class="calibre7">Since indexers cannot be run manually from admin, we have to rely either on their manual execution or the <code class="email">cron</code> execution.</p><p class="calibre7">Manual execution is done via the following console command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">php bin/magento indexer:reindex</strong></span>
</pre></div><p class="calibre7">The preceding command will run all the indexers at once. We can fine-tune it further to execute individual indexes by running a console command that is similar to the following line of code:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">php bin/magento indexer:reindex catalogsearch_fulltext</strong></span>
</pre></div><p class="calibre7">Cron-executed indexers are defined via the <code class="email">Magento_Indexer</code> module, as follows:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">indexer_reindex_all_invalid</code>: This will execute every minute of every hour every day. It runs the <code class="email">reindexAllInvalid</code> method on an instance of the <code class="email">Magento\Indexer\Model\Processor</code> class.</li><li class="listitem"><code class="email">indexer_update_all_views</code>: This will execute every minute of every hour every day. It runs the <code class="email">updateMview</code> method on an instance of the <code class="email">Magento\Indexer\Model\Processor</code> class.</li><li class="listitem"><code class="email">indexer_clean_all_changelogs</code>: This will execute the 0th minute of every hour every day. It runs the <code class="email">clearChangelog</code> method on an instance of the <code class="email">Magento\Indexer\Model\Processor</code> class.</li></ul></div><p class="calibre7">These <code class="email">cron</code> jobs <a id="id278" class="calibre1"/>use an operating system <code class="email">cron</code> job setup in such a way that the <code class="email">Magento</code> <code class="email">cron</code> job is triggered every minute.</p><p class="calibre7">The following three statuses is what an indexer can have:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">valid</code>: The data is synchronized and no re-indexing is required</li><li class="listitem"><code class="email">invalid</code>: The original data was changed and the index should be updated</li><li class="listitem"><code class="email">working</code>: The index process is running</li></ul></div><p class="calibre7">While we won't go into the details of actually creating a custom indexer within this chapter, it is worth noting that <code class="email">Magento</code> defines its indexers in the <code class="email">vendor/magento/module-*/etc/indexer.xml</code> file. This might come in handy for cases where we want a deeper understanding of the inner workings of an individual indexer. For example, the <code class="email">catalog_product_flat</code> indexer is implemented via the <code class="email">Magento\Catalog\Model\Indexer\Product\Flat</code> class, as defined within the <code class="email">vendor/magento/module-catalog/etc/indexer.xml</code> file. By studying the <code class="email">Flat</code> class implementation in depth, you can learn how data is taken from <code class="email">EAV</code> tables and flattened into a simplified structure.</p></div>
<div class="book" title="Summary" id="1P71O1-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec54" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">In this chapter, we covered some of the most relevant aspects of Magento, which was beyond models and classes, regarding backend development. We had a look at <code class="email">crontab.xml</code>, which helps us schedule <code class="email">jobs</code> (commands) so that they can be run periodically. Then, we tackled notification messages, which enable us to push styled messages to users via a browser. The <span class="strong"><em class="calibre9">Session and cookies</em></span> section gave us an understanding of how <code class="email">Magento</code> tracks user information from a browser to a session. Logging and profiling showed us a simple yet effective mechanism to keep track of performance and possible issues across code. The <span class="strong"><em class="calibre9">Events and observers</em></span> section introduced us to a powerful pattern that <code class="email">Magento</code> implements across the code, where we can trigger custom code execution when a certain event is fired. The section on caching guided us through the available cache types, and we studied how to create and use our own cache type. Through the section on frontend apps (widgets), we learned how to create our own miniature apps that can be called into CMS pages and blocks. Custom variables gave us an insight into a simple yet interesting feature, where we can define a variable via the admin interface and then use it within CMS page, block, or e-mail template. The section on i18n showed us how to use the Magento translation feature to translate any string on three different levels, namely the module CSV file, the theme CSV file, and inline translation. Finally, we had a look at indexers and their mode and status; we learned how to control their execution.</p><p class="calibre7">The next chapter will tackle frontend development. We will learn how create our own theme and use blocks and layouts to affect the output.</p></div></body></html>
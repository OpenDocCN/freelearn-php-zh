- en: '5'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '5'
- en: Managing Users, Cohorts, and Authentication
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理用户、群体和身份验证
- en: 'This chapter will teach you how to manage users in your Moodle system. We will
    first look at what information is stored for each user and how we can extend their
    profiles. We will then perform several standard user actions before dealing with
    cohorts. Finally, we will deal with a wide range of user authentication mechanisms.
    We will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将教你如何在Moodle系统中管理用户。我们首先将查看每个用户存储的信息以及我们如何扩展他们的个人资料。然后，在处理群体之前，我们将执行几个标准用户操作。最后，我们将处理一系列用户身份验证机制。我们将涵盖以下主题：
- en: Understanding user profiles
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解用户个人资料
- en: Performing standard user actions (manual and bulk)
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行标准用户操作（手动和批量）
- en: Creating user accounts manually (including batch upload)
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 手动创建用户账户（包括批量上传）
- en: Managing cohorts (including batch upload)
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理群体（包括批量上传）
- en: Configuring user authentication (internal, external, service providers, and
    system)
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置用户身份验证（内部、外部、服务提供商和系统）
- en: 'The following diagram shows a high-level overview of the aforementioned topics
    (users, cohorts, and authentication) and how they are connected:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表显示了上述主题（用户、群体和身份验证）的高级概述以及它们是如何相互关联的：
- en: '![Figure 5.1 – Users, courses, and authentication – a high-level overview ](img/Figure_5.01_B18779.jpg)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![图5.1 – 用户、课程和身份验证 – 高级概述](img/Figure_5.01_B18779.jpg)'
- en: Figure 5.1 – Users, courses, and authentication – a high-level overview
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.1 – 用户、课程和身份验证 – 高级概述
- en: By the end of this chapter, you will be able to manage all aspects of user accounts
    and user authentication. This is a lot to take in, so we’d better get going!
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将能够管理用户账户和用户身份验证的所有方面。这需要吸收很多信息，所以我们最好早点开始！
- en: Understanding user profiles
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解用户个人资料
- en: Other than guests, each user has a profile containing information about them.
    We will first deal with the information stored for each user and how it is organized
    in Moodle.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 除了访客外，每个用户都有一个包含其信息的个人资料。我们首先将处理每个用户存储的信息以及它在Moodle中的组织方式。
- en: You can view your own profile by selecting the **Profile** item in the drop-down
    menu beside your name at the top of the screen. Click on the **Edit profile**
    link in the **User details** section to change your profile details. To modify
    the profiles of other users, click on the **Edit** icon beside their name by navigating
    to **Site administration | Users | Accounts | Browse list of users**.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过在屏幕顶部的姓名旁边的下拉菜单中选择**个人资料**项来查看自己的个人资料。点击**用户详情**部分的**编辑个人资料**链接来更改个人资料详情。要修改其他用户的个人资料，请导航到**网站管理
    | 用户 | 账户 | 浏览用户列表**，然后点击他们名字旁边的**编辑**图标。
- en: Profile fields
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 个人资料字段
- en: 'Moodle user profiles are divided into pre-defined categories, which cannot
    be changed via the Moodle user interface:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: Moodle用户个人资料被分为预定义的类别，这些类别不能通过Moodle用户界面进行更改：
- en: '**General**: Standard user fields'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**通用**：标准用户字段'
- en: '**User picture**: Image of the user'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户图片**：用户的图片'
- en: '**Additional names**: Phonetic name, middle name, and alternate name'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**附加姓名**：音译名、中间名和别名'
- en: '**Interests**: Tags for networking activities'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**兴趣**：用于网络活动的标签'
- en: '**Optional**: Additional user information'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可选**：额外用户信息'
- en: In addition to these static profile field categories, Moodle allows us to create
    user-defined profile categories and fields. Before dealing with custom profile
    fields, we will cover the pre-defined fields grouped by the aforementioned categories.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 除了这些静态的个人资料字段类别之外，Moodle还允许我们创建用户自定义的个人资料类别和字段。在处理自定义个人资料字段之前，我们将介绍上述类别分组预定义的字段。
- en: User profile fields – General
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户个人资料字段 – 通用
- en: 'The following screenshot shows the profile fields of the **General** category:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了**通用**类别的个人资料字段：
- en: '![Figure 5.2 – User profile fields – General ](img/Figure_5.02_B18779.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![图5.2 – 用户个人资料字段 – 通用](img/Figure_5.02_B18779.jpg)'
- en: Figure 5.2 – User profile fields – General
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.2 – 用户个人资料字段 – 通用
- en: 'Most of these items are self-explanatory, but there are a few things you need
    to know about each of them. Here is a brief description of each profile element,
    along with tips to use them effectively:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数这些项目都是不言自明的，但有一些关于每个项目的细节你需要了解。以下是每个个人资料元素的简要描述，以及如何有效地使用它们的提示：
- en: '**Username**: A unique username has to be provided. By default, only alphanumeric
    lowercase characters, underscores (_), hyphens (-), periods (.), or the *at* symbol
    (@) are allowed. Suppose you also want to use other characters in usernames, such
    as umlauts (¨). In that case, you will have to enable these by going to **Site
    administration | Security | Site security settings** and turning on **Allow extended
    characters in usernames**. It is important to remember that you ought to have
    administrator rights to change the username.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户名**：必须提供一个唯一的用户名。默认情况下，仅允许使用字母数字小写字符、下划线（_）、连字符（-）、点（.）或*at*符号（@）。假设您还希望在用户名中使用其他字符，例如重音符号（¨），在这种情况下，您必须通过访问**站点管理
    | 安全 | 站点安全设置**并开启**允许用户名中使用扩展字符**来启用这些字符。重要的是要记住，您需要有管理员权限来更改用户名。'
- en: If you wish to use the email address as the username, consider the **Allow login
    via email** option (at **Site administration | Plugins | Authentication | Manage
    authentication**). That way, users have two alternatives to log in, their username
    and their email address.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望使用电子邮件地址作为用户名，请考虑**允许通过电子邮件登录**选项（在**站点管理 | 插件 | 认证 | 管理认证**）。这样，用户有两个登录选择，即他们的用户名和他们的电子邮件地址。
- en: Important note
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: If your users don’t already have a unique identifier that can be (re)used as
    their Moodle username, such as an email address or a staff ID, it is highly recommended
    to develop a consistent naming scheme for usernames, for example, `firstname.lastname`
    for smaller institutions or `startyear.firstname.lastname.index` for larger organizations.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的用户还没有可以作为Moodle用户名（可重复）使用的唯一标识符，例如电子邮件地址或员工ID，强烈建议为用户名制定一个一致的命名方案，例如，对于较小的机构使用`firstname.lastname`，对于较大的组织使用`startyear.firstname.lastname.index`。
- en: '`auth` method of the main admin account. We’ll look at authentication methods
    in detail in the second half of this chapter.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主管理员账户的`auth`方法。我们将在本章的后半部分详细探讨认证方法。
- en: Important note
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: An incorrect authentication method prevents users from logging in, or even completely
    deletes their account!
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 错误的认证方法会阻止用户登录，甚至可能完全删除他们的账户！
- en: '**Suspended account**: Select this option to prevent a user from logging in.
    This is useful as a disciplinary measure or in case of a more prolonged absence,
    for instance, a sabbatical term. There is no expiry date on the suspension, so
    you must manually change this back.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**挂起账户**：选择此选项以阻止用户登录。这作为一个纪律措施或在更长时间缺席的情况下（例如，休假学期）非常有用。挂起没有到期日期，因此您必须手动将其更改回来。'
- en: Important note
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Account suspension is not the same as enrolment suspension. The former affects
    users and the latter, individual course enrolments.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 账户挂起与注册挂起不同。前者影响用户，后者影响单个课程的注册。
- en: '**New password**: When creating manual accounts, a password must be provided
    for security reasons. If the user ought to change the given password on their
    first login, the **Force password change** option has to be selected. You can
    unmask (reveal) your own password but not that of other users. However, administrators
    can override the existing passwords of users.'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**新密码**：在创建手动账户时，出于安全考虑必须提供一个密码。如果用户在首次登录时需要更改提供的密码，必须选择**强制密码更改**选项。您可以揭示（显示）自己的密码，但不能揭示其他用户的密码。然而，管理员可以覆盖用户的现有密码。'
- en: If **Password policy** is enabled (in **Site administration | Security | Site
    security settings**), the password must adhere to this policy. Refer to [*Chapter
    13*](B18779_13.xhtml#_idTextAnchor251), *Ensuring Moodle Security*, for more details
    on password policy.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 如果**密码策略**已启用（在**站点管理 | 安全 | 站点安全设置**），密码必须遵守此策略。有关密码策略的更多详细信息，请参阅[*第13章*](B18779_13.xhtml#_idTextAnchor251)，*确保Moodle安全*。
- en: '**First name** and **Surname**: These are compulsory fields for users, for
    which diacritical marks (ä, â, à, á, …) are fully supported.'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名字**和**姓氏**：这些是用户的必填字段，对于带重音符号的字符（ä、â、à、á、…）完全支持。'
- en: '**Email address**: This is a compulsory field and should be unique. Ensure
    the address is correct since Moodle makes regular use of it, for example, to notify
    users who have forgotten their username or password.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件地址**：这是一个必填字段，并且应该是唯一的。请确保地址正确，因为Moodle会定期使用它，例如，通知忘记用户名或密码的用户。'
- en: Some organizations still do not make use of email addresses. As it is a mandatory
    field, there are two typical workarounds in this scenario.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 一些组织仍然没有使用电子邮件地址。由于这是一个必填字段，在这种情况下有两种典型的解决方案。
- en: The first option is to develop a unique dummy email address scheme or void email
    addresses solely used for identification purposes. While this solves the problem
    technically, it limits the user experience significantly because communication
    among users or notifications generated by Moodle cannot be sent.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 第一种选择是开发独特的虚拟电子邮件地址方案或仅用于识别目的的电子邮件地址。虽然从技术上解决了问题，但会显著限制用户体验，因为用户之间的通信或Moodle生成的通知无法发送。
- en: The second alternative is to activate **duplicate email addresses** (enable
    **Allow accounts with same email** in **Site administration | Plugins | Authentication
    | Manage authentication**) and have users with an email address responsible for
    groups of learners, for example, a teacher for a class or a supervisor for workers.
    While this approach is not ideal from a privacy perspective – user-specific messages
    could potentially be read by multiple persons – at least somebody knows what is
    going on and can then communicate it to the intended recipients.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 第二种选择是激活**重复电子邮件地址**（在**网站管理 | 插件 | 认证 | 管理认证**中启用**允许具有相同电子邮件的帐户**），并为具有电子邮件地址的用户负责学习小组，例如，一个教师负责一个班级或一个主管负责工人。虽然从隐私角度来看这种方法并不理想——特定用户的消息可能会被多个人阅读——但至少有人知道发生了什么，然后可以将其传达给预期的收件人。
- en: '**Email display**: Choices can be made as to who can see the user’s email address.
    The self-explanatory choices are **Hide my email address from non-privileged users**,
    **Allow everyone to see my email address**, and **Allow only other participants
    to see my email address** (default). Administrators and teachers (with editing
    rights) will always see email addresses, even if they are hidden.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件显示**：可以选择谁可以看到用户的电子邮件地址。不言自明的选项有**从非特权用户隐藏我的电子邮件地址**、**允许每个人查看我的电子邮件地址**和**仅允许其他参与者查看我的电子邮件地址**（默认）。管理员和教师（具有编辑权限）将始终看到电子邮件地址，即使它们被隐藏。'
- en: '**MoodleNet profile**: Link to the user’s MoodleNet profile, which has to be
    a WebFinger-compliant URI. We will deal with MoodleNet in [*Chapter 19*](B18779_19.xhtml#_idTextAnchor344),
    *Setting Up Moodle Networking*.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MoodleNet个人资料**：链接到用户的MoodleNet个人资料，它必须是一个符合WebFinger URI的链接。我们将在[*第19章*](B18779_19.xhtml#_idTextAnchor344)
    *设置Moodle网络*中处理MoodleNet。'
- en: '**City/town** and **Select a country**: These are used to further identify
    users by their geographical location.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**城市/镇**和**选择一个国家**：这些用于通过用户的地理位置进一步识别用户。'
- en: '**Timezone**: This is used to convert time-related messages on the system (such
    as assignment deadlines) from the local time (typically, the server time) to the
    correct time in whichever zone the user has selected. It is necessary as your
    users may be geographically spread across multiple time zones. The default city,
    country, and time zone can be specified by navigating to **Site administration
    | Location | Location settings**.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**时区**：此功能用于将系统中的时间相关消息（例如作业截止日期）从本地时间（通常是服务器时间）转换为用户所选时区的正确时间。由于您的用户可能分布在全球多个时区，因此这是必要的。默认的城市、国家和时区可以通过导航到**网站管理
    | 位置 | 位置设置**来指定。'
- en: '**Description**: This provides additional information about the user. As an
    administrator, you can leave the field empty.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**描述**：此选项提供有关用户的额外信息。作为管理员，您可以保留该字段为空。'
- en: Additional fields might appear in the user’s profile, for example, **Preferred
    theme** or **Email charset**, but this requires the settings to be changed elsewhere.
    We will mention these when the respective topics are being dealt with.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 用户个人资料中可能会出现其他字段，例如**首选主题**或**电子邮件字符集**，但这需要更改其他位置的设置。当处理相关主题时，我们将提及这些内容。
- en: User profile fields – User picture
  id: totrans-51
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户个人资料字段 – 用户图片
- en: The second category is called **User picture**, and, as the name suggests, it
    deals with the image attached to a user’s profile.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 第二类被称为**用户图片**，正如其名所示，它处理附加到用户个人资料上的图片。
- en: Simply drag it to the **New picture** pane or select the image from the file
    picker to upload a new picture. The image cannot be larger than the maximum size
    listed; if your image is too large, it is recommended to reduce its size to a
    minimum of 100 x 100 pixels. The supported formats are GIF, PNG, and the JPEG
    family; however, be careful with transparent backgrounds as they might cause issues
    in some browsers.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 简单地将它拖到**新图片**面板或从文件选择器中选择图片以上传新图片。图片的大小不能超过列出的最大尺寸；如果您的图片太大，建议将其大小减少到至少100
    x 100像素。支持的格式是GIF、PNG和JPEG系列；然而，请注意透明背景，因为它们可能在某些浏览器中引起问题。
- en: The **Picture description** field is used as an alt tag, a description of the
    image used for nonvisual browsers; it is in conformance with accessibility guidelines.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**图片描述**字段用作 alt 标签，为非视觉浏览器提供图片描述；它符合无障碍指南。'
- en: '![Figure 5.3 – User profile fields – User picture ](img/Figure_5.03_B18779.jpg)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.3 – 用户资料字段 – 用户图片](img/Figure_5.03_B18779.jpg)'
- en: Figure 5.3 – User profile fields – User picture
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.3 – 用户资料字段 – 用户图片
- en: Once a picture has been assigned, it will be shown in place of the **None**
    label. To remove the picture, check the **Delete** checkbox, and the picture will
    be removed when the profile information is updated.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦分配了图片，它将显示在**无**标签的位置。要删除图片，请勾选**删除**复选框，当更新资料信息时，图片将被删除。
- en: Moodle will automatically crop the image to a square and resize it to 100 x
    100 pixels for the larger view and 35 x 35 pixels for the smaller thumbnail view.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: Moodle 将自动裁剪图片成方形，并将其调整到 100 x 100 像素用于大视图和 35 x 35 像素用于小缩略图视图。
- en: Important note
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Two thumbnails are created automatically during the upload process, which reduces
    the file size to approximately 4 KB. An administrator can view all the uploaded
    user pictures via the `<moodleurl>/userpix` URL.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在上传过程中自动创建两个缩略图，这可以将文件大小减少到大约 4 KB。管理员可以通过 `<moodleurl>/userpix` URL 查看所有上传的用户图片。
- en: Moodle also supports **Gravatars**, so-called globally recognized avatars. Once
    you select the **Enable Gravatar** option on **Site administration | Users | Permissions
    | User policies**, Moodle will attempt to fetch a user profile picture from [gravatar.com](http://gravatar.com)
    if the user has not uploaded an image.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: Moodle 也支持**Gravatar**，所谓的全球认可的头像。一旦你在**网站管理 | 用户 | 权限 | 用户策略**上选择**启用 Gravatar**选项，Moodle
    将尝试从 [gravatar.com](http://gravatar.com) 获取用户资料图片，如果用户没有上传图片。
- en: If you suspect that your learners will likely misuse this feature by uploading
    inappropriate images, you can disable the functionality. Go to **Site administration
    | Security | Site security settings** and tick the **Disable user profile images**
    checkbox. Remember that once this feature is disabled, pictures cannot be assigned
    to any users (except the administrator), nor will it be possible for teachers
    to represent groups in courses with images.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你怀疑你的学习者可能会通过上传不适当的图片来滥用这个功能，你可以禁用此功能。前往**网站管理 | 安全 | 网站安全设置**并勾选**禁用用户资料图片**复选框。请记住，一旦此功能被禁用，图片将无法分配给任何用户（除了管理员），教师也无法在课程中使用图片代表小组。
- en: User profile fields – Additional names
  id: totrans-63
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户资料字段 – 其他名字
- en: 'This **Additional names** section comprises the following fields:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 此**其他名字**部分包括以下字段：
- en: '**First name – phonetic** and **Surname – phonetic**: The primary use case
    for the field pair is in Far East languages where users have an original and a
    Romanized version or a phonetic name displayed (for instance, Pinyin).'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名字 – 音译**和**姓氏 – 音译**：该字段对的使用场景主要在远东语言中，用户有原始版本和罗马化版本或音译名字显示（例如，拼音）。'
- en: '**Middle name**: In some cultures, it is common to have three or more names
    that are displayed.'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**中间名**：在某些文化中，有显示三个或更多名字的情况很常见。'
- en: '**Alternate name**: This can be a nickname, a handle, or an alias used in specific
    pedagogical settings, for example, in gamification or role-playing scenarios.'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**别名**：这可以是一个昵称、一个处理名或特定教学环境中的别名，例如，在游戏化或角色扮演场景中。'
- en: User profile fields – Interests
  id: totrans-68
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户资料字段 – 兴趣
- en: Interests, such as hobbies or professional activities, can be entered one by
    one. To remove a tag, select its label. The given **List of interests** represents
    tags displayed in the user’s profile. You can find more information on tagging
    at [docs.moodle.org/en/Tags](http://docs.moodle.org/en/Tags) and in [*Chapter
    9*](B18779_09.xhtml#_idTextAnchor181), *Configuring Educational Features*.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 兴趣，如爱好或职业活动，可以逐个输入。要删除标签，选择其标签。所提供的**兴趣列表**代表在用户资料中显示的标签。你可以在 [docs.moodle.org/en/Tags](http://docs.moodle.org/en/Tags)
    和 [*第 9 章*](B18779_09.xhtml#_idTextAnchor181)，*配置教育功能*中找到更多关于标签的信息。
- en: '![Figure 5.4 – User profile fields – Interests ](img/Figure_5.04_B18779.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.4 – 用户资料字段 – 兴趣](img/Figure_5.04_B18779.jpg)'
- en: Figure 5.4 – User profile fields – Interests
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.4 – 用户资料字段 – 兴趣
- en: User profile fields – Optional
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用户资料字段 – 可选
- en: 'More personal details are grouped under the **Optional** category:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 更多个人详细信息被归类在**可选**类别下：
- en: '**ID number** can contain a student or staff number and is usually used in
    synchronization tools, such as HR systems.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ID号**可以包含学生号或员工号，通常用于同步工具，如人力资源系统。'
- en: '**Institution** and **Department** might be used for campus and faculty in
    a university. If you are using Moodle Workplace, do not confuse these two fields
    with departments that are part of the organization structure, including department
    frameworks, positions, job assignments, and managers.'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**机构**和**部门**可能用于大学的校园和学院。如果您使用Moodle Workplace，不要将这些字段与组织结构中的部门混淆，包括部门框架、职位、工作分配和管理员。'
- en: '**Phone**, **Mobile phone**, and **Address** should be self-explanatory.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电话**、**移动电话**和**地址**应该很容易理解。'
- en: Some organizations rename unused fields to ones required in their setup. For
    more information on this, refer to the *Localization* section in [*Chapter 10*](B18779_10.xhtml#_idTextAnchor204),
    *Configuring Technical Features*.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 一些组织将未使用的字段重命名为其设置中所需的字段。有关此信息，请参阅[*第10章*](B18779_10.xhtml#_idTextAnchor204)中的*本地化*部分，*配置技术功能*。
- en: This concludes the explanation of pre-defined user profile fields. The list
    can be extended by custom fields covered in the following section.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 这就完成了预定义用户资料字段的解释。列表可以通过以下章节中介绍的定制字段进行扩展。
- en: Creating user-defined profile fields
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建用户自定义资料字段
- en: Moodle allows new arbitrary fields to be added to user profiles. We have already
    described the management of user-defined fields in the previous chapter when we
    dealt with custom course fields. Since the exact mechanism is used for user profile
    fields, we only deal with account-specific idiosyncrasies.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: Moodle 允许将新的任意字段添加到用户资料中。我们已经在上一章中描述了用户自定义字段的 管理，当时我们处理了自定义课程字段。由于使用了相同的机制来处理用户资料字段，我们只处理与账户相关的特殊问题。
- en: We just learned that profile fields are organized into categories (for instance,
    **General**, **User picture**, **Interests**, and **Optional**). Additional categories
    can be created, and user-defined fields can be placed within these new categories.
    This feature can be found by navigating to **Site administration | Users | Accounts
    | User profile fields**.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚了解到资料字段被组织成类别（例如，**通用**、**用户图片**、**兴趣**和**可选**）。可以创建额外的类别，并将用户自定义字段放置在这些新类别中。您可以通过导航到**网站管理
    | 用户 | 账户 | 用户资料字段**来找到这个功能。
- en: Unlike in custom courses, a default category, called **Other fields**, is already
    present, which can be deleted or renamed via the standard Moodle icons. To create
    a new category, click the **Create a new profile category** button at the bottom
    of the user profiles once the profile fields have been added.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 与自定义课程不同，已经存在一个默认类别，称为**其他字段**，可以通过标准Moodle图标进行删除或重命名。在添加资料字段后，点击用户资料底部的**创建新资料类别**按钮即可创建新类别。
- en: 'The five profile field types in courses (checkbox, date/time, drop-down menu,
    text area, and text input) exist for users, plus one more: social. Let us go through
    the differences in the field-specific settings:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 课程中的五个资料字段类型（复选框、日期/时间、下拉菜单、文本区域和文本输入）适用于用户，还有一个额外的类型：社交。让我们来了解一下字段特定设置中的差异：
- en: '**Checkbox**: This is the same as in custom course fields.'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**复选框**：这与自定义课程字段相同。'
- en: '**Date/time**: Instead of minimum and maximum value, the two date boundaries
    are **Start year** and **End year**, respectively. There also exists an **Include
    time?** option, though you cannot specify a default time.'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日期/时间**：而不是最小值和最大值，两个日期边界分别是**开始年份**和**结束年份**。还有一个**包含时间？**选项，尽管您不能指定默认时间。'
- en: '**Drop-down menu**: This is the same as in custom course fields.'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**下拉菜单**：这与自定义课程字段相同。'
- en: '**Social**: This new field type lets you specify social network IDs, such as
    the user’s Skype handle. The options you can see in the **Network type** list
    were formerly hard coded in the user profile. Let’s hope the list will be updated
    to the 21st century soon to support social media platforms such as Facebook, Twitter,
    Instagram, and TikTok, instead of outdated services such as ICQ and AIM.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**社交**：这种新的字段类型允许您指定社交网络ID，例如用户的Skype昵称。您在**网络类型**列表中看到的选项以前是硬编码在用户资料中的。让我们希望这个列表很快就能更新到21世纪，以支持Facebook、Twitter、Instagram和TikTok等社交媒体平台，而不是过时的服务如ICQ和AIM。'
- en: If you upgrade from Moodle 3.x and any of these services are populated, they
    will be retained and converted automatically.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您从Moodle 3.x升级，并且这些服务中有任何内容，它们将被保留并自动转换。
- en: '![Figure 5.5 – User profile fields of type social ](img/Figure_5.05_B18779.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![图5.5 – 社交类型用户资料字段](img/Figure_5.05_B18779.jpg)'
- en: Figure 5.5 – User profile fields of type social
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.5 – 社交类型用户资料字段
- en: '**Text area**: This is precisely the same as in custom course fields.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文本区域**：这与自定义课程字段中的完全相同。'
- en: '**Text input**: This is the same as the **Short text** field in courses, but
    some fields have been renamed: **Form input size** is now **Display size**, and
    **Maximum number of characters** is now **Character limit**. Why? I have absolutely
    no idea!'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文本输入**：这与课程中的**短文本**字段相同，但一些字段已被重命名：**表单输入大小**现在是**显示大小**，而**最大字符数**现在是**字符限制**。为什么？我完全没有头绪！'
- en: 'Each field type in user-profile fields has the same parameters as custom course
    fields with three notable differences:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 用户资料字段中的每个字段类型都有与自定义课程字段相同的参数，但有三个显著的不同点：
- en: The fields are arranged slightly differently, and the common field settings
    **Locked** and **Visible** have been moved to the **General** section.
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 字段排列略有不同，常见的字段设置**锁定**和**可见**已被移动到**常规**部分。
- en: The options in **Who is field visible to?** have been adjusted as follows. Instead
    of **Teachers**, there are now two options to choose from, namely **Visible to
    user** and **Visible to user, teachers, and admins**.
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**谁可以看到字段**的选项已被调整为如下。不再是**教师**，现在有两个选项可供选择，即**对用户可见**和**对用户、教师和管理员可见**。'
- en: The only additional setting available is **Display on signup page?**. When self-registration
    is enabled, several default fields must be provided at signup. If a custom field
    should also be displayed on the signup page, the option must be set to **Yes**.
    This feature can be helpful in commercial training settings when additional information,
    such as the learner’s address or previous qualifications, is required.
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 唯一可用的附加设置是**在注册页面上显示？**。当启用自助注册时，必须在注册时提供几个默认字段。如果自定义字段也应显示在注册页面上，则必须将选项设置为**是**。此功能在商业培训设置中可能很有用，当需要额外信息，如学习者的地址或先前资历时。
- en: 'To demonstrate how user profile fields work, let’s assume a school where you
    wish to extend the user profile with a new profile category called **Parental
    responsibilities** comprising fields such as **Contact person** and **Relationship**:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 为了展示用户资料字段的工作方式，让我们假设一个学校，你希望通过一个名为**家长责任**的新资料类别扩展用户资料，包括**联系人**和**关系**等字段：
- en: '![Figure 5.6 – User profile fields example ](img/Figure_5.06_B18779.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![图5.6 – 用户资料字段示例](img/Figure_5.06_B18779.jpg)'
- en: Figure 5.6 – User profile fields example
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.6 – 用户资料字段示例
- en: This completes the subsection dealing with custom user profile fields, extending
    standard user profiles. The third and last component of user profiles is user
    preferences, which we will cover next.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了关于自定义用户资料字段的子节处理，扩展了标准用户资料。用户资料的第三和最后一个组成部分是用户偏好，我们将在下一节中介绍。
- en: User preferences
  id: totrans-101
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 用户偏好
- en: 'Some more fields technically belong to the user profile, but they have been
    placed in the `moodle/user:editownprofile` capability) and let them specify preferences
    via dedicated forms:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 一些字段在技术上属于用户资料，但它们已被放置在`moodle/user:editownprofile`能力中，并允许他们通过专用表单指定偏好：
- en: '**Preferred language**: The default language of the system is shown and can
    be changed to the user’s preferred language. We will deal with localization in
    [*Chapter 10*](B18779_10.xhtml#_idTextAnchor204), *Configuring Technical Features*.'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**首选语言**：系统默认语言显示，可以更改为用户的偏好语言。我们将在[*第10章*](B18779_10.xhtml#_idTextAnchor204)
    *配置技术功能*中处理本地化。'
- en: '**Forum preferences**: **Email digest type** determines how a user receives
    posts from forums to which a subscription exists. There are three possible choices,
    which are **No digest (single email per forum post)**, which is the default, **Complete
    (daily email with full posts)**, or **Subjects (daily email with subjects only)**.
    The **Forum auto-subscribe** setting dictates whether users are automatically
    subscribed to forums to which they post. The **Use experimental nested discussion
    view** option makes available a new discussion view; at the time of print, the
    feature is still in trial mode.'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**论坛偏好**：**邮件摘要类型**确定用户如何接收存在订阅的论坛帖子。有三个可能的选择，即**无摘要（每个论坛帖子一个单独的电子邮件）**，这是默认设置，**完整（包含完整帖子的每日电子邮件）**或**主题（仅包含主题的每日电子邮件）**。**论坛自动订阅**设置规定用户是否自动订阅他们发帖的论坛。**使用实验性嵌套讨论视图**选项提供了一种新的讨论视图；在印刷时，该功能仍在试验模式中。'
- en: If **Forum tracking** is enabled, posts that have not yet been read will be
    highlighted, which improves forum usability. When sending forum post notifications,
    users can choose whether they should mark the post as read or not to impact forum
    tracking.
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果**论坛跟踪**已启用，未阅读的帖子将被突出显示，这提高了论坛的可用性。在发送论坛帖子通知时，用户可以选择是否标记帖子为已读，以影响论坛跟踪。
- en: '**Editor preferences**: This option determines which editor should be used
    when entering information in text areas. Unless the user has special requirements
    or preferences, this should be left as the **Default editor** option. In [*Chapter
    7*](B18779_07.xhtml#_idTextAnchor140), *Enhancing Moodle’s Look and Feel*, you’ll
    learn more about editors.'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**编辑器偏好设置**：此选项确定在文本区域中输入信息时应使用哪个编辑器。除非用户有特殊要求或偏好，否则应保留为**默认编辑器**选项。在[*第7章*](B18779_07.xhtml#_idTextAnchor140)“增强Moodle的外观和感觉”中，您将了解更多关于编辑器的信息。'
- en: '**Calendar preferences**: The user’s choice of calendar and event-related settings.
    Calendars will be discussed in a dedicated section in [*Chapter 10*](B18779_10.xhtml#_idTextAnchor204),
    *Configuring Technical Features*.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日历偏好设置**：用户选择的日历和事件相关设置。日历将在[*第10章*](B18779_10.xhtml#_idTextAnchor204)“配置技术功能”的专用部分中进行讨论。'
- en: '**Content bank preferences**: This setting determines the visibility of content
    the user has created (public or unlisted). We will cover content as part of the
    *H5P integration* section in [*Chapter 8*](B18779_08.xhtml#_idTextAnchor168),
    *Understanding Moodle Plugins*.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**内容库偏好设置**：此设置确定用户创建的内容的可见性（公开或未列出）。我们将在[*第8章*](B18779_08.xhtml#_idTextAnchor168)“理解Moodle插件”部分的*H5P集成*部分中介绍内容。'
- en: '**Message preferences**: These settings control privacy and notification preferences.
    We will deal with messaging as part of the *Communications* section in [*Chapter
    10*](B18779_10.xhtml#_idTextAnchor204), *Configuring Technical Features*.'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**消息偏好设置**：这些设置控制隐私和通知偏好。我们将在[*第10章*](B18779_10.xhtml#_idTextAnchor204)“配置技术功能”部分的*通讯*部分中处理消息。'
- en: '**Notification preferences**: The user can choose the channels for different
    notification types. We will deal with messaging as part of the *Communications*
    section in [*Chapter 10*](B18779_10.xhtml#_idTextAnchor204), *Configuring Technical
    Features*.'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**通知偏好设置**：用户可以选择不同通知类型的通道。我们将在[*第10章*](B18779_10.xhtml#_idTextAnchor204)“配置技术功能”部分的*通讯*部分中处理消息。'
- en: The default preferences of some settings (email, forums, and content bank) can
    be specified by navigating to **Site administration | Users | Accounts | User
    default preferences**.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过导航到**网站管理 | 用户 | 账户 | 用户默认偏好**来指定一些设置（电子邮件、论坛和内容库）的默认偏好。
- en: This completes the section on user profiles, where we covered standard and custom
    profile fields and briefly looked at various user preferences. Now that we know
    what a user profile looks like, let’s start interacting with users.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了用户配置文件部分的介绍，其中我们介绍了标准和自定义配置文件字段，并简要地查看了一些用户偏好。现在，既然我们已经知道了用户配置文件的样子，让我们开始与用户互动。
- en: Performing standard user actions
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行标准用户操作
- en: So far, you have learned what type of user information Moodle holds and how
    to extend the data stored in each profile. Now, it is time to work with existing
    users on your system, which consists of browsing and filtering user accounts and
    applying bulk actions.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，您已经了解了Moodle保存的用户信息类型以及如何扩展每个配置文件中存储的数据。现在，是时候与系统中的现有用户一起工作了，这包括浏览和筛选用户账户以及应用批量操作。
- en: Browsing users
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 浏览用户
- en: The quickest way to view your Moodle user accounts is by navigating to **Site
    administration | Users | Accounts | Browse list of users**. Initially, a list
    of users is displayed, ordered by **First name**. Thirty users are shown at a
    time, and, if applicable, you can navigate via the **«** and **»** links or jump
    directly to another page by selecting a number. Each column can be sorted in ascending
    or descending order by clicking on the column header.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 查看您的Moodle用户账户的最快方法是导航到**网站管理 | 用户 | 账户 | 浏览用户列表**。最初，会显示一个按**姓名**排序的用户列表。一次显示三十个用户，如果适用，您可以通过**<<**和**>>**链接进行导航，或者通过选择一个数字直接跳转到另一页。可以通过点击列标题按升序或降序对每一列进行排序。
- en: '![Figure 5.7 – Browsing user accounts ](img/Figure_5.07_B18779.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![图5.7 – 浏览用户账户](img/Figure_5.07_B18779.jpg)'
- en: Figure 5.7 – Browsing user accounts
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.7 – 浏览用户账户
- en: You can view an individual’s profile by clicking on a user’s name. In addition
    to the fields we introduced in the first section of this chapter, you can see
    **Login activity** showing **First access to site**, **Last access to site**,
    and the **Last IP address** login took place from.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过点击用户姓名来查看个人的资料。除了我们在本章第一部分介绍的字段外，您还可以看到**登录活动**，显示**首次访问网站**、**最后访问网站**以及登录时发生的**最后
    IP 地址**。
- en: You can specify which identity information (username, ID number, email address,
    phone numbers, department, institution, city, and country) about the users is
    shown in this list and other places. Go to `moodle/site:viewuseridentity` capability.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以指定在列表和其他位置显示有关用户的哪些身份信息（用户名、ID 号、电子邮件地址、电话号码、部门、机构、城市和国家）。转到 `moodle/site:viewuseridentity`
    能力。
- en: Important note
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: To masquerade as another user, use the **Log in as** option in a user’s profile.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 要伪装成另一个用户，请使用用户资料中的**登录为**选项。
- en: When you look at the profile of another user account, you will see a **Log in
    as** link in the **Administration** pane, which lets you masquerade as another
    user. This feature is useful when tracking down issues you cannot locate as an
    administrator. To view all the user profile fields of a user or modify any of
    them, as discussed earlier, click on the **Edit profile** link. To modify any
    of the user’s preferences, select the respective link.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 当您查看另一个用户账户的资料时，您将在**管理**面板中看到一个**登录为**链接，这允许您伪装成另一个用户。当您作为管理员找不到问题时，此功能非常有用。要查看用户的全部资料字段或修改其中任何一个，如前所述，请点击**编辑资料**链接。要修改用户的任何偏好设置，请选择相应的链接。
- en: Go back to the user list and click on the standard **Delete** icon in the rightmost
    column to delete a user. A confirmation screen has to be answered before the user
    is irreversibly removed. Actually, the user is only removed from Moodle’s user
    interface. Internally, the user is retained in the database with the deleted flag
    turned on, which is necessary so that certain user contributions don’t disappear,
    for instance, forum posts. Technically, a user account can be reinstated by changing
    the delete flag manually in the database.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 返回用户列表，并在最右侧列中点击标准**删除**图标来删除用户。在用户被不可逆地删除之前，必须回答确认屏幕。实际上，用户只是从 Moodle 的用户界面中删除。内部上，用户保留在数据库中，并且已将删除标志打开，这是必要的，以便某些用户贡献不会消失，例如论坛帖子。技术上，可以通过在数据库中手动更改删除标志来恢复用户账户。
- en: To **suspend** a user account, toggle the **Show/Hide** icon, which triggers
    the account suspension, as discussed in the *User profile fields* section.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 要**暂停**用户账户，切换**显示/隐藏**图标，这将触发账户暂停，如*用户资料字段*部分所述。
- en: Related to browsing accounts is filtering, which narrows down the number of
    user entries you are dealing with. This refinement mechanism is particularly helpful
    on sites with a large number of user accounts.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 与浏览账户相关的是过滤，这可以缩小您正在处理的用户条目数量。这种细化机制在拥有大量用户账户的网站上尤其有用。
- en: Filtering users
  id: totrans-127
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 过滤用户
- en: 'We may often be required to search for a particular user or a set of users.
    Moodle provides a flexible filtering mechanism to refine the list of displayed
    users. In basic mode, you can filter by the user’s full name, which is the first
    and last name combined. The following filter operations are available, all of
    which are case insensitive:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可能经常需要搜索特定的用户或一组用户。Moodle 提供了一个灵活的过滤机制来细化显示的用户列表。在基本模式下，您可以按用户的完整姓名进行过滤，这是姓名和姓氏的组合。以下过滤操作可用，所有这些操作均不区分大小写：
- en: '**Contains**: The provided text has to be contained in the field'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**包含**：提供的文本必须包含在字段中'
- en: '**Doesn’t contain**: This is the opposite of contains'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**不包含**：这是包含的反面'
- en: '**Is equal to**: The provided text has to be the same as the value of the field'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**等于**：提供的文本必须与字段的值相同'
- en: '**Starts with**: The field has to begin with the provided text'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**以...开始**：字段必须以提供的文本开头'
- en: '**Ends with**: The field has to end with the provided text'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**以...结束**：字段必须以提供的文本结束'
- en: '**Is empty**: The field has to be empty'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**为空**：字段必须为空'
- en: 'For example, when adding a filter, such as **User full name starts with “cl”**,
    all users whose name begins with *cl* are displayed. Take a look at the following
    screenshot:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，当添加一个过滤器，如**用户全名以“cl”开头**，所有以 *cl* 开头的用户都会显示。请查看以下屏幕截图：
- en: '![Figure 5.8 – Filtering user accounts I ](img/Figure_5.08_B18779.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.8 – 过滤用户账户 I](img/Figure_5.08_B18779.jpg)'
- en: Figure 5.8 – Filtering user accounts I
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.8 – 过滤用户账户 I
- en: 'You can see that the added filter is now active, which becomes more useful
    once multiple filters have been added (switch to advanced mode via the **Show
    more…** link). Now, we can apply filters to a wide range of fields:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到，现在添加的过滤器已激活，一旦添加了多个过滤器，它将变得更加有用（通过**显示更多…**链接切换到高级模式）。现在，我们可以将过滤器应用于广泛的字段：
- en: '![Figure 5.9 – Filtering user accounts II ](img/Figure_5.09_B18779.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.9 – 过滤用户账户 II](img/Figure_5.09_B18779.jpg)'
- en: Figure 5.9 – Filtering user accounts II
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.9 – 过滤用户账户 II
- en: For instance, in the preceding screenshot, we look for all users whose username
    starts with **22** (assuming the naming scheme starts with the year of entry)
    and whose account has been suspended. Using this mechanism, it is possible to
    add as many filters as required.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在前面的屏幕截图中，我们寻找所有用户名以**22**开头的用户（假设命名方案以入学年份开头）以及账户已被挂起。使用此机制，可以添加所需的任何数量的过滤器。
- en: Every time a filter is added, it will be shown in the **Active filters** frame
    and applied to the user data in Moodle.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 每次添加过滤器时，它都会显示在**活动过滤器**框架中，并应用于Moodle中的用户数据。
- en: '![Figure 5.10 – Filtering user accounts III ](img/Figure_5.10_B18779.jpg)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.10 – 过滤用户账户 III](img/Figure_5.10_B18779.jpg)'
- en: Figure 5.10 – Filtering user accounts III
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.10 – 过滤用户账户 III
- en: Here, three self-explanatory filters have been added. It is now possible to
    delete individual filters (select the filter and click on the **Remove selected**
    button) or **Remove all filters**.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，已添加了三个一目了然的过滤器。现在可以删除单个过滤器（选择过滤器并点击**删除所选**按钮）或**删除所有过滤器**。
- en: 'The filter criteria for text fields have been described earlier in this section.
    Depending on the field type, some additional operations can be used, as listed
    in the following table:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 文本字段的筛选标准在本节前面已描述。根据字段类型，可以使用一些额外的操作，如下表所示：
- en: '![Figure 5.11 – Filtering operations ](img/Figure_5.11_B18779.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.11 – 过滤操作](img/Figure_5.11_B18779.jpg)'
- en: Figure 5.11 – Filtering operations
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.11 – 过滤操作
- en: The **Authentication** criterion offers a selection of all the supported authentication
    methods. We will deal with these later in the chapter. If user profile fields
    have been specified, an additional **User profile fields** criterion is shown,
    offering a choice of all the user-defined fields (as specified earlier).
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: '**认证**标准提供所有支持认证方法的选择。我们将在本章后面处理这些内容。如果指定了用户配置文件字段，则还会显示额外的**用户配置文件字段**标准，提供所有用户定义字段的选择（如之前所述）。'
- en: The current filter settings are saved and can be used the next time you log
    in. Not only that but they are also saved for bulk user actions, which are covered
    in the next section.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 当前筛选设置被保存，可以在下次登录时使用。不仅如此，它们还被保存在下一节中将要介绍的批量用户操作中。
- en: Bulk user actions
  id: totrans-151
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 批量用户操作
- en: 'Bulk actions allow an administrator to perform a single action on multiple
    users, for example, forcing a password to change or sending a message. To illustrate
    how bulk user actions work, have a look at the user actions funnel depicted in
    the following diagram:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 批量操作允许管理员对多个用户执行单个操作，例如，强制更改密码或发送消息。为了说明批量用户操作的工作原理，请查看以下图中描述的用户操作筛选器：
- en: '![Figure 5.12 – Bulk user actions funnel ](img/Figure_5.12_B18779.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.12 – 批量用户操作筛选器](img/Figure_5.12_B18779.jpg)'
- en: Figure 5.12 – Bulk user actions funnel
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.12 – 批量用户操作筛选器
- en: 'The three layers of the funnel have the following characteristics:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 筛子模型的三个层级具有以下特点：
- en: The top layer shows all users in the system (tenant in Moodle Workplace)
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 顶层显示系统中的所有用户（Moodle Workplace中的租户）
- en: The middle layer contains all users after active filters have been applied
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 中间层包含应用了活动过滤器后的所有用户
- en: The bottom layer comprises any users left after you have narrowed down the list
    by selecting users manually
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 底层包含通过手动选择用户缩小列表后留下的任何用户
- en: Various bulk actions can then be applied to this group of chosen user accounts
    by going to **Site administration | Users | Accounts | Bulk user actions**.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过访问**网站管理 | 用户 | 账户 | 批量用户操作**来对所选用户账户组应用各种批量操作。
- en: '![Figure 5.13 – Bulk user actions I ](img/Figure_5.13_B18779.jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.13 – 批量用户操作 I](img/Figure_5.13_B18779.jpg)'
- en: Figure 5.13 – Bulk user actions I
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.13 – 批量用户操作 I
- en: The screen contains three main sections. The first two parts are the familiar
    **New filter** and **Active filters** sections. Interestingly, filters already
    created will also show up on this screen since they have been saved.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: The third part displays the users that match the specified filter criteria in
    the **All filtered** list. Before you can do anything with the users, you must
    move them to the **All selected** list using the **Add to selection** button.
    In the preceding screenshot, all users except one have been moved across. To move
    them back to the **All filtered** list, select the users and click the **Remove
    from selection** button. Two shortcut buttons exist, which allow you to add all
    users from the **All filtered** list to the **All selected** list and use **Remove
    all** to move them in the opposite direction.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: The advantage of this approach is that you can apply several filters in succession
    and select the respective users, for example, in a setting where the usernames
    start with the year of entry. Suppose you wish to select all the users from 2022
    and 2023, filter for all usernames that start with `23`.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: 'When the **Go** button for the **With selected users...** drop-down menu is
    clicked, the operation selected will be performed on the users from the **All
    selected** list. The available operations are shown in the following table:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.14 – Bulk user actions II ](img/Figure_5.14_B18779.jpg)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
- en: Figure 5.14 – Bulk user actions II
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: Now that we know how to deal with existing users, let’s look at how they are
    added to the system.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
- en: Creating user accounts manually
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are two ways to manually create accounts for users to get access to your
    system:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
- en: Adding individual users
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Uploading users in bulk, including their user pictures
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the following three sections, you will learn how to perform and support each
    type.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
- en: Adding individual users
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To add user accounts manually, go to **Site administration | Users | Accounts
    | Add a new user**. Alternatively, you can navigate the list of users and select
    the **Add a new user** button at the bottom of the screen. You will see the same
    form you saw earlier when you edited the user’s profile.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
- en: Adding users manually should be the exception, not the rule. It is highly recommended
    to automate the process.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
- en: You should avoid adding individual users manually as much as possible, as it
    is a very time-consuming, cumbersome, and potentially error-prone procedure. However,
    there are situations when you cannot avoid it, for example, when a student joins
    a school halfway through the term or an external trainer requires access to Moodle
    but is not part of the organization’s staff database.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
- en: If you have more than one user to add, use Moodle’s batch uploading facility,
    which we will look at next.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: Bulk uploading and updating user data
  id: totrans-180
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Uploading users in bulk allows importing multiple user accounts from a text
    file or updating user accounts that already exist in your system.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: 'Learner information is often available in existing applications, such as the
    internal student management information system or HR database, which can export
    data to an Excel spreadsheet or directly to a text file. The data represented
    in the CSV file is then loaded to the Moodle database, and, if specified, users
    are enrolled in courses and added as members to cohorts. This process is shown
    in the following workflow diagram:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 学习者信息通常存在于现有应用程序中，例如内部学生管理系统或人力资源数据库，可以将数据导出为Excel电子表格或直接导出为文本文件。CSV文件中的数据随后被加载到Moodle数据库中，如果指定，用户将被注册到课程中，并添加到班级成员中。此过程在以下工作流程图中显示：
- en: '![Figure 5.15 – Bulk user upload ](img/Figure_5.15_B18779.jpg)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.15 – 批量用户上传](img/Figure_5.15_B18779.jpg)'
- en: Figure 5.15 – Bulk user upload
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.15 – 批量用户上传
- en: You will find excellent and detailed instructions on uploading and updating
    users in batch mode at [docs.moodle.org/en/Upload_users](http://docs.moodle.org/en/Upload_users).
    We will focus on the key elements and upload workflows to supplement the well-documented
    feature.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在[docs.moodle.org/en/Upload_users](http://docs.moodle.org/en/Upload_users)找到有关批量上传和更新用户的优秀和详细说明。我们将关注关键元素和上传工作流程，以补充已充分记录的功能。
- en: The text file format
  id: totrans-186
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 文本文件格式
- en: Before uploading users, you must generate a text file conforming to a specific
    format. Its general format is a **Comma Separated Value** (**CSV**) file, a flat
    text file format. While creating CSV files manually (using a plain text editor
    or a spreadsheet application) is possible, the files are usually generated automatically
    by a system hosting the user data.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 在上传用户之前，您必须生成一个符合特定格式的文本文件。其一般格式是**逗号分隔值**（**CSV**）文件，一种平面文本文件格式。虽然手动创建CSV文件（使用纯文本编辑器或电子表格应用程序）是可能的，但这些文件通常由托管用户数据的系统自动生成。
- en: 'The format of a text file is as follows:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 文本文件的格式如下：
- en: Each line of the file must contain a single record
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件的每一行必须包含一个单独的记录
- en: Each record must be a series of data that are separated by delimiters
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每条记录必须是一系列由分隔符分隔的数据
- en: The first record of the file must contain the list of field names defining the
    structure of the rest of the file
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件的第一条记录必须包含定义文件其余部分结构的字段列表
- en: 'An example of a valid input file is as follows:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 一个有效的输入文件示例如下：
- en: '`username, password, firstname, lastname, email`'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: '`username, password, firstname, lastname, email`'
- en: '`galmond, pwd, Graham, Almond, galmond@openumlaut.com`'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '`galmond, pwd, Graham, Almond, galmond@openumlaut.com`'
- en: '`earmstrong, pwd, Eleanor, Armstrong, earmstrong@openumlaut.com`'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '`earmstrong, pwd, Eleanor, Armstrong, earmstrong@openumlaut.com`'
- en: '`jarnold, pwd, Joanne, Arnold, jarnold@openumlaut.com`'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: '`jarnold, pwd, Joanne, Arnold, jarnold@openumlaut.com`'
- en: The first line contains the list of provided fields, while the remaining three
    lines represent individual users to be uploaded.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 第一行包含提供的字段列表，而其余三行代表要上传的单独用户。
- en: 'Moodle’s upload function supports the following types of data fields:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: Moodle的上传功能支持以下类型的数据字段：
- en: '**Required**: Compulsory fields that must be included'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**必需**：必须包含的必填字段'
- en: '**Password**: Password fields'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码**：密码字段'
- en: '**Optional**: If no value is provided, specified default values will be used'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可选**：如果没有提供值，将使用指定的默认值'
- en: '**Custom**: User-defined profile fields'
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自定义**：用户定义的个人资料字段'
- en: '**Enrolment**: Dealing with courses, roles, and groups'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**注册**：处理课程、角色和组'
- en: '**Cohort**: Adding users as members to cohorts'
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**班级**：将用户添加为班级成员'
- en: '**System**: Assigning and unassigning system roles to and from users'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**系统**：将系统角色分配给用户或从用户中取消分配'
- en: '**Special**: Modifying and deleting user accounts'
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**特别**：修改和删除用户账户'
- en: We will be going through each field type to understand better how Moodle’s user
    batch upload works and how you can use it in your setting.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将逐一介绍每种字段类型，以更好地了解Moodle的用户批量上传工作原理以及如何在您的设置中使用它。
- en: Required fields
  id: totrans-208
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 必需字段
- en: When adding new users, only `firstname` and `lastname` are compulsory. When
    updating records, only `username` is required. You might recall that the user
    profile has a few more compulsory fields, such as the username or email address.
    A default value must be specified via a template if these fields are not provided.
    We will deal with templates later in this chapter.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 当添加新用户时，只需`firstname`和`lastname`是必填项。当更新记录时，只需`username`。你可能还记得用户资料中还有一些其他必填字段，例如用户名或电子邮件地址。如果这些字段没有提供，必须通过模板指定默认值。我们将在本章后面处理模板。
- en: The sample file is an example of an input file containing five fields, including
    the required `firstname` and `lastname`.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 示例文件是一个包含五个字段的输入文件示例，包括必需的`firstname`和`lastname`。
- en: Password
  id: totrans-211
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 密码
- en: The `password` value is required unless `cron` process runs.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 除非`cron`进程运行，否则需要`password`值。
- en: Note
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: If you set `password` to `changeme`, the user will be forced to change the password
    when they log in for the first time. A better way to do this is using the **Force
    password change** option.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 如果将`password`设置为`changeme`，则用户在首次登录时将被强制更改密码。更好的方法是使用**强制密码更改**选项。
- en: Optional fields
  id: totrans-215
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 可选字段
- en: 'As the name suggests, optional fields do not have to be specified—if they are
    not included in the text file, default values are taken, if present. These optional
    fields are as follows:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 如其名所示，可选字段不必指定——如果它们未包含在文本文件中，则如果存在，则使用默认值。以下为这些可选字段：
- en: '![Figure 5.16 – User upload (optional fields) ](img/Figure_5.16_B18779.jpg)'
  id: totrans-217
  prefs: []
  type: TYPE_IMG
  zh: '![图5.16 – 用户上传（可选字段）](img/Figure_5.16_B18779.jpg)'
- en: Figure 5.16 – User upload (optional fields)
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.16 – 用户上传（可选字段）
- en: 'It is crucial to include empty fields when the default setting has to be used.
    These must be left empty even if it is the last field in each record. An empty
    field is represented by two consecutive commas, as shown in the sample file:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 当必须使用默认设置时，必须包含空字段。即使在每个记录的最后一个字段，这些字段也必须保持为空。空字段由两个连续的逗号表示，如下所示，在示例文件中：
- en: '`username, password, firstname, lastname, email, city`'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: '`username, password, firstname, lastname, email, city`'
- en: '`galmond, changeme, Graham, Almond, galmond@openumlaut.com, Kyiv`'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: '`galmond, changeme, Graham, Almond, galmond@openumlaut.com, Kyiv`'
- en: '`earmstrong, , Eleanor, Armstrong, ermstrong@openumlaut.com,`'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: '`earmstrong, , Eleanor, Armstrong, ermstrong@openumlaut.com,`'
- en: '`jarnold, , Joanne, Arnold, jrnold@openumlaut.com, Doha`'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '`jarnold, , Joanne, Arnold, jrnold@openumlaut.com, Doha`'
- en: A `city` field has been added in the preceding sample file, and the default
    city has been set to `city` value for `city` value for `password` fields have
    also been left empty.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的示例文件中已添加`city`字段，并将默认城市设置为`city`值。对于`password`字段，默认值也已设置为空。
- en: Custom profile fields
  id: totrans-225
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 自定义配置文件字段
- en: Any user-defined fields you have specified (in our case, those for parental
    responsibilities) can also be used as part of the batch upload process. Each field
    must be preceded by `profile_field_`; for instance, the field representing the
    Skype ID would be labeled `profile_field_skype_id`.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 您指定的任何用户定义字段（在我们的案例中，那些用于家长责任）也可以作为批量上传过程的一部分使用。每个字段必须以`profile_field_`开头；例如，代表Skype
    ID的字段将被标记为`profile_field_skype_id`。
- en: Custom fields are treated in precisely the same way as optional fields. If specified,
    the values are taken; otherwise, default values will be used, if present.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 自定义字段的处理方式与可选字段完全相同。如果指定了值，则使用这些值；如果没有指定，如果存在，则使用默认值。
- en: Enrolment fields
  id: totrans-228
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 报名字段
- en: Enrolment fields allow you to assign roles to users; you can enrol them in courses
    and assign them to groups. Roles will be covered in detail in [*Chapter 6*](B18779_06.xhtml#_idTextAnchor116),
    *Managing Permissions, Roles, and Capabilities*.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 报名字段允许您将角色分配给用户；您可以在课程中注册他们并将他们分配到组。角色将在[*第6章*](B18779_06.xhtml#_idTextAnchor116)中详细说明，*管理权限、角色和能力*。
- en: 'Each course has to be specified separately by `course1`, `course2`, `course3`,
    and so on. The course name is the course’s short name and the only compulsory
    enrolment field. Each corresponding type, role, group, enrolment start time, enrolment
    period, and enrolment status must have the same postfix: `type1`, `role1`, `group1`,
    `enroltimestart1`, `enrolperiod1`, and `enrolstatus1` correspond to `course1`.'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 每门课程必须通过`course1`、`course2`、`course3`等单独指定。课程名称是课程的简称，并且是唯一的强制报名字段。每个相应的类型、角色、组、报名开始时间、报名期限和报名状态必须具有相同的后缀：`type1`、`role1`、`group1`、`enroltimestart1`、`enrolperiod1`和`enrolstatus1`对应于`course1`。
- en: It is further possible to set a user’s role in a course. Each role has a role
    short name and a role ID, either of which can be specified. If the type is left
    blank or no course is specified, the user will be enrolled as a student. The enrolment
    period sets the enrolment duration in terms of days; the enrolment status suspends
    a user from a course when it’s set to `1`.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 还可以设置用户在课程中的角色。每个角色都有一个角色简称和角色ID，可以指定其中之一。如果类型留空或未指定课程，则用户将被注册为学生。报名期限以天为单位设置报名期限；当设置为`1`时，报名状态将暂停用户参加课程。
- en: If you want to assign users to groups in a course (`group1` in `course1`, `group2`
    in `course2`, and so on), you have to specify the group name or ID. If a specified
    group does not exist, it will be created automatically.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想将用户分配到课程中的组（例如，`course1`中的`group1`，`course2`中的`group2`等），您必须指定组名或ID。如果指定的组不存在，它将被自动创建。
- en: 'The following example demonstrates some of the enrolment features:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 以下示例演示了一些登记功能：
- en: '`username, course1, role1, course2`'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '`username, course1, role1, course2`'
- en: '`galmond, Advanced, editingteacher, Staff`'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '`galmond, Advanced, editingteacher, Staff`'
- en: '`earmstrong, Advanced, examiner, Staff`'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '`earmstrong, Advanced, examiner, Staff`'
- en: '`jarnold, Basic, 3, Staff`'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '`jarnold, Basic, 3, Staff`'
- en: The `course1` field and its corresponding `role1` and `course2` are optional
    enrolment fields. Graham Almond (`galmond`) will be assigned the `editingteacher`
    role in the `Advanced` course, and Eva Armstrong (`earmstrong`) will be assigned
    the `examiner` role. Jonny Arnold (`jarnold`) will be `editingteacher` (the role
    ID is `3`) in the `Basic` course. All three users will be assigned the `student`
    role in the `Staff` course (no role has been specified, hence the default is set).
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '`course1`字段及其对应的`role1`和`course2`是可选的登记字段。Graham Almond (`galmond`)将被分配到`Advanced`课程的`editingteacher`角色，Eva
    Armstrong (`earmstrong`)将被分配到`examiner`角色。Jonny Arnold (`jarnold`)将在`Basic`课程中担任`editingteacher`（角色ID为`3`）。所有三位用户都将被分配到`Staff`课程的`student`角色（未指定角色，因此默认设置为）。'
- en: Cohort fields
  id: totrans-239
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 群体字段
- en: 'Cohort fields allow you to add users as members to cohorts. Like enrolments
    and groups in courses, the field name has to be suffixed by a counter: `cohort1`,
    `cohort2`, and so on. An example file snippet is as follows:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 群体字段允许您将用户添加为群体的成员。与课程中的登记和分组一样，字段名必须后缀一个计数器：`cohort1`、`cohort2`等等。以下是一个示例文件片段：
- en: '`username, firstname, lastname, cohort1, cohort2`'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: '`username, firstname, lastname, cohort1, cohort2`'
- en: '`pupil1, Pupil, One, 7a, drama`'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: '`pupil1, Pupil, One, 7a, drama`'
- en: '`pupil2, Pupil, Two, 7a, archery`'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '`pupil2, Pupil, Two, 7a, archery`'
- en: Users can be added to system cohorts as well as context cohorts. Cohorts will
    be dealt with after this main section.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 用户可以被添加到系统群体以及上下文群体。群体将在本节主要部分之后处理。
- en: System role
  id: totrans-245
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 系统角色
- en: If you need to assign users a system role, you must specify this via `sysrole1`,
    `sysrole2`, and so on. The field’s value has to be `shortname` of the role, for
    instance, `manager` or `coursecreator`.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要分配用户系统角色，您必须通过`sysrole1`、`sysrole2`等指定此角色。字段的值必须是角色的`shortname`，例如`manager`或`coursecreator`。
- en: You can also unassign a system role from a user by preceding the role name with
    the minus symbol, for example, `-manager` or `-coursecreator`.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以通过在角色名称前加减号来从用户中取消分配系统角色，例如`-manager`或`-coursecreator`。
- en: Special fields
  id: totrans-248
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 特殊字段
- en: 'The following special fields are supported:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 支持以下特殊字段：
- en: '`oldusername`: When changing a username, you must provide the current value'
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`oldusername`：当更改用户名时，您必须提供当前值'
- en: '`deleted`: When removing a user, you will set `deleted` to `1`'
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`deleted`: 当删除用户时，您将`deleted`设置为`1`'
- en: '`suspended`: When suspending a user, set `suspended` to `1`; to activate, set
    it to `0`'
  id: totrans-252
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`suspended`: 当暂停用户时，将`suspended`设置为`1`；要激活，设置为`0`'
- en: Special fields are the last category of text file format. Once you have created
    your user file, it is time to upload users to Moodle, which we will tackle next.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 特殊字段是文本文件格式的最后一类文本。一旦您创建了用户文件，就是时候将用户上传到Moodle了，我们将在下一部分讨论。
- en: Uploading users
  id: totrans-254
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 上传用户
- en: 'Uploading users is a four-step process, as shown in the following diagram:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 上传用户是一个四步过程，如下面的图所示：
- en: '![Figure 5.17 – User upload workflow ](img/Figure_5.17_B18779.jpg)'
  id: totrans-256
  prefs: []
  type: TYPE_IMG
  zh: '![图5.17 – 用户上传工作流程](img/Figure_5.17_B18779.jpg)'
- en: Figure 5.17 – User upload workflow
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.17 – 用户上传工作流程
- en: 'The workflow comprises the following four steps:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 工作流程包括以下四个步骤：
- en: Creating or generating the CSV file
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建或生成CSV文件
- en: Uploading the file, specifying metadata, and viewing the data preview
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 上传文件，指定元数据和查看数据预览
- en: Configuring upload settings and default values
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置上传设置和默认值
- en: Checking upload results
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查上传结果
- en: 'We already covered *step 1* in the previous subsection, so let’s jump straight
    to the second and third phases. To upload or update users in batch mode, go to
    **Site administration | Users | Accounts | Upload users,** where the following
    settings are available:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经在上一小节中介绍了*步骤1*，所以让我们直接跳到第二和第三阶段。要批量上传或更新用户，请转到**网站管理 | 用户 | 账户 | 上传用户**，其中以下设置可用：
- en: '**File**: The name of the text file.'
  id: totrans-264
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件**：文本文件的名称。'
- en: '**CSV delimiter**: Specify whether the delimiter is a comma (default), semicolon,
    colon, or tab. In most European locales, for instance, German, French, and Dutch,
    the default delimiter is a semicolon!'
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CSV分隔符**：指定分隔符是逗号（默认）、分号、冒号还是制表符。例如，在大多数欧洲地区，如德国、法国和荷兰，默认分隔符是分号！'
- en: '**Encoding**: The encoding scheme of your uploaded file specifies the locale
    in which it has been saved (the default is **UTF-8**).'
  id: totrans-266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**编码**：您上传文件的编码方案指定了它被保存的locale（默认为**UTF-8**）。'
- en: '**Preview rows**: The number of rows displayed on the preview screen.'
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**预览行**：预览屏幕上显示的行数。'
- en: '![Figure 5.18 – Upload users configuration ](img/Figure_5.18_B18779.jpg)'
  id: totrans-268
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.18 – 上传用户配置](img/Figure_5.18_B18779.jpg)'
- en: Figure 5.18 – Upload users configuration
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.18 – 上传用户配置
- en: 'Once this screen has been confirmed, you will see the following four sections:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦确认此屏幕，您将看到以下四个部分：
- en: '**Upload users** preview: A sneak peek of the specified number of rows that
    will be uploaded. Records that are to be skipped will not be shown.'
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**上传用户**预览：预览屏幕上显示的指定行数的预览。要跳过的记录将不会显示。'
- en: '**Settings**: Different options, which depend on the selected upload type.'
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**设置**：取决于所选上传类型的不同选项。'
- en: '**Default values**: All the user fields for which default values can be set.'
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**默认值**：可以设置默认值的所有用户字段。'
- en: '**Custom values**: Any user-defined fields grouped by category, if present.'
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自定义值**：如果有，按类别分组的任何用户定义字段。'
- en: 'Remember that not all settings exist for all upload types; they will remain
    hidden if they are not applicable. The following table shows which settings are
    available for which upload type:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，并非所有设置都适用于所有上传类型；如果它们不适用，它们将保持隐藏。以下表格显示了哪些设置适用于哪些上传类型：
- en: '![Figure 5.19 – Upload users settings ](img/Figure_5.19_B18779.jpg)'
  id: totrans-276
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.19 – 上传用户设置](img/Figure_5.19_B18779.jpg)'
- en: Figure 5.19 – Upload users settings
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.19 – 上传用户设置
- en: 'Here is a brief description of each **Upload users** setting:'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是每个**上传用户**设置的简要说明：
- en: '`cron` process will generate a one-off password automatically if none is specified
    (**Create password if needed and send via email**).'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果未指定，`cron`进程将自动生成一个一次性密码（**如有需要创建密码并通过电子邮件发送**）。
- en: '**Existing user details**: Specifies what action is performed on the existing
    user details when an account is updated. The options are **No changes**, **Override
    with file**, **Override with file and defaults**, and **Fill in missing [fields]
    from file and defaults**.'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**现有用户详情**：指定在账户更新时对现有用户详情执行的操作。选项包括**无更改**、**用文件覆盖**、**用文件和默认值覆盖**以及**从文件和默认值中填写缺失[字段]**。'
- en: '**Existing user password**: Specifies what happens with users’ passwords when
    the user details are updated. The password can be left unchanged (**No changes**)
    or overridden (**Update**).'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**现有用户密码**：指定当用户详细信息更新时用户密码会发生什么。密码可以保持不变（**无更改**）或被覆盖（**更新**）。'
- en: '**Force password change**: Specifies when to tag accounts requiring users to
    change the password (**Users having a weak password**, **None**, and **All**).'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**强制密码更改**：指定何时标记需要用户更改密码的账户（**拥有弱密码的用户**、**无**和**所有**）。'
- en: '`oldusername` field.'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`oldusername`字段。'
- en: '`deleted` field.'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`deleted`字段。'
- en: '`suspended` field.'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`suspended`字段。'
- en: '**Prevent email address duplicates**: Multiple users can have the same email
    address (as discussed in the *Understanding user profiles* section). This setting
    will only show if **Allow accounts with same email** on **Site administration
    | Plugins | Authentication | Manage authentication** is enabled.'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**防止电子邮件地址重复**：多个用户可以拥有相同的电子邮件地址（如*理解用户配置文件*部分所述）。此设置仅在**站点管理 | 插件 | 认证 | 管理认证**上启用了**允许具有相同电子邮件的账户**时才会显示。'
- en: '**Standardise usernames**: Removes any invalid characters from usernames (extended
    characters, unless allowed, as well as spaces) and ensures that all characters
    are lowercase.'
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标准化用户名**：从用户名中删除任何无效字符（除非允许，则为扩展字符以及空格）并确保所有字符都是小写。'
- en: '**Select for bulk user operations**: You can specify whether **New users**,
    **Updated users**, or **All users** should be selected for bulk operations. You
    will see the names in the user list for **Bulk user actions**.'
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**选择批量用户操作**：您可以指定是否选择**新用户**、**更新用户**或**所有用户**进行批量操作。您将在用户列表中看到**批量用户操作**的名称。'
- en: Default values have been mentioned a few times so far; now, it is time to deal
    with them alongside templates.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止已经提到了几次默认值；现在，是时候与模板一起处理它们了。
- en: Setting default values and templates
  id: totrans-290
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设置默认值和模板
- en: Moodle’s user batch upload function supports default values that are used if
    no value has been set. Default values cover all user profile fields that can be
    uploaded as well as user-defined custom fields.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: Moodle的用户批量上传功能支持默认值，如果未设置值，则使用这些默认值。默认值涵盖所有可以上传的用户配置文件字段以及用户定义的自定义字段。
- en: 'Each text-based field can be populated using a template. This feature is helpful
    for optional fields, such as the URL of students’ websites, and is compulsory
    for required fields if they’re not specified in the CSV file, for example, `username`
    and `email`. Moodle will warn you if the latter is the case. For example, in the
    following screenshot, **Username template** has not been provided, which is indicated
    by the red warning message:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 每个基于文本的字段都可以使用模板进行填充。此功能对于可选字段很有帮助，例如学生的网站 URL，如果它们在 CSV 文件中未指定，则对于必填字段是强制性的，例如
    `username` 和 `email`。如果后者是这种情况，Moodle 将会警告您。例如，在下面的屏幕截图中，**用户名模板**尚未提供，这由红色警告信息表示：
- en: '![Figure 5.20 – Template missing ](img/Figure_5.20_B18779.jpg)'
  id: totrans-293
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.20 – 模板缺失](img/Figure_5.20_B18779.jpg)'
- en: Figure 5.20 – Template missing
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.20 – 模板缺失
- en: 'The template (or pattern) will create a value based on the values of other
    fields and the standard characters you specify. A template can comprise the following
    content:'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 模板（或模式）将根据其他字段的值和您指定的标准字符创建一个值。模板可以包含以下内容：
- en: '**Replacement values**: The value is substituted by the corresponding profile
    field'
  id: totrans-296
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**替换值**：值由相应的配置文件字段替换'
- en: '**Template modifiers**: The value is converted or truncated based on the modifier'
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模板修饰符**：根据修饰符转换或截断值'
- en: '**Standard text**: Plain text is included without any modification'
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标准文本**：包含没有任何修改的纯文本'
- en: 'The following table hopefully clarifies the preceding concepts:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 下表可能有助于澄清前面的概念：
- en: '![Figure 5.21 – Template content ](img/Figure_5.21_B18779.jpg)'
  id: totrans-300
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.21 – 模板内容](img/Figure_5.21_B18779.jpg)'
- en: Figure 5.21 – Template content
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.21 – 模板内容
- en: There are four replacement values, indicated by a percentage. For example, if
    the username should be the first name of a user, followed by a period, and then
    the surname, the template would look like `%f.%l`.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 有四个替换值，由百分比表示。例如，如果用户名应该是用户的名字，后面跟着一个点，然后是姓氏，模板看起来就像 `%f.%l`。
- en: Four modifiers can be included between the `%` sign and any of the three code
    letters (`l`, `f`, and `u`), where the hash represents a decimal number. The last
    template is an example embedding the replacement values inside other text; in
    this case, it is a URL representing a user’s home page.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `%` 符号和三个代码字母（`l`、`f` 和 `u`）中的任何一个之间可以包含四个修饰符，其中井号代表十进制数字。最后一个模板是一个示例，它将替换值嵌入到其他文本中；在这种情况下，它是一个代表用户主页的
    URL。
- en: This completes the third step of our user upload workflow. The last step is
    to load and review the actual user data.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了我们用户上传工作流程的第三步。最后一步是加载和审查实际的用户数据。
- en: Loading of data
  id: totrans-305
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 数据加载
- en: Once all the settings have been specified, the default values have been provided,
    and the **Upload users** button has been pressed, Moodle will finally start the
    actual importing process.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦所有设置都已指定，默认值已提供，并且已按下**上传用户**按钮，Moodle 将最终开始实际的导入过程。
- en: Important note
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: It is highly recommended that you create a test file with a smaller number of
    dummy records first to ensure that the syntax is correct.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 强烈建议您首先创建一个包含较少虚拟记录的测试文件，以确保语法正确。
- en: Moodle displays a large table that contains all the user fields that have been
    added and/or changed. It also shows the status of each field, including any problems
    or errors that have occurred.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: Moodle 显示一个包含所有已添加和/或更改的用户字段的大表。它还显示每个字段的状况，包括发生的任何问题或错误。
- en: 'A message is displayed at the end of the results screen, summarizing the upload
    process. It contains the number of users created and updated, those with a weak
    password (according to the password policy), and the number of errors. Take a
    look at the following screenshot:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 结果屏幕底部会显示一条消息，总结上传过程。它包含创建和更新的用户数量，那些有弱密码（根据密码策略），以及错误数量。请看以下屏幕截图：
- en: '![Figure 5.22 – Reviewing upload results ](img/Figure_5.22_B18779.jpg)'
  id: totrans-311
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.22 – 审查上传结果](img/Figure_5.22_B18779.jpg)'
- en: Figure 5.22 – Reviewing upload results
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.22 – 审查上传结果
- en: It is recommended that you immediately identify invalid user accounts and modify
    their user settings manually or fix the upload file and do a re-run.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 建议您立即识别无效的用户账户，并手动修改它们的用户设置或修复上传文件并重新运行。
- en: 'Bulk user operations provide a versatile means to create and update textual
    user data. However, one type of user information that CSV files cannot process
    exists: profile images. Moodle comes with a dedicated feature that deals with
    user pictures. Let’s take a look at it in the next section.'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
- en: Uploading user pictures
  id: totrans-315
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'As described so far, the process of uploading users does not support profile
    images; instead, user pictures must be uploaded separately. The workflow to upload
    user images is simple yet effective, as depicted in the following diagram:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.23 – User pictures upload workflow ](img/Figure_5.23_B18779.jpg)'
  id: totrans-317
  prefs: []
  type: TYPE_IMG
- en: Figure 5.23 – User pictures upload workflow
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
- en: The upload user picture tool can be found at `attribute.ext`.
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
- en: The `ext` is the filename extension (`.jpg`, `.gif` or `.png`). The image filenames
    are not case sensitive.
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.24 – Upload user pictures ](img/Figure_5.24_B18779.jpg)'
  id: totrans-321
  prefs: []
  type: TYPE_IMG
- en: Figure 5.24 – Upload user pictures
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
- en: For example, if the username consists of the first name’s initial and a surname
    (`%1f%l`, if expressed in template style), the valid filenames are `psmith.png`,
    `lcohen.png`, and `mstripe.png`. If the users exist, the pictures will be added
    to their profiles; otherwise, they will be ignored. If a picture already exists
    for a user, it will only be replaced if you have enabled the **Overwrite existing
    user pictures?** option.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
- en: 'So far, we have only looked at individual users on an account-by-account basis.
    Moodle thrives on being a learning system that supports communication and collaboration
    among learners and teachers. To support working together, users can be arranged
    in two ways: groups and groupings at the course level, and cohorts at the system
    or category level. We have already come across groups in the previous chapter
    and during the user batch upload, so let’s have a closer look at cohorts now.'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
- en: Managing cohorts
  id: totrans-325
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We have already come across cohorts in [*Chapter 4*](B18779_04.xhtml#_idTextAnchor074),
    *Managing Courses and Enrolment*, and in the introductory diagram of this chapter.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
- en: Cohorts are groups that are used to logically cluster related users.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
- en: 'So far, we mainly mentioned cohorts in the context of enrolments; however,
    cohorts are utilized by Moodle in various places, such as the following:'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
- en: Course enrolments and synchronization
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cohort themes provide a user experience to a pre-defined group of users, for
    example, visually impaired learners
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Report audiences to limit access of a report to cohorts
  id: totrans-332
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Execute actions automatically, such as notifying or issuing a certificate to
    a cohort as part of dynamic rules (Moodle Workplace only)
  id: totrans-333
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Zooming in on the cohort element, we can see its structure and properties:'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.25 – Cohorts (high-level) ](img/Figure_5.25_B18779.jpg)'
  id: totrans-335
  prefs: []
  type: TYPE_IMG
- en: Figure 5.25 – Cohorts (high-level)
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
- en: Let’s have a closer look at how to create and manage cohorts. To do this, navigate
    to **Site administration | Users | Accounts | Cohorts**.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.26 – Available cohorts ](img/Figure_5.26_B18779.jpg)'
  id: totrans-338
  prefs: []
  type: TYPE_IMG
- en: Figure 5.26 – Available cohorts
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.26 – 可用班级
- en: The details of each cohort and its standard actions (hide, delete, edit, and
    assign) are provided. The **All cohorts** tab provides an almost identical view,
    displaying system and category cohorts.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 提供了每个班级的详细信息及其标准操作（隐藏、删除、编辑和分配）。**所有班级**标签提供几乎相同的视图，显示系统和类别班级。
- en: To create a cohort, select the **Add new cohort** tab and specify the cohort’s
    properties. **Context** is the scope of the cohort that indicates where the cohort
    can be used; the options are **System** (global or site-wide) and a selected category.
    **Cohort ID** is optional, but it is good practice to set this as it will be used
    for different operations, such as when adding bulk users.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建班级，请选择**添加新班级**标签并指定班级属性。**上下文**是班级的范围，表示班级可以使用的位置；选项是**系统**（全局或站点范围）和所选类别。**班级ID**是可选的，但将其设置为良好实践，因为它将在不同的操作中使用，例如在添加批量用户时。
- en: '![Figure 5.27 – Adding a cohort ](img/Figure_5.27_B18779.jpg)'
  id: totrans-342
  prefs: []
  type: TYPE_IMG
  zh: '![图5.27 – 添加班级](img/Figure_5.27_B18779.jpg)'
- en: Figure 5.27 – Adding a cohort
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.27 – 添加班级
- en: Once you have added a cohort, you will return to the list of all cohorts. Now,
    you should add members to it by selecting the **Assign** icon, which will display
    the familiar user selection screen to add or remove cohort memberships.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦添加了班级，你将返回所有班级的列表。现在，你应该通过选择**分配**图标来添加成员，这将显示熟悉的用户选择屏幕以添加或删除班级成员资格。
- en: Important note
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Removing users from a cohort will unenrol them from all courses where cohort
    synchronization has been enabled!
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 从班级中删除用户将取消他们在所有已启用班级同步的课程中的注册！
- en: 'Instead of adding cohorts manually, you can perform this task in a batch via
    the **Upload cohorts** tab. The principle is the same as adding users in batch
    mode, as described in the previous section. Here is a sample file representing
    the cohorts used earlier:'
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过**上传班级**标签批量执行此任务，而不是手动添加班级。这与上一节中描述的批量添加用户的原则相同。以下是一个表示之前使用的班级的示例文件：
- en: '`name, contextid, idnumber, description, visible`'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: '`name, contextid, idnumber, description, visible`'
- en: '`7a, 1, 7a, All students from class 7a, 1`'
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: '`7a, 1, 7a, 7a班的所有学生，1`'
- en: '`7b, 1, 7b, All students from class 7b, 1`'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: '`7b, 1, 7b, 7b班的所有学生，1`'
- en: '`7c, 1, 7c, All students from class 7c, 1`'
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: '`7c, 1, 7c, 7c班的所有学生，1`'
- en: '`Temp, , , Used as a placeholder, 0`'
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: '`Temp, , , 用作占位符，0`'
- en: You can find details on uploading cohorts, including optional and additional
    fields, at [docs.moodle.org/en/Upload_cohorts](http://docs.moodle.org/en/Upload_cohorts).
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在[docs.moodle.org/en/Upload_cohorts](http://docs.moodle.org/en/Upload_cohorts)上找到有关上传班级的详细信息，包括可选和附加字段。
- en: Now that you know everything about user accounts and the information stored
    about them, let’s look at how to authenticate them with Moodle.
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经了解了有关用户账户及其存储的信息的所有内容，让我们看看如何使用Moodle进行用户认证。
- en: Configuring user authentication
  id: totrans-355
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置用户认证
- en: Authentication is the process of getting access to a system. Moodle supports
    a significant number of authentication types. Furthermore, Moodle supports **multi-authentication**,
    that is, concurrent authentication from different authentication sources. For
    example, your organization might use an LDAP server containing user information
    for all your staff, and OAuth2 for students, but it wishes to manage part-time
    users locally.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 认证是获取系统访问权限的过程。Moodle支持大量的认证类型。此外，Moodle支持**多认证**，即来自不同认证源的并发认证。例如，您的组织可能使用包含所有员工信息的LDAP服务器，并为学生使用OAuth2，但希望本地管理兼职用户。
- en: 'In the second half of this chapter, we will explore user authentication and
    the overall management of authentication plugins before covering common authentication
    settings. Then, we will deal with all authentication methods, which have been
    grouped into four categories: internal, external, provider, and system.'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的后半部分，我们将探讨用户认证和认证插件的总体管理，然后介绍常见的认证设置。然后，我们将处理所有认证方法，这些方法已被分为四类：内部、外部、提供者和系统。
- en: Exploring user authentication
  id: totrans-358
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索用户认证
- en: 'Remember the basic authentication workflow we looked at in [*Chapter 3*](B18779_03.xhtml#_idTextAnchor059),
    *Exploring Courses, Users, and Roles*. Now, we can have a look at a more complete
    picture, as shown in the following diagram:'
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 记住我们在[*第3章*](B18779_03.xhtml#_idTextAnchor059)“探索课程、用户和角色”中查看的基本认证工作流程。现在，我们可以查看一个更完整的图景，如下所示：
- en: '![Figure 5.28 – Authentication workflow ](img/Figure_5.28_B18779.jpg)'
  id: totrans-360
  prefs: []
  type: TYPE_IMG
  zh: '![图5.28 – 认证工作流程](img/Figure_5.28_B18779.jpg)'
- en: Figure 5.28 – Authentication workflow
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.28 – 认证工作流程
- en: Let’s start from the top, where the user enters their user credentials, for
    example, username and password. Bear in mind that this could take place automatically,
    for example, in a single sign-on setup or via a service provider login. Moodle
    checks whether a profile exists for the user. If it does and the account is authenticated
    via an internal mechanism, Moodle only has to check whether the credentials are
    valid.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从顶部开始，用户在此输入他们的用户凭据，例如，用户名和密码。请注意，这可能会自动完成，例如，在单点登录设置或通过服务提供商登录。Moodle 会检查是否存在该用户的个人资料。如果存在并且账户通过内部机制进行认证，Moodle
    只需检查凭据是否有效。
- en: If the user profile doesn’t exist, which is often the case the first time a
    user attempts to log in, Moodle checks for any enabled and configured external
    provider-based authentication mechanisms. If there is a valid entry, an account
    will be created, any existing data for which a mapping exists will be copied to
    the local user profile, and access will be granted.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 如果用户个人资料不存在，这通常是用户第一次尝试登录时的情况，Moodle 会检查任何启用和配置的外部提供者基于的认证机制。如果存在有效条目，将创建一个账户，任何存在映射的现有数据将被复制到本地用户个人资料，并授予访问权限。
- en: Once the profile exists and authentication is external or via a provider, Moodle
    checks whether the credentials are valid for the set authentication method. If
    this is the case, any modified data in the source will be updated, and access
    will be granted.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦个人资料存在并且认证是外部或通过提供者，Moodle 会检查凭据是否适用于设置的认证方法。如果是这种情况，源中的任何修改数据将被更新，并授予访问权限。
- en: Managing user authentication
  id: totrans-365
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 管理用户认证
- en: To access all the authentication plugins, go to **Site administration | Plugins
    | Authentication | Manage authentication**. You will see a list of available authentication
    plugins. Each plugin can be activated/deactivated by toggling the **show/hide**
    icon. The settings for each type discussed in this section are accessed by their
    respective links or directly through the link in the plugins menu once the authentication
    method is active.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问所有认证插件，请转到 **站点管理 | 插件 | 认证 | 管理认证**。您将看到可用的认证插件列表。每个插件可以通过切换 **显示/隐藏** 图标来激活/停用。本节中讨论的每种类型的设置可以通过其相应的链接或一旦认证方法激活，直接通过插件菜单中的链接访问。
- en: You can also change the order in which Moodle attempts to authenticate users
    via the up and down arrows.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以通过上下箭头更改 Moodle 尝试通过认证用户的顺序。
- en: Important note
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: The order in which authentication plugins are applied will impact how long it
    takes for users to log in, so make sure that the main ones are at the top.
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 认证插件应用的顺序将影响用户登录所需的时间，所以请确保主要插件位于顶部。
- en: The **Users** column gives you an indication of the number of registered users
    for each authentication mechanism.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: '**用户** 列提供了每个认证机制的注册用户数量的指示。'
- en: '![Figure 5.29 – Authentication plugins ](img/Figure_5.29_B18779.jpg)'
  id: totrans-371
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.29 – 认证插件](img/Figure_5.29_B18779.jpg)'
- en: Figure 5.29 – Authentication plugins
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.29 – 认证插件
- en: Additional authentication methods are supported by external plugins on [moodle.org/plugins/?q=type:auth](http://moodle.org/plugins/?q=type:auth),
    for example, **OpenID** and **SAML2**. Once installed (refer to the *Installing
    third-party add-ons* section in [*Chapter 8*](B18779_08.xhtml#_idTextAnchor168),
    *Understanding Moodle Plugins*), they will appear in the list alongside all the
    core authentication methods. It is not recommended that you remove plugins via
    the **Uninstall** option—delete them at the system level instead.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 通过外部插件支持额外的认证方法，例如 [moodle.org/plugins/?q=type:auth](http://moodle.org/plugins/?q=type:auth)
    上的 **OpenID** 和 **SAML2**。一旦安装（请参阅 [*第 8 章*](B18779_08.xhtml#_idTextAnchor168)
    中的 *安装第三方插件* 部分，*理解 Moodle 插件*），它们将出现在列表中，并列在所有核心认证方法旁边。不建议您通过 **卸载** 选项删除插件——而是在系统级别删除它们。
- en: 'The following diagram illustrates a clustering of Moodle authentication plugins:'
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表展示了 Moodle 认证插件的聚类：
- en: '![Figure 5.30 – Authentication plugins grouping ](img/Figure_5.30_B18779.jpg)'
  id: totrans-375
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.30 – 认证插件分组](img/Figure_5.30_B18779.jpg)'
- en: Figure 5.30 – Authentication plugins grouping
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.30 – 认证插件分组
- en: This grouping also forms the structure of the remainder of the chapter, starting
    with common authentication settings all mechanisms share.
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 此分组也形成了本章剩余部分的结构，从所有机制共享的常见认证设置开始。
- en: Common authentication settings
  id: totrans-378
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 常见认证设置
- en: 'First, let’s look at the common authentication settings, which you will see
    under the list of available plugins. Whatever your preferred authentication system(s)
    is, several common settings apply across all methods:'
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
- en: '**Self registration**: Specify which plugin, if any, is used for self-registration
    (refer to the next section for details).'
  id: totrans-380
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Allow login via email**: Users can log in via their username or email address
    as long as the latter is unique.'
  id: totrans-381
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Allow accounts with same email**: In some settings, users will have to share
    the same email address. We discussed this topic in the *Understanding user profiles*
    section.'
  id: totrans-382
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Prevent account creation when authenticating**: Some authentication mechanisms,
    for instance, LDAP, support the creation of new accounts. If this is prevented,
    you must ensure that the accounts are created by other means.'
  id: totrans-383
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Autofocus login page form**: When enabled, the cursor on the login page will
    always jump directly to the username input field if it is empty or to the password
    field otherwise.'
  id: totrans-384
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Guest login button**: By default, guest access to your Moodle system is allowed.
    If you disable this, which is recommended for most educational and commercial
    sites, the guest login button will not be shown on the login screen.'
  id: totrans-385
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Important note
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
- en: Ensure to disable guest access to your Moodle system to prevent unwanted registrations.
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
- en: '**Limit concurrent logins**: You can specify the number of simultaneous browser
    logins. Once the number has been exceeded, the oldest session will be terminated.
    This limitation is useful in exam scenarios where you might allow only a single
    concurrent login.'
  id: totrans-388
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Alternate login URL**: By default, users have to log on to Moodle via the
    standard login screen. However, to change the source of the login credentials
    (username and password), enter the correct URL here. This redirect is necessary
    if you wish to have a login block on a separate web page, such as your home page.
    Details of this mechanism are shown in the *Customizing the login* subsection
    in [*Chapter 7*](B18779_07.xhtml#_idTextAnchor140), *Enhancing Moodle’s Look and
    Feel*.'
  id: totrans-389
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Forgotten password URL**: Moodle has a built-in mechanism to deal with lost
    or forgotten passwords. You should enter its URL here if you use an authentication
    method with its own password-recovery system.'
  id: totrans-390
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Instructions**: It is good practice to provide information on how to sign
    up for the system and what format the username should have (this only applies
    to self-registration). There are default instructions if it’s left blank.'
  id: totrans-391
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`openumlaut.com` or `.edu`.'
  id: totrans-392
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Restrict domains when changing email**: If enabled, the allowed/denied email
    domain settings will also be applied when an email address is changed.'
  id: totrans-393
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**ReCAPTCHA public/private key**: This is the key to display the reCAPTCHA
    element on the signup form/to communicate with the reCAPTCHA server (refer to
    the *Email-based self-registration* section).'
  id: totrans-394
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Some common authentication settings will make more sense once we have dealt
    with the authentication methods they impact. Let’s start with internal authentication
    methods.
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
- en: Internal authentication methods
  id: totrans-396
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Internal authentication methods handle all authentication within Moodle; no
    other system is connected. There are two internal authentication methods: manual
    accounts and email-based self-registration.'
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
- en: Manual accounts
  id: totrans-398
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Manual account authentication is simply the verification at login that the entered
    user credentials (username and password) stored in Moodle are correct.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
- en: The main Moodle administrator account is always a manual account.
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
- en: 'There are two types of settings for all manual accounts created: password expiry
    and the locking of user fields. Both can be changed by navigating to **Site administration
    | Plugins | Authentication | Manual accounts**.'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.31 – Manual accounts settings ](img/Figure_5.31_B18779.jpg)'
  id: totrans-403
  prefs: []
  type: TYPE_IMG
- en: Figure 5.31 – Manual accounts settings
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
- en: Password expiry lets you choose how long a password is valid via the **Password
    duration** setting before it has to be changed by a user. **Notification threshold**
    lets you specify when a user is notified of the password rotation.
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
- en: You can lock fields for accounts that are manually created or uploaded via batch
    files. This locking mechanism is helpful whenever you do not want users to be
    able to change specific data in their user profiles—young students may misuse
    the **Description** field, the ID number may be used internally to link to other
    systems, the company might have provided the email address, and so on.
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
- en: By default, all fields are **Unlocked**. If a field is **Locked**, the user
    will not be able to change its value. If you lock any compulsory fields, you either
    have to ensure they are populated correctly, or you set their lock state to **Unlocked
    if empty**. The latter will force the user to enter the value the next time they
    log in and lock the field afterward.
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
- en: 'Accounts verified by the manual authentication method are usually created manually
    or via user batch upload. Both operations have been described in detail in the
    first part of this chapter, where the latter effectively automates manual account
    creation. Two other authentication mechanisms mimic adding user accounts manually:
    web services, which we deal with in the *System authentication methods* section
    later on, and *Email-based self-registration*, which we cover next.'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
- en: Email-based self-registration
  id: totrans-409
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Moodle supports a mechanism that allows users to create accounts without any
    intervention or knowledge of the administrator. When new users sign up with Moodle
    via the **Create new account** button on the login screen, they can choose their
    new username and password. Once this step has been completed, a confirmation mail
    is sent to the user’s email address, containing a secure link that must be confirmed
    to activate the account. The signup screen looks like this:'
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.32 – Self-registration signup screen ](img/Figure_5.32_B18779.jpg)'
  id: totrans-411
  prefs: []
  type: TYPE_IMG
- en: Figure 5.32 – Self-registration signup screen
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
- en: We explained how to add more items to the signup screen (via the **Display on
    signup page** option) when dealing with user-defined profile fields. This feature
    is often invaluable in commercial training settings when additional data, such
    as the learner’s address, a participant’s dietary requirements, or a customer
    number, has to be gathered.
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
- en: Moodle supports a **reCAPTCHA** mechanism activated on the pictured signup screen.
    The facility is used to avoid automated signups by bots. To enable this facility,
    you must sign up for an account at [www.google.com/recaptcha](http://www.google.com/recaptcha),
    add the public and private key in **Common settings** in the **Manage Authentication**
    area, and enable the **reCAPTCHA** element.
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
- en: The PHP cURL extension must be installed for reCAPTCHA to work.
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
- en: The same locking settings can be set for self-registration as for manual accounts
    (go to **Site administration | Plugins | Authentication | Email-based self-registration**).
    Also, the same restrictions apply as described earlier. Additionally, you have
    the **Enable reCAPTCHA element** option.
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
- en: If a user policy has been specified when you navigate to **Site administration
    | Users | Privacy and policies | Policy settings**, a link to the agreement with
    the confirmation checkbox is shown on the signup screen. We will deal with more
    complex user consent handling as part of the GDPR set up in [*Chapter 14*](B18779_14.xhtml#_idTextAnchor271),
    *Complying with Data Protection Regulations*.
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
- en: 'If the confirmation email cannot be sent, for instance, because of technical
    issues, go to the list of users, where you will find two links beside the account
    entry: one to confirm the account and one to resend the email.'
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
- en: 'Before we move on to the next authentication method, here is a short checklist
    for setting up self-registration (apart from enablement, all steps are optional):'
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.33 – Checklist for self-registration ](img/Figure_5.33_B18779.jpg)'
  id: totrans-421
  prefs: []
  type: TYPE_IMG
- en: Figure 5.33 – Checklist for self-registration
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
- en: Allowing users to register accounts on your site comes with a degree of risk
    since you have no control over who – humans or bots – is coming to your site (assuming
    it is publicly accessible). Therefore, it is highly recommended to test self-registration
    thoroughly and regularly check your new users list.
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have covered internal authentication, it is time to look over the
    (Moodle) fence and deal with external methods.
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
- en: External authentication methods
  id: totrans-425
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: External authentication methods require a separate, connected system to handle
    authentication. We will cover two external authentication methods in detail (LDAP
    and databases) and two more we only briefly describe (CAS and Shibboleth).
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
- en: LDAP server
  id: totrans-427
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In the previous chapter, we had already seen a basic introduction to LDAP when
    dealing with course enrolment. Now, let’s look at how it can be utilized for **single
    sign-on** (**SSO**) authentication. We will only cover the basic LDAP settings
    and exclude advanced setups, such as multiple LDAP servers and secure LDAP. These
    configurations are documented in great detail at [docs.moodle.org/en/LDAP_authentication](http://docs.moodle.org/en/LDAP_authentication).
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
- en: The principle of the LDAP authentication method is relatively simple but effective—if
    the entered username and password are valid, Moodle creates a new user account
    in its database if it doesn’t already exist. Once it does exist, that is, from
    the second login onwards, the credentials are checked against LDAP for validity.
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
- en: The PHP LDAP extension must be installed on the server for LDAP authentication
    to work.
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
- en: Go to **Site administration | Plugins | Authentication | LDAP server** to see
    the settings, which also cover **Active Directory** (Microsoft’s implementation
    of LDAP). There is a significant number of parameters that you must set to communicate
    with an LDAP server. The settings have been amended with detailed explanations
    (which I will not repeat). Instead, additional information is provided wherever
    applicable. Contact your system administrator if you are unsure where to locate
    some of the required information.
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
- en: 'Two parts must be populated to make Moodle work in your LDAP setup: **server
    settings** and **data mappings**, discussed in the following paragraphs.'
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
- en: 'There are ten sections of **LDAP server settings** that have to be provided:'
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
- en: '**LDAP server settings**: These establish the connection to the directory.
    LDAP servers with SSL encryption are also supported.'
  id: totrans-435
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`ou=Students` and `ou=Staff` and your students make up 90% of the logins, it
    is recommended that you put them before their lecturers unless staff is given
    priority.'
  id: totrans-436
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**User lookup settings**: These describe how and where user details are stored
    on your LDAP directory. Make sure you select the correct user type. The same applies
    to the distinguished name in the bind settings for multiple contexts. It is crucial
    to set **Search subcontexts** correctly. If it is set to **No**, subcontexts will
    not be searched, but the search is potentially faster, and vice versa.'
  id: totrans-437
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Force change password**: This specifies whether and how users must change
    passwords when accessing Moodle for the first time.'
  id: totrans-438
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**LDAP password expiration settings**: These are concerned with password lapsing
    and how this is being dealt with.'
  id: totrans-439
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Enable user creation**: This lets you activate a mechanism that is similar
    to self-registration, but, in addition to this, an account is created with the
    values from your LDAP.'
  id: totrans-440
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**System role mapping**: This specifies which LDAP user groups will have manager
    and course creator permissions in Moodle, respectively.'
  id: totrans-441
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**User account synchronization**: This setting specifies what Moodle should
    do with local user accounts when these have been deleted on the LDAP server.'
  id: totrans-442
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**NTLM SSO**: This describes how, in a Windows-based environment with MS-AD
    and NTLM active, users can log in via the Windows domain without re-entering their
    credentials when accessing Moodle. Check out [docs.moodle.org/en/NTLM_authentication](http://docs.moodle.org/en/NTLM_authentication)
    for details.'
  id: totrans-443
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The second half of the admittedly very long screen contains the LDAP data mapping.
    It is common for user profile information to be stored in the LDAP server. To
    connect user profile fields and the Active Directory, a mapping has to be provided
    by specifying their counterparts in the directory for each field in Moodle (including
    user-defined profile fields). All the fields are optional. Default values are
    used if you leave any of the fields blank:'
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.34 – LDAP authentication (data mapping) ](img/Figure_5.34_B18779.jpg)'
  id: totrans-445
  prefs: []
  type: TYPE_IMG
- en: Figure 5.34 – LDAP authentication (data mapping)
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
- en: 'If you provide the field information, you will have to set four parameters
    for each data field, as follows:'
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
- en: '**Data mapping**: This is the field name in the external database representing
    the value in Moodle.'
  id: totrans-448
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Update local**: For each external user, information is stored locally. You
    can update this information using **On creation** (this is faster but potentially
    not up-to-date) or **On every login** (this is a bit slower, but it’s always up
    to date).'
  id: totrans-449
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Update external**: If a user updates the data field’s value in Moodle, you
    can decide whether you want to write this information back to the external database
    (**On update**) or not (**Never**). Often, the external database is a read-only
    view, preventing Moodle from updating data in it.'
  id: totrans-450
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Lock value**: You can specify whether the user can modify the value. As explained
    earlier, the settings (**Unlocked**, **Unlocked if empty**, and **Locked**) are
    identical to the lock field.'
  id: totrans-451
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If you use Microsoft’s Active Directory MS-AD, check out the data mapping section
    in [docs.moodle.org/en/LDAP_authentication](http://docs.moodle.org/en/LDAP_authentication)
    for details.
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
- en: Setting up LDAP authentication can be a bit of trial-and-error. Verifying that
    the connection works can be assisted by the **Test setting** facility located
    in the list of available authentication plugins. More detailed error messages
    will be displayed, which will help you identify any SSO connection issues.
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
- en: 'When using LDAP, you might encounter a situation where you wish to assign courses
    to users before they have logged in to the system for the first time. This scenario
    regularly applies before the start of the academic year. The problem is that the
    local user accounts do not exist yet, and you cannot access this information as
    it is only stored in the external directory. There are two ways around this conundrum:'
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
- en: Create the user accounts via batch files and set the `auth` field to `ldap`;
    that way, you effectively mimic the initial logging in of each user.
  id: totrans-455
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Set up the **LDAP users sync job** scheduled task. Tasks are covered in [*Chapter
    15*](B18779_15.xhtml#_idTextAnchor289), *Optimizing Moodle Performance*.
  id: totrans-456
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: LDAP is effectively a specialized and lightweight database for authentication
    purposes. Authentication against LDAP is very similar to authentication against
    external databases, which is the topic of the following subsection.
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
- en: External databases
  id: totrans-458
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Most large organizations use a student or management information system—either
    open source (good), proprietary (bad), or developed in-house (worst)—which holds
    information about staff and learners. It makes perfect sense to utilize this data
    for authorization to Moodle. Since all information systems use a database at their
    core, all we have to do is to get access to the relevant data.
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
- en: 'IT departments are usually not too keen for external systems to connect directly
    to their database. A mechanism that has proven valuable is the **read-only view**,
    which has several advantages:'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
- en: A view can be prepared for Moodle usage; only required fields are shown in the
    required format
  id: totrans-461
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There’s no write-access to the database
  id: totrans-462
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the database schema of the information system ever changes, only the view
    has to be adapted, not the Moodle configuration
  id: totrans-463
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The external database authentication method contains two types of parameters
    that you have to provide by going to **Site administration | Plugins | Authentication
    | External database**: **connection settings** and **data mappings**.'
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.35 – External database authentication ](img/Figure_5.35_B18779.jpg)'
  id: totrans-465
  prefs: []
  type: TYPE_IMG
- en: Figure 5.35 – External database authentication
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
- en: The database connection settings have been amended with good explanations. Contact
    your database administrator if you are unsure where to locate some of the required
    information.
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
- en: Some databases, such as Oracle, are case sensitive, and field names must be
    provided with the correct casing for the database link to work correctly.
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
- en: The second half of the settings screen contains the data mapping. User profile
    information is stored in the external database. To connect the user profile fields
    and the database, a mapping has to be provided where a counterpart in the external
    store has to be provided for each field in Moodle, including user-defined profile
    fields. All the fields are optional, and default values are used if you leave
    any fields blank.
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
- en: 'Most facilities covered in the LDAP section are also available for external
    database authentication:'
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
- en: Creating user accounts via batch files (set the `auth` field to `db`)
  id: totrans-472
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Automating synchronization via the task scheduler, **Synchronise users task**
  id: totrans-473
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Testing the database connection
  id: totrans-474
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To sum up the topic, here is a checklist for external authentication methods:'
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.36 – Checklist for external database authentication ](img/Figure_5.36_B18779.jpg)'
  id: totrans-476
  prefs: []
  type: TYPE_IMG
- en: Figure 5.36 – Checklist for external database authentication
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
- en: 'Hopefully, the previous two subsections gave you an insight into how external
    authentication mechanisms work in Moodle. Two more methods fall in the same category:
    CAS and Shibboleth.'
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
- en: Other external authentication mechanisms
  id: totrans-479
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Moodle supports some additional external SSO authentication methods that are
    not utilized as often as LDAP, external databases, and OAuth 2; we only briefly
    touch upon them:'
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
- en: '**CAS Server (SSO)**: **Central Authentication Service** (**CAS**) is an open
    source authentication server based on Tomcat and supports single sign-on in a
    web environment. CAS is particularly popular in environments that comprise multiple
    authentication sources and consumers. It utilizes LDAP and, therefore, requires
    the PHP LDAP modules to be installed.'
  id: totrans-481
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`<YOURSITE>/auth/shibboleth/README.txt`. More information on Shibboleth can
    be found at www.internet2.edu/products-services/trust-identity-middleware/shibboleth.'
  id: totrans-482
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All authentication mechanisms covered so far are either internal to Moodle (manual
    accounts and self-registration) or usually local to the organization but external
    to Moodle (LDAP or database). Moodle also supports provider-based authentication
    services via **OAuth 2**, which we will cover next.
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
- en: Service provider-based authentication (OAuth 2)
  id: totrans-484
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: OAuth 2.0 is the de facto industry standard protocol for user authorization.
    OAuth 2 authentication enables users to access Moodle via buttons on the login
    page using their credentials from popular service providers, such as Google, Microsoft,
    Facebook, and LinkedIn.
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.37 – Authentication via OAuth 2 service providers ](img/Figure_5.37_B18779.jpg)'
  id: totrans-486
  prefs: []
  type: TYPE_IMG
- en: Figure 5.37 – Authentication via OAuth 2 service providers
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
- en: 'Before we dive into the configuration of service provider-based authentication,
    have a look at the interaction diagram, which illustrates how OAuth 2 works in
    a Moodle context:'
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.38 – OAuth 2 interactions ](img/Figure_5.38_B18779.jpg)'
  id: totrans-489
  prefs: []
  type: TYPE_IMG
- en: Figure 5.38 – OAuth 2 interactions
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
- en: 'An OAuth service provider is an external system (“in the cloud”) that provides
    identity (via the authorization server) and API access (via the resource server)
    by issuing OAuth access tokens to a client (Moodle). Let’s go through the interactions
    from top to bottom:'
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
- en: A user sends an **authorization request**; that is, a user logs in to the service
    provider via the client. This step is initiated via the service provider buttons
    on the Moodle login screen.
  id: totrans-492
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The authorization server issues an **authorization code** if the entered credentials
    are valid. Once this has taken place, the user is authenticated with Moodle. If
    account creation is enabled (the **Prevent account creation when authenticating**
    setting), a new account will be created. Otherwise, the user will be prompted
    to link the authorization to an existing account with the same email address.
    An entry can be found in the **Linked logins** section in the user’s preferences.
  id: totrans-493
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: An `\core\oauth2\refresh_system_tokens_task`).
  id: totrans-494
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Moodle uses this access token for any internal services that require a **resource**
    from the service provider, for instance, a link to files in a repository. Some
    internal services require a system account to be connected.
  id: totrans-495
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The preceding interaction process is a very crude summary of how OAuth 2 authentication
    works in Moodle, but this should be sufficient to understand the overall concept.
    OK, enough of the high-level stuff; let’s start setting up service provider authentication.
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
- en: The first step is to configure OAuth 2 services in **Site administration | Server
    | Server | OAuth 2 services**.
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.39 – OAuth 2 services](img/Figure_5.39_B18779.jpg)'
  id: totrans-498
  prefs: []
  type: TYPE_IMG
- en: Figure 5.39 – OAuth 2 services
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
- en: At the bottom, you can see all supported service providers. Select the respective
    button to add a preconfigured service, which will direct you to the form to create
    a new service. The service specifications are already populated – all you must
    do is add the **Client ID** and the **Client secret** details of the respective
    service provider.
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
- en: How do you get the client ID and secret? The issuer provides these, so setup
    must be done at their end, not in Moodle. There is a **Service provider setup
    instructions** link for the six supported prominent OAuth 2 providers at the top
    of the screen.
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
- en: It is recommended to leave all fields at their default values for pre-defined
    service providers, except **Client ID**, **Client secret**, and **Service base
    URL**.
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
- en: If you wish to set up a service provider not listed, you can create a **Custom**
    service. The form is identical to the pre-defined services but without any pre-populated
    values. You find details about the purpose of each parameter at [docs.moodle.org/en/OAuth_2_services](http://docs.moodle.org/en/OAuth_2_services).
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
- en: 'Once the service has been created (pre-defined or custom), the standard actions
    are available in the **Edit** column, plus two more actions that require some
    more explanation:'
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
- en: '`authorization_endpoint`, `token_endpoint`, and `userinfo_endpoint`.'
  id: totrans-506
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`userinfo_endpoint` should be mapped to Moodle user fields. It is recommended
    to at least configure `firstname`, `lastname`, and `email` since these are compulsory
    fields in Moodle’s user profiles.'
  id: totrans-507
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Once the service provider has been configured properly, it can be used by the
    OAuth 2 authentication plugin, which has to be enabled at **Site administration
    | Plugins | Authentication | Manage authentication**. Like all other authentication
    plugins, OAuth 2 lets you configure any locked fields, and there are no additional
    configuration options as the service provider setup controls all behavior.
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
- en: 'As with other authentication methods, let’s conclude the section with a checklist,
    which hopefully comes in useful when you have to configure OAuth 2 authentication:'
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.40 – Checklist for OAuth 2 authentication ](img/Figure_5.40_B18779.jpg)'
  id: totrans-510
  prefs: []
  type: TYPE_IMG
- en: Figure 5.40 – Checklist for OAuth 2 authentication
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
- en: We have now covered all the authentication mechanisms that ship with Moodle
    and belong to the first three pillars of our authentication plugin grouping. The
    fourth category comprises system authentication methods, which we are covering
    next.
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
- en: System authentication methods
  id: totrans-513
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Moodle contains authentication methods, which are required by certain features
    to function correctly:'
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
- en: '**No login**: This plugin has no settings and cannot be disabled or uninstalled.
    Its sole purpose is to suspend users from logging in to your Moodle system, which
    takes place in the user’s profile by selecting the authentication method in the
    **Choose an authentication method** drop-down list.'
  id: totrans-515
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**No authentication**: When this method is enabled, users can create accounts
    without any kind of authentication or email-based confirmation. It is highly recommended
    that you do not use this method since it creates a very insecure Moodle site and
    should only be used for testing or development purposes. Only user fields can
    be locked in the same way as described earlier.'
  id: totrans-516
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**MNet authentication**: Moodle networking allows the connection of multiple
    Moodle sites in a peer-to-peer or hub style. See [*Chapter 19*](B18779_19.xhtml#_idTextAnchor344),
    *Setting Up Moodle Networking*, for details.'
  id: totrans-517
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**LTI**: This plugin has the sole purpose of facilitating the login to LTI
    producers. LTI will be discussed in [*Chapter 9*](B18779_09.xhtml#_idTextAnchor181),
    *Configuring Education Features*.'
  id: totrans-518
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Web services authentication**: This plugin authenticates users via external
    clients communicating with Moodle via web services (see [*Chapter 18*](B18779_18.xhtml#_idTextAnchor337),
    *Integrating External Systems Using Web Services*, for details). The authentication
    plugin has no settings.'
  id: totrans-519
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This concludes the section on user authentication. While there has been a lot
    of content, you are highly likely only to require information on manual accounts
    plus the method(s) you are utilizing in your organization. Since no two authentication
    setups are the same, you will soon be familiar with all the quirks and idiosyncrasies
    of your authentication infrastructure and the plugin(s) that connect it.
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
- en: 'A last piece of advice: be on good terms with your system, database, and network
    admins. They will grant you access to your LDAP directory or the organization’s
    authentication database system and open up the ports you need to connect to service
    providers and web services. Buy them a coffee or bribe them with other niceties!'
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-522
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Phew! That was a lot to take in for one chapter.
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
- en: The first part of this chapter demonstrated the different ways Moodle provides
    to manage users. We first looked at what information is stored for each user account
    and how their profiles can be extended. We then performed several standard manual
    and bulk user actions before dealing with cohorts.
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
- en: In the second part, we dealt with different types of user authentication, namely
    internal, external, service providers (via OAuth 2), and system. Due to the variety
    and complexity of authentication methods, we covered prominent plugins in more
    detail than others.
  id: totrans-525
  prefs: []
  type: TYPE_NORMAL
- en: Authentication has become a complex topic, and we only touched upon methods
    supported in Moodle core. Other methods such as Microsoft Azure AD or Open ID
    as well as mechanisms such as two-factor authentication, one-time passwords, and
    user key authentication are beyond the scope of this already packed chapter and
    are catered for via plugins at [moodle.org/plugins/?q=type:auth](http://moodle.org/plugins/?q=type:auth).
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
- en: 'One aspect of authentication we didn’t mention at all is `SAML_internal`, and
    customers and partners via `SAML_external`. There are two options for how this
    can be facilitated:'
  id: totrans-527
  prefs: []
  type: TYPE_NORMAL
- en: Duplicate the authentication plugin at the system level and modify the source
    code accordingly. A programmer must carry out this task as source code changes
    are required in the copied module. Be careful with this approach, as this might
    not work when Moodle is updated to a newer version.
  id: totrans-528
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Consider Moodle’s big brother, Moodle Workplace, which supports multi-tenancy
    authentication. To get a feel for how this works, have a look at [docs.moodle.org/en/Multi-tenancy_authentication](http://docs.moodle.org/en/Multi-tenancy_authentication).
    At the time of writing, the following authentication methods support multi-tenancy:
    manual, email-based self-registration, OAuth 2, and SAML 2 (as a third-party plugin).'
  id: totrans-529
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The next step is to grant user roles, that is, the rights as to what they are
    allowed to do and what they are not. This will be dealt with in the next chapter.
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL

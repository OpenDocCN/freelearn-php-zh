<html><head></head><body><div class="chapter" title="Chapter&#xA0;8.&#xA0;How Does It Taste? &#x2013; Getting Feedback"><div class="titlepage"><div><div><h1 class="title"><a id="ch08"/>Chapter 8. How Does It Taste? – Getting Feedback</h1></div></div></div><p><span class="emphasis"><em>This chapter will walk through the code that adds a placeholder for HTML form elements in the contact module. We will also revisit the Colorbox module that we installed in the previous chapter. We will make some enhancements to the code (an advanced real-world example), and walk through the process of working with patches. We will also implement the Review and Like system with recipe content type using comment types and views configurations.</em></span></p><div class="section" title="Introduction to the Drupal contact form"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec94"/>Introduction to the Drupal contact form</h1></div></div></div><p>A very<a class="indexterm" id="id419"/> simple contact form is included with Drupal core and is enabled by default. The core contact form provides a good starting point to introduce some interactive features to our d8dev site.</p></div></div>
<div class="section" title="Time for action &#x2013; enabling and configuring the core contact form"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec95"/>Time for action – enabling and configuring the core contact form</h1></div></div></div><p>We <a class="indexterm" id="id420"/>will configure the core contact form so that anonymous visitors to our site will be able to provide feedback about the site:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In <a class="indexterm" id="id421"/>Drupal 8, the contact module is enabled by default. We just need to set permissions to the <span class="strong"><strong>ANONYMOUS</strong></span> and <span class="strong"><strong>AUTHENTICATED</strong></span> roles to use the feedback form.</li><li class="listitem">Now, open the d8dev site in your favorite browser, and click on the <span class="strong"><strong>Extend</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar. Scroll down to the module named <span class="strong"><strong>Contact</strong></span> under the <span class="strong"><strong>Core</strong></span> group; you will notice that the module is enabled. Then, click on the <span class="strong"><strong>Permissions</strong></span> link:<div class="mediaobject"><img alt="Time for action – enabling and configuring the core contact form" src="graphics/4659_08_01.jpg"/></div></li><li class="listitem">On the <span class="strong"><strong>Permissions</strong></span> page, you will notice that the <span class="strong"><strong>Use the side-wide contact form</strong></span> permission is enabled for the <span class="strong"><strong>ADMINISTRATOR</strong></span>, <span class="strong"><strong>ANONYMOUS</strong></span>, and <span class="strong"><strong>AUTHENTICATED</strong></span> roles by default. So, anonymous users can use the contact form.</li><li class="listitem">Next, log out and navigate to <code class="literal">http://localhost/contact/feedback</code>. You will see a simple contact form, as shown in the following screenshot:<div class="mediaobject"><img alt="Time for action – enabling and configuring the core contact form" src="graphics/4659_08_02.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec65"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>We enabled a simple contact form to get feedback from the visitors to our d8dev site.</p></div></div>
<div class="section" title="Adding placeholder text to our contact form"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec96"/>Adding placeholder text to our contact form</h1></div></div></div><p>The <a class="indexterm" id="id422"/>core Contact module provides a decent out-of-the-box contact form for our site. But what if we want to customize it a bit? Say, for example, we want to add some placeholder text to explain to the users why they should fill out the form. As we have seen in previous chapters, there are usually multiple ways to accomplish customizations like this with Drupal.</p><div class="section" title="Using configurations to add placeholder text to the contact form"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec66"/>Using configurations to add placeholder text to the contact form</h2></div></div></div><p>We will<a class="indexterm" id="id423"/> configure the core contact form to enable placeholders to explain to the users why they should fill out the form.</p></div></div>
<div class="section" title="Time for action &#x2013; adding placeholder text to our site contact form"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec97"/>Time for action – adding placeholder text to our site contact form</h1></div></div></div><p>The<a class="indexterm" id="id424"/> core Contact module provides a decent out-of-the-box contact form for our site. The core also provides configurable placeholders for fields. So, we add the placeholders for form fields to display placeholders to explain to the users why they should fill out the form:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open up the d8dev site in your favorite browser, and click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar. Click on <span class="strong"><strong>Contact forms</strong></span> on the next page you can see <span class="strong"><strong>Website feedback</strong></span> listed.</li><li class="listitem">Now, click on <span class="strong"><strong>Manage form display</strong></span> in the <span class="strong"><strong>OPERATIONS</strong></span> column for the <span class="strong"><strong>Website feedback</strong></span> form:<div class="mediaobject"><img alt="Time for action – adding placeholder text to our site contact form" src="graphics/4659_08_03.jpg"/></div></li><li class="listitem">On the next screen, you can see that the <span class="strong"><strong>Subject</strong></span> and <span class="strong"><strong>Message</strong></span> fields are configurable:<div class="mediaobject"><img alt="Time for action – adding placeholder text to our site contact form" src="graphics/4659_08_04.jpg"/></div></li><li class="listitem">Now, click<a class="indexterm" id="id425"/> on the settings icon for the <span class="strong"><strong>Subject</strong></span> field, fill in <span class="strong"><strong>Placeholder</strong></span> as <code class="literal">Please enter your subject here!</code>, and click on the <span class="strong"><strong>Update</strong></span> button:<div class="mediaobject"><img alt="Time for action – adding placeholder text to our site contact form" src="graphics/4659_08_05.jpg"/></div></li><li class="listitem">Next, click on the settings icon for the <span class="strong"><strong>Message</strong></span> field, fill in <span class="strong"><strong>Placeholder</strong></span> as <code class="literal">Please enter your Message here!</code>, change the <span class="strong"><strong>Rows</strong></span> value from <code class="literal">12</code> to <code class="literal">8</code>, and click on the <span class="strong"><strong>Update</strong></span> button:<div class="mediaobject"><img alt="Time for action – adding placeholder text to our site contact form" src="graphics/4659_08_06.jpg"/></div></li><li class="listitem">Next, log out and navigate to <code class="literal">http://localhost/contact/feedback</code> as an <span class="strong"><strong>ANONYMOUS</strong></span> user. You will see a simple contact form, as shown in the following <a class="indexterm" id="id426"/>screenshot:<div class="mediaobject"><img alt="Time for action – adding placeholder text to our site contact form" src="graphics/4659_08_07.jpg"/></div></li></ol></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note18"/>Note</h3><p>You can also try the Contact Storage module, which provides storage for Contact messages; these are full-fledged entities in Drupal 8. This module provides features such as Message storage, Edit messages, and Delete messages. For more details, check out <a class="ulink" href="https://www.drupal.org/project/contact_storage">https://www.drupal.org/project/contact_storage</a>.</p></div></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec67"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>We configured the <span class="strong"><strong>Placeholder</strong></span> text for the <span class="strong"><strong>Subject</strong></span> and <span class="strong"><strong>Message</strong></span> fields in the <span class="strong"><strong>Manage form display</strong></span> page for the contact form.</p></div></div>
<div class="section" title="Using custom code to add placeholder text to the Name and Email fields"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec98"/>Using custom code to add placeholder text to the Name and Email fields</h1></div></div></div><p>Drupal <a class="indexterm" id="id427"/>provides configurable placeholders for the <span class="strong"><strong>Subject</strong></span> and <span class="strong"><strong>Message</strong></span> fields but not for the <span class="strong"><strong>Name</strong></span> and <span class="strong"><strong>Email</strong></span> fields, so we add placeholders for them using custom code in our d8dev module.</p></div>
<div class="section" title="Time for action &#x2013; adding placeholder text to Name and Email fields"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec99"/>Time for action – adding placeholder text to Name and Email fields</h1></div></div></div><p>We will utilize the core <code class="literal">hook_form_alter</code> hook to alter the core contact form to display placeholders for name and e-mail fields. We will be adding this code to the <code class="literal">d8dev.module</code> file:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In PhpStorm, open the <code class="literal">d8dev.module</code> file in your custom module at <code class="literal">/modules</code>.</li><li class="listitem">Next, switch<a class="indexterm" id="id428"/> over to the browser with the core contact form loaded, and find the <code class="literal">form_id</code> of the form element. Right-click on the page and click on <span class="strong"><strong>View source code</strong></span>. On the next page, you can see HTML code. Now search for <code class="literal">form_id</code> and you will find that <code class="literal">contact_message_feedback_form is</code> the required form ID.</li><li class="listitem">In another way, we can use the <code class="literal">drupal_set_message()</code> core function to find the <code class="literal">form_id</code>. To do this, we need to add the following code on top of the <code class="literal">d8dev.module</code> file:<div class="informalexample"><pre class="programlisting">use Drupal\Core\Form\FormStateInterface;

/**
 * Implements hook_form_alter().
 */
function d8dev_form_alter(&amp;$form, FormStateInterface $form_state, $form_id) {
  drupal_set_message($form_id);
}</pre></div></li><li class="listitem">Now, reload the <code class="literal">http://localhost/contact/feedback</code> page as a logged-in user, and you will see a message displaying <code class="literal">form_id</code>, as follows:<div class="mediaobject"><img alt="Time for action – adding placeholder text to Name and Email fields" src="graphics/4659_08_08.jpg"/></div></li><li class="listitem">Next, we need to add a placeholder HTML attribute to the <code class="literal">name</code> and <code class="literal">mail</code> form elements, as follows:<div class="informalexample"><pre class="programlisting">  $form['name']['#attributes'] = array('placeholder' =&gt; array('Please enter your first and last name.'));
  $form['mail']['#attributes'] = array('placeholder' =&gt; array('Please enter your e-mail address.'));</pre></div></li><li class="listitem">Add the <a class="indexterm" id="id429"/>preceding placeholder code only for the contact form. Now our <code class="literal">d8dev_form_alter()</code> function looks like this:<div class="informalexample"><pre class="programlisting">/**
 * Implements hook_form_alter().
 */
function d8dev_form_alter(&amp;$form, FormStateInterface $form_state, $form_id) {
  if ($form_id == 'contact_message_feedback_form') {
    $form['name']['#attributes'] = array('placeholder' =&gt; array('Please enter your first and last name.'));
    $form['mail']['#attributes'] = array('placeholder' =&gt; array('Please enter your e-mail address.'));
  }
}</pre></div></li><li class="listitem">Next, clear the cache by going to <span class="strong"><strong>Administration</strong></span> | <span class="strong"><strong>Configuration</strong></span> | <span class="strong"><strong>Development</strong></span> | <span class="strong"><strong>Performance</strong></span>. Now reload the contact page as an <span class="strong"><strong>ANONYMOUS</strong></span> user. Then you will see the following form:<div class="mediaobject"><img alt="Time for action – adding placeholder text to Name and Email fields" src="graphics/4659_08_09.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec68"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>We used the <code class="literal">hook_form_alter</code> hook to add placeholder text to the core contact form for the <span class="strong"><strong>Name</strong></span> and <span class="strong"><strong>Email</strong></span> fields.</p></div></div>
<div class="section" title="Time for another recipe!"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec100"/>Time for another recipe!</h1></div></div></div><p>Just in case you were getting hungry, we are going to add a new recipe. Let's add it now so that we have something delicious to eat as we work our way through the rest of this challenging chapter! The recipe for this chapter is garlic chicken Indian style. Enjoy!</p><div class="mediaobject"><img alt="Time for another recipe!" src="graphics/4659_08_09_39.jpg"/></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Name</strong></span>: Garlic chicken Indian style</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Description</strong></span>: Garlic chicken recipe Indian style, Learn how to make garlic chicken in 20 minutes, Includes restaurant style and home style starters, curries, biryanis and more. This garlic chicken can be prepared in just 20 mins excluding the marinating time. It makes a perfect starter or a side to make a meal exotic.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>recipeYield</strong></span>: Four servings</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>prepTime</strong></span>: 20 minutes</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>cookTime</strong></span>: 20 minutes</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Ingredients</strong></span>:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">300 grams of chicken strips or boneless cubes</li><li class="listitem" style="list-style-type: disc">4 tbsp. yogurt/dahi/curd (do not use sour yogurt)</li><li class="listitem" style="list-style-type: disc">Salt—very little</li><li class="listitem" style="list-style-type: disc">A generous pinch of pepper</li><li class="listitem" style="list-style-type: disc">Two tbsp. oil</li><li class="listitem" style="list-style-type: disc">One sprig curry leaf</li><li class="listitem" style="list-style-type: disc">¼ tsp cumin</li><li class="listitem" style="list-style-type: disc">One onion chopped finely</li><li class="listitem" style="list-style-type: disc">Five red chilies or ¾ tsp red chili powder</li><li class="listitem" style="list-style-type: disc">Five garlic cloves crushed</li><li class="listitem" style="list-style-type: disc">¾ tbsp. vinegar</li><li class="listitem" style="list-style-type: disc">¼ tsp sugar (optional)</li><li class="listitem" style="list-style-type: disc">Salt to taste</li><li class="listitem" style="list-style-type: disc">Water—15 to 30 ml (the lesser the better) to make a paste</li><li class="listitem" style="list-style-type: disc">A few coriander leaves</li><li class="listitem" style="list-style-type: disc">Onion wedges or rings</li><li class="listitem" style="list-style-type: disc">Lemon</li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Instructions</strong></span>:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Mix yogurt, salt, and pepper with ½ to ¾ cup of water. Beat well and set aside.</li><li class="listitem">Wash chicken and soak it in this prepared butter milk for 2 hours to overnight in the refrigerator.</li><li class="listitem">Soaking for at least 6 hours is recommended to get soft chicken.</li><li class="listitem">Blend and make a paste of the ingredients mentioned for chili garlic sauce.</li><li class="listitem">Drain the buttermilk and add the prepared sauce.</li><li class="listitem">Mix well and leave it for 5 minutes. If you want to prepare it at a later time, you can put it back in the refrigerator.</li><li class="listitem">Heat a pan with oil. Add cumin and curry leaves. Sauté until the cumin begins to splutter.</li><li class="listitem">Add onions and fry until golden.</li><li class="listitem">Add the chicken and fry on high heat for 2 to 3 minutes. When you see the chicken turning white, cover it with a lid, lower the heat, and cook until the chicken turns tender. This barely takes 5 minutes if you are using strips.</li><li class="listitem">Remove the lid and fry until the moisture evaporates and the sauce begins to cling to the chicken. The longer it is roasted, the more aromatic and tastier the sauce becomes, but the chicken tends to lose its tenderness.</li><li class="listitem">So take off from the heat when it is of your liking. Take care not to burn; garlic burns faster.</li></ol></div></li></ul></div></div>
<div class="section" title="Colorbox file enhancements"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec101"/>Colorbox file enhancements</h1></div></div></div><p>We added the <a class="indexterm" id="id430"/>Colorbox module to our d8dev site in the previous chapter to display the images in the overlay. Currently, the Colorbox module displays the title of the recipe as the caption for all recipe images displayed in the Colorbox overlay for our Recipe content type, as shown in the following screenshot. But it's not working with image properties such as title and alt values.</p><div class="mediaobject"><img alt="Colorbox file enhancements" src="graphics/4659_08_40.jpg"/></div><p>So for that, we raised an issue in the Colorbox issues queue (<a class="ulink" href="https://www.drupal.org/node/264516">https://www.drupal.org/node/264516</a>0) in <a class="link" href="ch07.html" title="Chapter 7. Adding Media to Our Site">Chapter 7</a>, <span class="emphasis"><em>Adding Media to Our Site</em></span>. Colorbox maintainer <code class="literal">@frjo</code> replied as follows:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>"The file entity module is a contrib module so what you really is asking for is that Colorbox support it. Change the title so this is clear. I have never used that module but if someone who does sends in a patch I will take a look at it."</em></span></p></blockquote></div><p>Before we begin creating a patch, we need to have a clear understanding of why it isn't showing up in this case of the <code class="literal">title</code> or <code class="literal">alt</code> property. I went through the Colorbox module and did debug on all preprocess functions where it was rendering the images field properties. I found that the <code class="literal">template_preprocess_colorbox_formatter() </code>function is the right function that loads all attributes of the image field. But when the file entity module is enabled, it does not load because the files have become entities and Colorbox doesn't know how to render from image files. So, we are going to create a patch for this issue and submit it in the Colorbox issue that we created in the last chapter.</p></div>
<div class="section" title="Time for action &#x2013; enhancing the Colorbox module with image title and alt captions"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec102"/>Time for action – enhancing the Colorbox module with image title and alt captions</h1></div></div></div><p>So, where <a class="indexterm" id="id431"/>do we begin implementing this proposed approach and complete the associated feature request? We will start by debugging the available processed <code class="literal">$variable</code> in the <code class="literal">template_preprocess_colorbox_formatter()</code> function so that we can modify or add required properties to the image field:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In PhpStorm, open the <code class="literal">colorbox.inc</code> file in your contribute modules at the <code class="literal">/modules</code> folder.</li><li class="listitem">Before we start modifying or adding code, let's understand the code in the <code class="literal">template_preprocess_colorbox_formatter()</code> function in the <code class="literal">colorbox.inc</code> file. First, we need to know where caption settings are saved. There is the <code class="literal">$settings</code> variable that has been declared; add the following code next to the <code class="literal">$settings</code> variable (line 35):<div class="informalexample"><pre class="programlisting">var_dump($settings); die;</pre></div></li><li class="listitem">Clear<a class="indexterm" id="id432"/> the cache from the <span class="strong"><strong>Performance</strong></span> page and reload the recipe content; you will see the following:<div class="mediaobject"><img alt="Time for action – enhancing the Colorbox module with image title and alt captions" src="graphics/4659_08_10_41.jpg"/></div></li><li class="listitem">We noticed that auto is the colorbox caption for this content type. To confirm this, go to <span class="strong"><strong>Structure</strong></span> | <span class="strong"><strong>Content types</strong></span> and click on <span class="strong"><strong>Manage display</strong></span> for the recipe content type. Next, click on the settings icon for the <span class="strong"><strong>Recipe images</strong></span> field and you will notice the <span class="strong"><strong>Caption</strong></span> as <span class="strong"><strong>Automatic</strong></span>:<div class="mediaobject"><img alt="Time for action – enhancing the Colorbox module with image title and alt captions" src="graphics/4659_08_10.jpg"/></div></li><li class="listitem">Your settings might be different, so in the last step, you can see relatively.</li><li class="listitem">In the next lines, we can see a <code class="literal">switch</code> statement declared as follows to set the <code class="literal">$caption</code> variable, which is going to be displayed as caption in the Colorbox overlay:<div class="informalexample"><pre class="programlisting">  switch ($settings['colorbox_caption']) {
     case 'auto':
      // If the title is empty use alt or the entity title in that order.
      if (!empty($item-&gt;title)) {
        $caption = $item-&gt;title;
      }
      elseif (!empty($item-&gt;alt)) {
        $caption = $item-&gt;alt;
      }
      elseif (!empty($entity_title)) {
        $caption = $entity_title;
      }
      else {
        $caption = '';
      }
      break;
    case 'title':
      $caption = $item-&gt;title;
      break;
    case 'alt':
      $caption = $item-&gt;alt;
      break;
    case 'entity_title':
      $caption = $entity_title;
      break;
    case 'custom':
      $token_service = \Drupal::token();
      $caption = $token_service-&gt;replace($settings['colorbox_caption_custom'], array($entity_type =&gt; $entity, 'file' =&gt; $item), array('clear' =&gt; TRUE));
      break;
    default:
      $caption = '';
  }</pre></div></li><li class="listitem">So, we <a class="indexterm" id="id433"/>can understand that the <code class="literal">$caption</code> variable needs to be modified to set alt or title text as the caption. To confirm this, when <code class="literal">$caption</code> is getting loaded in the colorbox overlay; we just have to set some dummy text to it and we will see the effect on the recipe content. Before adding the dummy text, remove the <code class="literal">var_dump($settings); die;</code> line you added in the last step.</li><li class="listitem">Next, add the following line next to the switch statement:<div class="informalexample"><pre class="programlisting">$caption = 'This is test caption!';</pre></div></li><li class="listitem">Clear the<a class="indexterm" id="id434"/> cache from the <span class="strong"><strong>Performance</strong></span> page. Reload the recipe content and click on any image to check the caption; you will see the following screenshot:<div class="mediaobject"><img alt="Time for action – enhancing the Colorbox module with image title and alt captions" src="graphics/4659_08_11.jpg"/></div></li><li class="listitem">Before moving to the next step, remove the dummy caption code you added in the last step: <code class="literal">$caption = 'This is test caption!';</code>.</li><li class="listitem">Next, preprocess the title of the <code class="literal">attributes</code> variable, which needs to be loaded from the image file entity. Add the following code before the <code class="literal">$variables['attributes']['title'] = $caption;</code> line, which is at the end of the <code class="literal">template_preprocess_colorbox_formatter()</code> function:<div class="informalexample"><pre class="programlisting">  // if File Entity module is enabled, load attribute values from file entity.
  if(\Drupal::moduleHandler()-&gt;moduleExists('file_entity')) {
    // file id of the save file.
    $fid = $item-&gt;target_id;
    // load file object
    $file_obj = file_load($fid);
    $file_array = $file_obj-&gt;toArray();
    // populate the image title
    if (Unicode::strlen($file_array['field_image_title_text'][0]['value']) != 0 &amp;&amp; empty($item-&gt;title) &amp;&amp; $settings['colorbox_caption'] == 'title') {
      $caption = $file_array['field_image_title_text'][0]['value'];
    }
    // populate the image alt text.
    if (!empty($file_array['field_image_alt_text'][0]['value']) &amp;&amp; empty($item-&gt;alt) &amp;&amp; $settings['colorbox_caption'] == 'alt') {
      $caption = $file_array['field_image_alt_text'][0]['value'];
    }
  }</pre></div></li><li class="listitem">First, we<a class="indexterm" id="id435"/> checked whether the <code class="literal">file_entity</code> module is enabled because this module is not dependent on the colorbox module. The purpose of the <code class="literal">file_entity</code> module is to provide interfaces for managing files and files to be fieldable as entities, so the properties of the image file can be rendered as objects. Next, we added code that loads the file object and we set the <code class="literal">$caption</code> variable by validating the title and alt text properties from the <code class="literal">$file</code> object.</li><li class="listitem">To see this effect on the recipe content, clear the cache from the Performance page and reload the recipe content before making sure that your image has updated with alt and title texts.</li><li class="listitem">Next, go to the Recipe content type manage display page, click on the settings icon for the <span class="strong"><strong>Recipe images</strong></span> field and update the <span class="strong"><strong>Caption</strong></span> as <span class="strong"><strong>Title text</strong></span>. Click on the <span class="strong"><strong>Save</strong></span> button at the bottom of the <span class="strong"><strong>Manage display</strong></span> page and reload the recipe content page to see the changes. Click on any image. WOW! Now it's showing title text as captions (see the next screenshot). Alternatively, update <span class="strong"><strong>Caption</strong></span> as <span class="strong"><strong>Alt text</strong></span> in the settings and check the recipe content; it will work:<div class="mediaobject"><img alt="Time for action – enhancing the Colorbox module with image title and alt captions" src="graphics/4659_08_12.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec69"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>We updated the colorbox module with custom code to work with the title and alt text properties of images.</p></div></div>
<div class="section" title="Contributing our code to Drupal"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec103"/>Contributing our code to Drupal</h1></div></div></div><p>Now we <a class="indexterm" id="id436"/>have code that will be usable across the colorbox module. But, how do we get this code into the hands of other Drupal users, and better yet, have it maintained as part of the colorbox module? To share this code, we are going to create a patch.</p></div>
<div class="section" title="Time for action &#x2013; creating a patch and uploading it on the Drupal issues queue"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec104"/>Time for action – creating a patch and uploading it on the Drupal issues queue</h1></div></div></div><p>Before we can <a class="indexterm" id="id437"/>create a patch the Drupal 8/Git way, we <a class="indexterm" id="id438"/>need to check out the colorbox module project with Git to a new directory:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to <a class="ulink" href="https://www.drupal.org/project/colorbox/git-instructions">https://www.drupal.org/project/colorbox/git-instructions</a>. At the top, you can see the <span class="strong"><strong>Version to work from</strong></span> select box. Select <span class="strong"><strong>8.x-1.x</strong></span> and click on the <span class="strong"><strong>Show</strong></span> button:<div class="mediaobject"><img alt="Time for action – creating a patch and uploading it on the Drupal issues queue" src="graphics/4659_08_13.jpg"/></div></li><li class="listitem">Now <a class="indexterm" id="id439"/>open the<a class="indexterm" id="id440"/> Terminal and go to any location (the <code class="literal">cd &lt;path/to/go&gt;</code> command) where you wish to clone the colorbox module. Run the following command to clone the colorbox Git repository:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ git clone --branch 8.x-1.x https://git.drupal.org/project/colorbox.git</strong></span>
<span class="strong"><strong>Cloning into 'colorbox'...</strong></span>
<span class="strong"><strong>remote: Counting objects: 2082, done.</strong></span>
<span class="strong"><strong>remote: Compressing objects: 100% (1545/1545), done.</strong></span>
<span class="strong"><strong>remote: Total 2082 (delta 1253), reused 661 (delta 410)</strong></span>
<span class="strong"><strong>Receiving objects: 100% (2082/2082), 1.84 MiB | 27.00 KiB/s, done.</strong></span>
<span class="strong"><strong>Resolving deltas: 100% (1253/1253), done.</strong></span>
<span class="strong"><strong>Checking connectivity... done.</strong></span>
</pre></div></li><li class="listitem">Next, we need to make the same changes in the <code class="literal">colorbox.inc</code> file that we just made for our d8dev site to the code that we just cloned with Git.</li><li class="listitem">Now that<a class="indexterm" id="id441"/> we have updated the code, we are ready<a class="indexterm" id="id442"/> to create our patch. Following the Drupal guidelines at <a class="ulink" href="http://drupal.org/node/707484">http://drupal.org/node/707484</a>, run this command from the colorbox root folder:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ git diff &gt; 2645160-6.patch</strong></span>
</pre></div></li><li class="listitem">Next, we will comment on the issue at <a class="ulink" href="http://drupal.org/node/2645160">http://drupal.org/node/2645160</a> and upload our patch with our comments, making sure that the status of the issue is set to needs review:<div class="mediaobject"><img alt="Time for action – creating a patch and uploading it on the Drupal issues queue" src="graphics/4659_08_14.jpg"/></div><p>If we want to apply the patch just shown, we use the following <code class="literal">git</code> command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>git apply -v [patchname.patch]</strong></span>
</pre></div><p>If want to revert the last applied patch, then we use these git commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>git checkout [filename]</strong></span>
<span class="strong"><strong>git reset --hard</strong></span>
</pre></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec70"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>Not only did we update our code so that it will work across the Colorbox module and any number of Drupal sites, but we also helped the Drupal community. We learned how to create a patch. We will get back to the Colorbox issue at <a class="ulink" href="http://drupal.org/node/2645160">http://drupal.org/node/2645160</a> to see how the Drupal community responds to our patch.</p></div></div>
<div class="section" title="Recipe reviews with comments"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec105"/>Recipe reviews with comments</h1></div></div></div><p>Now that we <a class="indexterm" id="id443"/>have enhanced the Colorbox module with configurable captions, we will turn our attention back to enhancing user interaction for the site. One great way to get visitors to interact with a website is to allow them to review and like/dislike the content, in this case, recipes.</p></div>
<div class="section" title="Time for action &#x2013; configuring comments as recipe reviews"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec106"/>Time for action – configuring comments as recipe reviews</h1></div></div></div><p>We will now set up<a class="indexterm" id="id444"/> the comments so that visitors to our d8dev site will be able to review the recipes:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We will configure our Recipe content type to use the comments. Open up the d8dev site in your favorite browser, click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, then click on the <span class="strong"><strong>Comment types</strong></span> link, and finally click on the <span class="strong"><strong>Add content type</strong></span> link for your Recipe content type.</li><li class="listitem">On the next screen, enter <code class="literal">Recipe Review</code> as the value for the <span class="strong"><strong>Label</strong></span> field and <span class="strong"><strong>Content</strong></span> as the <code class="literal">Target entity type</code> field. Click on the <span class="strong"><strong>Save</strong></span> button:<div class="mediaobject"><img alt="Time for action – configuring comments as recipe reviews" src="graphics/4659_08_15.jpg"/></div></li><li class="listitem">We <a class="indexterm" id="id445"/>added a new comment type and it can be used in any content types. Click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, then click on the <span class="strong"><strong>Content types</strong></span> link, and finally click on the <span class="strong"><strong>Manage fields</strong></span> link for your Recipe content type.</li><li class="listitem">Next, click on the <span class="strong"><strong>Add field</strong></span> link. On the next screen, select <span class="strong"><strong>Comments</strong></span> as <span class="strong"><strong>Add a new field</strong></span>, enter <code class="literal">Recipe Review</code> as <span class="strong"><strong>Label</strong></span>, and click on the <span class="strong"><strong>Save and continue</strong></span> button:<div class="mediaobject"><img alt="Time for action – configuring comments as recipe reviews" src="graphics/4659_08_16.jpg"/></div></li><li class="listitem">On the next screen, select <span class="strong"><strong>Recipe Review</strong></span> as <span class="strong"><strong>Comment type</strong></span> and click on the <span class="strong"><strong>Save field settings</strong></span> button. Next, leave all fields as default and click on the <span class="strong"><strong>Save settings</strong></span> button:<div class="mediaobject"><img alt="Time for action – configuring comments as recipe reviews" src="graphics/4659_08_17.jpg"/></div></li><li class="listitem">We<a class="indexterm" id="id446"/> have enabled comments for recipe content types. Now we reload the recipe content as an <span class="strong"><strong>ANONYMOUS</strong></span> user to see the default comments form. But we cannot see the form because of permission issues. To set the permission, go to <span class="strong"><strong>people</strong></span> | <span class="strong"><strong>permissions</strong></span>, check the <span class="strong"><strong>Post comments</strong></span> permission for <span class="strong"><strong>ANONYMOUS</strong></span> users, scroll down to the bottom of the page, and click on the <span class="strong"><strong>Save permissions</strong></span> button. Again, reload the recipe content as an <span class="strong"><strong>ANONYMOUS</strong></span> user and you will see something like the following screenshot:<div class="mediaobject"><img alt="Time for action – configuring comments as recipe reviews" src="graphics/4659_08_18.jpg"/></div></li><li class="listitem">We <a class="indexterm" id="id447"/>don't need the name, subject, and comment fields provided by default. We are going to delete them and add the <span class="strong"><strong>e-mail</strong></span> and <span class="strong"><strong>How does it taste ?</strong></span> fields. Now click on <span class="strong"><strong>Structure</strong></span> in the <span class="strong"><strong>Admin</strong></span> bar, and then click on the link <span class="strong"><strong>Comment types</strong></span>.</li><li class="listitem">Now, click on <span class="strong"><strong>Manage fields</strong></span> from the Operations for Recipe review comment type. You can see that only the <span class="strong"><strong>Comment</strong></span> field is there. Click on the <span class="strong"><strong>Delete</strong></span> link from <span class="strong"><strong>OPERATIONS</strong></span> for the <span class="strong"><strong>Comment</strong></span> field. On the next screen, click on the <span class="strong"><strong>Delete</strong></span> button to delete this field:<div class="mediaobject"><img alt="Time for action – configuring comments as recipe reviews" src="graphics/4659_08_19.jpg"/></div></li><li class="listitem">Next, click <a class="indexterm" id="id448"/>on <span class="strong"><strong>Add field</strong></span>, select <span class="strong"><strong>Add a new field</strong></span> as <span class="strong"><strong>Email</strong></span>, enter <span class="strong"><strong>Label</strong></span> as <code class="literal">E-mail</code>, and click on the <span class="strong"><strong>Save and continue</strong></span> button:<div class="mediaobject"><img alt="Time for action – configuring comments as recipe reviews" src="graphics/4659_08_20.jpg"/></div></li><li class="listitem">On the next screen, leave the default values <span class="strong"><strong>Limited</strong></span>, <span class="strong"><strong>1</strong></span>, and click on the <span class="strong"><strong>Save field settings</strong></span> button. Next, check <span class="strong"><strong>Required field</strong></span> and click on the <span class="strong"><strong>Save settings</strong></span> button.</li><li class="listitem">Now, click <a class="indexterm" id="id449"/>on the <span class="strong"><strong>Add field</strong></span> link. Select <span class="strong"><strong>Text (plain, long)</strong></span> as <span class="strong"><strong>Add a new field</strong></span> and <span class="strong"><strong>How does it taste ?</strong></span> as the <span class="strong"><strong>Label</strong></span>. Click on the <span class="strong"><strong>Save and continue</strong></span> button.</li><li class="listitem">On the next screen, leave the default settings as <span class="strong"><strong>1</strong></span> and click on the <span class="strong"><strong>Save field settings</strong></span> button. Again on the next screen, leave all fields as default and click on the <span class="strong"><strong>Save settings</strong></span> button.</li><li class="listitem">Next, reload the recipe content as an <span class="strong"><strong>ANONYMOUS</strong></span> user. We can see the form as shown in the following screenshot:<div class="mediaobject"><img alt="Time for action – configuring comments as recipe reviews" src="graphics/4659_08_21.jpg"/></div></li><li class="listitem">But we can still see the <span class="strong"><strong>Your name</strong></span> and <span class="strong"><strong>Subject</strong></span> fields, which are not required. So we will disable them from the <span class="strong"><strong>Manage form display</strong></span> page. Now, click on <span class="strong"><strong>Manage form display</strong></span> for the Recipe Review comment type. On the next screen, select the <span class="strong"><strong>Hidden</strong></span> value for the <span class="strong"><strong>Author</strong></span> and <span class="strong"><strong>Subject</strong></span> fields and click on the <span class="strong"><strong>Save</strong></span> button. See the following screenshot:<div class="mediaobject"><img alt="Time for action – configuring comments as recipe reviews" src="graphics/4659_08_22.jpg"/></div></li><li class="listitem">Now we<a class="indexterm" id="id450"/> reload the recipe content, and we can see the comment form as follows:<div class="mediaobject"><img alt="Time for action – configuring comments as recipe reviews" src="graphics/4659_08_23.jpg"/></div></li><li class="listitem">We need to restrict viewing comments for <span class="strong"><strong>ANONYMOUS</strong></span> and <span class="strong"><strong>AUTHENTICATED</strong></span> user roles since we need to display only the number of likes for the <a class="indexterm" id="id451"/>recipe content. To set the permission, go to <span class="strong"><strong>people</strong></span> | <span class="strong"><strong>permissions</strong></span>. Uncheck the <span class="strong"><strong>View comments</strong></span> permission for <span class="strong"><strong>ANONYMOUS</strong></span> and <span class="strong"><strong>AUTHENTICATED</strong></span> users, scroll down to the bottom of the page, and click on the <span class="strong"><strong>Save permissions</strong></span> button.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec71"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>We created a new comment type, Recipe review, and enabled it in the Recipe content type. Also, we configured new fields in the Recipe review comment type.</p></div></div>
<div class="section" title="Time for action &#x2013; enhancing the liking system using comments and views"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec107"/>Time for action – enhancing the liking system using comments and views</h1></div></div></div><p>We will now<a class="indexterm" id="id452"/> set up a like/dislike button so that visitors to our d8dev site will be able to like/dislike the recipes. Also, we will show how many people have liked each recipe content:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Firstly, we will add the <span class="strong"><strong>Do you like it ?</strong></span> button in the Recipe Review comment type so that visitors to our d8dev site will be able to like/dislike the recipes. Open up the d8dev site in your favorite browser, and click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar. Then click on the <span class="strong"><strong>Comment types</strong></span> link, and finally click on the <span class="strong"><strong>Manage fields</strong></span> link for your Recipe review in the <span class="strong"><strong>Operations</strong></span> dropdown.</li><li class="listitem">Click on the <span class="strong"><strong>Add field</strong></span> link to add a new field. On the next screen, select <span class="strong"><strong>List (integer)</strong></span> as <span class="strong"><strong>Add a new field</strong></span> and <code class="literal">Do you like it ?</code> as <span class="strong"><strong>Label</strong></span>. Click on the <span class="strong"><strong>Save and continue</strong></span> button:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_24.jpg"/></div></li><li class="listitem">Now, enter <a class="indexterm" id="id453"/>the following text in the <span class="strong"><strong>Allowed values list</strong></span> field, leave other settings as default, and click on the <span class="strong"><strong>Save field settings</strong></span> button:<div class="informalexample"><pre class="programlisting">1|Yes
0|No</pre></div></li><li class="listitem">For this step, check the <span class="strong"><strong>Required field</strong></span> button, select <span class="strong"><strong>Default value</strong></span> as <span class="strong"><strong>Yes</strong></span>, and click on the <span class="strong"><strong>Save settings</strong></span> button.</li><li class="listitem">Now click on the <span class="strong"><strong>Manage form display</strong></span> link. Change the <span class="strong"><strong>Do you like it ?</strong></span> field widget to the <span class="strong"><strong>Check boxes/radio buttons</strong></span> widget and click on the <span class="strong"><strong>Save</strong></span> button:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_25.jpg"/></div></li><li class="listitem">Next, reload<a class="indexterm" id="id454"/> the recipe content and you can see the comment form as follows:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_26.jpg"/></div></li><li class="listitem">We have enabled the <span class="strong"><strong>Like</strong></span> button. Next, we need to show how many people have liked the recipe content. We are going to create one view block to display the count of likes for each recipe content. Open up the d8dev site in your favorite browser. Click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, then click on the <span class="strong"><strong>Views</strong></span> link, and finally click on the <span class="strong"><strong>Add new view</strong></span> link.</li><li class="listitem">On the <span class="strong"><strong>Add new view</strong></span> page, enter the view name as <code class="literal">Recipe likes count</code>. In the <span class="strong"><strong>View settings</strong></span> section, select the <span class="strong"><strong>Show</strong></span> field as <span class="strong"><strong>Comments</strong></span> and the <span class="strong"><strong>of type</strong></span> field as <span class="strong"><strong>Recipe review</strong></span>. In the <span class="strong"><strong>Block settings</strong></span> section, check <span class="strong"><strong>Create block</strong></span> and click on the <span class="strong"><strong>Save and edit</strong></span> button.</li><li class="listitem">Next, in <a class="indexterm" id="id455"/>the <span class="strong"><strong>Format</strong></span> section, click on the <span class="strong"><strong>Show: Comment</strong></span> link. Then, a popup will appear. Change the <span class="strong"><strong>Row</strong></span> field value comment to fields and click on the <span class="strong"><strong>Apply (all displays)</strong></span> button:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_27.jpg"/></div></li><li class="listitem">Next, in the <span class="strong"><strong>Advanced</strong></span> section and under the <span class="strong"><strong>Other</strong></span> group, click on the <span class="strong"><strong>Use aggregation: No</strong></span> link. Then, a popup will appear. Check <span class="strong"><strong>Aggregate</strong></span> and click on the <span class="strong"><strong>Apply (all displays)</strong></span> button:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_28.jpg"/></div></li><li class="listitem">Now, in <a class="indexterm" id="id456"/>the <span class="strong"><strong>Fields</strong></span> section, click on the <span class="strong"><strong>Add</strong></span> link. In the popup, search for the keywords <code class="literal">do you like</code>. Then check the <span class="strong"><strong>Do you like it ? (field_do_you_like_it_)</strong></span> checkbox and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_29.jpg"/></div></li><li class="listitem">On the next screen, select <span class="strong"><strong>Sum</strong></span> as the <span class="strong"><strong>Aggregation type</strong></span> field and click on the <span class="strong"><strong>Apply and continue</strong></span> button:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_30.jpg"/></div></li><li class="listitem">On the<a class="indexterm" id="id457"/> next screen, scroll down to the <span class="strong"><strong>REWRITE RESULTS</strong></span> section and click on it. Check the <span class="strong"><strong>Override the output of this field with custom text</strong></span> checkbox and enter the following text in the <span class="strong"><strong>Text</strong></span> field:<div class="informalexample"><pre class="programlisting">{{ field_do_you_like_it_ }} likes </pre></div></li><li class="listitem">Next, in the <span class="strong"><strong>STYLE SETTINGS</strong></span> section, check the <span class="strong"><strong>Customize field HTML</strong></span> checkbox. Select the <span class="strong"><strong>HTML element</strong></span> as <span class="strong"><strong>STRONG</strong></span> and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button.</li><li class="listitem">Now, in the <span class="strong"><strong>ADVANCED</strong></span> section, click on the <span class="strong"><strong>Add</strong></span> link for <span class="strong"><strong>CONTEXTUAL FILTERS</strong></span>. In the popup, search for the keywords <code class="literal">node id</code>. Then check the <span class="strong"><strong>Node ID</strong></span> checkbox and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button. On the next screen, leave the settings as default and click on the <span class="strong"><strong>Apply and continue</strong></span> button.</li><li class="listitem">Under the <span class="strong"><strong>WHEN THE FILTER VALUE IS NOT AVAILABLE</strong></span> section on the <a class="indexterm" id="id458"/>next screen, select the <span class="strong"><strong>Provide default value</strong></span> radio button. Select <span class="strong"><strong>Type</strong></span> as <span class="strong"><strong>Content ID from URL</strong></span> and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button at the bottom:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_31.jpg"/></div></li><li class="listitem">Next, in the <span class="strong"><strong>FIELDS</strong></span> section, click on the <span class="strong"><strong>Comment: Title</strong></span> link. In the popup, click on the <span class="strong"><strong>Delete</strong></span> link. In the same <span class="strong"><strong>FIELDS</strong></span> section, click on the <span class="strong"><strong>Add</strong></span> link. In the popup, search for <code class="literal">title</code> and select <span class="strong"><strong>Type</strong></span> as <span class="strong"><strong>Content</strong></span>. Check the <span class="strong"><strong>Title</strong></span> checkbox and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button at the bottom.</li><li class="listitem">On the next screen, leave the default settings and click on the <span class="strong"><strong>Apply and continue</strong></span> button.</li><li class="listitem">On the next screen, check the <span class="strong"><strong>Exclude from display</strong></span> checkbox and click on the <span class="strong"><strong>Apply(all displays)</strong></span> button at the bottom. Then, scroll down and click on the <span class="strong"><strong>Save</strong></span> button to save the view settings.</li><li class="listitem">We <a class="indexterm" id="id459"/>are done creating a block view. Now we need to place this block in the Recipe content page. Click on the <span class="strong"><strong>Structure</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, and then click on the <span class="strong"><strong>Block layout</strong></span> link.</li><li class="listitem">Scroll down to the <span class="strong"><strong>Content</strong></span> section and click on the <span class="strong"><strong>Place block</strong></span> button. Next, in the popup, search for <code class="literal">Recipe likes count</code> and click on the <span class="strong"><strong>Place block</strong></span> button for this:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_32.jpg"/></div></li><li class="listitem">On the<a class="indexterm" id="id460"/> next screen, uncheck <span class="strong"><strong>Display title</strong></span>. Under the <span class="strong"><strong>Content types</strong></span> section check <span class="strong"><strong>Recipe</strong></span> and leave the other settings as default. Click on the <span class="strong"><strong>Save block</strong></span> button:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_33.jpg"/></div></li><li class="listitem">Next,<a class="indexterm" id="id461"/> in the <span class="strong"><strong>Block layout</strong></span> page, move the <span class="strong"><strong>Recipe likes count</strong></span> block to above the <span class="strong"><strong>Main page content</strong></span> block and scroll down to the bottom. Click on the <span class="strong"><strong>Save block</strong></span> button:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_34.jpg"/></div></li><li class="listitem">We <a class="indexterm" id="id462"/>are now done with all configurations. Now we need to check out the recipe content page to check how the number of likes will display on it. We will use the Devel module to generate dummy content and comments. Use Drush to download and enable the Devel module. Run the following commands in the d8dev root folder:<div class="informalexample"><pre class="programlisting">$ drush en devel -y
devel was not found.
[warning]
The following projects provide some or all of the extensions not found:
[ok]
devel
Would you like to download them? (y/n): y
Project devel (8.x-1.x-dev) downloaded to /usr/share/nginx/html/drupal-8.0.2//modules/devel.
[success]
Project devel contains 5 modules: webprofiler, kint, devel_node_access, devel_generate, devel.
The following extensions will be enabled: devel
Do you really want to continue? (y/n): y
devel was enabled successfully.
[ok]
devel defines the following permissions: access devel information, execute php code, switch users 

$ drush en devel_generate -y
devel_generate is already enabled.
[ok]
There were no extensions that could be enabled.
[ok]</pre></div></li><li class="listitem">To <a class="indexterm" id="id463"/>generate dummy content, open up the d8dev site in your favorite browser, click on the <span class="strong"><strong>Configuration</strong></span> link in the <span class="strong"><strong>Admin</strong></span> toolbar, and then click on the <span class="strong"><strong>Generate content</strong></span> link under the <span class="strong"><strong>DEVELOPMENT</strong></span> section.</li><li class="listitem">On the next screen, check the <span class="strong"><strong>Recipe</strong></span> content type, enter <code class="literal">10</code> in the <span class="strong"><strong>Maximum number of comments per node</strong></span> field, and click on the <span class="strong"><strong>Generate</strong></span> button. This will generate 50 Recipe contents with 10 comments each:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_35.jpg"/></div></li><li class="listitem">Open any Recipe content that was just created by the devel module from the <span class="strong"><strong>Admin Content</strong></span> page. We can see the count of likes as shown in the next screenshot. If we check all comments of this Recipe, we can find only <span class="strong"><strong>4</strong></span>(or how many <span class="strong"><strong>Yes</strong></span> values) likes from the <span class="strong"><strong>Do you like it ?</strong></span> field:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_36.jpg"/></div></li><li class="listitem">Only <a class="indexterm" id="id464"/>approved comments' likes will be counted, so if we get any comments, then the administrator has to update them as <span class="strong"><strong>Published comments</strong></span>. To do this, we have to go to <code class="literal">http://localhost/admin/content/comment/approval</code>:<div class="mediaobject"><img alt="Time for action – enhancing the liking system using comments and views" src="graphics/4659_08_37.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch08lvl2sec72"/><span class="emphasis"><em>What just happened?</em></span></h2></div></div></div><p>We created a <span class="strong"><strong>View</strong></span> block and configured the comment settings to use for the Review and Like/Dislike recipes on our d8dev site. The process was straightforward and showed that sometimes adding a unique flare to a Drupal site doesn't take much development at all.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch08lvl1sec108"/>Summary</h1></div></div></div><p>In this chapter, we added some new features that will provide a way for visitors to interact with our d8dev site, and we enhanced some of those interactive features with comments and views. We also revisited the Colorbox File module that was introduced in the previous chapter, and made some modifications to it that allow more control over how captions are displayed in the Colorbox overlay.</p><p>In the next chapter, we will take a more in-depth look at the Views module. We will explore advanced configuration and developing a custom Views plugin that utilizes a custom jQuery plugin to display the Views output in semantic and progressive enhanced tabs.</p></div></body></html>
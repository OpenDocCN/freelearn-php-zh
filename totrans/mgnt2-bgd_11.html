<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;10.&#xA0;The Major Functional Areas"><div class="book" id="26I9K2-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10" class="calibre1"/>Chapter 10. The Major Functional Areas</h1></div></div></div><p class="calibre7">The Magento platform comprises various modules that deliver various bits of functionality. Developers are often more in touch with one group of functionality than others. Examples of some of the most commonly used functionalities include those related to CMS blocks and pages, categories, products, customers, imports, custom product types, custom payment, and shipping modules. This is not to say that other functionalities are less important. In this chapter, we will take a quick look at the functionalities in the Magento admin area, PHP code, and API calls. The chapter is divided into the following sections:</p><div class="book"><ul class="itemizedlist"><li class="listitem">CMS management</li><li class="listitem">Catalog management</li><li class="listitem">Customer management</li><li class="listitem">Products and customer import</li><li class="listitem">Custom product types</li><li class="listitem">Custom offline shipping methods</li><li class="listitem">Custom offline payment methods</li></ul></div><p class="calibre7">The intention is not to go into the details of each functional area. Rather, the aim is to show the admin interface and the corresponding programmatic and API approach towards basic management.</p></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;The Major Functional Areas">
<div class="book" title="CMS management"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch10lvl1sec67" class="calibre1"/>CMS management</h1></div></div></div><p class="calibre7">Content is<a id="id443" class="calibre1"/> what helps differentiate one store from another. Quality content can boost a store's visibility on search engines, provide informative insight to the customers who buy products, and provide credibility and trust. Magento provides a solid content management system, which can be used to create rich content for a store. We can use it to manage blocks and pages too.</p></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;The Major Functional Areas">
<div class="book" title="CMS management">
<div class="book" title="Managing blocks manually"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch10lvl2sec32" class="calibre1"/>Managing blocks manually</h2></div></div></div><p class="calibre7">A CMS <a id="id444" class="calibre1"/>block is a small modular unit of content that can be positioned almost anywhere on a page. They can even be called into another blocks. Blocks support HTML and JavaScript as its content. Therefore, they are able to display static information such as text, images, and embedded video as well as dynamic information.</p><p class="calibre7">Blocks can be created via an admin interface, APIs, or code.</p><p class="calibre7">The following steps outline the block creation process from within an admin interface:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Log in to the Magento admin area.</li><li class="listitem" value="2">In the <span class="strong"><strong class="calibre8">Content</strong></span> | <span class="strong"><strong class="calibre8">Elements</strong></span> | <span class="strong"><strong class="calibre8">Blocks</strong></span> menu, click on <span class="strong"><strong class="calibre8">Add New Block</strong></span>. This opens a screen that is similar to the one shown in the following screenshot:<div class="mediaobject"><img src="../images/00070.jpeg" alt="Managing blocks manually" class="calibre10"/></div><p class="calibre13"> </p></li><li class="listitem" value="3">Fill in some values for the required fields (<span class="strong"><strong class="calibre8">Block Title</strong></span>, <span class="strong"><strong class="calibre8">Identifier</strong></span>, <span class="strong"><strong class="calibre8">Store View</strong></span>, <span class="strong"><strong class="calibre8">Status</strong></span>, and <span class="strong"><strong class="calibre8">Content</strong></span>) and click on the <span class="strong"><strong class="calibre8">Save Block</strong></span> button.</li></ol><div class="calibre14"/></div><p class="calibre7">Once the block is saved, you will see the <span class="strong"><strong class="calibre8">You saved the block.</strong></span> success message in the browser. CMS blocks are stored in the <code class="email">cms_block</code> and <code class="email">cms_block_store</code> tables in a database.</p><p class="calibre7">The <span class="strong"><strong class="calibre8">Identifier</strong></span> value is probably the most interesting aspect here. We can use it in a CMS page, another CMS block, or some code to fetch the block that we have just created.</p><p class="calibre7">Assuming that we have created a block with the <span class="strong"><strong class="calibre8">Identifier</strong></span> value of <code class="email">foggyline_hello</code>, we can call it in the CMS page or another block by using the following expression:</p><div class="informalexample"><pre class="programlisting">{{widget type="Magento\\Cms\\Block\\Widget\\Block" template="widget/static_block/default.phtml" block_id="foggyline_hello"}}</pre></div><p class="calibre7">We <a id="id445" class="calibre1"/>can also pass the actual integer ID value of a block to the preceding expression, as follows:</p><div class="informalexample"><pre class="programlisting">{{widget type="Magento\\Cms\\Block\\Widget\\Block" template="widget/static_block/default.phtml" block_id="2"}}</pre></div><p class="calibre7">However, this approach requires us to know the actual integer ID of a block.</p><p class="calibre7">The preceding expressions show that blocks are included in a page or another block via a widget, which is also known as a frontend app. A widget of the <code class="email">Magento\Cms\Block\Widget\Block</code> class type is using the <code class="email">widget/static_block/default.phtml</code> template file to render the actual CMS block.</p></div></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;The Major Functional Areas">
<div class="book" title="CMS management">
<div class="book" title="Managing blocks via code"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch10lvl2sec33" class="calibre1"/>Managing blocks via code</h2></div></div></div><p class="calibre7">Besides <a id="id446" class="calibre1"/>the manual creation of blocks via the admin interface, we can create CMS blocks by using code, as shown in the following code snippet:</p><div class="informalexample"><pre class="programlisting">$model = $this-&gt;_objectManager-&gt;create('Magento\Cms\Model\Block');
$model-&gt;setTitle('Test block');
$model-&gt;setIdentifier('test_block');
$model-&gt;setContent('Test block!');
$model-&gt;setIsActive(true);
$model-&gt;save();</pre></div><p class="calibre7">Here, we used the instance manager to create a new model instance of the <code class="email">Magento\Cms\Model\Block</code> class. Then, we set some properties through defined methods and finally called the <code class="email">save</code> method.</p><p class="calibre7">We can load and update the existing blocks using a code snippet that is similar to the following code:</p><div class="informalexample"><pre class="programlisting">$model = $this-&gt;_objectManager-&gt;create('Magento\Cms\Model\Block');
//$model-&gt;load(3);
$model-&gt;load('test_block');
$model-&gt;setTitle('Updated Test block');
$model-&gt;setStores([0]);
$model-&gt;save();</pre></div><p class="calibre7">The block's <code class="email">load</code> method accepts either an integer value of a block ID or a string value of a block identifier.</p><p class="calibre7">Finally, we<a id="id447" class="calibre1"/> can manage the creation and updating of blocks through the available APIs method. The following code snippet shows how a CMS block is created via a console cURL REST API call:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X POST "http://magento2.ce/index.php/rest/V1/cmsBlock" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8" \</strong></span>
<span class="strong"><strong class="calibre8">     -d '{"block": {"identifier": "test_api_block", "title": "Test API Block", "content": "API Block Content"}}'</strong></span>
</pre></div><p class="calibre7">The bearer string is just a login token that we obtain by first running the authentication API call, as described in the previous chapter. Once we have the authentication token, we can make a <code class="email">V1/cmsBlock</code> <code class="email">POST</code> request, passing a JSON object as data.</p></div></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;The Major Functional Areas">
<div class="book" title="CMS management">
<div class="book" title="Managing blocks via API"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch10lvl2sec34" class="calibre1"/>Managing blocks via API</h2></div></div></div><p class="calibre7">We can<a id="id448" class="calibre1"/> get the newly created CMS block through an API by executing a snippet of code that looks like this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X GET "http://magento2.ce/index.php/rest/V1/cmsBlock/4" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8"</strong></span>
</pre></div><p class="calibre7">We can update the existing CMS block by using an API and executing a snippet of code that is similar to this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X PUT "http://magento2.ce/index.php/rest/V1/cmsBlock/4" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8" \</strong></span>
<span class="strong"><strong class="calibre8">     -d '{"block": {"title": "Updated Test API Block"}}'</strong></span>
</pre></div><p class="calibre7">Here, we used the HTTP PUT method and passed the integer <code class="email">4</code> as a part of the <code class="email">V1/cmsBlock/4</code> URL. The number 4 represents the ID value of the block in the database.</p></div></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;The Major Functional Areas">
<div class="book" title="CMS management">
<div class="book" title="Managing pages manually"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch10lvl2sec35" class="calibre1"/>Managing pages manually</h2></div></div></div><p class="calibre7">CMS pages <a id="id449" class="calibre1"/>are robust content units unlike CMS blocks, which are simply embedded into certain pages. The CMS page can have its own URL. Examples of CMS pages are pages such as <span class="strong"><strong class="calibre8">404 Not Found</strong></span>, <span class="strong"><strong class="calibre8">Home page</strong></span>, <span class="strong"><strong class="calibre8">Enable Cookies</strong></span>, and <span class="strong"><strong class="calibre8">Privacy and Cookie Policy</strong></span>. The idea, when it comes to dealing with CMS pages, is that we can control the content area of a page without affecting site-wide elements such as the header, footer, or sidebars. Magento does not really come with many out-of-the-box CMS pages other than the ones that were listed previously.</p><p class="calibre7">Like blocks, pages can also be created via the admin interface, APIs, or code.</p><p class="calibre7">The following <a id="id450" class="calibre1"/>steps outline the page creation process from within the admin interface:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Log in to Magento admin area.</li><li class="listitem" value="2">In the <span class="strong"><strong class="calibre8">Content</strong></span> | <span class="strong"><strong class="calibre8">Elements</strong></span> | <span class="strong"><strong class="calibre8">Pages menu</strong></span>, click on <span class="strong"><strong class="calibre8">Add New Page</strong></span>. This opens a screen that is similar the one shown in the following screenshot:<div class="mediaobject"><img src="../images/00071.jpeg" alt="Managing pages manually" class="calibre10"/></div><p class="calibre13"> </p></li><li class="listitem" value="3">Fill in some values for the required fields (<span class="strong"><strong class="calibre8">Page Title</strong></span>, <span class="strong"><strong class="calibre8">Store View</strong></span>, <span class="strong"><strong class="calibre8">Status</strong></span>, and <span class="strong"><strong class="calibre8">Content</strong></span>) and click on the <span class="strong"><strong class="calibre8">Save</strong></span> Block button.</li></ol><div class="calibre14"/></div><p class="calibre7">Once the page is saved, you will see the <span class="strong"><strong class="calibre8">You saved this page.</strong></span> success message in the browser. CMS pages are stored in the <code class="email">cms_page</code> and <code class="email">cms_page_store</code> tables in the database.</p><p class="calibre7">Assuming that we have created a page with <span class="strong"><strong class="calibre8">Page Title</strong></span> value <span class="strong"><strong class="calibre8">Info</strong></span>, we can access this page in a browser via a URL such as <code class="email">http://magento2.ce/info</code>. Though we could have to specify the <span class="strong"><strong class="calibre8">URL Key</strong></span> value in the <span class="strong"><strong class="calibre8">New Page</strong></span> edit screen, Magento automatically assigns <span class="strong"><strong class="calibre8">URL Key</strong></span> that matches <span class="strong"><strong class="calibre8">Page Title</strong></span>.</p></div></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;The Major Functional Areas">
<div class="book" title="CMS management">
<div class="book" title="Managing pages via code"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_6"><a id="ch10lvl2sec36" class="calibre1"/>Managing pages via code</h2></div></div></div><p class="calibre7">Besides the manual creation through the admin interface, we can create CMS pages via code, as<a id="id451" class="calibre1"/> shown in the following code snippet:</p><div class="informalexample"><pre class="programlisting">$model = $this-&gt;_objectManager-&gt;create('Magento\Cms\Model\Page');
$model-&gt;setTitle('Test page');
$model-&gt;setIdentifier('test-page');
$model-&gt;setPageLayout('1column');
$model-&gt;setContent('Test page!');
$model-&gt;setIsActive(true);
$model-&gt;setStores([0]);
$model-&gt;save();</pre></div><p class="calibre7">Here, we used the instance manager to create a new model instance of the <code class="email">Magento\Cms\Model\Page</code> class. Then, we set some properties through the defined methods and finally called the <code class="email">save</code> method. The <span class="strong"><strong class="calibre8">URL Key</strong></span> that we set through the admin interface is actually an identifier that we set via the <code class="email">setIdentifier</code> method call.</p></div></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;The Major Functional Areas">
<div class="book" title="CMS management">
<div class="book" title="Managing pages via API"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_7"><a id="ch10lvl2sec37" class="calibre1"/>Managing pages via API</h2></div></div></div><p class="calibre7">We can<a id="id452" class="calibre1"/> load and update the existing pages by using a code snippet that is similar to the following one:</p><div class="informalexample"><pre class="programlisting">$model = $this-&gt;_objectManager-&gt;create('Magento\Cms\Model\Page');
//$model-&gt;load(6);
$model-&gt;load('test-page');
$model-&gt;setContent('Updated Test page!');
$model-&gt;save();</pre></div><p class="calibre7">The page model <code class="email">load</code> method accepts either an integer ID value of a page identifier (<span class="strong"><strong class="calibre8">URL Key</strong></span>).</p><p class="calibre7">Finally, we can manage the creation and updating of pages through the available APIs method. The following code snippet shows how a CMS page is created via a console cURL REST API call:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X POST "http://magento2.ce/index.php/rest/V1/cmsPage" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8" \</strong></span>
<span class="strong"><strong class="calibre8">     -d '{"page": {"identifier": "test-api-page", "title": "Test API Page", "content": "API Block Content"}}'</strong></span>
</pre></div><p class="calibre7">Once we have the authentication token, we can make a <code class="email">V1/cmsPage</code> <code class="email">POST</code> request, passing on the JSON object as data.</p><p class="calibre7">We can get the newly created CMS page through an API by executing a snippet of code that is<a id="id453" class="calibre1"/> similar to the following one:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X GET "http://magento2.ce/index.php/rest/V1/cmsPage/7" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8"</strong></span>
</pre></div><p class="calibre7">We can update the existing CMS page through an API by executing a snippet of code that is similar to the following one:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X PUT "http://magento2.ce/index.php/rest/V1/cmsPage/7" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8" \</strong></span>
<span class="strong"><strong class="calibre8">     -d '{"page": {"content": "Updated Test API Page", "identifier":"updated-page"}}'</strong></span>
</pre></div><p class="calibre7">Here, we used the HTTP PUT method, passing the integer <code class="email">7</code> as a part of the <code class="email">V1/cmsPage/7</code> URL. The number 7 represents the ID value of the page in the database.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Catalog management"><div class="book" id="27GQ62-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec68" class="calibre1"/>Catalog management</h1></div></div></div><p class="calibre7">The <code class="email">Magento_Catalog</code> module is one of the backbones of the entire Magento platform. It provides <a id="id454" class="calibre1"/>robust support for the inventory management of various product types. This module is what manages products, categories and their attributes, the display on the frontend, and many more things.</p></div>

<div class="book" title="Catalog management">
<div class="book" title="Managing categories manually"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec38" class="calibre1"/>Managing categories manually</h2></div></div></div><p class="calibre7">We <a id="id455" class="calibre1"/>can access the catalog functionality within the Magento admin area by navigating to <span class="strong"><strong class="calibre8">Products</strong></span> | <span class="strong"><strong class="calibre8">Inventory</strong></span> | <span class="strong"><strong class="calibre8">Catalog </strong></span>or<span class="strong"><strong class="calibre8"> Products</strong></span> | <span class="strong"><strong class="calibre8">Inventory</strong></span> | <span class="strong"><strong class="calibre8">Category</strong></span>.</p><p class="calibre7">If we start with a blank Magento installation, we will probably start with categories as one of the first entities to be created. We can manually create categories by performing the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Log in to the Magento admin area.</li><li class="listitem" value="2">Go to the <span class="strong"><strong class="calibre8">Products</strong></span> | <span class="strong"><strong class="calibre8">Inventory</strong></span> | <span class="strong"><strong class="calibre8">Category</strong></span> menu. This opens a screen that is similar to the one shown in the following screenshot:<div class="mediaobject"><img src="../images/00072.jpeg" alt="Managing categories manually" class="calibre10"/></div><p class="calibre13"> </p></li><li class="listitem" value="3">On<a id="id456" class="calibre1"/> the left-hand side of the screen, click on <span class="strong"><strong class="calibre8">Default Category</strong></span>. Then, when the page reloads, click on the <span class="strong"><strong class="calibre8">Add Subcategory</strong></span> button.</li><li class="listitem" value="4">Though it may seem that nothing has happened, as the screen content does not change, we should now fill in the required options in the <span class="strong"><strong class="calibre8">General Information</strong></span> tab, setting <span class="strong"><strong class="calibre8">Name</strong></span> to some string value and <span class="strong"><strong class="calibre8">Is Active</strong></span> to Yes.</li><li class="listitem" value="5">Finally, click on the <span class="strong"><strong class="calibre8">Save Category</strong></span> button.</li></ol><div class="calibre14"/></div><p class="calibre7">The new category should now be created. To the left screen area, if you click on the name of the newly created category, you will see its ID value above the <span class="strong"><strong class="calibre8">General Information</strong></span> tab, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00073.jpeg" alt="Managing categories manually" class="calibre10"/></div><p class="calibre11"> </p><div class="informalexample" title="Note"><h3 class="title2"><a id="note18" class="calibre1"/>Note</h3><p class="calibre7">Knowing the category ID enables you to directly test it on a storefront simply by opening a URL such as <code class="email">http://magento2.ce/index.php/catalog/category/view/id/3</code> in the browser, where the number <code class="email">3</code> is the ID of the category. You will see a loaded category page that probably shows the <span class="strong"><strong class="calibre8">We can't find products matching the selection.</strong></span> message, which is good, as we haven't assigned products to a category.</p></div><p class="calibre7">Though <a id="id457" class="calibre1"/>we will not go into its details, it is worth noting that we have simply scratched the surface here, as categories enable us to provide many additional options using the <span class="strong"><strong class="calibre8">Display Settings</strong></span>, <span class="strong"><strong class="calibre8">Custom Design</strong></span> tabs.</p><p class="calibre7">Given that categories are EAV entities, their data is stored across several tables in the database, as follows:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">catalog_category_entity</code></li><li class="listitem"><code class="email">catalog_category_entity_datetime</code></li><li class="listitem"><code class="email">catalog_category_entity_decimal</code></li><li class="listitem"><code class="email">catalog_category_entity_int</code></li><li class="listitem"><code class="email">catalog_category_entity_text</code></li><li class="listitem"><code class="email">catalog_category_entity_varchar</code></li></ul></div><p class="calibre7">There are a few additional tables that link categories to products:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">catalog_category_product</code></li><li class="listitem"><code class="email">catalog_category_product_index</code></li><li class="listitem"><code class="email">catalog_category_product_index_tmp</code></li><li class="listitem"><code class="email">catalog_url_rewrite_product_category</code></li></ul></div></div></div>

<div class="book" title="Catalog management">
<div class="book" title="Managing categories via code"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch10lvl2sec39" class="calibre1"/>Managing categories via code</h2></div></div></div><p class="calibre7">Besides<a id="id458" class="calibre1"/> the manual creation through the admin interface, we can create categories via code, as shown in the following code snippet:</p><div class="informalexample"><pre class="programlisting">$parentId = \Magento\Catalog\Model\Category::TREE_ROOT_ID;

$parentCategory = $this-&gt;_objectManager
                       -&gt;create('Magento\Catalog\Model\Category')
                       -&gt;load($parentId);

$category = $this-&gt;_objectManager
                -&gt;create('Magento\Catalog\Model\Category');

$category-&gt;setPath($parentCategory-&gt;getPath());
$category-&gt;setParentId($parentId);
$category-&gt;setName('Test');
$category-&gt;setIsActive(true);

$category-&gt;save();</pre></div><p class="calibre7">What is <a id="id459" class="calibre1"/>specific here is that when creating a new category, we first created a <code class="email">$parentCategory</code> instance, which represents the root category object. We used the <code class="email">Category</code> model <code class="email">TREE_ROOT_ID</code> constant as the ID value of a parent category ID. Then, we created an instance of the category, set its <code class="email">path</code>, <code class="email">parent_id</code>, <code class="email">name</code>, and <code class="email">is_active</code> value.</p></div></div>

<div class="book" title="Catalog management">
<div class="book" title="Managing categories via API"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch10lvl2sec40" class="calibre1"/>Managing categories via API</h2></div></div></div><p class="calibre7">We can<a id="id460" class="calibre1"/> further manage category creation through the available APIs method. The following code snippet shows category creation via the console cURL REST API call:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X POST "http://magento2.ce/index.php/rest/V1/categories" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8" \</strong></span>
<span class="strong"><strong class="calibre8">     -d '{"category": {"parent_id": "1", "name": "Test API Category", "is_active": true}}'</strong></span>
</pre></div><p class="calibre7">The bearer string is just a login token that we obtain by first running the authentication API call, as described in the previous chapter. Once we have the authentication token, we can make a <code class="email">/V1/categories POST</code> request, passing a JSON object as data.</p><p class="calibre7">We can get the newly created category as a JSON object through an API by executing a snippet of code that looks like the following one:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X GET "http://magento2.ce/index.php/rest/V1/categories/9" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8"</strong></span>
</pre></div></div></div>

<div class="book" title="Catalog management">
<div class="book" title="Managing products manually"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch10lvl2sec41" class="calibre1"/>Managing products manually</h2></div></div></div><p class="calibre7">Now, let's<a id="id461" class="calibre1"/> take a look at how to create a new product. We can manually create products by performing the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Log in to the Magento admin area.</li><li class="listitem" value="2">In the <span class="strong"><strong class="calibre8">Products</strong></span> | <span class="strong"><strong class="calibre8">Inventory</strong></span> | <span class="strong"><strong class="calibre8">Catalog</strong></span> menu, click on the <span class="strong"><strong class="calibre8">Add Product</strong></span> button. This opens a screen similar to the one shown in the following screenshot:<div class="mediaobject"><img src="../images/00074.jpeg" alt="Managing products manually" class="calibre10"/></div><p class="calibre13"> </p></li><li class="listitem" value="3">Now, fill in the required options on the <span class="strong"><strong class="calibre8">Product Details</strong></span> tab.</li><li class="listitem" value="4">Finally, click on the <span class="strong"><strong class="calibre8">Save</strong></span> button.</li></ol><div class="calibre14"/></div><p class="calibre7">If it is<a id="id462" class="calibre1"/> successfully saved, the page reloads and shows the <span class="strong"><strong class="calibre8">You saved the product.</strong></span> message.</p><p class="calibre7">Like categories, we have barely scratched the surface of products here. Looking at the other available tabs, there are a large number of additional options that can be assigned to a product. Simply assigning the required options should be enough for us to see the product on the store's frontend on a URL such as <code class="email">http://magento2.ce/index.php/catalog/product/view/id/4</code>, where the number <code class="email">4</code> is the ID value of a product.</p><p class="calibre7">Products are also EAV entities, whose data is stored across several tables in a database, as follows:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">catalog_product_entity</code></li><li class="listitem"><code class="email">catalog_product_entity_datetime</code></li><li class="listitem"><code class="email">catalog_product_entity_decimal</code></li><li class="listitem"><code class="email">catalog_product_entity_gallery</code></li><li class="listitem"><code class="email">catalog_product_entity_group_price</code></li><li class="listitem"><code class="email">catalog_product_entity_int</code></li><li class="listitem"><code class="email">catalog_product_entity_media_gallery</code></li><li class="listitem"><code class="email">catalog_product_entity_media_gallery_value</code></li><li class="listitem"><code class="email">catalog_product_entity_text</code></li><li class="listitem"><code class="email">catalog_product_entity_tier_price</code></li><li class="listitem"><code class="email">catalog_product_entity_varchar</code></li></ul></div><p class="calibre7">There<a id="id463" class="calibre1"/> are also a large number of other table referencing products, such as <code class="email">catalog_product_bundle_selection</code>, but these are mostly used to link bits of functionalities.</p></div></div>

<div class="book" title="Catalog management">
<div class="book" title="Managing products via code"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch10lvl2sec42" class="calibre1"/>Managing products via code</h2></div></div></div><p class="calibre7">Besides <a id="id464" class="calibre1"/>the manual creation through the admin interface, we can create products via code, as shown in the following code snippet:</p><div class="informalexample"><pre class="programlisting">$catalogConfig = $this-&gt;_objectManager
    -&gt;create('Magento\Catalog\Model\Config');

$attributeSetId = $catalogConfig-&gt;getAttributeSetId(4, 'Default');

$product = $this-&gt;_objectManager
    -&gt;create('Magento\Catalog\Model\Product');

$product
    -&gt;setTypeId(\Magento\Catalog\Model\Product\Type::TYPE_SIMPLE)
    -&gt;setAttributeSetId($attributeSetId)
    -&gt;setWebsiteIds([$this-&gt;storeManager-&gt;getWebsite()-&gt;getId()])
    -&gt;setStatus(\Magento\Catalog\Model\Product\Attribute \Source\Status::STATUS_ENABLED)
    -&gt;setStockData(['is_in_stock' =&gt; 1, 'manage_stock' =&gt; 0])
    -&gt;setStoreId(\Magento\Store\Model\Store::DEFAULT_STORE_ID)
    -&gt;setVisibility(\Magento\Catalog\Model\Product \Visibility::VISIBILITY_BOTH);

$product
    -&gt;setName('Test API')
    -&gt;setSku('tets-api')
    -&gt;setPrice(19.99);

$product-&gt;save();</pre></div></div></div>

<div class="book" title="Catalog management">
<div class="book" title="Managing products via API"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_6"><a id="ch10lvl2sec43" class="calibre1"/>Managing products via API</h2></div></div></div><p class="calibre7">The following <a id="id465" class="calibre1"/>example uses the REST API to create a new simple product:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X POST "http://magento2.ce/index.php/rest/V1/products" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8" \</strong></span>
<span class="strong"><strong class="calibre8">     -d '{"product":{"sku":"test_api_1","name":"Test API #1","attribute_set_id":4,"price":19.99,"status":1, "visibility":4,"type_id":"simple","weight":1}}'</strong></span>
</pre></div><p class="calibre7">The <code class="email">Bearer</code> token should have been previously obtained by using an authentication request. The response should be a JSON object that contains all the exposed product data.</p><p class="calibre7">We can get the existing product as information through an API that executes a snippet of code, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X GET "http://magento2.ce/index.php/rest/V1/products /product_dynamic_125" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json"</strong></span>
</pre></div><p class="calibre7">The <code class="email">product_dynamic_125</code> part in the preceding URL stands for this specific product SKU value. The response is a JSON object that contains all the exposed product data.</p><p class="calibre7">The entire list of the available catalog APIs can be seen in the <code class="email">vendor/magento/module-catalog/etc/webapi.xml</code> file.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Customer management"><div class="book" id="28FAO2-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec69" class="calibre1"/>Customer management</h1></div></div></div><p class="calibre7">Managing <a id="id466" class="calibre1"/>customers is another important aspect of the Magento platform. Most of the time, customer creation is something that is left for a new customer to do. A new customer who visits a store initiates the registration process and finishes up with a customer account being created. Once registered, customers can then further edit their account details on the storefront under the <span class="strong"><strong class="calibre8">My Account</strong></span> page, which is usually available on a link such as <code class="email">http://magento2.ce/index.php/customer/account/index/</code>.</p><p class="calibre7">As a part of this section, we are interested in the possibility of managing customer accounts by using the admin area, code, and API.</p></div>

<div class="book" title="Customer management">
<div class="book" title="Managing customers manually"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec44" class="calibre1"/>Managing customers manually</h2></div></div></div><p class="calibre7">The <a id="id467" class="calibre1"/>following steps outline the customer account creation process from within the admin interface:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Log in to Magento admin area.</li><li class="listitem" value="2">In the <span class="strong"><strong class="calibre8">Customers</strong></span> | <span class="strong"><strong class="calibre8">All Customers</strong></span> menu, click on the <span class="strong"><strong class="calibre8">Add New Customer</strong></span> button. This opens a screen<a id="id468" class="calibre1"/> that looks similar to the one shown in the following screenshot:<div class="mediaobject"><img src="../images/00075.jpeg" alt="Managing customers manually" class="calibre10"/></div><p class="calibre13"> </p></li><li class="listitem" value="3">Fill in some values for the required fields (<span class="strong"><strong class="calibre8">Associate to Website</strong></span>, <span class="strong"><strong class="calibre8">Group</strong></span>, <span class="strong"><strong class="calibre8">First Name</strong></span>, <span class="strong"><strong class="calibre8">Last Name</strong></span>, and <span class="strong"><strong class="calibre8">Email</strong></span>) and click on the <span class="strong"><strong class="calibre8">Save Customer</strong></span> button.</li></ol><div class="calibre14"/></div><p class="calibre7">Once the customer is saved, you will see the <span class="strong"><strong class="calibre8">You saved the customer.</strong></span> success message in the browser.</p><p class="calibre7">The <span class="strong"><strong class="calibre8">Associate to Website</strong></span> value is probably the most important value for cases like this one, where customer accounts are being indirectly created by a user who's not a customer.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note19" class="calibre1"/>Note</h3><p class="calibre7">Since Magento supports the setting up of multiple websites, customer accounts can be set to either the <span class="strong"><strong class="calibre8">Global</strong></span> or <span class="strong"><strong class="calibre8">Per Website</strong></span> value, depending on the <span class="strong"><strong class="calibre8">Stores</strong></span> | <span class="strong"><strong class="calibre8">Settings</strong></span> | <span class="strong"><strong class="calibre8">Configuration</strong></span> | <span class="strong"><strong class="calibre8">Customers</strong></span> | <span class="strong"><strong class="calibre8">Customer Configuration</strong></span> | <span class="strong"><strong class="calibre8">Account Sharing Option</strong></span> | <span class="strong"><strong class="calibre8">Share Customer Accounts</strong></span> option. Thus, if the <span class="strong"><strong class="calibre8">Share Customer Accounts</strong></span> option has been set to <span class="strong"><strong class="calibre8">Per Website</strong></span>, it is of the utmost important to point the <span class="strong"><strong class="calibre8">Associate to Website</strong></span> value to the proper website. Otherwise, a customer account will be created but the customer won't be able to log in to it on the storefront.</p></div><p class="calibre7">The <code class="email">Magento_Customer</code> module uses the EAV structure to store customer data. Thus, there is<a id="id469" class="calibre1"/> no single table that stores customer information. Rather, multiple tables exist, depending on the customer property and its data type.</p><p class="calibre7">The following list comprises tables that store customer entity:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">customer_entity</code></li><li class="listitem"><code class="email">customer_entity_datetime</code></li><li class="listitem"><code class="email">customer_entity_decimal</code></li><li class="listitem"><code class="email">customer_entity_int</code></li><li class="listitem"><code class="email">customer_entity_text</code></li><li class="listitem"><code class="email">customer_entity_varchar</code></li></ul></div><p class="calibre7">Customer accounts will not really be complete without a customer address. The address can be added via the <span class="strong"><strong class="calibre8">Addresses</strong></span> tab under the customer edit screen in the admin area, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00076.jpeg" alt="Managing customers manually" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Note that Magento enables us to set one of the addresses as <span class="strong"><strong class="calibre8">Default Shipping Address</strong></span> and <span class="strong"><strong class="calibre8">Default Billing Address</strong></span>.</p><p class="calibre7">Like the customer entity, the customer address entity also uses the EAV structure to store its data.</p><p class="calibre7">The<a id="id470" class="calibre1"/> following list comprises tables that store the customer address entity:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">customer_address_entity</code></li><li class="listitem"><code class="email">customer_address_entity_datetime</code></li><li class="listitem"><code class="email">customer_address_entity_decimal</code></li><li class="listitem"><code class="email">customer_address_entity_int</code></li><li class="listitem"><code class="email">customer_address_entity_text</code></li><li class="listitem"><code class="email">customer_address_entity_varchar</code></li></ul></div></div></div>

<div class="book" title="Customer management">
<div class="book" title="Managing customers via code"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch10lvl2sec45" class="calibre1"/>Managing customers via code</h2></div></div></div><p class="calibre7">Besides <a id="id471" class="calibre1"/>the manual creation via the admin interface, we can create customers via code, as shown in the following code snippet:</p><div class="informalexample"><pre class="programlisting">$model = $this-&gt;_objectManager-&gt; create('Magento\Customer\Model\Customer');
$model-&gt;setWebsiteId(1);
$model-&gt;setGroupId(1);
$model-&gt;setFirstname('John');
$model-&gt;setLastname('Doe');
$model-&gt;setEmail('john.doe@mail.com');
$model-&gt;save();</pre></div><p class="calibre7">Here, we are using the instance manager to create a new model instance of the <code class="email">Magento\Customer\Model\Customer</code> class. We can then set some properties through the defined methods and finally call the <code class="email">save</code> method.</p><p class="calibre7">We can load and update an existing customer by using a code snippet that is similar to the following one:</p><div class="informalexample"><pre class="programlisting">$model = $this-&gt;_objectManager-&gt; create('Magento\Customer\Model\Customer');
$model-&gt;setWebsiteId(1);
//$model-&gt;loadByEmail('john.doe@mail.com');
$model-&gt;load(1);
$model-&gt;setFirstname('Updated John');
$model-&gt;save();</pre></div><p class="calibre7">We can use either the <code class="email">load</code> or <code class="email">loadByEmail</code> method call. The <code class="email">load</code> method accepts the integer ID value of the existing customer entity, while <code class="email">loadByEmail</code> accepts a string e-mail address. It is worth noting that <code class="email">setWebsiteId</code> has to be called prior to any of the load methods. Otherwise, we will get an error message that says <span class="strong"><strong class="calibre8">A customer website ID must be specified when using the website scope</strong></span>.</p></div></div>

<div class="book" title="Customer management">
<div class="book" title="Managing customers via an API"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch10lvl2sec46" class="calibre1"/>Managing customers via an API</h2></div></div></div><p class="calibre7">Finally, we <a id="id472" class="calibre1"/>can manage the creation and updating of customer information using the available API method. The following code snippet shows how to create a customer via a console cURL REST API call:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X POST "http://magento2.ce/index.php/rest/V1/customers" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
     <span class="strong"><strong class="calibre8">-H "Authorization: Bearer r9ok12c3wsusrxqomyxiwo0v7etujw9h" \</strong></span>
<span class="strong"><strong class="calibre8">     -d '{"customer": {"website_id": 1, "group_id": 1, "firstname": "John", "lastname": "Doe", "email": "john.doe@mail.com"}, "password":"abc123"}'</strong></span>
</pre></div><p class="calibre7">Once we have the authentication token, we can make a <code class="email">V1/customers</code> <code class="email">POST</code> request, passing a JSON object as data.</p><p class="calibre7">We can get the newly created customer via an API by executing a snippet of code that is similar to the following one:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X GET "http://magento2.ce/index.php/rest/V1/customers/24" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8"</strong></span>
</pre></div><p class="calibre7">We can update an existing customer through an API by executing a snippet of code that is similar to the following one:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X PUT "http://magento2.ce/index.php/rest/V1/customers/24" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer r9ok12c3wsusrxqomyxiwo0v7etujw9h" \</strong></span>
<span class="strong"><strong class="calibre8">     -d '{"customer": {"id":24, "website_id": 1, "firstname": "John Updated", "lastname": "Doe", "email": "john2@mail.com"}, "password_hash":"cda57c7995e5f03fe07ad52d99686ba130e0d3e fe0d84dd5ee9fe7f6ea632650:cEf8i1f1ZXT1L2NwawTRNEqDWGyru6h3:1"}'</strong></span>
</pre></div><p class="calibre7">Here, we used the HTTP PUT method, passing the integer <code class="email">24</code> as a part of the <code class="email">V1/customers/24 and as part of the body</code> URL. The number 24 represents the ID value of a customer in the database. Also, note the <code class="email">password_hash</code> value; without it, the update will fail.</p></div></div>

<div class="book" title="Customer management">
<div class="book" title="Managing customer address via code"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch10lvl2sec47" class="calibre1"/>Managing customer address via code</h2></div></div></div><p class="calibre7">Similar <a id="id473" class="calibre1"/>to customers, we can create a customer address using code, as shown in the following code snippet:</p><div class="informalexample"><pre class="programlisting">$model = $this-&gt;_objectManager-&gt; create('Magento\Customer\Model\Address');
//$model-&gt;setCustomer($customer);
$model-&gt;setCustomerId(24);
$model-&gt;setFirstname('John');
$model-&gt;setLastname('Doe');
$model-&gt;setCompany('Foggyline');
$model-&gt;setStreet('Test street');
$model-&gt;setCity('London');
$model-&gt;setCountryId('GB');
$model-&gt;setPostcode('GU22 7PY');
$model-&gt;setTelephone('112233445566');
$model-&gt;setIsDefaultBilling(true);
$model-&gt;setIsDefaultShipping(true);
$model-&gt;save();</pre></div><p class="calibre7">Here, we<a id="id474" class="calibre1"/> used the instance manager to create a new model instance of the <code class="email">Magento\Customer\Model\Address</code> class. We then set some properties through the defined methods and finally called the <code class="email">save</code> method.</p><p class="calibre7">We can load and update the existing customer address by using a code snippet that is similar to the following one:</p><div class="informalexample"><pre class="programlisting">$model = $this-&gt;_objectManager-&gt; create('Magento\Customer\Model\Address');
$model-&gt;load(22);
$model-&gt;setCity('Update London');
$model-&gt;save();</pre></div><p class="calibre7">Here, we used the <code class="email">load</code> method to load an existing address by its ID value. Then, we called the <code class="email">setCity</code> method passing it the updated string. After the <code class="email">save</code> method is executed, the address should reflect the change.</p></div></div>

<div class="book" title="Customer management">
<div class="book" title="Managing customers address via an API"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch10lvl2sec48" class="calibre1"/>Managing customers address via an API</h2></div></div></div><p class="calibre7">Surprisingly, a customer address cannot<a id="id475" class="calibre1"/> be created or updated directly via an API call, as there is no <code class="email">POST</code> or <code class="email">PUT REST</code> API defined. However, we can still get the existing customer address information by using an API, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">curl -X GET "http://magento2.ce/index.php/rest/V1/customers /addresses/22" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Content-Type:application/json" \</strong></span>
<span class="strong"><strong class="calibre8">     -H "Authorization: Bearer lcpnsrk4t6al83lymhfs86jabbi9mmt8"</strong></span>
</pre></div><p class="calibre7">The entire list of available customer APIs can be seen in the <code class="email">vendor/magento/module-customer/etc/webapi.xml</code> file.</p></div></div>
<div class="book" title="Products and customers import"><div class="book" id="29DRA2-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec70" class="calibre1"/>Products and customers import</h1></div></div></div><p class="calibre7">Magento <a id="id476" class="calibre1"/>provides an out-of-the-box mass import and export functionality via the following modules:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">AdvancedPricingImportExport</code></li><li class="listitem"><code class="email">BundleImportExport</code></li><li class="listitem"><code class="email">CatalogImportExport</code></li><li class="listitem"><code class="email">ConfigurableImportExport</code></li><li class="listitem"><code class="email">CustomerImportExport</code></li><li class="listitem"><code class="email">GroupedImportExport</code></li><li class="listitem"><code class="email">ImportExport</code></li><li class="listitem"><code class="email">TaxImportExport</code></li></ul></div><p class="calibre7">The heart of the import functionality actually lies in the <code class="email">ImportExport</code> module, while other modules provide individual import and export entities through the <code class="email">vendor/magento/module-{partialModuleName}-import-export/etc/import.xml</code> and <code class="email">vendor/magento/module-{partialModuleName}-import-export/etc/export.xml</code> files.</p><p class="calibre7">These functionalities can be accessed from the Magento admin area from the <span class="strong"><strong class="calibre8">System</strong></span> | <span class="strong"><strong class="calibre8">Data Transfer</strong></span> menu. They enable us to export and import several entity types, such as <span class="strong"><strong class="calibre8">Advanced Pricing</strong></span>, <span class="strong"><strong class="calibre8">Products</strong></span>, <span class="strong"><strong class="calibre8">Customers Main File</strong></span>, and <span class="strong"><strong class="calibre8">Customer Addresses</strong></span>.</p><p class="calibre7">The following screenshot shows the <span class="strong"><strong class="calibre8">Entity Type</strong></span> options for the <span class="strong"><strong class="calibre8">Import Settings</strong></span> screen:</p><div class="mediaobject"><img src="../images/00077.jpeg" alt="Products and customers import" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Next to <span class="strong"><strong class="calibre8">Import Settings</strong></span>, when we select <span class="strong"><strong class="calibre8">Entity Type</strong></span> for import, the <span class="strong"><strong class="calibre8">Import Behavior</strong></span> section appears, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00078.jpeg" alt="Products and customers import" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Most<a id="id477" class="calibre1"/> entity types have similar options for <span class="strong"><strong class="calibre8">Import Behavior</strong></span>. Most of the time, we will be interested in the <span class="strong"><strong class="calibre8">Add/Update</strong></span> behavior.</p><p class="calibre7">Since importing is a bit more complicated process than exporting, we will focus on importing and the CSV file format. More specifically, our focus is on <span class="strong"><strong class="calibre8">Products</strong></span>, <span class="strong"><strong class="calibre8">Customers Main File</strong></span>, and <span class="strong"><strong class="calibre8">Customer Addresses</strong></span> imports.</p><p class="calibre7">When working with a clean Magento installation, the following columns are required during the product import in order to make the product visible on the storefront afterwards:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">sku</code> (for example, "test-sku"): This can have almost any value as long as it is unique across Magento.</li><li class="listitem"><code class="email">attribute_set_code</code> (for example, "Default"): This can have any of the values found in a database when the <code class="email">SELECT DISTINCT attribute_set_name FROM eav_attribute_set;</code> query is executed.</li><li class="listitem"><code class="email">product_type</code> (for example, "simple"): This can have the values of <code class="email">simple</code>, <code class="email">configurable</code>, <code class="email">grouped</code>, <code class="email">virtual</code>, <code class="email">bundle</code>, or <code class="email">downloadable</code>. Additionally, if we create or install a third-party module that adds a new product type, we can use that one as well.</li><li class="listitem"><code class="email">categories </code>(for example, "Root/Shoes"): Create a full category path using the "Root category name/Child category name/Child child category name" syntax. If there are multiple categories, then a pipe ("|") is used to separate them. An example of this is "Root category name/Child category name/Child child category name| Root category name/Child_2 category name".</li><li class="listitem"><code class="email">product_websites </code>(for example, "base"): This can have the values found in a database when the <code class="email">SELECT DISTINCT code FROM store_website;</code> query is executed.</li><li class="listitem"><code class="email">name </code>(for example, "Test"): This can have almost any value.</li><li class="listitem"><code class="email">product_online </code>(for example, "1"): This can be either <code class="email">1</code> for <code class="email">visible</code> or <code class="email">0</code> for <code class="email">not visible</code></li><li class="listitem"><code class="email">visibility </code>(for example, "Catalog, Search"): This can have the values of "Not Visible Individually", "Catalog", "Search", or "Catalog, Search".</li><li class="listitem"><code class="email">price </code>(for example, "9.99"): This can be an integer or a decimal value.</li><li class="listitem"><code class="email">qty </code>(for example, "100"): This can be an integer or a decimal value.</li></ul></div><p class="calibre7">Though <a id="id478" class="calibre1"/>the products will get imported just with the preceding list that comprises a set of columns, we usually would like to assign additional information to them, such as descriptions and images. We can do so with the help of the following columns:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">description </code>(for example, "The description"): This can have any string value. HTML and JavaScript are supported.</li><li class="listitem"><code class="email">short_description </code>(for example, "The short description"): This can have any string value. HTML and JavaScript are supported.</li><li class="listitem"><code class="email">base_image </code>(for example, <code class="email">butterfly.jpg</code>): This is the final import image name.</li><li class="listitem"><code class="email">small_image </code>(for example, <code class="email">galaxy.jpg</code>)</li><li class="listitem"><code class="email">thumbnail_image </code>(for example, <code class="email">serenity.jpg</code>)</li></ul></div><p class="calibre7">Regarding the importing of images, we only need to provide the final image name as long as the <span class="strong"><strong class="calibre8">Images File Directory</strong></span> path is set during the import. We can use a relative path for the Magento installation, such as <code class="email">var/export</code>, <code class="email">var/import</code>, <code class="email">var/export/some/dir</code>.</p><p class="calibre7">Once the import is finished, it is suggested to run the <code class="email">php bin/magento indexer:reindex</code> command via the console. Otherwise, the products won't be visible on the storefront until the indexer is run.</p><p class="calibre7">Once the reindexing is done, we can try opening the storefront URL, which looks like <code class="email">http://magento2.ce/index.php/catalog/product/view/id/1</code>. The number <code class="email">1</code> in this case is a newly imported product ID.</p><p class="calibre7">When working with a clean Magento installation, the following columns are required during a customer's main file import in order for our customer to be able to successfully log in to the storefront afterwards:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">email</code> (for example, <code class="email">&lt;<a class="calibre1" href="mailto:john.doe@fake.mail">john.doe@fake.mail</a>&gt;</code>): an e-mail address as a string value</li><li class="listitem"><code class="email">_website</code> (for example, base): This can have any of the values found in the database when the <code class="email">SELECT DISTINCT code FROM store_website;</code> query is executed</li><li class="listitem"><code class="email">firstname</code> (for example, John): a string value</li><li class="listitem"><code class="email">lastname</code> (for example, Doe): a string value</li><li class="listitem"><code class="email">group_id</code> (for example, 1): This can have any of the values found in the database when the <code class="email">SELECT customer_group_id code FROM customer_group WHERE customer_group_id != 0;</code> query is executed</li></ul></div><p class="calibre7">Though a <a id="id479" class="calibre1"/>customer will be able to log in to the storefront with just the previously listed set of columns, we usually would like to assign other relevant pieces of information. We can do so with the help of the following columns:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">gender</code> (for example, Male): This can be either Male or Female</li><li class="listitem"><code class="email">taxvat</code> (for example, HR33311122299): any valid VAT number, though an import will accept even the invalid ones</li><li class="listitem"><code class="email">dob</code> (for example, 1983-01-16): date of birth</li><li class="listitem"><code class="email">prefix</code> (for example, Mr): any string value</li><li class="listitem"><code class="email">middlename</code> (for example, the dev guy): any string value</li><li class="listitem"><code class="email">suffix</code> (for example, engineer): any string value</li><li class="listitem"><code class="email">password</code> (for example, 123abc): any string value that has a minimum length of 6 characters, as defined via <code class="email">\Magento\CustomerImportExport\Model\Import\Customer::MIN_PASSWORD_LENGTH</code></li></ul></div><p class="calibre7">We need to pay special attention to the <code class="email">password</code> column. This is a clear text password. Therefore, we need to be careful not to distribute a CSV file in a nonsecure manner. Ideally, we can provide the <code class="email">password_hash</code> column instead of <code class="email">password</code>. However, entries under the <code class="email">password_hash</code> column will need to be hashed via the same algorithm as the one that was called within the <code class="email">hashPassword</code> method of the <code class="email">Magento\Customer\Model\Customer</code> class. This further calls the <code class="email">getHash</code> method on an instance of the <code class="email">Magento\Framework\Encryption\Encryptor</code> class, which finally resolves to the <code class="email">md5</code> or <code class="email">sha256</code> algorithm.</p><p class="calibre7">When working with a clean Magento installation, the following columns are required during the customer address import in order for our customers to be able to successfully use the addresses on the storefront afterwards:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">_website</code> (for example, base): This can have any of the values found in the database when the <code class="email">SELECT DISTINCT code FROM store_website;</code> query is executed</li><li class="listitem"><code class="email">_email</code> (for example, <code class="email">&lt;<a class="calibre1" href="mailto:john@change.me">john@change.me</a>&gt;</code>): an e-mail address as a string value</li><li class="listitem"><code class="email">_entity_id</code></li><li class="listitem"><code class="email">firstname</code> (for example, John): any string value</li><li class="listitem"><code class="email">lastname</code> (for example, Doe): any string value</li><li class="listitem"><code class="email">street</code> (for example, Ashton Lane): any string value</li><li class="listitem"><code class="email">city</code> (for example, Austin): any string value</li><li class="listitem"><code class="email">telephone</code> (for example, 00 385 91 111 000): any string value</li><li class="listitem"><code class="email">country_id</code> (for example, GB): the country code in the ISO-2 format</li><li class="listitem"><code class="email">postcode</code> (for example, TX 78753): any string value</li></ul></div><p class="calibre7">Though<a id="id480" class="calibre1"/> a customer will be able to use the addresses on the storefront with just a listed set of columns, we usually would like to assign other relevant pieces of information. We can do so with the help of the following columns:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="email">region</code> (for example, California): This can be blank, a free form string, or a specific string that matches any of the values found in the database when the <code class="email">SELECT DISTINCT default_name FROM directory_country_region;</code> query is executed. On running <code class="email">SELECT DISTINCT country_id FROM directory_country_region;</code>, 13 different country codes that have entries within the <code class="email">directory_country_region</code> table are shown—<code class="email">AT</code>, <code class="email">BR</code>, <code class="email">CA</code>, <code class="email">CH</code>, <code class="email">DE</code>, <code class="email">EE</code>, <code class="email">ES</code>, <code class="email">FI</code>, <code class="email">FR</code>, <code class="email">LT</code>, <code class="email">LV</code>, <code class="email">RO</code>, <code class="email">US</code>. This means that countries with that code need to have a proper region name assigned.</li><li class="listitem"><code class="email">company</code> (for example, Foggyline): This can be any string value.</li><li class="listitem"><code class="email">fax</code> (for example, 00 385 91 111 000): This can be any string value.</li><li class="listitem"><code class="email">middlename</code> (for example, the developer): This can be any string value.</li><li class="listitem"><code class="email">prefix</code> (for example, Mr): This can be any string value.</li><li class="listitem"><code class="email">suffix</code> (for example, engineer): This can be any string value.</li><li class="listitem"><code class="email">vat_id</code> (for example, HR33311122299): This can be any valid VAT number, though import will accept even the non-valid ones.</li><li class="listitem"><code class="email">_address_default_billing_</code> (for example, "1"): This can be either "1" as yes or "0" as no, to flag the address as being the default billing address.</li><li class="listitem"><code class="email">_address_default_shipping_</code> (for example, "1"): This can be either "1" as yes or "0" as no, to flag the address as being default shipping address.</li></ul></div><p class="calibre7">While CSV imports are a great and relatively fast way to mass import products, customers, and their addresses, there are some limitations to it. CSV is simply flat data. We cannot apply any logic to it. Depending on how clean and valid the data is, the CSV import might do just fine. Otherwise, we might want to opt for APIs. We need to keep in mind that a CSV import is much faster than the API creation of products and customers because CSV imports work directly by bulk inserting on the database, while APIs instantiate full models, respect the event observers, and so on.</p></div>
<div class="book" title="The custom product types"><div class="book" id="2ACBS2-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec71" class="calibre1"/>The custom product types</h1></div></div></div><p class="calibre7">Magento <a id="id481" class="calibre1"/>provides the following six out-of-the-box product types:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Simple products</li><li class="listitem">Configurable products</li><li class="listitem">Grouped products</li><li class="listitem">Virtual products</li><li class="listitem">Bundle products</li><li class="listitem">Downloadable products</li></ul></div><p class="calibre7">Each product has its specifics. For example, the virtual and downloadable products do not have the <code class="email">weight</code> attribute. Therefore, they are excluded from the standard shipping calculations. With custom coding around built-in product types, by using observers and plugins we can achieve almost any functionality. However, this is not enough sometimes or there is no solution to the requirement. In cases such as these, we might need to create our own product type that will match the project requirements in a more streamlined way.</p><p class="calibre7">Let's create a miniature module called <code class="email">Foggyline_DailyDeal</code> that will add a new product type to Magento.</p><p class="calibre7">Start by creating a module registration file named <code class="email">app/code/Foggyline/DailyDeal/registration.php</code> that has the following partial content:</p><div class="informalexample"><pre class="programlisting">\Magento\Framework\Component\ComponentRegistrar::register(
    \Magento\Framework\Component\ComponentRegistrar::MODULE,
    'Foggyline_DailyDeal',
    __DIR__
);</pre></div><p class="calibre7">Then, create an <code class="email">app/code/Foggyline/DailyDeal/etc/module.xml</code> with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;config  xsi:noNamespaceSchemaLocation="urn:magento:framework:Module /etc/module.xsd"&gt;
    &lt;module name="Foggyline_DailyDeal" setup_version="1.0.0"&gt;
        &lt;sequence&gt;
            &lt;module name="Magento_Catalog"/&gt;
        &lt;/sequence&gt;
    &lt;/module&gt;
&lt;/config&gt;</pre></div><p class="calibre7">Now, create an <code class="email">app/code/Foggyline/DailyDeal/etc/product_types.xml</code> file that has the following content:</p><div class="informalexample"><pre class="programlisting">&lt;config  xsi:noNamespaceSchemaLocation="urn:magento:module: Magento_Catalog:etc/product_types.xsd"&gt;
    &lt;type name="foggylinedailydeal"
          label="Daily Deal"
          modelInstance="Foggyline\DailyDeal\Model\Product\Type \DailyDeal"
          composite="false"
          isQty="true"
          canUseQtyDecimals="false"&gt;
        &lt;priceModel instance="Foggyline\DailyDeal\Model \Product\Price"/&gt;
        &lt;indexerModel instance="Foggyline\DailyDeal\Model \ResourceModel\Indexer\Price"/&gt;
        &lt;stockIndexerModel instance="Foggyline\DailyDeal\Model \ResourceModel\Indexer\Stock"/&gt;
        &lt;!-- customAttributes parsed by Magento\Catalog\Model\ProductTypes\Config --&gt;
        &lt;customAttributes&gt;
            &lt;attribute name="is_real_product" value="true"/&gt;
            &lt;attribute name="refundable" value="false"/&gt;
            &lt;attribute name="taxable" value="true"/&gt;
        &lt;/customAttributes&gt;
    &lt;/type&gt;
&lt;/config&gt;</pre></div><p class="calibre7">The <code class="email">customAttributes</code> element is parsed by <code class="email">vendor/magento/module-catalog/Model/ProductTypes/Config.php</code>.</p><p class="calibre7">Create <a id="id482" class="calibre1"/>an <code class="email">app/code/Foggyline/DailyDeal/Model/Product/Type/DailyDeal.php</code> file with partial content, as follows:</p><div class="informalexample"><pre class="programlisting">namespace Foggyline\DailyDeal\Model\Product\Type;

class DailyDeal extends \Magento\Catalog\Model\Product\Type\AbstractType
{
    const TYPE_DAILY_DEAL = 'foggylinedailydeal';

    public function deleteTypeSpecificData (\Magento\Catalog\Model\Product $product)
    {
        // TODO: Implement deleteTypeSpecificData() method.
    }
}</pre></div><p class="calibre7">Now, create an <code class="email">app/code/Foggyline/DailyDeal/Model/Product/Price.php</code> file with partial content, as follows:</p><div class="informalexample"><pre class="programlisting">namespace Foggyline\DailyDeal\Model\Product;

class Price extends \Magento\Catalog\Model\Product\Type\Price
{

}</pre></div><p class="calibre7">After this<a id="id483" class="calibre1"/> is done, create an <code class="email">app/code/Foggyline/DailyDeal/Model/ResourceModel/Indexer/Price.php</code> file with partial content, as follows:</p><div class="informalexample"><pre class="programlisting">namespace Foggyline\DailyDeal\Model\ResourceModel\Indexer;

class Price extends \Magento\Catalog\Model\ResourceModel\Product \Indexer\Price\DefaultPrice
{
}</pre></div><p class="calibre7">Then, create an <code class="email">app/code/Foggyline/DailyDeal/Model/ResourceModel/Indexer/Stock.php</code> file with partial content, as follows:</p><div class="informalexample"><pre class="programlisting">namespace Foggyline\DailyDeal\Model\ResourceModel\Indexer;

class Stock extends \Magento\CatalogInventory\Model\ResourceModel \Indexer\Stock\DefaultStock
{

}</pre></div><p class="calibre7">Finally, create an <code class="email">app/code/Foggyline/DailyDeal/Setup/InstallData.php</code> file with partial content, as follows:</p><div class="informalexample"><pre class="programlisting">namespace Foggyline\DailyDeal\Setup;

class InstallData implements \Magento\Framework\Setup\InstallDataInterface
{
    private $eavSetupFactory;

    public function __construct(\Magento\Eav\Setup\EavSetupFactory $eavSetupFactory)
    {
        $this-&gt;eavSetupFactory = $eavSetupFactory;
    }

    public function install(
        \Magento\Framework\Setup\ModuleDataSetupInterface $setup,
        \Magento\Framework\Setup\ModuleContextInterface $context
    )
    {
        // the "foggylinedailydeal" type specifics
    }
}</pre></div><p class="calibre7">Extend the <code class="email">install</code> method<a id="id484" class="calibre1"/> from within the <code class="email">InstallData</code> class by adding the following <code class="email">foggylinedailydeal</code> type specifics to it:</p><div class="informalexample"><pre class="programlisting">$eavSetup = $this-&gt;eavSetupFactory-&gt;create(['setup' =&gt; $setup]);
$type = \Foggyline\DailyDeal\Model\Product\Type\ DailyDeal::TYPE_DAILY_DEAL;

$fieldList = [
    'price',
    'special_price',
    'special_from_date',
    'special_to_date',
    'minimal_price',
    'cost',
    'tier_price',
    'weight',
];

// make these attributes applicable to foggylinedailydeal products
foreach ($fieldList as $field) {
    $applyTo = explode(
        ',',
        $eavSetup-&gt;getAttribute (\Magento\Catalog\Model\Product::ENTITY, $field, 'apply_to')
    );

    if (!in_array($type, $applyTo)) {
        $applyTo[] = $type;
        $eavSetup-&gt;updateAttribute(
            \Magento\Catalog\Model\Product::ENTITY,
            $field,
            'apply_to',
            implode(',', $applyTo)
        );
    }
}</pre></div><p class="calibre7">Now, run <code class="email">php bin/magento setup:upgrade</code> from the console.</p><p class="calibre7">If you now open the <span class="strong"><strong class="calibre8">Products</strong></span> | <span class="strong"><strong class="calibre8">Inventory</strong></span> | <span class="strong"><strong class="calibre8">Catalog</strong></span> menu in the admin area and click on the dropdown<a id="id485" class="calibre1"/> icon next to the <span class="strong"><strong class="calibre8">Add Product</strong></span> button, you will see the <span class="strong"><strong class="calibre8">Daily Deal</strong></span> product type on the list, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00079.jpeg" alt="The custom product types" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Clicking on the <span class="strong"><strong class="calibre8">Daily Deal</strong></span> product type in the dropdown list should open the product edit page, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00080.jpeg" alt="The custom product types" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">There is no noticeable difference between the custom product type edit screen and one of the built-in product types.</p><p class="calibre7">Assuming<a id="id486" class="calibre1"/> that we have named the product <code class="email">Daily Deal Test Product</code> and saved it, we should be able to see it on the storefront, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00081.jpeg" alt="The custom product types" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">If we add the product to the cart and perform a checkout, an order should be created just as with any other product type. Within the admin area, on the order view page, under <span class="strong"><strong class="calibre8">Items Ordered</strong></span>, we should be able to see the product on the list, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00082.jpeg" alt="The custom product types" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Again, there is no noticeable difference between the custom product type and the built-in product type that is rendering under the <span class="strong"><strong class="calibre8">Items Ordered</strong></span> section.</p><p class="calibre7">Finally, we<a id="id487" class="calibre1"/> should run the <code class="email">php bin/magento indexer:reindex</code> command on the console. Even though we haven't really implemented any code within the indexers, this is just to ensure that none of the existing indexers broke.</p><p class="calibre7">The <a id="id488" class="calibre1"/>entire module code can be downloaded from <a class="calibre1" href="https://github.com/ajzele/B05032-Foggyline_DailyDeal">https://github.com/ajzele/B05032-Foggyline_DailyDeal</a>.</p></div>
<div class="book" title="Custom offline shipping methods"><div class="book" id="2BASE2-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec72" class="calibre1"/>Custom offline shipping methods</h1></div></div></div><p class="calibre7">Magento <a id="id489" class="calibre1"/>provides several out-of-the-box offline shipping methods, such as <code class="email">Flatrate</code>, <code class="email">Freeshipping</code>, <code class="email">Pickup</code>, and <code class="email">Tablerate</code>. We can see those in the <code class="email">vendor/magento/module-offline-shipping/Model/Carrier</code> directory.</p><p class="calibre7">However, project requirements quite often are such that we need a custom coded shipping method where a special business logic is applied. Thus, the shipping price calculation can be controlled by us. In such cases, knowing how to code our own offline shipping method might come in handy.</p><p class="calibre7">Let's go ahead and create a small module called <code class="email">Foggyline_Shipbox</code> that provides Magento an extra offline shipping method.</p><p class="calibre7">Start by creating a module registration file named <code class="email">app/code/Foggyline/Shipbox/registration.php</code> with partial content, as follows:</p><div class="informalexample"><pre class="programlisting">\Magento\Framework\Component\ComponentRegistrar::register(
    \Magento\Framework\Component\ComponentRegistrar::MODULE,
    'Foggyline_Shipbox',
    __DIR__
);</pre></div><p class="calibre7">Then, create an <code class="email">app/code/Foggyline/Shipbox/etc/module.xml</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;config  xsi:noNamespaceSchemaLocation="urn:magento:framework:Module /etc/module.xsd"&gt;
    &lt;module name="Foggyline_Shipbox" setup_version="1.0.0"&gt;
        &lt;sequence&gt;
            &lt;module name="Magento_OfflineShipping"/&gt;
        &lt;/sequence&gt;
    &lt;/module&gt;
&lt;/config&gt;</pre></div><p class="calibre7">Now, create an <code class="email">app/code/Foggyline/Shipbox/etc/config.xml</code> file with content, as follows:</p><div class="informalexample"><pre class="programlisting">&lt;config  xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Store :etc/config.xsd"&gt;
    &lt;default&gt;
        &lt;carriers&gt;
            &lt;shipbox&gt;
                &lt;active&gt;0&lt;/active&gt;
                &lt;sallowspecific&gt;0&lt;/sallowspecific&gt;
                &lt;model&gt; Foggyline\Shipbox\Model\Carrier\Shipbox&lt;/model&gt;
                &lt;name&gt;Shipbox&lt;/name&gt;
                &lt;price&gt;4.99&lt;/price&gt;
                &lt;title&gt;Foggyline Shipbox&lt;/title&gt;
                &lt;specificerrmsg&gt;This shipping method is not available. To use this shipping method, please contact us.&lt;/specificerrmsg&gt;
            &lt;/shipbox&gt;
        &lt;/carriers&gt;
    &lt;/default&gt;
&lt;/config&gt;</pre></div><p class="calibre7">After <a id="id490" class="calibre1"/>this is done, create an <code class="email">app/code/Foggyline/Shipbox/etc/adminhtml/system.xml</code> file with content, as follows:</p><div class="informalexample"><pre class="programlisting">&lt;config  xsi:noNamespaceSchemaLocation="urn:magento:module: Magento_Config:etc/system_file.xsd"&gt;
    &lt;system&gt;
        &lt;section id="carriers"&gt;
            &lt;group id="shipbox" translate="label" type="text" sortOrder="99" showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                &lt;label&gt;Foggyline Shipbox&lt;/label&gt;
                &lt;field id="active" translate="label" type="select" sortOrder="1" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Enabled&lt;/label&gt;
                    &lt;source_model&gt; Magento\Config\Model\Config\Source\Yesno &lt;/source_model&gt;
                &lt;/field&gt;
                &lt;field id="name" translate="label" type="text" sortOrder="3" showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                    &lt;label&gt;Method Name&lt;/label&gt;
                &lt;/field&gt;
                &lt;field id="price" translate="label" type="text" sortOrder="5" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Price&lt;/label&gt;
                    &lt;validate&gt;validate-number validate-zero-or-greater&lt;/validate&gt;
                &lt;/field&gt;
                &lt;field id="title" translate="label" type="text" sortOrder="2" showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                    &lt;label&gt;Title&lt;/label&gt;
                &lt;/field&gt;
                &lt;field id="sallowspecific" translate="label" type="select" sortOrder="90" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Ship to Applicable Countries&lt;/label&gt;
                    &lt;frontend_class&gt;shipping-applicable-country &lt;/frontend_class&gt;
                    &lt;source_model&gt; Magento\Shipping\Model\Config\Source \Allspecificcountries &lt;/source_model&gt;
                &lt;/field&gt;
                &lt;field id="specificcountry" translate="label" type="multiselect" sortOrder="91" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Ship to Specific Countries&lt;/label&gt;
                    &lt;source_model&gt; Magento\Directory\Model \Config\Source\Country &lt;/source_model&gt;
                    &lt;can_be_empty&gt;1&lt;/can_be_empty&gt;
                &lt;/field&gt;
            &lt;/group&gt;
        &lt;/section&gt;
    &lt;/system&gt;
&lt;/config&gt;</pre></div><p class="calibre7">Now, create<a id="id491" class="calibre1"/> an <code class="email">app/code/Foggyline/Shipbox/Model/Carrier/Shipbox.php</code> file with partial content, as follows:</p><div class="informalexample"><pre class="programlisting">namespace Foggyline\Shipbox\Model\Carrier;

use Magento\Quote\Model\Quote\Address\RateRequest;

class Shipbox extends \Magento\Shipping\Model\Carrier\AbstractCarrier
    implements \Magento\Shipping\Model\Carrier\CarrierInterface
{
    protected $_code = 'shipbox';
    protected $_isFixed = true;
    protected $_rateResultFactory;
    protected $_rateMethodFactory;

    public function __construct(
        \Magento\Framework\App\Config\ScopeConfigInterface $scopeConfig,
        \Magento\Quote\Model\Quote\Address\RateResult\ErrorFactory $rateErrorFactory,
        \Psr\Log\LoggerInterface $logger,
        \Magento\Shipping\Model\Rate\ResultFactory $rateResultFactory,
        \Magento\Quote\Model\Quote\Address\RateResult \MethodFactory $rateMethodFactory,
        array $data = []
    )
    {
        $this-&gt;_rateResultFactory = $rateResultFactory;
        $this-&gt;_rateMethodFactory = $rateMethodFactory;
        parent::__construct($scopeConfig, $rateErrorFactory, $logger, $data);
    }

    public function collectRates(RateRequest $request)
    {
        //implement business logic
    }

    public function getAllowedMethods()
    {
        return ['shipbox' =&gt; $this-&gt;getConfigData('name')];
    }
}</pre></div><p class="calibre7">Extend<a id="id492" class="calibre1"/> the <code class="email">collectRates</code> method in the <code class="email">Carrier\Shipbox</code> class, as follows:</p><div class="informalexample"><pre class="programlisting">public function collectRates(RateRequest $request)
{
    if (!$this-&gt;getConfigFlag('active')) {
        return false;
    }

    //Do some filtering of items in cart
    if ($request-&gt;getAllItems()) {
        foreach ($request-&gt;getAllItems() as $item) {
            //$item-&gt;getQty();
            //$item-&gt;getFreeShipping()
            //$item-&gt;isShipSeparately()
            //$item-&gt;getHasChildren()
            //$item-&gt;getProduct()-&gt;isVirtual()
            //...
        }
    }

    //After filtering, start forming final price
    //Final price does not have to be fixed like below
    $shippingPrice = $this-&gt;getConfigData('price');
    $result = $this-&gt;_rateResultFactory-&gt;create();

    $method = $this-&gt;_rateMethodFactory-&gt;create();

    $method-&gt;setCarrier('shipbox');
    $method-&gt;setCarrierTitle($this-&gt;getConfigData('title'));

    $method-&gt;setMethod('shipbox');
    $method-&gt;setMethodTitle($this-&gt;getConfigData('name'));

    $method-&gt;setPrice($shippingPrice);
    $method-&gt;setCost($shippingPrice);

    $result-&gt;append($method);

    return $result;
}</pre></div><p class="calibre7">In the <a id="id493" class="calibre1"/>Magento admin area, if you now look under <span class="strong"><strong class="calibre8">Stores</strong></span> | <span class="strong"><strong class="calibre8">Settings</strong></span> | <span class="strong"><strong class="calibre8">Configuration</strong></span> | <span class="strong"><strong class="calibre8">Sales</strong></span> | <span class="strong"><strong class="calibre8">Shipping Methods</strong></span>, you will see <span class="strong"><strong class="calibre8">Foggyline Shipbox</strong></span> on the list, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00083.jpeg" alt="Custom offline shipping methods" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Set the <span class="strong"><strong class="calibre8">Enabled</strong></span> option to <span class="strong"><strong class="calibre8">Yes</strong></span> and click the <span class="strong"><strong class="calibre8">Save Config</strong></span> button.</p><p class="calibre7">If you <a id="id494" class="calibre1"/>now run the <code class="email">SELECT * FROM core_config_data WHERE path LIKE "%shipbox%";</code> query on the MySQL server, you will see results that are similar to the ones shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00084.jpeg" alt="Custom offline shipping methods" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Note how there is no direct code within the code snippets in the preceding screenshot that is related to the <span class="strong"><strong class="calibre8">Ship to Applicable Countries</strong></span> and <span class="strong"><strong class="calibre8">Ship to Specific Countries</strong></span> options, because the handling of these options is built into the parent <code class="email">AbstractCarrier</code> class. Thus, simply by adding the <code class="email">sallowspecific</code> option in <code class="email">config.xml</code> and <code class="email">system.xml</code>, we enabled a feature where the shipping method can be shown or hidden from certain countries.</p><p class="calibre7">The crux of the implementation comes down to the <code class="email">collectRates</code> method. This is where we implement our own business logic that should calculate the shipping price based on<a id="id495" class="calibre1"/> the items in the cart. We can use the <code class="email">$request-&gt;getAllItems()</code>in the <code class="email">collectRates</code> method to fetch the collection of all the cart items, traverse through them, form a final shipping price based on various conditions, and so on.</p><p class="calibre7">Now, let's go ahead and jump to the storefront in order to test the checkout. We should be able to see our method on the checkout, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00085.jpeg" alt="Custom offline shipping methods" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">If we complete one order, we should further see the shipping method details on the order itself. Within the admin area, under <span class="strong"><strong class="calibre8">Sales</strong></span> | <span class="strong"><strong class="calibre8">Operations</strong></span> | <span class="strong"><strong class="calibre8">Orders</strong></span>, if we <span class="strong"><strong class="calibre8">View</strong></span> our order in the <span class="strong"><strong class="calibre8">Payment &amp; Shipping Method</strong></span> section, we should see the shipping method, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00086.jpeg" alt="Custom offline shipping methods" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Similarly, in the <span class="strong"><strong class="calibre8">Order Totals</strong></span> section, we should see the shipping amount in <span class="strong"><strong class="calibre8">Shipping &amp; Handling</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00087.jpeg" alt="Custom offline shipping methods" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">With<a id="id496" class="calibre1"/> this, we conclude our custom offline<a id="id497" class="calibre1"/> shipping method module. The full module can be found at <a class="calibre1" href="https://github.com/ajzele/B05032-Foggyline_Shipbox">https://github.com/ajzele/B05032-Foggyline_Shipbox</a>.</p></div>
<div class="book" title="Custom offline payment methods"><div class="book" id="2C9D02-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec73" class="calibre1"/>Custom offline payment methods</h1></div></div></div><p class="calibre7">Magento<a id="id498" class="calibre1"/> provides several out-of-the-box offline payment methods, such as <code class="email">Banktransfer</code>, <code class="email">Cashondelivery</code>, <code class="email">Checkmo</code>, and <code class="email">Purchaseorder</code>. You can see them in the <code class="email">vendor/magento/module-offline-payments/Model</code> directory.</p><p class="calibre7">When it comes to payment methods, it is more common to use an online payment provider (gateway), such as PayPal or Braintree. Sometimes, project requirements may be such that we may need a custom coded payment method. You will need to think of programmatic product import and order creation script that might specialize in some specifically labeled payment method. Thus, the payment process will be controlled by us.</p><p class="calibre7">In such cases, knowing how to code our own offline payment method might come in handy. It is worth noting that while we can make an offline payment that will grab a user's credit card information, it is not really advisable to do so unless our infrastructure is PCI-compliant.</p><p class="calibre7">Let's go ahead and create a small module called <code class="email">Foggyline_Paybox</code> that provides Magento an extra offline payment method.</p><p class="calibre7">Start by creating a module registration file named <code class="email">app/code/Foggyline/Paybox/registration.php</code> with partial content, as follows:</p><div class="informalexample"><pre class="programlisting">\Magento\Framework\Component\ComponentRegistrar::register(
    \Magento\Framework\Component\ComponentRegistrar::MODULE,
    'Foggyline_Paybox',
    __DIR__
);</pre></div><p class="calibre7">Then, create <a id="id499" class="calibre1"/>an <code class="email">app/code/Foggyline/Paybox/etc/module.xml</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;config  xsi:noNamespaceSchemaLocation="urn:magento:framework:Module /etc/module.xsd"&gt;
    &lt;module name="Foggyline_Paybox" setup_version="1.0.0"&gt;
        &lt;sequence&gt;
            &lt;module name="Magento_OfflinePayments"/&gt;
        &lt;/sequence&gt;
    &lt;/module&gt;
&lt;/config&gt;</pre></div><p class="calibre7">After this is done, create an <code class="email">app/code/Foggyline/Paybox/etc/config.xml</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;config  xsi:noNamespaceSchemaLocation="urn:magento:module: Magento_Store:etc/config.xsd"&gt;
    &lt;default&gt;
        &lt;payment&gt;
            &lt;paybox&gt;
                &lt;active&gt;0&lt;/active&gt;
                &lt;model&gt;Foggyline\Paybox\Model\Paybox&lt;/model&gt;
                &lt;order_status&gt;pending&lt;/order_status&gt;
                &lt;title&gt;Foggyline Paybox&lt;/title&gt;
                &lt;allowspecific&gt;0&lt;/allowspecific&gt;
                &lt;group&gt;offline&lt;/group&gt;
            &lt;/paybox&gt;
        &lt;/payment&gt;
    &lt;/default&gt;
&lt;/config&gt;</pre></div><p class="calibre7">Then, create the <code class="email">app/code/Foggyline/Paybox/etc/payment.xml</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;payment  xsi:noNamespaceSchemaLocation="urn:magento:module: Magento_Payment:etc/payment.xsd"&gt;
    &lt;methods&gt;
        &lt;method name="paybox"&gt;
            &lt;allow_multiple_address&gt;1&lt;/allow_multiple_address&gt;
        &lt;/method&gt;
    &lt;/methods&gt;
&lt;/payment&gt;</pre></div><p class="calibre7">Now, create an <code class="email">app/code/Foggyline/Paybox/etc/adminhtml/system.xml</code> file with the<a id="id500" class="calibre1"/> following content:</p><div class="informalexample"><pre class="programlisting">&lt;config  xsi:noNamespaceSchemaLocation="urn:magento:module: Magento_Config:etc/system_file.xsd"&gt;
    &lt;system&gt;
        &lt;section id="payment"&gt;
            &lt;group id="paybox" translate="label" type="text" sortOrder="30" showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                &lt;label&gt;Paybox&lt;/label&gt;
                &lt;field id="active" translate="label" type="select" sortOrder="1" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Enabled&lt;/label&gt;
                    &lt;source_model&gt; Magento\Config\Model\Config\Source\Yesno &lt;/source_model&gt;
                &lt;/field&gt;
                &lt;field id="order_status" translate="label" type="select" sortOrder="20" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;New Order Status&lt;/label&gt;
                    &lt;source_model&gt; Magento\Sales\Model\Config \Source\Order\Status\NewStatus &lt;/source_model&gt;
                &lt;/field&gt;
                &lt;field id="sort_order" translate="label" type="text" sortOrder="100" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Sort Order&lt;/label&gt;
                    &lt;frontend_class&gt; validate-number&lt;/frontend_class&gt;
                &lt;/field&gt;
                &lt;field id="title" translate="label" type="text" sortOrder="10" showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                    &lt;label&gt;Title&lt;/label&gt;
                &lt;/field&gt;
                &lt;field id="allowspecific" translate="label" type="allowspecific" sortOrder="50" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Payment from Applicable Countries &lt;/label&gt;
                    &lt;source_model&gt; Magento\Payment\Model\ Config\Source\Allspecificcountries &lt;/source_model&gt;
                &lt;/field&gt;
                &lt;field id="specificcountry" translate="label" type="multiselect" sortOrder="51" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Payment from Specific Countries&lt;/label&gt;
                    &lt;source_model&gt; Magento\Directory\Model \Config\Source\Country &lt;/source_model&gt;
                    &lt;can_be_empty&gt;1&lt;/can_be_empty&gt;
                &lt;/field&gt;
                &lt;field id="payable_to" translate="label" sortOrder="61" showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                    &lt;label&gt;Make Check Payable to&lt;/label&gt;
                &lt;/field&gt;
                &lt;field id="mailing_address" translate="label" type="textarea" sortOrder="62" showInDefault="1" showInWebsite="1" showInStore="1"&gt;
                    &lt;label&gt;Send Check to&lt;/label&gt;
                &lt;/field&gt;
                &lt;field id="min_order_total" translate="label" type="text" sortOrder="98" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Minimum Order Total&lt;/label&gt;
                &lt;/field&gt;
                &lt;field id="max_order_total" translate="label" type="text" sortOrder="99" showInDefault="1" showInWebsite="1" showInStore="0"&gt;
                    &lt;label&gt;Maximum Order Total&lt;/label&gt;
                &lt;/field&gt;
                &lt;field id="model"&gt;&lt;/field&gt;
            &lt;/group&gt;
        &lt;/section&gt;
    &lt;/system&gt;
&lt;/config&gt;</pre></div><p class="calibre7">Create <a id="id501" class="calibre1"/>an <code class="email">app/code/Foggyline/Paybox/etc/frontend/di.xml</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;config  xsi:noNamespaceSchemaLocation="urn:magento:framework: ObjectManager/etc/config.xsd"&gt;
    &lt;type name="Magento\Checkout\Model\CompositeConfigProvider"&gt;
        &lt;arguments&gt;
            &lt;argument name="configProviders" xsi:type="array"&gt;
                &lt;item name= "offline_payment_paybox_config_provider" xsi:type="object"&gt;
                    Foggyline\Paybox\Model\PayboxConfigProvider
                &lt;/item&gt;
            &lt;/argument&gt;
        &lt;/arguments&gt;
    &lt;/type&gt;
&lt;/config&gt;</pre></div><p class="calibre7">After<a id="id502" class="calibre1"/> this is done, create an <code class="email">app/code/Foggyline/Paybox/Model/Paybox.php</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">namespace Foggyline\Paybox\Model;

class Paybox extends \Magento\Payment\Model\Method\AbstractMethod
{
    const PAYMENT_METHOD_PAYBOX_CODE = 'paybox';
    protected $_code = self::PAYMENT_METHOD_PAYBOX_CODE;

    protected $_isOffline = true;

    public function getPayableTo()
    {
        return $this-&gt;getConfigData('payable_to');
    }

    public function getMailingAddress()
    {
        return $this-&gt;getConfigData('mailing_address');
    }
}</pre></div><p class="calibre7">Now, create an <code class="email">app/code/Foggyline/Paybox/Model/PayboxConfigProvider.php</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">namespace Foggyline\Paybox\Model;

class PayboxConfigProvider implements \Magento\Checkout\Model\ConfigProviderInterface
{
    protected $methodCode = \Foggyline\Paybox\Model\Paybox::PAYMENT_METHOD_PAYBOX_CODE;
    protected $method;
    protected $escaper;

    public function __construct(
        \Magento\Payment\Helper\Data $paymentHelper
    )
    {
        $this-&gt;method = $paymentHelper-&gt;getMethodInstance($this-&gt; methodCode);
    }

    public function getConfig()
    {
        return $this-&gt;method-&gt;isAvailable() ? [
            'payment' =&gt; [
                'paybox' =&gt; [
                    'mailingAddress' =&gt; $this-&gt; getMailingAddress(),
                    'payableTo' =&gt; $this-&gt;getPayableTo(),
                ],
            ],
        ] : [];
    }

    protected function getMailingAddress()
    {
        $this-&gt;method-&gt;getMailingAddress();
    }

    protected function getPayableTo()
    {
        return $this-&gt;method-&gt;getPayableTo();
    }
}</pre></div><p class="calibre7">Copy <a id="id503" class="calibre1"/>the entire <code class="email">vendor/magento/module-offline-payments/view/frontend/layout/checkout_index_index.xml</code> Magento core file into the <code class="email">app/code/Foggyline/Paybox/view/frontend/layout/checkout_index_index.xml</code> module. Then, edit the module's <code class="email">checkout_index_index.xml</code> file by replacing the entire <code class="email">&lt;item name="offline-payments" xsi:type="array"&gt;</code> element and its children with the following code:</p><div class="informalexample"><pre class="programlisting">&lt;item name="foggline-offline-payments" xsi:type="array"&gt;
    &lt;item name="component" xsi:type="string"&gt; Foggyline_Paybox/js/view/payment/foggline-offline-payments &lt;/item&gt;
    &lt;item name="methods" xsi:type="array"&gt;
        &lt;item name="paybox" xsi:type="array"&gt;
            &lt;item name="isBillingAddressRequired" xsi:type="boolean"&gt;true&lt;/item&gt;
        &lt;/item&gt;
    &lt;/item&gt;
&lt;/item&gt;</pre></div><p class="calibre7">Then, create an <code class="email">app/code/Foggyline/Paybox/view/frontend/web/js/view/payment/offline-payments.js</code> file <a id="id504" class="calibre1"/>with the following content:</p><div class="informalexample"><pre class="programlisting">/*browser:true*/
/*global define*/
define(
    [
        'uiComponent',
        'Magento_Checkout/js/model/payment/renderer-list'
    ],
    function (
        Component,
        rendererList
    ) {
        'use strict';
        rendererList.push(
            {
                type: 'paybox',
                component: 'Foggyline_Paybox/js/view/payment/method- renderer/paybox'
            }
        );
        return Component.extend({});
    }
);</pre></div><p class="calibre7">After this is done, create an <code class="email">app/code/Foggyline/Paybox/view/frontend/web/js/view/payment/method-renderer/paybox.js</code> file with the following content:</p><div class="informalexample"><pre class="programlisting">/*browser:true*/
/*global define*/
define(
    [
        'Magento_Checkout/js/view/payment/default'
    ],
    function (Component) {
        'use strict';

        return Component.extend({
            defaults: {
                template: 'Foggyline_Paybox/payment/paybox'
            },

            getMailingAddress: function () {
                return window.checkoutConfig.payment. paybox.mailingAddress;
            },

            getPayableTo: function () {
                return window.checkoutConfig.payment. paybox.payableTo;
            }
        });
    }
);</pre></div><p class="calibre7">Now, create an <code class="email">app/code/Foggyline/Paybox/view/frontend/web/template/payment/paybox.html</code> file <a id="id505" class="calibre1"/>with the following content:</p><div class="informalexample"><pre class="programlisting">&lt;div class="payment-method" data-bind="css: {'_active': (getCode()  == isChecked())}"&gt;
    &lt;div class="payment-method-title field choice"&gt;
        &lt;input type="radio"
               name="payment[method]"
               class="radio"
               data-bind="attr: {'id': getCode()}, value: getCode(), checked: isChecked, click: selectPaymentMethod, visible: isRadioButtonVisible()"/&gt;
        &lt;label data-bind="attr: {'for': getCode()}" class="label"&gt;&lt;span data-bind="text: getTitle()"&gt;&lt;/span&gt;&lt;/label&gt;
    &lt;/div&gt;
    &lt;div class="payment-method-content"&gt;
        &lt;div class="payment-method-billing-address"&gt;
            &lt;!-- ko foreach: $parent.getRegion(getBillingAddressFormName()) --&gt;
            &lt;!-- ko template: getTemplate() --&gt;&lt;!-- /ko --&gt;
            &lt;!--/ko--&gt;
        &lt;/div&gt;
        &lt;!-- ko if: getMailingAddress() || getPayableTo() --&gt;
        &lt;dl class="items check payable"&gt;
            &lt;!-- ko if: getPayableTo() --&gt;
            &lt;dt class="title"&gt;&lt;!-- ko i18n: 'Make Check payable toooooo:' --&gt;&lt;!-- /ko --&gt;&lt;/dt&gt;
            &lt;dd class="content"&gt;&lt;!-- ko i18n: getPayableTo() --&gt; &lt;!-- /ko --&gt;&lt;/dd&gt;
            &lt;!-- /ko --&gt;
            &lt;!-- ko if: getMailingAddress() --&gt;
            &lt;dt class="title"&gt;&lt;!-- ko i18n: 'Send Check toxyz:' -- &gt;&lt;!-- /ko --&gt;&lt;/dt&gt;
            &lt;dd class="content"&gt;
                &lt;address class="paybox mailing address" data-bind ="html: $t(getMailingAddress())"&gt;&lt;/address&gt;
            &lt;/dd&gt;
            &lt;!-- /ko --&gt;
        &lt;/dl&gt;
        &lt;!-- /ko --&gt;
        &lt;div class="checkout-agreements-block"&gt;
            &lt;!-- ko foreach: $parent.getRegion('before-place- order') --&gt;
            &lt;!-- ko template: getTemplate() --&gt;&lt;!-- /ko --&gt;
            &lt;!--/ko--&gt;
        &lt;/div&gt;
        &lt;div class="actions-toolbar"&gt;
            &lt;div class="primary"&gt;
                &lt;button class="action primary checkout"
                        type="submit"
                        data-bind="
                        click: placeOrder,
                        attr: {title: $t('Place Order')},
                        css: {disabled: !isPlaceOrderActionAllowed()},
                        enable: (getCode() == isChecked())
                        "
                        disabled&gt;
                    &lt;span data-bind="i18n: 'Place Order'"&gt;&lt;/span&gt;
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;</pre></div><p class="calibre7">With <a id="id506" class="calibre1"/>this, we conclude our custom offline <a id="id507" class="calibre1"/>payment method module. The entire module can be found at <a class="calibre1" href="https://github.com/ajzele/B05032-Foggyline_Paybox">https://github.com/ajzele/B05032-Foggyline_Paybox</a>.</p></div>
<div class="book" title="Summary" id="2D7TI1-818f5224668745eb9070ddf1d85e6bfa"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec74" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">In this chapter, we touched upon some of the most common bits of functionality that developers come in contact with. We learned where to look in the admin area and how to programmatically manage the entities behind these functionalities. Thus, we were effectively able to manually and programmatically create and fetch CMS pages, blocks, categories, and products. We also learned how to create product and customer import scripts. Finally, we studied how to create our own custom product type, simple payment, and shipment module.</p><p class="calibre7">The following chapter will guide us through Magento's in-built tests and how we can use them to effectively QA an application to keep it healthy.</p></div></body></html>
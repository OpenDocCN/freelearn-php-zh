# 前言

Yii 是一个免费的开源网络应用程序开发框架，用 PHP5 编写，它促进了干净的 DRY 设计，并鼓励快速开发。它旨在简化您的应用程序开发时间，并帮助确保最终产品极其高效、可扩展和易于维护。由于性能优化极高，Yii 是任何规模项目的完美选择。然而，它是以复杂的企业应用程序为设计理念的。您可以从头到尾（从表示到持久化）完全控制配置，以符合您的企业开发指南。它附带了一些工具，可以帮助测试和调试您的应用程序，并且具有清晰和全面的文档。

本书是 Yii2 菜谱的集合。每个菜谱都是一个完整且独立的条目，展示了来自真实网络应用程序的解决方案。因此，您可以在自己的环境中轻松复制它们，快速且无泪地学习 Yii2。所有菜谱都配有逐步的代码示例和清晰的截图。Yii2 像一件从货架上看起来很棒的西装，同时也非常容易根据您的需求定制。几乎框架的每个组件都是可扩展的。本书将展示如何使用官方扩展，扩展任何组件，或编写一个新的组件。

本书将帮助您快速创建现代网络应用程序，并确保它们通过真实生活中的示例和业务逻辑表现良好。您将处理 Yii 命令行、迁移和资产。您将了解基于角色的访问、安全和部署。我们将向您展示如何轻松开始，配置您的环境，并准备好高效快速地编写网络应用程序。

# 本书涵盖的内容

第一章, *基础*，涵盖了如何安装 Yii 框架以及不同的安装方式。我们将向您介绍应用模板：基本和高级，以及它们之间的区别。然后您将了解依赖注入容器。本章包含有关模型事件的信息，这些事件在执行一些简单操作（如模型保存和更新等）后触发。我们将学习如何使用外部代码，包括在示例中使用 ZendFramework、Laravel 和 Sympony。我们还将学习如何逐步将基于 yii-1.x.x 的应用程序更新到 yii2。更多食谱可在[`www.packtpub.com/sites/default/files/downloads/4270OS_Chapter1.pdf`](https://www.packtpub.com/sites/default/files/downloads/4270OS_Chapter1.pdf)找到。

第二章, *路由、控制器和视图*，介绍了关于 Yii URL 路由器、控制器和视图的一些实用技巧。您将能够使您的控制器和视图更加灵活。

第三章，*ActiveRecord、模型和数据库*，讨论了在 Yii 中与数据库交互的三个主要方法：Active Record、查询构建器和通过 DAO 的直接 SQL 查询。这三个方法在语法、功能和性能方面都不同。在本章中，我们将学习如何高效地与数据库交互，何时使用模型以及何时不使用，如何处理多个数据库，如何自动预处理 Active Record 字段，以及如何使用强大的数据库条件。

第四章，*表单*，介绍了 Yii 如何使处理表单变得轻松，并且关于它的文档几乎已经完成。尽管如此，还有一些需要澄清和示例的区域。

第五章，*安全*，讨论了根据通用 Web 应用安全原则“过滤输入，转义输出”如何保持您的应用程序安全。我们将涵盖创建自己的控制器过滤器、防止 XSS、CSRF 和 SQL 注入、转义输出以及使用基于角色的访问控制等主题。

第六章，*RESTful Web 服务*，介绍了如何使用 Yii2 和内置功能编写 RESTful Web 服务。

第七章，*官方扩展*，解释了如何在项目中安装和使用官方扩展。您将学习如何编写自己的扩展并与其他开发者共享。

第八章，*扩展 Yii*，不仅涵盖了如何实现自己的 Yii 扩展，还涵盖了如何使您的扩展可重用并对社区有用。此外，我们将关注许多您应该做的事情，以便使您的扩展尽可能高效。

第九章，*性能调优*，教授了一些开发出能够平稳运行直到非常高的负载的应用程序的最佳实践。Yii 是其中最快的框架之一。然而，在开发和部署应用程序时，拥有一些额外的免费性能以及遵循应用程序本身的最佳实践是很好的。在本章中，我们将了解如何配置 Yii 以获得额外的性能。此外，我们还将学习一些开发出能够平稳运行直到非常高的负载的应用程序的最佳实践。

第十章，*部署*，涵盖了各种技巧，这些技巧在应用部署时特别有用，当你在团队中开发应用，或者只是想要使你的开发环境更加舒适时。

第十一章，*测试*，教我们如何使用最佳测试技术，如 Codeception、PhpUnit、Atoum 和 Behat。你将了解如何编写简单的测试以及如何避免在应用程序中产生回归错误。

第十二章，*调试、日志记录和错误处理*，讨论了审查日志、分析异常堆栈跟踪以及实现我们自己的错误处理器。如果应用相对复杂，那么创建一个无错误的程序是不可能的，因此开发者必须尽快检测错误并处理它们。Yii 提供了一套很好的实用功能来处理日志记录和错误处理。此外，在调试模式下，如果出现错误，Yii 会提供堆栈跟踪。使用它，你可以更快地修复错误。

# 本书所需

为了运行本书中的示例，需要以下软件：

+   网络服务器

+   数据库服务器

+   PHP

+   Yii2

# 本书面向对象

本书是为具有良好 PHP5 知识和 MVC 框架知识，并尝试使用 Yii 1.x.x 版本开发应用程序的开发者而编写的。对于那些想要尝试 Yii2，或者害怕从 Yii 1.x.x 迁移到 Yii2 的开发者来说，本书将非常有用。如果你还没有尝试过 Yii2，这本书绝对适合你！

# 部分

在本书中，你会发现一些频繁出现的标题（准备、如何操作...、工作原理...、更多内容...和相关信息）。

为了清楚地说明如何完成一个食谱，我们使用以下部分如下：

## 准备工作

本节告诉你在食谱中可以期待什么，并描述了如何设置任何软件或任何为食谱所需的初步设置。

## 如何操作…

本节包含遵循食谱所需的步骤。

## 工作原理…

本节通常包含对上一节发生情况的详细解释。

## 更多内容…

本节包含有关食谱的附加信息，以便使读者对食谱有更深入的了解。

## 相关内容

本节提供了对其他有用信息的链接，这些信息对食谱很有帮助。

# 术语约定

在本书中，你会发现许多文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称如下所示：“我们正在定义一个别名参数，该参数应在`/page/`之后在 URL 中指定。”

代码块设置如下：

```php
'urlManager' => array(
    'enablePrettyUrl' => true,
    'showScriptName' => false,
),
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```php
'urlManager' => array(
 'enablePrettyUrl' => true,
 'showScriptName' => false,
),
```

任何命令行输入或输出都如下所示：

```php
./yii migrate up

```

**新术语**和**重要单词**以粗体显示。屏幕上显示的单词，例如在菜单或对话框中，在文本中如下所示：“使用 Gii 生成启用了**生成 ActiveQuery**选项的`Post`模型，这将生成`PostQuery`类。”

### 注意

警告或重要注意事项以如下方式显示在框中。

### 小贴士

小贴士和技巧看起来像这样。

# 读者反馈

我们始终欢迎读者的反馈。请告诉我们您对这本书的看法——您喜欢什么或不喜欢什么。读者反馈对我们来说很重要，因为它帮助我们开发出您真正能从中获得最大收益的标题。

要向我们发送一般反馈，请简单地发送电子邮件至`<feedback@packtpub.com>`，并在邮件的主题中提及书籍的标题。

如果您在某个主题上有所专长，并且您对撰写或为书籍做出贡献感兴趣，请参阅我们的作者指南，网址为[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在您已经是 Packt 书籍的骄傲拥有者，我们有一些事情可以帮助您从您的购买中获得最大收益。

## 下载示例代码

您可以从您的账户中下载本书的示例代码文件，网址为[`www.packtpub.com`](http://www.packtpub.com)。如果您在其他地方购买了这本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  使用您的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标指针悬停在顶部的**支持**标签上。

1.  点击**代码下载与勘误**。

1.  在**搜索**框中输入书籍的名称。

1.  选择您想要下载代码文件的书籍。

1.  从下拉菜单中选择您购买这本书的地方。

1.  点击**代码下载**。

下载文件后，请确保您使用最新版本的软件解压缩或提取文件夹：

+   Windows 上的 WinRAR / 7-Zip

+   Mac 上的 Zipeg / iZip / UnRarX

+   Linux 上的 7-Zip / PeaZip

书籍的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Yii2-Application-Development-Cookbook-Third-Edition`](https://github.com/PacktPublishing/Yii2-Application-Development-Cookbook-Third-Edition)。我们还有其他来自我们丰富图书和视频目录的代码包可供选择，网址为[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)。查看它们吧！

## 下载本书彩色图像

我们还为您提供了一个包含本书中使用的截图/图表的彩色图像的 PDF 文件。彩色图像将帮助您更好地理解输出的变化。您可以从 [`www.packtpub.com/sites/default/files/downloads/Yii2ApplicationDevelopmentCookbookThirdEdition_ColorImages.pdf`](http://www.packtpub.com/sites/default/files/downloads/Yii2ApplicationDevelopmentCookbookThirdEdition_ColorImages.pdf) 下载此文件。

## 错误清单

尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在我们的书中发现错误——可能是文本或代码中的错误——如果您能向我们报告这个问题，我们将不胜感激。通过这样做，您可以避免其他读者的挫败感，并帮助我们改进本书的后续版本。如果您发现任何错误，请通过访问 [`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**错误提交表单**链接，并输入您的错误详情来报告它们。一旦您的错误得到验证，您的提交将被接受，错误将被上传到我们的网站或添加到该标题的错误清单部分。

要查看之前提交的错误清单，请访问 [`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书籍名称。所需信息将在**错误清单**部分显示。

## 盗版

在互联网上盗版受版权保护的材料是一个跨所有媒体的持续问题。在 Packt，我们非常重视保护我们的版权和许可证。如果您在互联网上遇到任何形式的我们作品的非法副本，请立即向我们提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过 `<copyright@packtpub.com>` 联系我们，并提供疑似盗版材料的链接。

我们感谢您的帮助，以保护我们的作者和我们为您提供有价值内容的能力。

## 问题

如果您在这本书的任何方面遇到问题，您可以通过 `<questions@packtpub.com>` 联系我们，我们将尽力解决问题。

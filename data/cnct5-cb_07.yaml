- en: Chapter 7. Working with Users and Permissions
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章. 与用户和权限协作
- en: 'In this chapter we will cover the following:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将涵盖以下内容：
- en: Checking if the current user is logged in
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查当前用户是否登录
- en: Getting the currently logged-in user
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取当前登录用户
- en: Loading a user by its ID
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过ID加载用户
- en: Loading a user by its username
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过用户名加载用户
- en: Getting a user's info
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取用户信息
- en: Setting a user's attributes
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置用户的属性
- en: Retrieving a user's attributes
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取用户的属性
- en: Loading a group by its ID
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过ID加载一个组
- en: Loading a group by its name
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过名称加载一个组
- en: Adding a user to a group
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将用户添加到组中
- en: Getting all of the users from a group
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从一个组中获取所有用户
- en: Checking if a user is a member of a group
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查用户是否是某个组的成员
- en: Removing a user from a group
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从组中移除用户
- en: Logging out a user
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户登出
- en: Deleting a user
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除用户
- en: Getting the permission object
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取权限对象
- en: Checking if a user can write to a page
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查用户是否可以写入页面
- en: Checking if a user can edit a page
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查用户是否有编辑页面的权限
- en: Checking a user's file permissions
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查用户的文件权限
- en: Introduction
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: One of concrete5's greatest attributes is the included functionality surrounding
    users and permissions. concrete5 makes it easy to control which users and user
    groups can access specific pages. Users in concrete5 can be site editors, administrators,
    community members, or any other role that site owners can devise.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5最伟大的属性之一是围绕用户和权限的功能。concrete5使得控制哪些用户和用户组可以访问特定页面变得容易。在concrete5中，用户可以是网站编辑者、管理员、社区成员或网站所有者可以设定的任何其他角色。
- en: In this chapter, we will explore several recipes that allow developers to interact
    with and manipulate user objects, groups, and their related permissions. The recipes
    in this chapter will empower concrete5 developers to incorporate the powerful
    user and permissions model into their own custom applications and websites.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将探讨几个配方，允许开发者与用户对象、组和它们相关的权限进行交互和操作。本章中的配方将赋予concrete5开发者将强大的用户和权限模型纳入他们自己的自定义应用程序和网站的能力。
- en: Checking if the current user is logged in
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检查当前用户是否登录
- en: One of the most common tasks in concrete5 development is finding out if a user
    is logged into the website. In this recipe, we will output some HTML to say hello
    to the logged-in user if they are logged in. If they are logged out, we will output
    a link to the login page.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5开发中最常见的任务之一是找出用户是否登录到网站上。在这个配方中，如果用户已登录，我们将输出一些HTML来向登录用户打招呼。如果他们未登录，我们将输出一个指向登录页面的链接。
- en: How to do it...
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for checking if the current user is logged in are as follows:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 检查当前用户是否登录的步骤如下：
- en: Check if the current user is logged in.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查当前用户是否已登录。
- en: '[PRE0]'
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: If they are logged in, show a welcome message.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果他们已登录，显示欢迎信息。
- en: '[PRE1]'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Otherwise, show a link to the login page.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 否则，显示登录页面的链接。
- en: '[PRE2]'
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: How it works...
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The user model contains a static function called `isLoggedIn` which will simply
    return a Boolean result. This does not bring any sort of permission checks into
    the mix, only checks to see if the person viewing the page is logged in at all.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 用户模型包含一个名为`isLoggedIn`的静态函数，它将简单地返回一个布尔结果。这不会将任何类型的权限检查混合其中，只是检查查看页面的人是否已登录。
- en: Getting the currently logged-in user
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 获取当前登录用户
- en: concrete5 makes it easy to get the object of the currently logged-in user. In
    this recipe, we will output the the username of the currently logged-in user.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5使得获取当前登录用户的对象变得非常容易。在这个配方中，我们将输出当前登录用户的用户名。
- en: Getting ready
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: It is a good idea to make sure the user is logged in at all before attempting
    to display their username. We will use the skills from the previous recipe to
    make sure the user is logged first.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在尝试显示用户名之前确保用户已登录是一个好主意。我们将使用前一个配方中的技能来确保用户首先登录。
- en: How to do it...
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for getting the currently logged-in user are as follows:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 获取当前登录用户的步骤如下：
- en: Check if the user is logged in.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查用户是否登录。
- en: '[PRE3]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: If the user is logged in, create a new instance of the `User` class.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果用户已登录，创建`User`类的新实例。
- en: '[PRE4]'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Echo the username of the `user` object.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输出`user`对象的用户名。
- en: '[PRE5]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: How it works...
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 makes it incredibly easy to get the currently logged-in user. Essentially,
    we only have to instantiate the `User` class, which will return an object representing
    the currently logged-in user.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5使得获取当前登录用户变得极其容易。本质上，我们只需要实例化`User`类，它将返回一个代表当前登录用户的对象。
- en: See also
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Checking if the current user is logged in* recipe
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检查当前用户是否已登录* 食谱'
- en: The *Getting a user's info* recipe
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取用户信息* 食谱'
- en: Loading a user by its ID
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 通过ID加载用户
- en: Developers can also load users by their unique IDs. In this recipe, we will
    load the user with the ID of 1 and output their username.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 开发者也可以通过唯一的ID加载用户。在本食谱中，我们将加载ID为1的用户，并输出其用户名。
- en: How to do it...
  id: totrans-55
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for loading a user by its ID are as follows:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 通过ID加载用户的步骤如下：
- en: Determine the ID of the user that you wish to load. In this example, we will
    load the user with an ID of 1.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定要加载的用户的ID。在本例中，我们将加载ID为1的用户。
- en: '[PRE6]'
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Load a user by its ID.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过ID加载用户。
- en: '[PRE7]'
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Echo out the user's username.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输出用户的用户名。
- en: '[PRE8]'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: How it works...
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: concrete5 will look in the `Users` table of the database and return a user object
    populated with data from that corresponding record.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5将在数据库的`Users`表中查找并返回一个包含相应记录数据的用户对象。
- en: See also
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: The *Loading a user by its username* recipe
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*通过用户名加载用户* 食谱'
- en: Loading a user by its username
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 通过用户名加载用户
- en: In addition to being able to load users by their IDs, developers can also load
    users by their usernames. In this recipe, we will load a user with the username
    of admin and output their numerical ID.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 除了能够通过ID加载用户外，开发者还可以通过用户名加载用户。在本食谱中，我们将加载用户名为admin的用户，并输出其数值ID。
- en: How to do it...
  id: totrans-69
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for loading a user by its username are as follows:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 通过用户名加载用户的步骤如下：
- en: Determine the username of the user that you are loading.
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定要加载的用户的用户名。
- en: '[PRE9]'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Load the user by its username.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过用户名加载用户。
- en: '[PRE10]'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Echo the user's ID.
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输出用户的ID。
- en: '[PRE11]'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: How it works...
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Hey, that was easy! The `UserInfo` class contains methods to load a user by
    its username rather than just its ID. The `UserInfo` class also has a method to
    get the numerical user ID, for the user.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 嘿，这很简单！`UserInfo`类包含通过用户名而不是ID加载用户的方法。`UserInfo`类还有一个获取用户数值ID的方法。
- en: See also
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: The *Loading a user by its ID* recipe
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*通过ID加载用户* 食谱'
- en: The *Getting the currently logged-in user* recipe
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取当前登录用户* 食谱'
- en: Getting a user's info
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 获取用户信息
- en: User objects carry a lot of information with them, including the user's username,
    e-mail, and several other attributes. In this recipe, we will run through several
    functions to retrieve data associated with users.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 用户对象携带大量信息，包括用户的用户名、电子邮件和几个其他属性。在本食谱中，我们将运行几个函数来检索与用户关联的数据。
- en: Getting ready
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The code for this chapter doesn't necessarily belong to any specific place in
    concrete5\. The steps for this recipe are basic, one-line functions to demonstrate
    the different ways to get data from a user object. If you'd like a place to just
    write arbitrary code and have concrete5 evaluate it, the `site_post.php` file
    in `config/` is a pretty good place to start.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的代码不一定属于concrete5的任何特定位置。本食谱的步骤是基本的单行函数，用于展示从用户对象获取数据的不同方法。如果您需要一个可以写入任意代码并由concrete5评估的地方，`config/`目录下的`site_post.php`文件是一个不错的选择。
- en: How to do it...
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for getting a user''s info are as follows:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 获取用户信息步骤如下：
- en: First, we will load the currently logged-in user.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们将加载当前登录的用户。
- en: '[PRE12]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Get the user's ID.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取用户的ID。
- en: '[PRE13]'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Get the user's username.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取用户的用户名。
- en: '[PRE14]'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Check if the user is registered on the site.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查用户是否在该网站上注册。
- en: '[PRE15]'
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Check if the user's account is active.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查用户的账户是否活跃。
- en: '[PRE16]'
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Check if the user is the super admin.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查用户是否是超级管理员。
- en: '[PRE17]'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Load the `UserInfo` object, which contains even more information about the user.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载包含更多用户信息的`UserInfo`对象。
- en: '[PRE18]'
  id: totrans-101
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Get the user's e-mail address.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取用户的电子邮件地址。
- en: '[PRE19]'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Get the user's encrypted password.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取用户的加密密码。
- en: '[PRE20]'
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Get the number of times the user has logged in.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取用户登录次数。
- en: '[PRE21]'
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Find out if the user has verified their e-mail address.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查询用户是否已验证他们的电子邮件地址。
- en: '[PRE22]'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Get the Unix timestamp of the previous time that this user logged in.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取用户上次登录的Unix时间戳。
- en: '[PRE23]'
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Find out if the user has an avatar uploaded to the site.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查询用户是否已上传头像到网站。
- en: '[PRE24]'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Find out when the user was added to the website.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查询用户何时被添加到网站上。
- en: '[PRE25]'
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: How it works...
  id: totrans-116
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The `User` class contains a couple of methods to retrieve basic user data, such
    as a user's ID and username. When developers want to see more information about
    a user, though, they will need to use the `UserInfo` class.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '`User`类包含一些检索基本用户数据的方法，例如用户的ID和用户名。当开发者想查看更多关于用户的信息时，他们需要使用`UserInfo`类。'
- en: See also
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: The *Getting the currently logged-in user* recipe
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取当前登录用户* 菜谱'
- en: Setting a user's attributes
  id: totrans-120
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置用户属性
- en: Users in concrete5 can have custom attributes that get defined through the interface.
    Imagine a website where you would like to know your users' ages. concrete5 does
    not provide an age field for users out of the box, but one can easily be added
    using attributes.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 的用户可以拥有自定义属性，这些属性通过界面定义。想象一下一个你想知道用户年龄的网站。concrete5 默认不提供用户年龄字段，但可以通过属性轻松添加。
- en: Getting ready
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'First, you will want to make sure that the attribute exists in the concrete5
    site before trying to set it. Go to `http://example.com/dashboard/users/attributes`
    (replacing `example.com` with your own domain name, of course) and make sure that
    the attribute that you are creating exists. The page will look similar to the
    following screenshot:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，在尝试设置属性之前，您需要确保该属性存在于 concrete5 网站中。请访问 `http://example.com/dashboard/users/attributes`（当然，用您自己的域名替换
    `example.com`），并确保您创建的属性存在。页面看起来类似于以下截图：
- en: '![Getting ready](img/4548OS_07_01.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![准备工作](img/4548OS_07_01.jpg)'
- en: In this recipe, we will work with an attribute with the handle of age, so feel
    free to create that attribute to follow along.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个菜谱中，我们将使用名为年龄的属性，所以请随意创建该属性以跟随操作。
- en: How to do it...
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for setting a user''s attributes are as follows:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 设置用户属性的分步如下：
- en: Load the currently logged-in user.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载当前登录用户。
- en: '[PRE26]'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Load the `UserInfo` object for that user.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载该用户的 `UserInfo` 对象。
- en: '[PRE27]'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Set the age attribute to `35`.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将年龄属性设置为 `35`。
- en: '[PRE28]'
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: How it works...
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The `UserInfo` class contains a function called `setAttribute` which will accept
    either a string that represents the attribute key handle, or an actual instance
    of an `AttributeKey` object. In this recipe, we opted for the simpler approach
    of providing the attribute handle in a string.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '`UserInfo` 类包含一个名为 `setAttribute` 的函数，该函数可以接受一个表示属性键处理的字符串，或者一个实际的 `AttributeKey`
    对象实例。在这个菜谱中，我们选择了更简单的方法，即在字符串中提供属性处理。'
- en: See also
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关链接
- en: The *Retrieving a user's attributes* recipe
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检索用户属性* 菜谱'
- en: The *Getting the currently logged-in user* recipe
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取当前登录用户* 菜谱'
- en: The *Getting a user's info* recipe
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取用户信息* 菜谱'
- en: Retrieving a user's attributes
  id: totrans-140
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检索用户属性
- en: In addition to setting attributes, we can also retrieve them. In this recipe,
    we will retrieve the attribute for the user's age, which we set in the previous
    recipe.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 除了设置属性外，我们还可以检索它们。在这个菜谱中，我们将检索用户年龄的属性，这是我们之前设置的。
- en: Getting ready
  id: totrans-142
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: As in the previous recipe, you will need to make sure that any attributes you
    are retrieving actually exist in concrete5\. In this case, we will be referencing
    an attribute with the handle of `age`. If your concrete5 system does not have
    a user attribute available called age, please adapt this recipe to fit your needs.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 与之前的菜谱一样，您需要确保您正在检索的任何属性实际上存在于 concrete5 中。在这种情况下，我们将引用一个名为 `age` 的属性。如果您的 concrete5
    系统中没有名为年龄的用户属性，请根据您的需求调整此菜谱。
- en: How to do it...
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for retrieving a user''s attributes are as follows:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 检索用户属性的分步如下：
- en: Load the currently logged-in user.
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载当前登录用户。
- en: '[PRE29]'
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Get the `user info` object for the user.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取用户的 `user info` 对象。
- en: '[PRE30]'
  id: totrans-149
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Get the value of the user's age attribute.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取用户年龄属性的值。
- en: '[PRE31]'
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: How it works...
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: concrete5 provides a simple API to retrieve attributes from users. In the database,
    attribute keys and values are spread over several tables and are difficult to
    query manually. This method is the preferred way to retrieve user attributes.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 提供了一个简单的 API 来从用户中检索属性。在数据库中，属性键和值分布在几个表中，手动查询比较困难。这种方法是检索用户属性的首选方式。
- en: There's more...
  id: totrans-154
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: 'concrete5 also makes use of "magic methods" to retrieve user attributes. Essentially,
    call a function with the camel-cased version of the attribute handle, preceded
    by the word `get`. In this recipe, to get the user''s age, we could simply write
    the following code:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 还使用“魔法方法”来检索用户属性。本质上，调用一个以属性处理 camelCase 版本为名称的函数，前面加上单词 `get`。在这个菜谱中，要获取用户的年龄，我们可以简单地编写以下代码：
- en: '[PRE32]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: See also
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关链接
- en: The *Setting a user's attributes* recipe
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*设置用户属性* 菜谱'
- en: The *Getting the currently logged-in user* recipe
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取当前登录用户* 菜谱'
- en: The *Getting a user's info* recipe
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取用户信息* 菜谱'
- en: Loading a group by its ID
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 通过其 ID 加载组
- en: Groups in concrete5 are ways to organize users by their role on the website.
    Groups can receive permission settings just like users can. In this recipe, we
    will load a group with the ID of 3 (which is the Administrators' group on most
    concrete5 installations).
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5中的组是按用户在网站上的角色组织用户的方式。组可以接收权限设置，就像用户可以一样。在这个配方中，我们将加载ID为3的组（在大多数concrete5安装中是管理员组）。
- en: How to do it...
  id: totrans-163
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for loading a group by its ID are as follows:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 按ID加载组的步骤如下：
- en: Determine the ID of the group that we want to load.
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定我们想要加载的组的ID。
- en: '[PRE33]'
  id: totrans-166
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Load the group by its ID.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按ID加载组。
- en: '[PRE34]'
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: Dump the name of the group variable to ensure that it has loaded correctly.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输出组变量的名称以确保它已正确加载。
- en: '[PRE35]'
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: How it works...
  id: totrans-171
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 will simply query the `Groups` table in the database to find the group
    record that corresponds to the provided ID.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5将简单地查询数据库中的`Groups`表以找到与提供的ID相对应的组记录。
- en: See also
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Loading a group by its name* recipe
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按名称加载组配方
- en: Loading a group by its name
  id: totrans-175
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 按名称加载组
- en: Groups can be loaded by their name, which can be useful when you do not know
    the numeric ID of the group.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 组可以通过其名称加载，这在您不知道组的数字ID时可能很有用。
- en: How to do it...
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for loading a group by its name are as follows:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 按名称加载组的方法如下：
- en: Define the name of the group that you wish to load.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义您要加载的组的名称。
- en: '[PRE36]'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: Load the group by its name.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按名称加载组。
- en: '[PRE37]'
  id: totrans-182
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: Dump the group variable to make sure that you have loaded the group correctly.
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输出组变量以确保正确加载了组。
- en: '[PRE38]'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: How it works...
  id: totrans-185
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 queries the database to find the group that has the same name that
    you provided to the `getByName` function. Group names can be changed through the
    concrete5 dashboard any time, so use caution when hardcoding group names in your
    applications.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5查询数据库以找到与您提供给`getByName`函数的名称相同的组。组名称可以通过concrete5仪表板随时更改，因此在您的应用程序中硬编码组名称时要小心。
- en: See also
  id: totrans-187
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Loading a group by its ID* recipe
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按ID加载组配方
- en: Adding a user to a group
  id: totrans-189
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 向组中添加用户
- en: While the concrete5 dashboard provides a simple interface to add users to different
    groups, sometimes you will encounter the need to do it programmatically. In this
    recipe, we will add a user with the ID of 1 to the Administrators' group, which
    has an ID of 3.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然concrete5仪表板提供了一个简单的界面来向不同的组添加用户，但有时您可能需要以编程方式执行此操作。在这个配方中，我们将向ID为3的管理员组（在大多数concrete5安装中是管理员组）添加ID为1的用户。
- en: How to do it...
  id: totrans-191
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for adding a user to a group are as follows:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 添加用户到组的步骤如下：
- en: Define the ID of the user that you would like to load.
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义您要加载的用户的ID。
- en: '[PRE39]'
  id: totrans-194
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Load the user by its ID.
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按ID加载用户。
- en: '[PRE40]'
  id: totrans-196
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Define the ID of the group that you would like to add the user to.
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义您想要添加用户到的组的ID。
- en: '[PRE41]'
  id: totrans-198
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Load the group by its ID.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按ID加载组。
- en: '[PRE42]'
  id: totrans-200
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Add the user to the group.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将用户添加到组中。
- en: '[PRE43]'
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: How it works...
  id: totrans-203
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: When the `enterGroup` function of the user model is called, the user will be
    added to the group that was passed as the first parameter. The user now will inherit
    all of the permissions associated with that group.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 当调用用户模型的`enterGroup`函数时，用户将被添加到作为第一个参数传递的组中。现在，该用户将继承与该组关联的所有权限。
- en: See also
  id: totrans-205
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Loading a user by its ID* recipe
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按ID加载用户配方
- en: The *Loading a group by its ID* recipe
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按ID加载组配方
- en: The *Removing a user from a group* recipe
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从组中删除用户配方
- en: Getting all of the users from a group
  id: totrans-209
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从组中获取所有用户
- en: Once you have loaded a group object, you can easily iterate through the users
    that are members of that group. In this recipe, we will load a group, and then
    output the username of each member within the group.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦加载了组对象，您可以轻松地遍历该组的成员。在这个配方中，我们将加载一个组，然后输出组内每个成员的用户名。
- en: How to do it...
  id: totrans-211
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for getting all of the users from a group are as follows:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 获取组中所有用户的步骤如下：
- en: Define the ID of the group that you wish to load.
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义您要加载的组的ID。
- en: '[PRE44]'
  id: totrans-214
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE44]'
- en: Load the group by its ID.
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按ID加载组。
- en: '[PRE45]'
  id: totrans-216
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Get an array of group members.
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取组成员数组。
- en: '[PRE46]'
  id: totrans-218
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: Loop through the members array, echoing the user's name.
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 遍历成员数组，回显用户名。
- en: '[PRE47]'
  id: totrans-220
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: How it works...
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: As usual, concrete5 does the heavy lifting here in regards to querying the database
    to find all of the user accounts that are members of the group that has been loaded.
    The `getGroupMembers` function returns an array of `UserInfo` objects, which can
    be used to read and modify the members of the group.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 如同往常，concrete5在这里负责查询数据库以找到所有已加载的组成员的用户账户。`getGroupMembers`函数返回一个`UserInfo`对象的数组，可以用来读取和修改组成员。
- en: See also
  id: totrans-223
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Loading a group by its ID* recipe
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*通过ID加载组* 的配方'
- en: The *Getting a user's info* recipe
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取用户信息* 的配方'
- en: Checking if a user is a member of a group
  id: totrans-226
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检查用户是否是组成员
- en: concrete5 comes with a robust permissions model, but sometimes developers will
    want to do simple permissions and access control tasks on their own. In this recipe,
    we will see if a user is in the Administrators' group. We will then display a
    message that indicates if they are an administrator or not.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5自带了一个强大的权限模型，但有时开发者可能希望在自己的代码中执行简单的权限和访问控制任务。在这个配方中，我们将检查用户是否在管理员组中。然后，我们将显示一个消息，指示他们是否是管理员。
- en: How to do it...
  id: totrans-228
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for checking if a user is a member of a group are as follows:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 检查用户是否是组成员的步骤如下：
- en: Load the currently logged-in user.
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载当前登录用户。
- en: '[PRE48]'
  id: totrans-231
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: Determine the ID of the group that you wish to load (in this case, it's the
    Administrators' group with an ID of 3).
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定您要加载的组的ID（在这个例子中，是ID为3的管理员组）。
- en: '[PRE49]'
  id: totrans-233
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Load the group by its ID.
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过其ID加载组。
- en: '[PRE50]'
  id: totrans-235
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE50]'
- en: Check if the user is a member of the group.
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查用户是否是组成员。
- en: '[PRE51]'
  id: totrans-237
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE51]'
- en: Display a message to the user confirming or denying if they are a member of
    the Administrators' group.
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向用户显示消息，确认或否认他们是否是管理员组的成员。
- en: '[PRE52]'
  id: totrans-239
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE52]'
- en: How it works...
  id: totrans-240
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 checks to see if the user is a member of the specified group object
    and returns a Boolean value.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5会检查用户是否是特定组对象的成员，并返回一个布尔值。
- en: See also
  id: totrans-242
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Loading a group by its ID* recipe
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*通过ID加载组* 的配方'
- en: The *Getting the currently logged-in user* recipe
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取当前登录用户* 的配方'
- en: Removing a user from a group
  id: totrans-245
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从组中删除用户
- en: 'In addition to being able to add users to groups, concrete5 also allows developers
    to perform the opposite task: removing users from groups. In this recipe, we will
    remove a user from the Administrators'' group.'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 除了能够将用户添加到组中，concrete5还允许开发者执行相反的任务：从组中删除用户。在这个配方中，我们将从管理员组中删除一个用户。
- en: How to do it...
  id: totrans-247
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for removing a user from a group are as follows:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 从组中删除用户的步骤如下：
- en: Load the currently logged-in user.
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载当前登录用户。
- en: '[PRE53]'
  id: totrans-250
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE53]'
- en: Define the ID of the group that you wish to load.
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义您要加载的组的ID。
- en: '[PRE54]'
  id: totrans-252
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE54]'
- en: Load the group by its ID.
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过其ID加载组。
- en: '[PRE55]'
  id: totrans-254
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE55]'
- en: Check to see if this user is a member of the group.
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查此用户是否是组成员。
- en: '[PRE56]'
  id: totrans-256
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE56]'
- en: If the user is a member, remove them from the group.
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果用户是成员，则从组中移除他们。
- en: '[PRE57]'
  id: totrans-258
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE57]'
- en: How it works...
  id: totrans-259
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: In this case concrete5 will simply remove the association between the user and
    the group. The user will lose all of the permissions that it had inherited from
    the group.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，concrete5将简单地删除用户和组之间的关联。用户将失去从组继承的所有权限。
- en: See also...
  id: totrans-261
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见...
- en: The *Adding a user to a group* recipe
  id: totrans-262
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*将用户添加到组中* 的配方'
- en: The *Loading a group by its ID* recipe
  id: totrans-263
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*通过ID加载组* 的配方'
- en: The *Getting the currently logged-in user* recipe
  id: totrans-264
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取当前登录用户* 的配方'
- en: The *Checking if a user is a member of a group* recipe
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检查用户是否是组成员* 的配方'
- en: Logging out a user
  id: totrans-266
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 注销用户
- en: concrete5 also contains functionality to log users out of the system programmatically.
    In this recipe, we will log out the user who is currently logged in.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5还包含程序化注销用户的函数。在这个配方中，我们将注销当前登录的用户。
- en: How to do it...
  id: totrans-268
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for logging out a user are as follows:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 注销用户的步骤如下：
- en: Check if the user is logged in.
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查用户是否已登录。
- en: '[PRE58]'
  id: totrans-271
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE58]'
- en: Load the logged-in user.
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载登录用户。
- en: '[PRE59]'
  id: totrans-273
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE59]'
- en: Log out the user.
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注销用户。
- en: '[PRE60]'
  id: totrans-275
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE60]'
- en: How it works...
  id: totrans-276
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 deletes the current session, effectively logging the user out.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5删除当前会话，实际上注销了用户。
- en: See also
  id: totrans-278
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Checking if the current user is logged in* recipe
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*检查当前用户是否已登录* 的配方'
- en: The *Getting the currently logged-in user* recipe
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*获取当前登录用户* 的配方'
- en: Deleting a user
  id: totrans-281
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 删除用户
- en: In this recipe, we will load a user with the ID of 3 and delete that user from
    concrete5.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个配方中，我们将加载ID为3的用户，并将其从concrete5中删除。
- en: How to do it...
  id: totrans-283
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for deleting a user are as follows:'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 删除用户的步骤如下：
- en: Define the ID of the user that you wish to delete.
  id: totrans-285
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义您要删除的用户的ID。
- en: '[PRE61]'
  id: totrans-286
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE61]'
- en: Load the `UserInfo` object for that user.
  id: totrans-287
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载该用户的`UserInfo`对象。
- en: '[PRE62]'
  id: totrans-288
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE62]'
- en: Delete the user.
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除用户。
- en: '[PRE63]'
  id: totrans-290
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE63]'
- en: How it works...
  id: totrans-291
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 will remove the user as well as all of their attributes from the database.
    This action is permanent and cannot be reversed, short of restoring a database
    backup.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5将从数据库中删除用户及其所有属性。此操作是不可逆的，除非恢复数据库备份。
- en: See also
  id: totrans-293
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: The *Getting a user's info* recipe
  id: totrans-294
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取用户信息的食谱
- en: Getting the permission object
  id: totrans-295
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 获取权限对象
- en: Verifying and modifying page permissions, centers around the permissions object.
    In this recipe, we will load the permissions object for a page.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 验证和修改页面权限，主要围绕权限对象展开。在本食谱中，我们将加载页面的权限对象。
- en: How to do it...
  id: totrans-297
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for getting the permission object are as follows:'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 获取权限对象步骤如下：
- en: Specify the path of the page for which you want to check the permissions settings.
  id: totrans-299
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定您要检查权限设置的页面路径。
- en: '[PRE64]'
  id: totrans-300
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE64]'
- en: Load the page by its path.
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过路径加载页面。
- en: '[PRE65]'
  id: totrans-302
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE65]'
- en: Load the `permissions` object for that page.
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载该页面的`permissions`对象。
- en: '[PRE66]'
  id: totrans-304
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE66]'
- en: Dump the `permissions` object to verify its contents.
  id: totrans-305
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`permissions`对象导出以验证其内容。
- en: '[PRE67]'
  id: totrans-306
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE67]'
- en: How it works...
  id: totrans-307
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 will return a `permissions` object that can be further used to determine
    if a user has access to perform various actions on that page.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5将返回一个`permissions`对象，可以进一步用来确定用户是否有权在该页面上执行各种操作。
- en: There's more...
  id: totrans-309
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: You can get the `permissions` objects for content areas and blocks as well,
    just pass a block or area object to the `Permissions` constructor instead of a
    `Page` object.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以获取内容区域和块的`permissions`对象，只需将块或区域对象传递给`Permissions`构造函数，而不是`Page`对象。
- en: See also
  id: totrans-311
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: The *Getting a Page object by its path* in [Chapter 1](ch01.html "Chapter 1. Pages
    and Page Types"), *Pages and Page Types*
  id: totrans-312
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。页面和页面类型")的*获取页面对象路径*中，*页面和页面类型*
- en: Checking if a user can read a page
  id: totrans-313
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检查用户是否有阅读页面权限
- en: You may find that sometimes you will want to manually find out if a user is
    allowed to read a particular page. In this recipe, we will load a page by its
    path, get the `permissions` object for it, and then find out if the user is allowed
    to view it.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能会发现有时您需要手动确定用户是否有权阅读特定的页面。在本食谱中，我们将通过路径加载页面，获取其`permissions`对象，然后确定用户是否有权查看该页面。
- en: How to do it...
  id: totrans-315
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for checking if a user can read a page are as follows:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 检查用户是否有阅读页面权限的步骤如下：
- en: Determine the path of the page to load.
  id: totrans-317
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定要加载的页面的路径。
- en: '[PRE68]'
  id: totrans-318
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE68]'
- en: Load the page by its path.
  id: totrans-319
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过路径加载页面。
- en: '[PRE69]'
  id: totrans-320
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE69]'
- en: Load the `permissions` object for that page.
  id: totrans-321
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载该页面的`permissions`对象。
- en: '[PRE70]'
  id: totrans-322
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE70]'
- en: Find out if the user is allowed to read that page.
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看用户是否有权阅读该页面。
- en: '[PRE71]'
  id: totrans-324
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE71]'
- en: How it works...
  id: totrans-325
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 will check all of the permissions for that `Page` object, including
    group and user permissions, to find out if the current user is allowed to view
    that page. The *canRead* function returns a Boolean value.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5将检查该`Page`对象的全部权限，包括组和用户权限，以确定当前用户是否有权查看该页面。`canRead`函数返回一个布尔值。
- en: There's more...
  id: totrans-327
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: Read permissions can also be checked for content areas and blocks by simply
    providing an area or block object to the `Permissions` constructor, instead of
    a `Page` object.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过简单地向`Permissions`构造函数提供一个区域或块对象，而不是`Page`对象来检查内容区域和块的读取权限。
- en: See also
  id: totrans-329
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: The *Getting a Page object by its path* in [Chapter 1](ch01.html "Chapter 1. Pages
    and Page Types"), *Pages and Page Types*
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。页面和页面类型")的*获取页面对象路径*中，*页面和页面类型*
- en: The *Getting the permission object* recipe
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取权限对象的食谱
- en: Checking if a user can edit a page
  id: totrans-332
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检查用户是否有编辑页面的权限
- en: In addition to being able to check if users can view pages, developers can also
    manually check to see if the logged-in user has the ability to edit a page. In
    this recipe, we will load a page by its path, get the `permissions` object for
    that page, and then find out if the user is allowed to edit it.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 除了能够检查用户是否可以查看页面外，开发者还可以手动检查登录用户是否有编辑页面的能力。在本食谱中，我们将通过路径加载页面，获取该页面的`permissions`对象，然后确定用户是否有权编辑它。
- en: How to do it...
  id: totrans-334
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for checking if a user can edit a page are as follows:'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 检查用户是否有编辑页面权限的步骤如下：
- en: Specify the page path to load.
  id: totrans-336
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定要加载的页面路径。
- en: '[PRE72]'
  id: totrans-337
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE72]'
- en: Load the page.
  id: totrans-338
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载页面。
- en: '[PRE73]'
  id: totrans-339
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE73]'
- en: Load the `permissions` object for the page.
  id: totrans-340
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载页面的`permissions`对象。
- en: '[PRE74]'
  id: totrans-341
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE74]'
- en: Find out if the user can edit the page.
  id: totrans-342
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看用户是否有编辑页面的权限。
- en: '[PRE75]'
  id: totrans-343
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE75]'
- en: How it works...
  id: totrans-344
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: concrete5 will look at the user's own permission settings as well as the settings
    for any groups that it is a member of, and determine if the user has the ability
    to edit or write to the given page.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 将查看用户的个人权限设置以及它所属的任何组的设置，并确定用户是否有能力编辑或写入指定的页面。
- en: There's more...
  id: totrans-346
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: As with read permissions, content area and block permissions can also be checked
    using this method. Simply provide an instance of an area or block instead of a
    page, and the permissions will be checked against those items instead.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 与读取权限一样，内容区域和块权限也可以使用此方法进行检查。只需提供一个区域或块的实例而不是页面，权限将针对这些项目进行检查。
- en: See also
  id: totrans-348
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关内容
- en: The *Getting a Page object by its path* recipe
  id: totrans-349
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过路径获取页面对象的配方
- en: The *Getting the permission object* recipe
  id: totrans-350
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取权限对象的配方
- en: Checking a user's file permissions
  id: totrans-351
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检查用户的文件权限
- en: concrete5 allows site owners to specify permissions on the file manager. In
    this recipe, we will see if a user is allowed to upload files to the file manager.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 允许网站所有者指定文件管理器的权限。在本配方中，我们将查看用户是否被允许将文件上传到文件管理器。
- en: How to do it...
  id: totrans-353
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps for checking a user''s file permissions are as follows:'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 检查用户文件权限的步骤如下：
- en: Load the `FilePermissions` global object.
  id: totrans-355
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载 `FilePermissions` 全局对象。
- en: '[PRE76]'
  id: totrans-356
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE76]'
- en: Check if the user can view the `file manager` interface.
  id: totrans-357
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查用户是否可以查看 `文件管理器` 界面。
- en: '[PRE77]'
  id: totrans-358
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE77]'
- en: Check if the user can upload to the file manager.
  id: totrans-359
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查用户是否可以上传到文件管理器。
- en: '[PRE78]'
  id: totrans-360
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE78]'
- en: How it works...
  id: totrans-361
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The `FilePermissions` class extends the `Permissions` class, and allows users
    to check the global settings of the file manager.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: '`FilePermissions` 类扩展了 `Permissions` 类，并允许用户检查文件管理器的全局设置。'
- en: There's more...
  id: totrans-363
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容...
- en: concrete5 also allows developers to check if a user is allowed to upload files
    of a specific type.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: concrete5 还允许开发者检查用户是否被允许上传特定类型的文件。
- en: '[PRE79]'
  id: totrans-365
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'

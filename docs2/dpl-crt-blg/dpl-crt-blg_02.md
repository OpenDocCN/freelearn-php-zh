# 第二章。设置开发环境

*究竟什么是开发环境，为什么我需要它？* 人们普遍认为，在构建网站的过程中，你不应该让它对互联网用户可用。在你还在进行更改、破坏和修复事物的时候，让你的网站“上线”，意味着人们可能会找到你的网站，尝试使用它，并对你网站开发技能形成极差的印象。在最坏的情况下，你可能会发现，由于安全设置不当，你甚至无意中允许恶意用户获取敏感信息，以及其他一些问题。

与其让公众访问你的工作进度，不如在你的家庭或办公室电脑上设置一个 PHP 启用的 Web 服务器。这个服务器，连同 PHP 和你的数据库，可以用来设计和构建你想要的一切，然后再将最终产品转移到实时网站上。开发环境正是这样一台机器，以及它附带的发展工具和技术，你可以用它来构建你的网站。因此，本章将确保你正确且高效地设置它，以便你可以在接下来的章节中直接开始处理 Drupal。

具体来说，我们将讨论以下重要主题：

+   涉及技术的简要介绍

+   获取和安装 Apache、MySQL 和 PHP

+   获取和安装 Drupal

+   升级 Drupal

+   故障排除常见问题

+   Drupal 简介之旅

对于 Apache、MySQL 和 PHP 的安装和设置，我们只会涵盖 Windows 系统，因为我们相信 Linux 用户已经安装了所有必要的软件（或者知道如何安装）。如果你还没有安装所有软件，快速浏览一下软件所在网站上的说明应该足以让你开始操作。Drupal 的安装过程在 Windows 和 Linux 系统上基本相同；因此，使用任一系统的用户都可以跟随“获取和安装 Drupal”部分进行操作。

在我们开始之前，然而，有一项至关重要的建议需要给出：

### 注意

确保你有一个好，最好是闪电般的快速，互联网连接，因为你将下载相当多的软件。

对于已经安装了各种软件的用户，您可能会发现跳过不需要的部分，只阅读感兴趣的部分很方便。除了提供安装信息外，本章还将包含一个故障排除部分，解决与 Drupal 设置过程相关的一些最常见错误。

还应注意的是，由于 Drupal 的开发是以灵活性为前提的，因此它可以用作 IIS 之外的替代 Web 服务器，同时也可以使用 PostgreSQL 作为替代数据库，因为这些支持正在积极开发中。我们不会展示如何设置每一个组件，而是将重点放在最流行的组合 Apache、MySQL 和 PHP 上。

# Drupal 环境

我知道你们大多数人现在都迫不及待地想要开始，可能更愿意直接修改你的 Drupal 网站。在我们这样做之前，花几分钟时间阅读这一部分，了解幕后的一切是如何组合起来的，这对你们来说将是非常有益的。了解各种技术如何合作以提供工作的 Drupal 网站，将极大地帮助你们在长期中。

首先，最好的做法是查看我们将要使用的每个基础技术：

+   **PHP**：PHP，或 PHP Hypertext Preprocessor，是 Drupal 所使用的语言。最近它经历了一次重大升级，现在几乎是一个完全功能的**面向对象语言**，具有一些非常强大的功能。PHP 在互联网上被广泛用于各种不同的项目，以其易用性而闻名。当前的 PHP 版本是 PHP 5，这是我们将在本书中用于演示的版本，因为最新的 Drupal 版本与 PHP 5 兼容。然而，你们可以使用版本 4，因为这是目前大多数互联网服务提供商所使用的版本。好消息是，我们不需要深入编程代码来构建我们的网站——Drupal 处理了大多数，如果不是所有，复杂的编程问题。

+   **Apache**：这是我们将在开发阶段用来提供网页服务的 Web 服务器。Apache 是互联网上最受欢迎的 Web 服务器，每天都有数百万个网站在使用它。事实上，正如 Apache 网站所说：*它比所有其他 Web 服务器加起来还要广泛使用*。

+   **MySQL**：这是我们用来存储所有保持网站运行所需信息的数据库软件。从客户详情到产品信息以及其他许多东西都将存储在 MySQL 数据库中。遵循流行的趋势，MySQL 也是全球最受欢迎的数据库软件，全球有超过六百万个活跃安装。

现在，由于我们不希望浪费太多时间下载和安装我们需要的各种软件，我们将使用包安装，它只通过一次安装就为我们提供了一切所需。我们将在本书中使用的包叫做**Apache2Triad**。

既然我们已经知道了*我们要使用什么*，那么快速看一下*我们将如何使用它*是很重要的。以下图表展示了如何简化地了解一切是如何工作的，其中阴影部分表示包含 Apache web 服务器、PHP 解释器和 MySQL 数据库的 Apache2Triad 软件包，Drupal 已安装在该系统上：

![Drupal 环境](img/1800_02_01.jpg)

因此，每当用户在您的 Drupal 网站上做任何事情（希望是做出有意义的贡献）时，以下是会发生的事情：

1.  相关信息以 HTTP（超文本传输协议）请求的形式打包发送到服务器。HTTP 请求有两种形式——要么是 `GET`，要么是 `POST`。对于我们来说，了解 `GET` 和 `POST` 如何工作并不重要，只要您理解可以通过这些请求从用户那里捕获信息并发送到服务器进行处理即可。

1.  服务器接收到 HTTP 请求后说：“啊！这是一个请求的 PHP 页面。我需要将其发送给 PHP 引擎进行处理。”然后 PHP 页面被处理并适当地执行，任何由用户请求引起的必要操作都会被执行。

1.  一旦完成，服务器就会向用户的浏览器返回适当的响应，然后循环继续。

有很多提供动态网页内容的方法，这些方法不依赖于 PHP 服务器请求。相反，处理是在应用程序的客户端（换句话说，在网页浏览器）上完成的。我们将在第九章中稍后讨论如何使用 JavaScript 增强您的网页，但您在这里看到的是一切工作的基本原理，即使有一些例外。

尽管这一节对 Drupal 相关的底层技术进行了一次快速浏览，但这里包含的信息在某些阶段应该非常有价值。例如，了解一切是如何结合在一起的通常有助于您隔离遇到问题的原因，从而更快地解决问题。

目前这一切看起来可能有些令人畏惧，但请记住，Drupal 本身就处理了大多数，如果不是所有，与确保一切顺利运行相关的复杂性。正如您将看到的，我们的工作变成了定制而不是实际的软件开发。有了这个基础，让我们继续进行安装过程。

# 获取和安装 PHP、Apache 和 MySQL

如前所述，我们将利用软件包安装来简化创建可工作开发环境的工作。您会注意到，大多数软件安装实际上就是学习一个过程，然后为所需的任何软件重复该过程。更常见的情况是，您将：

1.  前往软件生产商的网站

1.  找到下载页面

1.  下载软件

1.  解压软件或运行可执行文件，具体取决于安装方法

1.  安装软件

1.  配置您的安装

1.  测试您的设置

这听起来很简单；所以前往[`apache2triad.net/`](http://apache2triad.net/)，这是 Apache2Triad 项目的首页，点击屏幕底部左侧框中的**下载**链接。（您可以随意浏览以了解更多关于这个有用企业信息。）这将带您到 SourceForge 网站上的下载页面：[`sourceforge.net/project/showfiles.php?group_id=93507`](http://sourceforge.net/project/showfiles.php?group_id=93507)。

选择您希望使用的软件包——在本书中，使用了版本 1.5.3 的发布包。在撰写本文时，这是最新的稳定版本，但您当然可以使用更晚的版本，这不会影响您在这里的跟随。一旦您为某个软件包点击了**下载**，您将看到一个下载选项列表。发布包 1.5.3 只有一个选项，如下所示：

![获取和安装 PHP、Apache 和 MySQL](img/1800_02_02.jpg)

这是我们将要下载和安装的软件包。为了做到这一点，只需点击`软件包名称.exe`文件，这将带您到一个镜像站点列表，您可以从中选择一个来提供下载。镜像只是一个在不同地理位置提供所有相同设施的服务器——这样做是为了减少单个服务器的负载，并为全球各地的人提供更快的下载。做出选择并点击**下载**以开始。

根据您的 PC 安全设置，您可能会收到以下警告信息：

![获取和安装 PHP、Apache 和 MySQL](img/1800_02_03.jpg)

简单点击**运行**以继续（或者如果您想保留副本，请点击**保存**）。在这个时候，如果您连接速度较慢，可能需要花一些时间，您可能想要休息一下，喝杯咖啡或茶。

在设置过程中某个阶段，安装程序将要求您确认几个设置，您可以根据提示随时进行更改。所有可配置的设置都有合理的默认值；所以您实际上不必太在意这一点。然而，您将被要求输入密码。请确保使用一个您能记住且安全的密码。您需要使用 8 个字符或更多，并且最好在密码中使用一些数字。

### 注意

确保您能记住您的密码，因为它在设置过程中稍后运行初始化任务时是必需的。

一切完成后，您应该会收到以下信息：

![获取和安装 PHP、Apache 和 MySQL](img/1800_02_04.jpg)

在点击**确定**之前，请确保保存并关闭你打开的所有重要文档。一旦你的机器重新启动，你会发现你有一系列新的和令人兴奋的选项可以探索，这些选项位于**开始**菜单下的**所有程序**中的**Apache2Triad**选项下。例如，以下选项是 1.5.3 版本中提供的：

![获取和安装 PHP、Apache 和 MySQL](img/1800_02_05.jpg)

对于我们当前目的来说，还有很多我们不需要的东西，但为了确保一切按计划进行，点击**开始**菜单中的**打开网站根目录**，你应该会在默认浏览器中看到以下网页：

![获取和安装 PHP、Apache 和 MySQL](img/1800_02_06.jpg)

这确认了一切都按预期运行。到目前为止，这很简单！在之前的屏幕截图中需要注意的一点是最后的链接叫做**htdocs**。在 Apache 服务器中，文件系统中的`htdocs`文件夹通常被称为**根**文件夹。这意味着为了使 Apache 能够提供，你的网站的所有网页和文件夹都必须放在`htdocs`内部。如果某个东西不在`htdocs`中，那么就无法浏览它！

从这里我们知道，为了知道下载后 Drupal 应该放在哪里，我们必须在文件系统中定位名为`htdocs`的实际文件夹。假设你选择了默认设置，你将在以下目录中找到`htdocs`，以及设置过程中安装和创建的所有其他内容：（在 Windows 机器上）`C:/apache2triad/`。

在我们继续前进之前，看看 Apache2Triad 安装中提供的内容是值得的，因为随着时间的推移，一些提供给你的设施可能非常有用。你还会发现，许多现场网站的主机套餐提供的功能与你现在在 PC 上拥有的功能几乎相同。

对于我们 Drupal 用户来说，特别有趣和有用的是 phpMyAdmin，这是一个完整的 MySQL 数据库管理工具。随着你变得更加高级并希望对你的数据进行操作，它可以使你的生活变得更加容易。你完全有可能通过使用 phpMyAdmin 来完成大多数任务，而无需学习 MySQL 的命令行客户端。

### 注意

如果你登录 phpMyAdmin 或网站的任何其他部分有困难，那么尝试使用**root**作为用户名，并使用你在设置过程中设置的任何密码。

我们现在有一个平台，可以从这里开始构建 Drupal 网站。当然，我们仍然需要 Drupal。

# 获取和安装 Drupal

第一章已经浏览了 Drupal 网站上的下载页面；因此，目前没有太多问题。前往[`drupal.org/project/Drupal+project`](http://drupal.org/project/Drupal+project)，点击您希望下载的 Drupal 版本号——通常，*最新稳定版本*是您应该选择的。点击**下载**以获取最新版本并将其保存到您的`C:`驱动器或`我的文档`文件夹（或您想要的位置）。

现在，Drupal 的下载与 Apache2Triad 安装程序不同，我们将自己安装 Drupal；它没有自己的`.exe`安装程序文件。相反，我们会被告知是否要**保存**（或**打开**）一个`.tar.gz`文件。如果您发现您的 PC 无法识别`.gz`文件（这是针对 Windows 用户的），那么您需要下载一个 zip 程序，如 WinZip（[`www.winzip.com`](http://www.winzip.com)），或者更倾向于开源选项，如 7-zip（[`www.7-zip.org`](http://www.7-zip.org)）。

当您确认可以打开并解压缩下载的`tar.gz`文件后，将其提取到 Apache 安装的`htdocs`文件夹中。如果您现在查看，您将看到如下内容：

![获取和安装 Drupal](img/1800_02_07.jpg)

我们仍然需要创建一个数据库，并填充所有 Drupal 运行所需的必要表和结构——尽管从技术上讲，您可以尝试浏览 Drupal 页面，因为它们现在位于`htdocs`文件夹中。有几种方法可以实现这一点，但让我们坚持最基本的方法，以便使本节适用于所有人。

1.  打开一个命令行外壳。在 Windows 中，可以通过点击**开始**，选择**运行**并输入**cmd**来完成。

1.  在提示符下输入以下命令：

    ```php
    C:\ mysqladmin -u root -p create drupal

    ```

1.  当提示输入密码时，请输入您的密码。（这是您在 Apache2Triad 设置时输入的密码。）

1.  通过以下命令进入 MySQL 命令行提示符：

    ```php
    C:\ mysql -u root p

    ```

1.  再次输入您至今为止一直在使用的相同密码，当提示时。

1.  为了为 Drupal 特别设置数据库用户名和密码，请输入以下命令：

    ```php
    mysql> GRANT ALL PRIVILEGES ON drupal.* TO nobody@localhost IDENTIFIED BY
    'password';

    ```

1.  请记住，用与您相关的值替换此命令中加粗的部分——`nobody`（您的用户名）和`password`（您的密码）。之后，您应该会看到一个类似以下屏幕的界面：![获取和安装 Drupal](img/1800_02_08.jpg)

1.  接下来，输入以下命令以确保这些设置立即生效：

    ```php
    mysql> flush privileges;

    ```

1.  输入`quit`退出 MySQL 命令行客户端，然后通过输入以下命令来加载数据库：

    ```php
    $> mysql -u drupal -p drupal < C:/apache2triad/htdocs/drupal-4.7.0/
    database/database.4.1.mysql

    ```

1.  请记住，输入您为 drupal 数据库用户设置的正确密码——在本例中，如上图所示为 ny4thi。加粗的部分可能根据您在之前步骤中定义的用户和您获得的 Drupal 版本而有所不同。

到目前为止，Drupal 的所有数据库设置都已完成，我们只需要处理几个配置任务，以便完成安装过程。对于那些对在设置过程中引擎盖下发生了什么感兴趣的人，请使用以下方法打开 MySQL 命令行提示符：

```php
$> mysql udrupal p drupal

```

当提示输入密码时，然后在命令行中输入以下内容：

```php
mysql> show tables;
mysql> select * from <tablename>;

```

第一条命令将列出`drupal`数据库中现在所有存在的表。下一条命令可以用来查看任何给定表的详细信息，只需将其中一个现有的表名替换为`<tablename>`。通过查看结果，您应该能够看到已经做了大量工作来确保我们网站所需的一切都已创建。

我们现在可以继续配置设置！

通过导航到`C:\apache2triad\htdocs\`**drupal-4.7.0**`\ sites\default`来访问您的 Drupal 安装——显然您的版本号可能不同。使用您选择的编辑器打开`settings.php`文件，并修改大约在第 81 行的以下行：

```php
$db_url = 'mysql://username:password@localhost/database';

```

例如，演示网站的设置现在是：

```php
$db_url = 'mysql://drupal:ny4thi@localhost/drupal';

```

因为正如您所知，我们创建了一个名为`drupal`的用户，并给这个用户设置了密码`ny4thi`，这允许他们访问使用下载中提供的 SQL 脚本创建的`drupal`数据库。目前我们唯一需要考虑的其他设置是描述您网站地址的基本 URL——填写此信息是可选的；所以如果您在第一次检查网站时发现存在断链等问题，请回到这个设置。

假设您没有在网络上使用其他服务器，只需将额外的文件夹添加到默认地址，并从行首移除井号（#）符号，如下所示：

```php
$base_url = 'http://localhost/drupal-4.7.0';

```

记得将粗体部分更改为您下载的包的正确 Drupal 版本。

如果您已将文件保存到其他位置，那么您需要相应地调整您的配置设置。完成之后，保存文件中的更改，并准备进行压力测试。如果一切按计划进行，当您在浏览器中导航到基本 URL 时，应该会看到一个全新的 Drupal 网站，如下所示：

![获取和安装 Drupal](img/1800_02_09.jpg)

如果您看到的不是这个屏幕（或者非常接近），那么请不要担心。接下来将很快有一个故障排除部分，以及一个完整的社区，其中包含论坛来帮助解决问题。然而，如果您看到的是这个，那么恭喜您，您现在已经成为了一个自豪的默认 Drupal 网站的管理员。当然，如果您每次想要访问网站时都不想输入`drupal-4.7.0`，您可以自由地更改这个文件夹的名称。

### 注意

确保您在`settings.php`中对`$base_url`变量进行了相应的更改，以反映地址的任何更改，否则您将得到一个损坏的网站。

实际上，这就是安装 Drupal 所需做的全部事情。从今往后，所有其他的事情都是配置和定制。我们首先需要做的事情之一是设置一个管理员账户，所有关于它的说明都已经在您默认的网页上呈现，如之前的截图所示。在我们进行简要的 Drupal 之旅并在这个过程中设置管理员账户之前，我们需要考虑一些其他问题。

# 升级 Drupal

有时，为了保持您的网站运行顺畅且无故障，您需要升级您的 Drupal 安装。例如，有时可能会发现安全问题，人们升级以避免成为恶意黑客的受害者是很重要的。不要对此过于恐慌。所有软件，无论是专有软件还是开源软件，都有弱点。弱点是您无法逃避的东西。重要的是一旦发现它们，如何处理它们。在 Drupal 的情况下，有一个庞大的社区在寻找漏洞、报告它们、修复它们，然后免费向所有用户提供解决方案。

因此，如果需要的话，了解如何进行无痛升级是很重要的。正如您所期望的，Drupal 的过程相当简单，但在我们查看它之前，我应该提醒您：

### 注意

如果您使用的是非默认主题，您的网站可能会出现故障。在升级之前恢复到默认主题可能是最好的选择。

目前，这个注意事项不应该让您感到任何困扰，因为我们甚至还没有讨论到主题——不过将来可能会很有用。让我们继续：

1.  备份您当前的数据库，以便保留用户添加的所有信息以及您实施的任何配置更改。（备份在第十章中讨论。如果您需要在此期间进行备份，请快速查看那里。）

1.  备份旧文件，特别是那些包含重要设置，如您的样式表或位于`sites/default/directory`中的配置文件。这允许您在新网站上重新实施任何重要的设置。

1.  从您的文件系统中删除所有旧的 Drupal 文件，并且假设您想要从相同的位置运行您的网站，将所有新文件解压缩到相同的文件夹中。

1.  根据旧配置文件中保存的设置对配置文件进行必要的更改。

1.  以网站管理员（必须是用户编号 1）的身份登录，然后导航到您的 Drupal 主页，并通过浏览器访问`update.php`脚本来运行它。例如，演示网站的更新页面将是`http://localhost/drupal-4.7.0/update.php`。这将显示如下页面：![升级 Drupal](img/1800_02_10.jpg)

1.  在您点击**运行数据库升级脚本**链接之前，请阅读这些说明，以确保您执行可能需要的任何特定版本的任务。

1.  点击链接以打开以下页面：![升级 Drupal](img/1800_02_11.jpg)

1.  选择要执行的操作更新（仅在您出于某种原因对自动选择不满意时），然后点击**更新**。如果一切顺利，您应该会看到一个已执行更新的列表，以及这些操作的状态；类似于以下内容：

![升级 Drupal](img/1800_02_12.jpg)

您现在已完全更新，可以继续正常操作。当您需要升级时，还应查看另一个非常有价值的信息来源，即 Drupal 网站本身：[`drupal.org/upgrade/`](http://drupal.org/upgrade/)。此页面包含有用的说明和特定版本的注意事项、问题和说明，可能非常有用。

# 故障排除常见问题

在本节中，我们将探讨在您的设置过程中最有可能出现的两个问题。我们还将查看它们如何表现出来以及如何快速解决它们。需要注意的是，在这个早期阶段，由于安装程序已经被广泛使用，并且大多数，如果不是全部，的 bug 已经被消除，因此不太可能出现问题。这对我们来说是个好消息，因为任何错误很可能是由于打字错误或其他相当简单的原因造成的，这应该很容易纠正。

不幸的是，我们无法在本节中涵盖所有内容；因此，我们还将概述一个简短的过程，您可以使用它来解决任何问题，而不仅仅是与安装相关的问题。在遇到问题时遵循一个合理的流程是无价的，而不仅仅是展示每个问题的解决方案。在本节结束时，您应该有信心能够安装和升级 Drupal，以及处理可能出现的任何问题。那么，让我们开始吧。

如果您收到的不是默认主页，而是如下信息：

![故障排除常见问题](img/1800_02_13.jpg)

然后，很可能是您在`/sites/default/settings.php`文件中的连接字符串中犯了拼写错误。请重新检查此文件，以确保您提供的名称和密码是正确的。如果您找不到问题，请在`settings.php`文件中输入您的 root 名称和密码，看看您是否可以用它登录。如果这可行，那么您就知道问题出在用户和/或他们的权限上，而不是其他地方，所以请再次检查步骤 5 中的`GRANT`语句，并确保它与`settings.php`文件中的设置相匹配。

在上一张截图中，`settings.php`文件中给出的用户名有拼写错误，导致 Drupal 试图用用户名`drupa`而不是`drupal`连接到 MySQL。当然，有些人可能已经通过了这一点，却遇到了类似这样的情况：

![故障排除常见问题](img/1800_02_14.jpg)

如您所见，我们几乎就要成功了，但肯定是在某个环节出了问题，这从断开的链接和缺少任何格式和样式可以证明。这个错误最可能的原因是设置了错误的基 URL——在 4.7 版及以后的版本中，Drupal 会自动检测这个 URL，所以这不应该是一个太大的问题。然而，如果您将`htdocs`中的 Drupal 文件夹名称更改为`drupal`而不是原始的`drupal-4.7.0`，那么在不调整基 URL 的情况下浏览该地址可能会引起这类问题。

为了解决这个问题，确保您在浏览器中找到页面的地址与`settings.php`文件中给出的地址相同，只是没有尾随的反斜杠，如下所示：

```php
$base_url = 'http://localhost/drupal-4.7.0';

```

哎呀，您可以看到这仍然是旧值；所以我们需要更新它以匹配上一张截图中的地址，如下所示：

```php
$base_url = 'http://localhost/drupal';

```

一旦您设置了正确的设置，您会发现网站会正确显示。*但是，如果其他事情出了问题怎么办？* 好吧，在这个时候，可能发生的问题类型不容易隔离；所以您最好知道*如何*去解决它们。以下要点强调了您在故障排除任何问题时应该使用的流程：

1.  仔细检查您收到的任何错误消息，并尝试自己解决问题。

1.  访问 Drupal 论坛并搜索类似的问题。

1.  查看[`drupal.org/node/199`](http://drupal.org/node/199)上的故障排除常见问题。

1.  查看错误列表([`drupal.org/project/issues`](http://drupal.org/project/issues) )，看看您的问题是否是已报告的错误。

1.  如果您找不到错误、类似帖子或问题，那么请尝试在论坛上发布您的查询，并请求社区中的某个人帮助您。

1.  作为补充，上 Google 并尝试使用相关关键词查找类似的问题，希望找到一个解决方案。

在这个阶段，你很可能不需要使用所有六个选项，但在未来的某个时候，你可能会发现你需要比在网上搜索更多的专业知识。如果这种情况发生，那么不要绝望，如果你愿意支付费用，有顾问可供选择。不过，现在，你应该准备好继续设置过程中的最后几个任务，这些任务将在下一节中执行。

# Drupal 简游

在我们继续讨论定制和配置主题之前，重要的是我们先了解一下 Drupal 的实际样子，并确保它已经启动并且运行正常。为了做到这一点，我们需要查看一些 PHP 设置。一旦这些问题得到解决，我们就需要创建第一个用户，他将控制网站的各个方面。没有对实际 Drupal 页面的讨论，任何 Drupal 之旅都不会完整，因此，我们将在本节末尾完成一些尝试后，查看一个示例。

然而，首先让我们来处理 PHP。

## 几个重要的设置

我将演示 Apache2Triad 设置所需的更改，但如果你选择了其他任何东西（或者如果你已经安装了所有东西），你可能会注意到布局方式上的细微差异。现在，我们需要做所有这些事情的原因是，我们显然希望 Drupal 发送的任何电子邮件都来自一个我们可以访问的工作电子邮件地址，并且我们需要检查 Drupal 用于发送电子邮件的`mail()`函数是否有一个 SMTP 服务器可以与之配合。既然我们最终不得不在某个地方设置这个（假设它还没有设置），我们不妨现在就做。

打开你的`php.ini`文件，在 Windows 使用 Apache2Triad 的情况下，该文件位于`C:\WINDOWS`。搜索以下行：

```php
[mail function]
; For Win32 only.
SMTP = localhost
smtp_port = 25
; For Win32 only.
sendmail_from = admin@localhost
; For Unix only. You may supply arguments as well (default: "sendmail -t -i").
;sendmail_path =

```

你需要为 PHP 提供一个可以在这里工作的 SMTP 服务器。如果你在 Windows 上使用 Microsoft Outlook，可以通过查看**工具 | 账户 | 属性**菜单中的服务器选项卡来找到你正在使用的 SMTP 服务器。此外，你可能还想设置的不是`admin@localhost`；因此，请确保相应地做出这些更改。对于演示网站，进行了以下更改：

```php
[mail function]
; For Win32 only.
SMTP = smtp.dsl.<myserver>.net
smtp_port = 25
; For Win32 only.
sendmail_from = staff@contechst.com
; For Unix only. You may supply arguments as well (default: "sendmail -t -i").
;sendmail_path =

```

显然，你必须能够访问一个可用的 SMTP 服务器——如果你没有服务器可以使用，那么你就无法从你的网站发送电子邮件。这在目前并不是一个巨大的问题，而且，即使你无法从你的开发机器发送，你的实际网站仍然能够发送邮件。

### 注意

为了让这些设置生效，你还必须记得重新启动 Apache 服务器。

你可以通过双击屏幕右下角的过程栏中的 Apache 图标来重新启动 Apache，然后在菜单中选择**重启**。你也可以通过**开始**菜单访问服务器。完成这些后，你可以像平常一样继续使用 Drupal。

## 创建管理用户

如默认 Drupal 页面所述，你需要点击**创建第一个账户**链接来开始操作。这将显示注册页面，你可以适当地填写。一旦你点击**创建新账户**，Drupal 将自动尝试发送欢迎邮件（如果你收到，那么你知道你的 SMTP 设置是有效的）以及打印出如下所示的消息：

![创建管理用户](img/1800_02_15.jpg)

注意到，不仅已经成功将电子邮件发送到了我在注册过程中指定的地址，而且这封电子邮件**来自**我在稍早前在`php.ini`文件中指定的地址。

### 注意

如果你没有互联网连接，你仍然可以设置你的 Drupal 网站，但你将无法使用如这里所示的第三方 STMP 服务器发送和接收电子邮件。

到目前为止一切顺利！下一步是将你的新密码输入到网站上——记得选择一个比目前分配的稍微容易记住一些的东西。完成之后，只需在页面底部点击**提交**继续——你可能希望先查看一下其他设置并做出任何快速更改（例如添加**签名**或更改**时区**）。

## 使用管理面板

在我们进入下一章更严肃的网站构建问题之前，让我们先轻松一下。一旦你完成了编辑用户设置，点击页面左侧的**管理**链接，这将显示一个类似这样的页面（已选择**模块**选项）：

![使用管理面板](img/1800_02_16.jpg)

在我们真正开始操作之前，列出每个选项的功能是值得的，因为当你深入其中时，可能会变得有些混乱——主要是因为菜单项的数量很多，并不是因为网站特别难以管理。特别注意的是以下内容：

### 注意

**管理**菜单项下可用的部分可能会根据你启用的模块、添加的贡献或用户分配的权限而变化。

这意味着，在你添加并启用了一个新模块之后，你应该始终确保检查该部分是否有新的选项可用。你也应该意识到，并非所有用户都会拥有相同的**管理**选项，你需要检查他们是否有足够的权限来完成他们打算执行的任务。我们将在稍后更详细地探讨这些问题；因此，在这个阶段，没有必要急于求成。

以下列表概述了核心选项：

+   **访问控制**：允许你设置权限以控制用户可以在你的网站上做什么。

+   **块：** 启用的块可以在您网站上的多个位置显示。块可以包含各种信息，例如谁在线或最新的论坛帖子。

+   **分类：** 允许管理员对网站上的内容进行分类和分类。Drupal 有一个非常复杂的分类系统，即分类模块。

+   **评论：** 允许管理添加到网站上的评论。评论与其他内容类型不完全相同，而是*附加*到其他内容类型上。

+   **内容：** 允许管理网站上所有帖子。它提供了各种过滤器，以便快速找到特定内容以及更新选项。

+   **输入格式：** Drupal 可以以多种方式查看用户的内容。这从过滤 HTML 到完整的 PHP 代码都有。

+   **日志：** 启用记录各种事件，例如使用信息、警告和错误，这些可以在健康网站的常规维护期间使用。

+   **菜单：** 允许创建和管理导航结构。从这里可以启用或禁用菜单项，创建新的菜单项，以及处理主要链接。

+   **模块：** 提供 Drupal 的功能（标准 Drupal 分发中包含许多核心模块，还有许多需要下载和安装的贡献模块），可以根据网站的需求启用或禁用。

+   **设置：** 提供了一个方便的页面，可以从中实施网站的通用配置。

+   **主题：** 控制您网站的外观和感觉。默认情况下有各种选项可用。记住，如果您了解一些 PHP、HTML 和 CSS，也可以创建您自己的全新主题。 

+   **用户：** 从这里您可以添加、删除或编辑您网站上任何和所有的用户。

+   **帮助：** 包含指向 Drupal 手册以及各种模块的帮助主题的链接，之后是一个重要术语的简短词汇表。

让我们实际对网站进行一些修改，看看我们能做什么。请前往**管理**菜单项下的**模块**部分，勾选**启用**标题下的相关复选框，然后点击**保存配置**。您应该会立即注意到页面加载时有一些变化，以博客相关的菜单项的形式出现——在菜单顶部寻找新的**我的博客**链接。在我们看到实际网站如何改变之前，前往**块**（同样在**管理**下）并做同样的事情，确保您启用了一些块，并在**位置**下拉列表中选择**右侧栏**。

目前不必担心具体要做出哪些更改。我们只是快速查看使用管理工具做事情有多容易。下一节将通过一个示例 Drupal 页面截图来查看一些更改的效果。

## 一个示例 Drupal 页面

完成修改后，点击左侧导航块中的**创建内容**，然后点击**博客条目**。一旦打开博客页面，只需添加一些内容，无论是什么，然后点击**预览**以查看效果，如果满意，点击**提交**。如果你现在注销，你会面对你新的默认页面。让我们简要地看一下它，以便讨论一些主要功能：

![一个示例 Drupal 页面](img/1800_02_17.jpg)

当有人第一次来到你的网站时，目前的状态，他们可能会看到之前截图中的内容。（正如你可以看到的，我已经启用了一大批新模块，并将一些块设置为在页面右侧显示。此外，你可以看到我输入了一条问候消息作为我的第一条博客条目，Drupal 在主页上尽职尽责地显示了它，而不是初始说明。）此截图中有几个主要区域值得关注，我们应该在这里查看它们，以便了解接下来章节中可以期待的内容：

1.  URL 表示正在访问的页面，并且可以修改以提供搜索引擎友好的格式。

1.  页面标题包含你的网站标志和标语，以及其他内容。它还提供了一个链接到主页，并且是完全可配置的。

1.  搜索工具允许用户输入搜索词以在 Drupal 网站上定位内容。

1.  左侧和右侧边栏包含块，这些块实际上是信息容器，以及导航链接。在这种情况下，几乎所有功能都已启用——这就是为什么页面的两侧有这么多单独的块。请注意，我们现在在右侧也有块，因为我们设置了一些块在右侧边栏中显示。块也可以出现在页面的其他部分，我们稍后也会处理这些。

1.  Drupal 中的所有内容都包含在节点中，如这里所示。这不必是一个博客条目——它可能是一个投票或论坛帖子。当然，显示方式是可定制的，正如我们稍后将会看到的。

1.  用户可以注册并登录到网站以创建帖子或查看内容。可以分配权限和角色给用户，以便他们执行各种管理任务等。

由于页面过长，此截图没有显示页脚区域。此部分也可以包含块和其他内容，并且像网站的其他部分一样，是完全可定制的。

这就结束了我们对 Drupal 的简要游览。在下一章以及随后的章节中，我们将开始利用 Drupal 核心功能的各个方面（以及寻求一些贡献的帮助）并将其塑造成我们希望创建的网站。同时，我们鼓励你尽可能多地玩转网站，以了解你可以做什么。

# 摘要

为了提供给你完成所有事情的最有效方法，本章在名为 Apache2Triad 的包中涵盖了 PHP、MySQL 和 Apache 的安装。因此，你现在有了在接下来的几天和几周内建立现场网站的基础。在花费时间设置一个可工作的开发环境后，你可以确信，通过不在现场网站上直接工作，你已经避免了任何不必要的浪费时间，以及可能的不良宣传。

现在你已经在自己的机器上安装了 Apache、PHP 和 MySQL 提供的服务，你可以自由地实验和玩转你的网站，以了解如何操作。当然，安装所需技术的结束并不是故事的终结。我们还学习了如何获取和安装 Drupal 本身——希望你觉得这相当简单！

在此之后，我们注意到，不时地升级 Drupal 是很重要的；因此，我们讨论了如何实施升级以涵盖这一点。毫无疑问，一切都很顺利，但你不能总是保证这一点，所以我们还花时间探索了一些与安装相关的一些更常见的问题，并制定了一个解决问题的流程。

最后，我们通过创建一个管理用户并在网站上发布一些内容，来熟悉了 Drupal 本身。我们花了一些时间通过启用一个或两个模块来对网站进行相当大的修改，以便观察它对实际网站的影响。利用这一点，我们接着讨论了普通 Drupal 页面的主要元素。

如果你已经走到这一步，那么恭喜你，你准备好开始开发你的网站了！是时候动手了……
